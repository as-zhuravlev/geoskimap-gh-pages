(function(){const D=document.createElement("link").relList;if(D&&D.supports&&D.supports("modulepreload"))return;for(const W of document.querySelectorAll('link[rel="modulepreload"]'))H(W);new MutationObserver(W=>{for(const ee of W)if(ee.type==="childList")for(const A of ee.addedNodes)A.tagName==="LINK"&&A.rel==="modulepreload"&&H(A)}).observe(document,{childList:!0,subtree:!0});function I(W){const ee={};return W.integrity&&(ee.integrity=W.integrity),W.referrerPolicy&&(ee.referrerPolicy=W.referrerPolicy),W.crossOrigin==="use-credentials"?ee.credentials="include":W.crossOrigin==="anonymous"?ee.credentials="omit":ee.credentials="same-origin",ee}function H(W){if(W.ep)return;W.ep=!0;const ee=I(W);fetch(W.href,ee)}})();function tf(T){return T&&T.__esModule&&Object.prototype.hasOwnProperty.call(T,"default")?T.default:T}var Np={exports:{}},od={},jp={exports:{}},Fr={};var Pf;function Ym(){if(Pf)return Fr;Pf=1;var T=Symbol.for("react.element"),D=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),H=Symbol.for("react.strict_mode"),W=Symbol.for("react.profiler"),ee=Symbol.for("react.provider"),A=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),Se=Symbol.for("react.suspense"),Pe=Symbol.for("react.memo"),Le=Symbol.for("react.lazy"),re=Symbol.iterator;function ne(ke){return ke===null||typeof ke!="object"?null:(ke=re&&ke[re]||ke["@@iterator"],typeof ke=="function"?ke:null)}var Ge={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},et=Object.assign,je={};function Xe(ke,He,Gt){this.props=ke,this.context=He,this.refs=je,this.updater=Gt||Ge}Xe.prototype.isReactComponent={},Xe.prototype.setState=function(ke,He){if(typeof ke!="object"&&typeof ke!="function"&&ke!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ke,He,"setState")},Xe.prototype.forceUpdate=function(ke){this.updater.enqueueForceUpdate(this,ke,"forceUpdate")};function Pt(){}Pt.prototype=Xe.prototype;function mt(ke,He,Gt){this.props=ke,this.context=He,this.refs=je,this.updater=Gt||Ge}var St=mt.prototype=new Pt;St.constructor=mt,et(St,Xe.prototype),St.isPureReactComponent=!0;var ar=Array.isArray,ur=Object.prototype.hasOwnProperty,gr={current:null},Vt={key:!0,ref:!0,__self:!0,__source:!0};function zr(ke,He,Gt){var Tt,$t={},rr=null,tr=null;if(He!=null)for(Tt in He.ref!==void 0&&(tr=He.ref),He.key!==void 0&&(rr=""+He.key),He)ur.call(He,Tt)&&!Vt.hasOwnProperty(Tt)&&($t[Tt]=He[Tt]);var cr=arguments.length-2;if(cr===1)$t.children=Gt;else if(1<cr){for(var Ar=Array(cr),bi=0;bi<cr;bi++)Ar[bi]=arguments[bi+2];$t.children=Ar}if(ke&&ke.defaultProps)for(Tt in cr=ke.defaultProps,cr)$t[Tt]===void 0&&($t[Tt]=cr[Tt]);return{$$typeof:T,type:ke,key:rr,ref:tr,props:$t,_owner:gr.current}}function xr(ke,He){return{$$typeof:T,type:ke.type,key:He,ref:ke.ref,props:ke.props,_owner:ke._owner}}function Br(ke){return typeof ke=="object"&&ke!==null&&ke.$$typeof===T}function Et(ke){var He={"=":"=0",":":"=2"};return"$"+ke.replace(/[=:]/g,function(Gt){return He[Gt]})}var Hr=/\/+/g;function kr(ke,He){return typeof ke=="object"&&ke!==null&&ke.key!=null?Et(""+ke.key):He.toString(36)}function _r(ke,He,Gt,Tt,$t){var rr=typeof ke;(rr==="undefined"||rr==="boolean")&&(ke=null);var tr=!1;if(ke===null)tr=!0;else switch(rr){case"string":case"number":tr=!0;break;case"object":switch(ke.$$typeof){case T:case D:tr=!0}}if(tr)return tr=ke,$t=$t(tr),ke=Tt===""?"."+kr(tr,0):Tt,ar($t)?(Gt="",ke!=null&&(Gt=ke.replace(Hr,"$&/")+"/"),_r($t,He,Gt,"",function(bi){return bi})):$t!=null&&(Br($t)&&($t=xr($t,Gt+(!$t.key||tr&&tr.key===$t.key?"":(""+$t.key).replace(Hr,"$&/")+"/")+ke)),He.push($t)),1;if(tr=0,Tt=Tt===""?".":Tt+":",ar(ke))for(var cr=0;cr<ke.length;cr++){rr=ke[cr];var Ar=Tt+kr(rr,cr);tr+=_r(rr,He,Gt,Ar,$t)}else if(Ar=ne(ke),typeof Ar=="function")for(ke=Ar.call(ke),cr=0;!(rr=ke.next()).done;)rr=rr.value,Ar=Tt+kr(rr,cr++),tr+=_r(rr,He,Gt,Ar,$t);else if(rr==="object")throw He=String(ke),Error("Objects are not valid as a React child (found: "+(He==="[object Object]"?"object with keys {"+Object.keys(ke).join(", ")+"}":He)+"). If you meant to render a collection of children, use an array instead.");return tr}function ti(ke,He,Gt){if(ke==null)return ke;var Tt=[],$t=0;return _r(ke,Tt,"","",function(rr){return He.call(Gt,rr,$t++)}),Tt}function Wr(ke){if(ke._status===-1){var He=ke._result;He=He(),He.then(function(Gt){(ke._status===0||ke._status===-1)&&(ke._status=1,ke._result=Gt)},function(Gt){(ke._status===0||ke._status===-1)&&(ke._status=2,ke._result=Gt)}),ke._status===-1&&(ke._status=0,ke._result=He)}if(ke._status===1)return ke._result.default;throw ke._result}var wr={current:null},ft={transition:null},Mt={ReactCurrentDispatcher:wr,ReactCurrentBatchConfig:ft,ReactCurrentOwner:gr};function xt(){throw Error("act(...) is not supported in production builds of React.")}return Fr.Children={map:ti,forEach:function(ke,He,Gt){ti(ke,function(){He.apply(this,arguments)},Gt)},count:function(ke){var He=0;return ti(ke,function(){He++}),He},toArray:function(ke){return ti(ke,function(He){return He})||[]},only:function(ke){if(!Br(ke))throw Error("React.Children.only expected to receive a single React element child.");return ke}},Fr.Component=Xe,Fr.Fragment=I,Fr.Profiler=W,Fr.PureComponent=mt,Fr.StrictMode=H,Fr.Suspense=Se,Fr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Mt,Fr.act=xt,Fr.cloneElement=function(ke,He,Gt){if(ke==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+ke+".");var Tt=et({},ke.props),$t=ke.key,rr=ke.ref,tr=ke._owner;if(He!=null){if(He.ref!==void 0&&(rr=He.ref,tr=gr.current),He.key!==void 0&&($t=""+He.key),ke.type&&ke.type.defaultProps)var cr=ke.type.defaultProps;for(Ar in He)ur.call(He,Ar)&&!Vt.hasOwnProperty(Ar)&&(Tt[Ar]=He[Ar]===void 0&&cr!==void 0?cr[Ar]:He[Ar])}var Ar=arguments.length-2;if(Ar===1)Tt.children=Gt;else if(1<Ar){cr=Array(Ar);for(var bi=0;bi<Ar;bi++)cr[bi]=arguments[bi+2];Tt.children=cr}return{$$typeof:T,type:ke.type,key:$t,ref:rr,props:Tt,_owner:tr}},Fr.createContext=function(ke){return ke={$$typeof:A,_currentValue:ke,_currentValue2:ke,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},ke.Provider={$$typeof:ee,_context:ke},ke.Consumer=ke},Fr.createElement=zr,Fr.createFactory=function(ke){var He=zr.bind(null,ke);return He.type=ke,He},Fr.createRef=function(){return{current:null}},Fr.forwardRef=function(ke){return{$$typeof:d,render:ke}},Fr.isValidElement=Br,Fr.lazy=function(ke){return{$$typeof:Le,_payload:{_status:-1,_result:ke},_init:Wr}},Fr.memo=function(ke,He){return{$$typeof:Pe,type:ke,compare:He===void 0?null:He}},Fr.startTransition=function(ke){var He=ft.transition;ft.transition={};try{ke()}finally{ft.transition=He}},Fr.unstable_act=xt,Fr.useCallback=function(ke,He){return wr.current.useCallback(ke,He)},Fr.useContext=function(ke){return wr.current.useContext(ke)},Fr.useDebugValue=function(){},Fr.useDeferredValue=function(ke){return wr.current.useDeferredValue(ke)},Fr.useEffect=function(ke,He){return wr.current.useEffect(ke,He)},Fr.useId=function(){return wr.current.useId()},Fr.useImperativeHandle=function(ke,He,Gt){return wr.current.useImperativeHandle(ke,He,Gt)},Fr.useInsertionEffect=function(ke,He){return wr.current.useInsertionEffect(ke,He)},Fr.useLayoutEffect=function(ke,He){return wr.current.useLayoutEffect(ke,He)},Fr.useMemo=function(ke,He){return wr.current.useMemo(ke,He)},Fr.useReducer=function(ke,He,Gt){return wr.current.useReducer(ke,He,Gt)},Fr.useRef=function(ke){return wr.current.useRef(ke)},Fr.useState=function(ke){return wr.current.useState(ke)},Fr.useSyncExternalStore=function(ke,He,Gt){return wr.current.useSyncExternalStore(ke,He,Gt)},Fr.useTransition=function(){return wr.current.useTransition()},Fr.version="18.3.1",Fr}var Mf;function rf(){return Mf||(Mf=1,jp.exports=Ym()),jp.exports}var Af;function Qm(){if(Af)return od;Af=1;var T=rf(),D=Symbol.for("react.element"),I=Symbol.for("react.fragment"),H=Object.prototype.hasOwnProperty,W=T.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ee={key:!0,ref:!0,__self:!0,__source:!0};function A(d,Se,Pe){var Le,re={},ne=null,Ge=null;Pe!==void 0&&(ne=""+Pe),Se.key!==void 0&&(ne=""+Se.key),Se.ref!==void 0&&(Ge=Se.ref);for(Le in Se)H.call(Se,Le)&&!ee.hasOwnProperty(Le)&&(re[Le]=Se[Le]);if(d&&d.defaultProps)for(Le in Se=d.defaultProps,Se)re[Le]===void 0&&(re[Le]=Se[Le]);return{$$typeof:D,type:d,key:ne,ref:Ge,props:re,_owner:W.current}}return od.Fragment=I,od.jsx=A,od.jsxs=A,od}var Df;function eg(){return Df||(Df=1,Np.exports=Qm()),Np.exports}var pr=eg(),Ze=rf();const tg=tf(Ze);var Lf="popstate";function rg(T={}){function D(H,W){let{pathname:ee,search:A,hash:d}=H.location;return Kp("",{pathname:ee,search:A,hash:d},W.state&&W.state.usr||null,W.state&&W.state.key||"default")}function I(H,W){return typeof W=="string"?W:ud(W)}return ng(D,I,null,T)}function Vn(T,D){if(T===!1||T===null||typeof T>"u")throw new Error(D)}function Ps(T,D){if(!T){typeof console<"u"&&console.warn(D);try{throw new Error(D)}catch{}}}function ig(){return Math.random().toString(36).substring(2,10)}function Rf(T,D){return{usr:T.state,key:T.key,idx:D}}function Kp(T,D,I=null,H){return{pathname:typeof T=="string"?T:T.pathname,search:"",hash:"",...typeof D=="string"?cd(D):D,state:I,key:D&&D.key||H||ig()}}function ud({pathname:T="/",search:D="",hash:I=""}){return D&&D!=="?"&&(T+=D.charAt(0)==="?"?D:"?"+D),I&&I!=="#"&&(T+=I.charAt(0)==="#"?I:"#"+I),T}function cd(T){let D={};if(T){let I=T.indexOf("#");I>=0&&(D.hash=T.substring(I),T=T.substring(0,I));let H=T.indexOf("?");H>=0&&(D.search=T.substring(H),T=T.substring(0,H)),T&&(D.pathname=T)}return D}function ng(T,D,I,H={}){let{window:W=document.defaultView,v5Compat:ee=!1}=H,A=W.history,d="POP",Se=null,Pe=Le();Pe==null&&(Pe=0,A.replaceState({...A.state,idx:Pe},""));function Le(){return(A.state||{idx:null}).idx}function re(){d="POP";let Xe=Le(),Pt=Xe==null?null:Xe-Pe;Pe=Xe,Se&&Se({action:d,location:je.location,delta:Pt})}function ne(Xe,Pt){d="PUSH";let mt=Kp(je.location,Xe,Pt);Pe=Le()+1;let St=Rf(mt,Pe),ar=je.createHref(mt);try{A.pushState(St,"",ar)}catch(ur){if(ur instanceof DOMException&&ur.name==="DataCloneError")throw ur;W.location.assign(ar)}ee&&Se&&Se({action:d,location:je.location,delta:1})}function Ge(Xe,Pt){d="REPLACE";let mt=Kp(je.location,Xe,Pt);Pe=Le();let St=Rf(mt,Pe),ar=je.createHref(mt);A.replaceState(St,"",ar),ee&&Se&&Se({action:d,location:je.location,delta:0})}function et(Xe){return og(Xe)}let je={get action(){return d},get location(){return T(W,A)},listen(Xe){if(Se)throw new Error("A history only accepts one active listener");return W.addEventListener(Lf,re),Se=Xe,()=>{W.removeEventListener(Lf,re),Se=null}},createHref(Xe){return D(W,Xe)},createURL:et,encodeLocation(Xe){let Pt=et(Xe);return{pathname:Pt.pathname,search:Pt.search,hash:Pt.hash}},push:ne,replace:Ge,go(Xe){return A.go(Xe)}};return je}function og(T,D=!1){let I="http://localhost";typeof window<"u"&&(I=window.location.origin!=="null"?window.location.origin:window.location.href),Vn(I,"No window.location.(origin|href) available to create URL");let H=typeof T=="string"?T:ud(T);return H=H.replace(/ $/,"%20"),!D&&H.startsWith("//")&&(H=I+H),new URL(H,I)}function Hf(T,D,I="/"){return ag(T,D,I,!1)}function ag(T,D,I,H){let W=typeof D=="string"?cd(D):D,ee=fu(W.pathname||"/",I);if(ee==null)return null;let A=Wf(T);sg(A);let d=null;for(let Se=0;d==null&&Se<A.length;++Se){let Pe=_g(ee);d=gg(A[Se],Pe,H)}return d}function Wf(T,D=[],I=[],H="",W=!1){let ee=(A,d,Se=W,Pe)=>{let Le={relativePath:Pe===void 0?A.path||"":Pe,caseSensitive:A.caseSensitive===!0,childrenIndex:d,route:A};if(Le.relativePath.startsWith("/")){if(!Le.relativePath.startsWith(H)&&Se)return;Vn(Le.relativePath.startsWith(H),`Absolute route path "${Le.relativePath}" nested under path "${H}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),Le.relativePath=Le.relativePath.slice(H.length)}let re=pu([H,Le.relativePath]),ne=I.concat(Le);A.children&&A.children.length>0&&(Vn(A.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${re}".`),Wf(A.children,D,ne,re,Se)),!(A.path==null&&!A.index)&&D.push({path:re,score:fg(re,A.index),routesMeta:ne})};return T.forEach((A,d)=>{if(A.path===""||!A.path?.includes("?"))ee(A,d);else for(let Se of Xf(A.path))ee(A,d,!0,Se)}),D}function Xf(T){let D=T.split("/");if(D.length===0)return[];let[I,...H]=D,W=I.endsWith("?"),ee=I.replace(/\?$/,"");if(H.length===0)return W?[ee,""]:[ee];let A=Xf(H.join("/")),d=[];return d.push(...A.map(Se=>Se===""?ee:[ee,Se].join("/"))),W&&d.push(...A),d.map(Se=>T.startsWith("/")&&Se===""?"/":Se)}function sg(T){T.sort((D,I)=>D.score!==I.score?I.score-D.score:mg(D.routesMeta.map(H=>H.childrenIndex),I.routesMeta.map(H=>H.childrenIndex)))}var lg=/^:[\w-]+$/,ug=3,cg=2,hg=1,dg=10,pg=-2,Ff=T=>T==="*";function fg(T,D){let I=T.split("/"),H=I.length;return I.some(Ff)&&(H+=pg),D&&(H+=cg),I.filter(W=>!Ff(W)).reduce((W,ee)=>W+(lg.test(ee)?ug:ee===""?hg:dg),H)}function mg(T,D){return T.length===D.length&&T.slice(0,-1).every((H,W)=>H===D[W])?T[T.length-1]-D[D.length-1]:0}function gg(T,D,I=!1){let{routesMeta:H}=T,W={},ee="/",A=[];for(let d=0;d<H.length;++d){let Se=H[d],Pe=d===H.length-1,Le=ee==="/"?D:D.slice(ee.length)||"/",re=cp({path:Se.relativePath,caseSensitive:Se.caseSensitive,end:Pe},Le),ne=Se.route;if(!re&&Pe&&I&&!H[H.length-1].route.index&&(re=cp({path:Se.relativePath,caseSensitive:Se.caseSensitive,end:!1},Le)),!re)return null;Object.assign(W,re.params),A.push({params:W,pathname:pu([ee,re.pathname]),pathnameBase:bg(pu([ee,re.pathnameBase])),route:ne}),re.pathnameBase!=="/"&&(ee=pu([ee,re.pathnameBase]))}return A}function cp(T,D){typeof T=="string"&&(T={path:T,caseSensitive:!1,end:!0});let[I,H]=yg(T.path,T.caseSensitive,T.end),W=D.match(I);if(!W)return null;let ee=W[0],A=ee.replace(/(.)\/+$/,"$1"),d=W.slice(1);return{params:H.reduce((Pe,{paramName:Le,isOptional:re},ne)=>{if(Le==="*"){let et=d[ne]||"";A=ee.slice(0,ee.length-et.length).replace(/(.)\/+$/,"$1")}const Ge=d[ne];return re&&!Ge?Pe[Le]=void 0:Pe[Le]=(Ge||"").replace(/%2F/g,"/"),Pe},{}),pathname:ee,pathnameBase:A,pattern:T}}function yg(T,D=!1,I=!0){Ps(T==="*"||!T.endsWith("*")||T.endsWith("/*"),`Route path "${T}" will be treated as if it were "${T.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${T.replace(/\*$/,"/*")}".`);let H=[],W="^"+T.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(A,d,Se)=>(H.push({paramName:d,isOptional:Se!=null}),Se?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return T.endsWith("*")?(H.push({paramName:"*"}),W+=T==="*"||T==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):I?W+="\\/*$":T!==""&&T!=="/"&&(W+="(?:(?=\\/|$))"),[new RegExp(W,D?void 0:"i"),H]}function _g(T){try{return T.split("/").map(D=>decodeURIComponent(D).replace(/\//g,"%2F")).join("/")}catch(D){return Ps(!1,`The URL path "${T}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${D}).`),T}}function fu(T,D){if(D==="/")return T;if(!T.toLowerCase().startsWith(D.toLowerCase()))return null;let I=D.endsWith("/")?D.length-1:D.length,H=T.charAt(I);return H&&H!=="/"?null:T.slice(I)||"/"}var Kf=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,vg=T=>Kf.test(T);function xg(T,D="/"){let{pathname:I,search:H="",hash:W=""}=typeof T=="string"?cd(T):T,ee;if(I)if(vg(I))ee=I;else{if(I.includes("//")){let A=I;I=I.replace(/\/\/+/g,"/"),Ps(!1,`Pathnames cannot have embedded double slashes - normalizing ${A} -> ${I}`)}I.startsWith("/")?ee=Bf(I.substring(1),"/"):ee=Bf(I,D)}else ee=D;return{pathname:ee,search:Sg(H),hash:kg(W)}}function Bf(T,D){let I=D.replace(/\/+$/,"").split("/");return T.split("/").forEach(W=>{W===".."?I.length>1&&I.pop():W!=="."&&I.push(W)}),I.length>1?I.join("/"):"/"}function Vp(T,D,I,H){return`Cannot include a '${T}' character in a manually specified \`to.${D}\` field [${JSON.stringify(H)}].  Please separate it out to the \`to.${I}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function wg(T){return T.filter((D,I)=>I===0||D.route.path&&D.route.path.length>0)}function Jf(T){let D=wg(T);return D.map((I,H)=>H===D.length-1?I.pathname:I.pathnameBase)}function Yf(T,D,I,H=!1){let W;typeof T=="string"?W=cd(T):(W={...T},Vn(!W.pathname||!W.pathname.includes("?"),Vp("?","pathname","search",W)),Vn(!W.pathname||!W.pathname.includes("#"),Vp("#","pathname","hash",W)),Vn(!W.search||!W.search.includes("#"),Vp("#","search","hash",W)));let ee=T===""||W.pathname==="",A=ee?"/":W.pathname,d;if(A==null)d=I;else{let re=D.length-1;if(!H&&A.startsWith("..")){let ne=A.split("/");for(;ne[0]==="..";)ne.shift(),re-=1;W.pathname=ne.join("/")}d=re>=0?D[re]:"/"}let Se=xg(W,d),Pe=A&&A!=="/"&&A.endsWith("/"),Le=(ee||A===".")&&I.endsWith("/");return!Se.pathname.endsWith("/")&&(Pe||Le)&&(Se.pathname+="/"),Se}var pu=T=>T.join("/").replace(/\/\/+/g,"/"),bg=T=>T.replace(/\/+$/,"").replace(/^\/*/,"/"),Sg=T=>!T||T==="?"?"":T.startsWith("?")?T:"?"+T,kg=T=>!T||T==="#"?"":T.startsWith("#")?T:"#"+T,Tg=class{constructor(T,D,I,H=!1){this.status=T,this.statusText=D||"",this.internal=H,I instanceof Error?(this.data=I.toString(),this.error=I):this.data=I}};function zg(T){return T!=null&&typeof T.status=="number"&&typeof T.statusText=="string"&&typeof T.internal=="boolean"&&"data"in T}function Eg(T){return T.map(D=>D.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Qf=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function em(T,D){let I=T;if(typeof I!="string"||!Kf.test(I))return{absoluteURL:void 0,isExternal:!1,to:I};let H=I,W=!1;if(Qf)try{let ee=new URL(window.location.href),A=I.startsWith("//")?new URL(ee.protocol+I):new URL(I),d=fu(A.pathname,D);A.origin===ee.origin&&d!=null?I=d+A.search+A.hash:W=!0}catch{Ps(!1,`<Link to="${I}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:H,isExternal:W,to:I}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var tm=["POST","PUT","PATCH","DELETE"];new Set(tm);var Cg=["GET",...tm];new Set(Cg);var Ch=Ze.createContext(null);Ch.displayName="DataRouter";var hp=Ze.createContext(null);hp.displayName="DataRouterState";var Ig=Ze.createContext(!1),rm=Ze.createContext({isTransitioning:!1});rm.displayName="ViewTransition";var Pg=Ze.createContext(new Map);Pg.displayName="Fetchers";var Mg=Ze.createContext(null);Mg.displayName="Await";var Ms=Ze.createContext(null);Ms.displayName="Navigation";var dp=Ze.createContext(null);dp.displayName="Location";var mu=Ze.createContext({outlet:null,matches:[],isDataRoute:!1});mu.displayName="Route";var nf=Ze.createContext(null);nf.displayName="RouteError";var im="REACT_ROUTER_ERROR",Ag="REDIRECT",Dg="ROUTE_ERROR_RESPONSE";function Lg(T){if(T.startsWith(`${im}:${Ag}:{`))try{let D=JSON.parse(T.slice(28));if(typeof D=="object"&&D&&typeof D.status=="number"&&typeof D.statusText=="string"&&typeof D.location=="string"&&typeof D.reloadDocument=="boolean"&&typeof D.replace=="boolean")return D}catch{}}function Rg(T){if(T.startsWith(`${im}:${Dg}:{`))try{let D=JSON.parse(T.slice(40));if(typeof D=="object"&&D&&typeof D.status=="number"&&typeof D.statusText=="string")return new Tg(D.status,D.statusText,D.data)}catch{}}function Fg(T,{relative:D}={}){Vn(hd(),"useHref() may be used only in the context of a <Router> component.");let{basename:I,navigator:H}=Ze.useContext(Ms),{hash:W,pathname:ee,search:A}=dd(T,{relative:D}),d=ee;return I!=="/"&&(d=ee==="/"?I:pu([I,ee])),H.createHref({pathname:d,search:A,hash:W})}function hd(){return Ze.useContext(dp)!=null}function $u(){return Vn(hd(),"useLocation() may be used only in the context of a <Router> component."),Ze.useContext(dp).location}var nm="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function om(T){Ze.useContext(Ms).static||Ze.useLayoutEffect(T)}function am(){let{isDataRoute:T}=Ze.useContext(mu);return T?Xg():Bg()}function Bg(){Vn(hd(),"useNavigate() may be used only in the context of a <Router> component.");let T=Ze.useContext(Ch),{basename:D,navigator:I}=Ze.useContext(Ms),{matches:H}=Ze.useContext(mu),{pathname:W}=$u(),ee=JSON.stringify(Jf(H)),A=Ze.useRef(!1);return om(()=>{A.current=!0}),Ze.useCallback((Se,Pe={})=>{if(Ps(A.current,nm),!A.current)return;if(typeof Se=="number"){I.go(Se);return}let Le=Yf(Se,JSON.parse(ee),W,Pe.relative==="path");T==null&&D!=="/"&&(Le.pathname=Le.pathname==="/"?D:pu([D,Le.pathname])),(Pe.replace?I.replace:I.push)(Le,Pe.state,Pe)},[D,I,ee,W,T])}Ze.createContext(null);function dd(T,{relative:D}={}){let{matches:I}=Ze.useContext(mu),{pathname:H}=$u(),W=JSON.stringify(Jf(I));return Ze.useMemo(()=>Yf(T,JSON.parse(W),H,D==="path"),[T,W,H,D])}function Og(T,D,I,H,W){Vn(hd(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:ee}=Ze.useContext(Ms),{matches:A}=Ze.useContext(mu),d=A[A.length-1],Se=d?d.params:{},Pe=d?d.pathname:"/",Le=d?d.pathnameBase:"/",re=d&&d.route;{let mt=re&&re.path||"";lm(Pe,!re||mt.endsWith("*")||mt.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${Pe}" (under <Route path="${mt}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${mt}"> to <Route path="${mt==="/"?"*":`${mt}/*`}">.`)}let ne=$u(),Ge;Ge=ne;let et=Ge.pathname||"/",je=et;if(Le!=="/"){let mt=Le.replace(/^\//,"").split("/");je="/"+et.replace(/^\//,"").split("/").slice(mt.length).join("/")}let Xe=Hf(T,{pathname:je});return Ps(re||Xe!=null,`No routes matched location "${Ge.pathname}${Ge.search}${Ge.hash}" `),Ps(Xe==null||Xe[Xe.length-1].route.element!==void 0||Xe[Xe.length-1].route.Component!==void 0||Xe[Xe.length-1].route.lazy!==void 0,`Matched leaf route at location "${Ge.pathname}${Ge.search}${Ge.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),$g(Xe&&Xe.map(mt=>Object.assign({},mt,{params:Object.assign({},Se,mt.params),pathname:pu([Le,ee.encodeLocation?ee.encodeLocation(mt.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:mt.pathname]),pathnameBase:mt.pathnameBase==="/"?Le:pu([Le,ee.encodeLocation?ee.encodeLocation(mt.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:mt.pathnameBase])})),A,I,H,W)}function Ng(){let T=Wg(),D=zg(T)?`${T.status} ${T.statusText}`:T instanceof Error?T.message:JSON.stringify(T),I=T instanceof Error?T.stack:null,H="rgba(200,200,200, 0.5)",W={padding:"0.5rem",backgroundColor:H},ee={padding:"2px 4px",backgroundColor:H},A=null;return console.error("Error handled by React Router default ErrorBoundary:",T),A=Ze.createElement(Ze.Fragment,null,Ze.createElement("p",null,"ðŸ’¿ Hey developer ðŸ‘‹"),Ze.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Ze.createElement("code",{style:ee},"ErrorBoundary")," or"," ",Ze.createElement("code",{style:ee},"errorElement")," prop on your route.")),Ze.createElement(Ze.Fragment,null,Ze.createElement("h2",null,"Unexpected Application Error!"),Ze.createElement("h3",{style:{fontStyle:"italic"}},D),I?Ze.createElement("pre",{style:W},I):null,A)}var jg=Ze.createElement(Ng,null),sm=class extends Ze.Component{constructor(T){super(T),this.state={location:T.location,revalidation:T.revalidation,error:T.error}}static getDerivedStateFromError(T){return{error:T}}static getDerivedStateFromProps(T,D){return D.location!==T.location||D.revalidation!=="idle"&&T.revalidation==="idle"?{error:T.error,location:T.location,revalidation:T.revalidation}:{error:T.error!==void 0?T.error:D.error,location:D.location,revalidation:T.revalidation||D.revalidation}}componentDidCatch(T,D){this.props.onError?this.props.onError(T,D):console.error("React Router caught the following error during render",T)}render(){let T=this.state.error;if(this.context&&typeof T=="object"&&T&&"digest"in T&&typeof T.digest=="string"){const I=Rg(T.digest);I&&(T=I)}let D=T!==void 0?Ze.createElement(mu.Provider,{value:this.props.routeContext},Ze.createElement(nf.Provider,{value:T,children:this.props.component})):this.props.children;return this.context?Ze.createElement(Vg,{error:T},D):D}};sm.contextType=Ig;var Up=new WeakMap;function Vg({children:T,error:D}){let{basename:I}=Ze.useContext(Ms);if(typeof D=="object"&&D&&"digest"in D&&typeof D.digest=="string"){let H=Lg(D.digest);if(H){let W=Up.get(D);if(W)throw W;let ee=em(H.location,I);if(Qf&&!Up.get(D))if(ee.isExternal||H.reloadDocument)window.location.href=ee.absoluteURL||ee.to;else{const A=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(ee.to,{replace:H.replace}));throw Up.set(D,A),A}return Ze.createElement("meta",{httpEquiv:"refresh",content:`0;url=${ee.absoluteURL||ee.to}`})}}return T}function Ug({routeContext:T,match:D,children:I}){let H=Ze.useContext(Ch);return H&&H.static&&H.staticContext&&(D.route.errorElement||D.route.ErrorBoundary)&&(H.staticContext._deepestRenderedBoundaryId=D.route.id),Ze.createElement(mu.Provider,{value:T},I)}function $g(T,D=[],I=null,H=null,W=null){if(T==null){if(!I)return null;if(I.errors)T=I.matches;else if(D.length===0&&!I.initialized&&I.matches.length>0)T=I.matches;else return null}let ee=T,A=I?.errors;if(A!=null){let Le=ee.findIndex(re=>re.route.id&&A?.[re.route.id]!==void 0);Vn(Le>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(A).join(",")}`),ee=ee.slice(0,Math.min(ee.length,Le+1))}let d=!1,Se=-1;if(I)for(let Le=0;Le<ee.length;Le++){let re=ee[Le];if((re.route.HydrateFallback||re.route.hydrateFallbackElement)&&(Se=Le),re.route.id){let{loaderData:ne,errors:Ge}=I,et=re.route.loader&&!ne.hasOwnProperty(re.route.id)&&(!Ge||Ge[re.route.id]===void 0);if(re.route.lazy||et){d=!0,Se>=0?ee=ee.slice(0,Se+1):ee=[ee[0]];break}}}let Pe=I&&H?(Le,re)=>{H(Le,{location:I.location,params:I.matches?.[0]?.params??{},unstable_pattern:Eg(I.matches),errorInfo:re})}:void 0;return ee.reduceRight((Le,re,ne)=>{let Ge,et=!1,je=null,Xe=null;I&&(Ge=A&&re.route.id?A[re.route.id]:void 0,je=re.route.errorElement||jg,d&&(Se<0&&ne===0?(lm("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),et=!0,Xe=null):Se===ne&&(et=!0,Xe=re.route.hydrateFallbackElement||null)));let Pt=D.concat(ee.slice(0,ne+1)),mt=()=>{let St;return Ge?St=je:et?St=Xe:re.route.Component?St=Ze.createElement(re.route.Component,null):re.route.element?St=re.route.element:St=Le,Ze.createElement(Ug,{match:re,routeContext:{outlet:Le,matches:Pt,isDataRoute:I!=null},children:St})};return I&&(re.route.ErrorBoundary||re.route.errorElement||ne===0)?Ze.createElement(sm,{location:I.location,revalidation:I.revalidation,component:je,error:Ge,children:mt(),routeContext:{outlet:null,matches:Pt,isDataRoute:!0},onError:Pe}):mt()},null)}function of(T){return`${T} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Zg(T){let D=Ze.useContext(Ch);return Vn(D,of(T)),D}function qg(T){let D=Ze.useContext(hp);return Vn(D,of(T)),D}function Gg(T){let D=Ze.useContext(mu);return Vn(D,of(T)),D}function af(T){let D=Gg(T),I=D.matches[D.matches.length-1];return Vn(I.route.id,`${T} can only be used on routes that contain a unique "id"`),I.route.id}function Hg(){return af("useRouteId")}function Wg(){let T=Ze.useContext(nf),D=qg("useRouteError"),I=af("useRouteError");return T!==void 0?T:D.errors?.[I]}function Xg(){let{router:T}=Zg("useNavigate"),D=af("useNavigate"),I=Ze.useRef(!1);return om(()=>{I.current=!0}),Ze.useCallback(async(W,ee={})=>{Ps(I.current,nm),I.current&&(typeof W=="number"?await T.navigate(W):await T.navigate(W,{fromRouteId:D,...ee}))},[T,D])}var Of={};function lm(T,D,I){!D&&!Of[T]&&(Of[T]=!0,Ps(!1,I))}Ze.memo(Kg);function Kg({routes:T,future:D,state:I,onError:H}){return Og(T,void 0,I,H,D)}function Jg({basename:T="/",children:D=null,location:I,navigationType:H="POP",navigator:W,static:ee=!1,unstable_useTransitions:A}){Vn(!hd(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=T.replace(/^\/*/,"/"),Se=Ze.useMemo(()=>({basename:d,navigator:W,static:ee,unstable_useTransitions:A,future:{}}),[d,W,ee,A]);typeof I=="string"&&(I=cd(I));let{pathname:Pe="/",search:Le="",hash:re="",state:ne=null,key:Ge="default"}=I,et=Ze.useMemo(()=>{let je=fu(Pe,d);return je==null?null:{location:{pathname:je,search:Le,hash:re,state:ne,key:Ge},navigationType:H}},[d,Pe,Le,re,ne,Ge,H]);return Ps(et!=null,`<Router basename="${d}"> is not able to match the URL "${Pe}${Le}${re}" because it does not start with the basename, so the <Router> won't render anything.`),et==null?null:Ze.createElement(Ms.Provider,{value:Se},Ze.createElement(dp.Provider,{children:D,value:et}))}var sp="get",lp="application/x-www-form-urlencoded";function pp(T){return typeof HTMLElement<"u"&&T instanceof HTMLElement}function Yg(T){return pp(T)&&T.tagName.toLowerCase()==="button"}function Qg(T){return pp(T)&&T.tagName.toLowerCase()==="form"}function ey(T){return pp(T)&&T.tagName.toLowerCase()==="input"}function ty(T){return!!(T.metaKey||T.altKey||T.ctrlKey||T.shiftKey)}function ry(T,D){return T.button===0&&(!D||D==="_self")&&!ty(T)}function Jp(T=""){return new URLSearchParams(typeof T=="string"||Array.isArray(T)||T instanceof URLSearchParams?T:Object.keys(T).reduce((D,I)=>{let H=T[I];return D.concat(Array.isArray(H)?H.map(W=>[I,W]):[[I,H]])},[]))}function iy(T,D){let I=Jp(T);return D&&D.forEach((H,W)=>{I.has(W)||D.getAll(W).forEach(ee=>{I.append(W,ee)})}),I}var np=null;function ny(){if(np===null)try{new FormData(document.createElement("form"),0),np=!1}catch{np=!0}return np}var oy=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function $p(T){return T!=null&&!oy.has(T)?(Ps(!1,`"${T}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${lp}"`),null):T}function ay(T,D){let I,H,W,ee,A;if(Qg(T)){let d=T.getAttribute("action");H=d?fu(d,D):null,I=T.getAttribute("method")||sp,W=$p(T.getAttribute("enctype"))||lp,ee=new FormData(T)}else if(Yg(T)||ey(T)&&(T.type==="submit"||T.type==="image")){let d=T.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let Se=T.getAttribute("formaction")||d.getAttribute("action");if(H=Se?fu(Se,D):null,I=T.getAttribute("formmethod")||d.getAttribute("method")||sp,W=$p(T.getAttribute("formenctype"))||$p(d.getAttribute("enctype"))||lp,ee=new FormData(d,T),!ny()){let{name:Pe,type:Le,value:re}=T;if(Le==="image"){let ne=Pe?`${Pe}.`:"";ee.append(`${ne}x`,"0"),ee.append(`${ne}y`,"0")}else Pe&&ee.append(Pe,re)}}else{if(pp(T))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');I=sp,H=null,W=lp,A=T}return ee&&W==="text/plain"&&(A=ee,ee=void 0),{action:H,method:I.toLowerCase(),encType:W,formData:ee,body:A}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function sf(T,D){if(T===!1||T===null||typeof T>"u")throw new Error(D)}function sy(T,D,I,H){let W=typeof T=="string"?new URL(T,typeof window>"u"?"server://singlefetch/":window.location.origin):T;return I?W.pathname.endsWith("/")?W.pathname=`${W.pathname}_.${H}`:W.pathname=`${W.pathname}.${H}`:W.pathname==="/"?W.pathname=`_root.${H}`:D&&fu(W.pathname,D)==="/"?W.pathname=`${D.replace(/\/$/,"")}/_root.${H}`:W.pathname=`${W.pathname.replace(/\/$/,"")}.${H}`,W}async function ly(T,D){if(T.id in D)return D[T.id];try{let I=await import(T.module);return D[T.id]=I,I}catch(I){return console.error(`Error loading route module \`${T.module}\`, reloading page...`),console.error(I),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function uy(T){return T==null?!1:T.href==null?T.rel==="preload"&&typeof T.imageSrcSet=="string"&&typeof T.imageSizes=="string":typeof T.rel=="string"&&typeof T.href=="string"}async function cy(T,D,I){let H=await Promise.all(T.map(async W=>{let ee=D.routes[W.route.id];if(ee){let A=await ly(ee,I);return A.links?A.links():[]}return[]}));return fy(H.flat(1).filter(uy).filter(W=>W.rel==="stylesheet"||W.rel==="preload").map(W=>W.rel==="stylesheet"?{...W,rel:"prefetch",as:"style"}:{...W,rel:"prefetch"}))}function Nf(T,D,I,H,W,ee){let A=(Se,Pe)=>I[Pe]?Se.route.id!==I[Pe].route.id:!0,d=(Se,Pe)=>I[Pe].pathname!==Se.pathname||I[Pe].route.path?.endsWith("*")&&I[Pe].params["*"]!==Se.params["*"];return ee==="assets"?D.filter((Se,Pe)=>A(Se,Pe)||d(Se,Pe)):ee==="data"?D.filter((Se,Pe)=>{let Le=H.routes[Se.route.id];if(!Le||!Le.hasLoader)return!1;if(A(Se,Pe)||d(Se,Pe))return!0;if(Se.route.shouldRevalidate){let re=Se.route.shouldRevalidate({currentUrl:new URL(W.pathname+W.search+W.hash,window.origin),currentParams:I[0]?.params||{},nextUrl:new URL(T,window.origin),nextParams:Se.params,defaultShouldRevalidate:!0});if(typeof re=="boolean")return re}return!0}):[]}function hy(T,D,{includeHydrateFallback:I}={}){return dy(T.map(H=>{let W=D.routes[H.route.id];if(!W)return[];let ee=[W.module];return W.clientActionModule&&(ee=ee.concat(W.clientActionModule)),W.clientLoaderModule&&(ee=ee.concat(W.clientLoaderModule)),I&&W.hydrateFallbackModule&&(ee=ee.concat(W.hydrateFallbackModule)),W.imports&&(ee=ee.concat(W.imports)),ee}).flat(1))}function dy(T){return[...new Set(T)]}function py(T){let D={},I=Object.keys(T).sort();for(let H of I)D[H]=T[H];return D}function fy(T,D){let I=new Set;return new Set(D),T.reduce((H,W)=>{let ee=JSON.stringify(py(W));return I.has(ee)||(I.add(ee),H.push({key:ee,link:W})),H},[])}function um(){let T=Ze.useContext(Ch);return sf(T,"You must render this element inside a <DataRouterContext.Provider> element"),T}function my(){let T=Ze.useContext(hp);return sf(T,"You must render this element inside a <DataRouterStateContext.Provider> element"),T}var lf=Ze.createContext(void 0);lf.displayName="FrameworkContext";function cm(){let T=Ze.useContext(lf);return sf(T,"You must render this element inside a <HydratedRouter> element"),T}function gy(T,D){let I=Ze.useContext(lf),[H,W]=Ze.useState(!1),[ee,A]=Ze.useState(!1),{onFocus:d,onBlur:Se,onMouseEnter:Pe,onMouseLeave:Le,onTouchStart:re}=D,ne=Ze.useRef(null);Ze.useEffect(()=>{if(T==="render"&&A(!0),T==="viewport"){let je=Pt=>{Pt.forEach(mt=>{A(mt.isIntersecting)})},Xe=new IntersectionObserver(je,{threshold:.5});return ne.current&&Xe.observe(ne.current),()=>{Xe.disconnect()}}},[T]),Ze.useEffect(()=>{if(H){let je=setTimeout(()=>{A(!0)},100);return()=>{clearTimeout(je)}}},[H]);let Ge=()=>{W(!0)},et=()=>{W(!1),A(!1)};return I?T!=="intent"?[ee,ne,{}]:[ee,ne,{onFocus:ad(d,Ge),onBlur:ad(Se,et),onMouseEnter:ad(Pe,Ge),onMouseLeave:ad(Le,et),onTouchStart:ad(re,Ge)}]:[!1,ne,{}]}function ad(T,D){return I=>{T&&T(I),I.defaultPrevented||D(I)}}function yy({page:T,...D}){let{router:I}=um(),H=Ze.useMemo(()=>Hf(I.routes,T,I.basename),[I.routes,T,I.basename]);return H?Ze.createElement(vy,{page:T,matches:H,...D}):null}function _y(T){let{manifest:D,routeModules:I}=cm(),[H,W]=Ze.useState([]);return Ze.useEffect(()=>{let ee=!1;return cy(T,D,I).then(A=>{ee||W(A)}),()=>{ee=!0}},[T,D,I]),H}function vy({page:T,matches:D,...I}){let H=$u(),{future:W,manifest:ee,routeModules:A}=cm(),{basename:d}=um(),{loaderData:Se,matches:Pe}=my(),Le=Ze.useMemo(()=>Nf(T,D,Pe,ee,H,"data"),[T,D,Pe,ee,H]),re=Ze.useMemo(()=>Nf(T,D,Pe,ee,H,"assets"),[T,D,Pe,ee,H]),ne=Ze.useMemo(()=>{if(T===H.pathname+H.search+H.hash)return[];let je=new Set,Xe=!1;if(D.forEach(mt=>{let St=ee.routes[mt.route.id];!St||!St.hasLoader||(!Le.some(ar=>ar.route.id===mt.route.id)&&mt.route.id in Se&&A[mt.route.id]?.shouldRevalidate||St.hasClientLoader?Xe=!0:je.add(mt.route.id))}),je.size===0)return[];let Pt=sy(T,d,W.unstable_trailingSlashAwareDataRequests,"data");return Xe&&je.size>0&&Pt.searchParams.set("_routes",D.filter(mt=>je.has(mt.route.id)).map(mt=>mt.route.id).join(",")),[Pt.pathname+Pt.search]},[d,W.unstable_trailingSlashAwareDataRequests,Se,H,ee,Le,D,T,A]),Ge=Ze.useMemo(()=>hy(re,ee),[re,ee]),et=_y(re);return Ze.createElement(Ze.Fragment,null,ne.map(je=>Ze.createElement("link",{key:je,rel:"prefetch",as:"fetch",href:je,...I})),Ge.map(je=>Ze.createElement("link",{key:je,rel:"modulepreload",href:je,...I})),et.map(({key:je,link:Xe})=>Ze.createElement("link",{key:je,nonce:I.nonce,...Xe})))}function xy(...T){return D=>{T.forEach(I=>{typeof I=="function"?I(D):I!=null&&(I.current=D)})}}var wy=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{wy&&(window.__reactRouterVersion="7.12.0")}catch{}function by({basename:T,children:D,unstable_useTransitions:I,window:H}){let W=Ze.useRef();W.current==null&&(W.current=rg({window:H,v5Compat:!0}));let ee=W.current,[A,d]=Ze.useState({action:ee.action,location:ee.location}),Se=Ze.useCallback(Pe=>{I===!1?d(Pe):Ze.startTransition(()=>d(Pe))},[I]);return Ze.useLayoutEffect(()=>ee.listen(Se),[ee,Se]),Ze.createElement(Jg,{basename:T,children:D,location:A.location,navigationType:A.action,navigator:ee,unstable_useTransitions:I})}var hm=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,dm=Ze.forwardRef(function({onClick:D,discover:I="render",prefetch:H="none",relative:W,reloadDocument:ee,replace:A,state:d,target:Se,to:Pe,preventScrollReset:Le,viewTransition:re,unstable_defaultShouldRevalidate:ne,...Ge},et){let{basename:je,unstable_useTransitions:Xe}=Ze.useContext(Ms),Pt=typeof Pe=="string"&&hm.test(Pe),mt=em(Pe,je);Pe=mt.to;let St=Fg(Pe,{relative:W}),[ar,ur,gr]=gy(H,Ge),Vt=zy(Pe,{replace:A,state:d,target:Se,preventScrollReset:Le,relative:W,viewTransition:re,unstable_defaultShouldRevalidate:ne,unstable_useTransitions:Xe});function zr(Br){D&&D(Br),Br.defaultPrevented||Vt(Br)}let xr=Ze.createElement("a",{...Ge,...gr,href:mt.absoluteURL||St,onClick:mt.isExternal||ee?D:zr,ref:xy(et,ur),target:Se,"data-discover":!Pt&&I==="render"?"true":void 0});return ar&&!Pt?Ze.createElement(Ze.Fragment,null,xr,Ze.createElement(yy,{page:St})):xr});dm.displayName="Link";var Sy=Ze.forwardRef(function({"aria-current":D="page",caseSensitive:I=!1,className:H="",end:W=!1,style:ee,to:A,viewTransition:d,children:Se,...Pe},Le){let re=dd(A,{relative:Pe.relative}),ne=$u(),Ge=Ze.useContext(hp),{navigator:et,basename:je}=Ze.useContext(Ms),Xe=Ge!=null&&Ay(re)&&d===!0,Pt=et.encodeLocation?et.encodeLocation(re).pathname:re.pathname,mt=ne.pathname,St=Ge&&Ge.navigation&&Ge.navigation.location?Ge.navigation.location.pathname:null;I||(mt=mt.toLowerCase(),St=St?St.toLowerCase():null,Pt=Pt.toLowerCase()),St&&je&&(St=fu(St,je)||St);const ar=Pt!=="/"&&Pt.endsWith("/")?Pt.length-1:Pt.length;let ur=mt===Pt||!W&&mt.startsWith(Pt)&&mt.charAt(ar)==="/",gr=St!=null&&(St===Pt||!W&&St.startsWith(Pt)&&St.charAt(Pt.length)==="/"),Vt={isActive:ur,isPending:gr,isTransitioning:Xe},zr=ur?D:void 0,xr;typeof H=="function"?xr=H(Vt):xr=[H,ur?"active":null,gr?"pending":null,Xe?"transitioning":null].filter(Boolean).join(" ");let Br=typeof ee=="function"?ee(Vt):ee;return Ze.createElement(dm,{...Pe,"aria-current":zr,className:xr,ref:Le,style:Br,to:A,viewTransition:d},typeof Se=="function"?Se(Vt):Se)});Sy.displayName="NavLink";var ky=Ze.forwardRef(({discover:T="render",fetcherKey:D,navigate:I,reloadDocument:H,replace:W,state:ee,method:A=sp,action:d,onSubmit:Se,relative:Pe,preventScrollReset:Le,viewTransition:re,unstable_defaultShouldRevalidate:ne,...Ge},et)=>{let{unstable_useTransitions:je}=Ze.useContext(Ms),Xe=Py(),Pt=My(d,{relative:Pe}),mt=A.toLowerCase()==="get"?"get":"post",St=typeof d=="string"&&hm.test(d),ar=ur=>{if(Se&&Se(ur),ur.defaultPrevented)return;ur.preventDefault();let gr=ur.nativeEvent.submitter,Vt=gr?.getAttribute("formmethod")||A,zr=()=>Xe(gr||ur.currentTarget,{fetcherKey:D,method:Vt,navigate:I,replace:W,state:ee,relative:Pe,preventScrollReset:Le,viewTransition:re,unstable_defaultShouldRevalidate:ne});je&&I!==!1?Ze.startTransition(()=>zr()):zr()};return Ze.createElement("form",{ref:et,method:mt,action:Pt,onSubmit:H?Se:ar,...Ge,"data-discover":!St&&T==="render"?"true":void 0})});ky.displayName="Form";function Ty(T){return`${T} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function pm(T){let D=Ze.useContext(Ch);return Vn(D,Ty(T)),D}function zy(T,{target:D,replace:I,state:H,preventScrollReset:W,relative:ee,viewTransition:A,unstable_defaultShouldRevalidate:d,unstable_useTransitions:Se}={}){let Pe=am(),Le=$u(),re=dd(T,{relative:ee});return Ze.useCallback(ne=>{if(ry(ne,D)){ne.preventDefault();let Ge=I!==void 0?I:ud(Le)===ud(re),et=()=>Pe(T,{replace:Ge,state:H,preventScrollReset:W,relative:ee,viewTransition:A,unstable_defaultShouldRevalidate:d});Se?Ze.startTransition(()=>et()):et()}},[Le,Pe,re,I,H,D,T,W,ee,A,d,Se])}function Ey(T){Ps(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let D=Ze.useRef(Jp(T)),I=Ze.useRef(!1),H=$u(),W=Ze.useMemo(()=>iy(H.search,I.current?null:D.current),[H.search]),ee=am(),A=Ze.useCallback((d,Se)=>{const Pe=Jp(typeof d=="function"?d(new URLSearchParams(W)):d);I.current=!0,ee("?"+Pe,Se)},[ee,W]);return[W,A]}var Cy=0,Iy=()=>`__${String(++Cy)}__`;function Py(){let{router:T}=pm("useSubmit"),{basename:D}=Ze.useContext(Ms),I=Hg(),H=T.fetch,W=T.navigate;return Ze.useCallback(async(ee,A={})=>{let{action:d,method:Se,encType:Pe,formData:Le,body:re}=ay(ee,D);if(A.navigate===!1){let ne=A.fetcherKey||Iy();await H(ne,I,A.action||d,{unstable_defaultShouldRevalidate:A.unstable_defaultShouldRevalidate,preventScrollReset:A.preventScrollReset,formData:Le,body:re,formMethod:A.method||Se,formEncType:A.encType||Pe,flushSync:A.flushSync})}else await W(A.action||d,{unstable_defaultShouldRevalidate:A.unstable_defaultShouldRevalidate,preventScrollReset:A.preventScrollReset,formData:Le,body:re,formMethod:A.method||Se,formEncType:A.encType||Pe,replace:A.replace,state:A.state,fromRouteId:I,flushSync:A.flushSync,viewTransition:A.viewTransition})},[H,W,D,I])}function My(T,{relative:D}={}){let{basename:I}=Ze.useContext(Ms),H=Ze.useContext(mu);Vn(H,"useFormAction must be used inside a RouteContext");let[W]=H.matches.slice(-1),ee={...dd(T||".",{relative:D})},A=$u();if(T==null){ee.search=A.search;let d=new URLSearchParams(ee.search),Se=d.getAll("index");if(Se.some(Le=>Le==="")){d.delete("index"),Se.filter(re=>re).forEach(re=>d.append("index",re));let Le=d.toString();ee.search=Le?`?${Le}`:""}}return(!T||T===".")&&W.route.index&&(ee.search=ee.search?ee.search.replace(/^\?/,"?index&"):"?index"),I!=="/"&&(ee.pathname=ee.pathname==="/"?I:pu([I,ee.pathname])),ud(ee)}function Ay(T,{relative:D}={}){let I=Ze.useContext(rm);Vn(I!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:H}=pm("useViewTransitionState"),W=dd(T,{relative:D});if(!I.isTransitioning)return!1;let ee=fu(I.currentLocation.pathname,H)||I.currentLocation.pathname,A=fu(I.nextLocation.pathname,H)||I.nextLocation.pathname;return cp(W.pathname,A)!=null||cp(W.pathname,ee)!=null}var Zp={exports:{}},Ca={},qp={exports:{}},Gp={};var jf;function Dy(){return jf||(jf=1,(function(T){function D(ft,Mt){var xt=ft.length;ft.push(Mt);e:for(;0<xt;){var ke=xt-1>>>1,He=ft[ke];if(0<W(He,Mt))ft[ke]=Mt,ft[xt]=He,xt=ke;else break e}}function I(ft){return ft.length===0?null:ft[0]}function H(ft){if(ft.length===0)return null;var Mt=ft[0],xt=ft.pop();if(xt!==Mt){ft[0]=xt;e:for(var ke=0,He=ft.length,Gt=He>>>1;ke<Gt;){var Tt=2*(ke+1)-1,$t=ft[Tt],rr=Tt+1,tr=ft[rr];if(0>W($t,xt))rr<He&&0>W(tr,$t)?(ft[ke]=tr,ft[rr]=xt,ke=rr):(ft[ke]=$t,ft[Tt]=xt,ke=Tt);else if(rr<He&&0>W(tr,xt))ft[ke]=tr,ft[rr]=xt,ke=rr;else break e}}return Mt}function W(ft,Mt){var xt=ft.sortIndex-Mt.sortIndex;return xt!==0?xt:ft.id-Mt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var ee=performance;T.unstable_now=function(){return ee.now()}}else{var A=Date,d=A.now();T.unstable_now=function(){return A.now()-d}}var Se=[],Pe=[],Le=1,re=null,ne=3,Ge=!1,et=!1,je=!1,Xe=typeof setTimeout=="function"?setTimeout:null,Pt=typeof clearTimeout=="function"?clearTimeout:null,mt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function St(ft){for(var Mt=I(Pe);Mt!==null;){if(Mt.callback===null)H(Pe);else if(Mt.startTime<=ft)H(Pe),Mt.sortIndex=Mt.expirationTime,D(Se,Mt);else break;Mt=I(Pe)}}function ar(ft){if(je=!1,St(ft),!et)if(I(Se)!==null)et=!0,Wr(ur);else{var Mt=I(Pe);Mt!==null&&wr(ar,Mt.startTime-ft)}}function ur(ft,Mt){et=!1,je&&(je=!1,Pt(zr),zr=-1),Ge=!0;var xt=ne;try{for(St(Mt),re=I(Se);re!==null&&(!(re.expirationTime>Mt)||ft&&!Et());){var ke=re.callback;if(typeof ke=="function"){re.callback=null,ne=re.priorityLevel;var He=ke(re.expirationTime<=Mt);Mt=T.unstable_now(),typeof He=="function"?re.callback=He:re===I(Se)&&H(Se),St(Mt)}else H(Se);re=I(Se)}if(re!==null)var Gt=!0;else{var Tt=I(Pe);Tt!==null&&wr(ar,Tt.startTime-Mt),Gt=!1}return Gt}finally{re=null,ne=xt,Ge=!1}}var gr=!1,Vt=null,zr=-1,xr=5,Br=-1;function Et(){return!(T.unstable_now()-Br<xr)}function Hr(){if(Vt!==null){var ft=T.unstable_now();Br=ft;var Mt=!0;try{Mt=Vt(!0,ft)}finally{Mt?kr():(gr=!1,Vt=null)}}else gr=!1}var kr;if(typeof mt=="function")kr=function(){mt(Hr)};else if(typeof MessageChannel<"u"){var _r=new MessageChannel,ti=_r.port2;_r.port1.onmessage=Hr,kr=function(){ti.postMessage(null)}}else kr=function(){Xe(Hr,0)};function Wr(ft){Vt=ft,gr||(gr=!0,kr())}function wr(ft,Mt){zr=Xe(function(){ft(T.unstable_now())},Mt)}T.unstable_IdlePriority=5,T.unstable_ImmediatePriority=1,T.unstable_LowPriority=4,T.unstable_NormalPriority=3,T.unstable_Profiling=null,T.unstable_UserBlockingPriority=2,T.unstable_cancelCallback=function(ft){ft.callback=null},T.unstable_continueExecution=function(){et||Ge||(et=!0,Wr(ur))},T.unstable_forceFrameRate=function(ft){0>ft||125<ft?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):xr=0<ft?Math.floor(1e3/ft):5},T.unstable_getCurrentPriorityLevel=function(){return ne},T.unstable_getFirstCallbackNode=function(){return I(Se)},T.unstable_next=function(ft){switch(ne){case 1:case 2:case 3:var Mt=3;break;default:Mt=ne}var xt=ne;ne=Mt;try{return ft()}finally{ne=xt}},T.unstable_pauseExecution=function(){},T.unstable_requestPaint=function(){},T.unstable_runWithPriority=function(ft,Mt){switch(ft){case 1:case 2:case 3:case 4:case 5:break;default:ft=3}var xt=ne;ne=ft;try{return Mt()}finally{ne=xt}},T.unstable_scheduleCallback=function(ft,Mt,xt){var ke=T.unstable_now();switch(typeof xt=="object"&&xt!==null?(xt=xt.delay,xt=typeof xt=="number"&&0<xt?ke+xt:ke):xt=ke,ft){case 1:var He=-1;break;case 2:He=250;break;case 5:He=1073741823;break;case 4:He=1e4;break;default:He=5e3}return He=xt+He,ft={id:Le++,callback:Mt,priorityLevel:ft,startTime:xt,expirationTime:He,sortIndex:-1},xt>ke?(ft.sortIndex=xt,D(Pe,ft),I(Se)===null&&ft===I(Pe)&&(je?(Pt(zr),zr=-1):je=!0,wr(ar,xt-ke))):(ft.sortIndex=He,D(Se,ft),et||Ge||(et=!0,Wr(ur))),ft},T.unstable_shouldYield=Et,T.unstable_wrapCallback=function(ft){var Mt=ne;return function(){var xt=ne;ne=Mt;try{return ft.apply(this,arguments)}finally{ne=xt}}}})(Gp)),Gp}var Vf;function Ly(){return Vf||(Vf=1,qp.exports=Dy()),qp.exports}var Uf;function Ry(){if(Uf)return Ca;Uf=1;var T=rf(),D=Ly();function I(n){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+n,h=1;h<arguments.length;h++)a+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+n+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var H=new Set,W={};function ee(n,a){A(n,a),A(n+"Capture",a)}function A(n,a){for(W[n]=a,n=0;n<a.length;n++)H.add(a[n])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Se=Object.prototype.hasOwnProperty,Pe=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Le={},re={};function ne(n){return Se.call(re,n)?!0:Se.call(Le,n)?!1:Pe.test(n)?re[n]=!0:(Le[n]=!0,!1)}function Ge(n,a,h,y){if(h!==null&&h.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return y?!1:h!==null?!h.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function et(n,a,h,y){if(a===null||typeof a>"u"||Ge(n,a,h,y))return!0;if(y)return!1;if(h!==null)switch(h.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function je(n,a,h,y,b,E,Z){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=y,this.attributeNamespace=b,this.mustUseProperty=h,this.propertyName=n,this.type=a,this.sanitizeURL=E,this.removeEmptyString=Z}var Xe={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Xe[n]=new je(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var a=n[0];Xe[a]=new je(a,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){Xe[n]=new je(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Xe[n]=new je(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Xe[n]=new je(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){Xe[n]=new je(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){Xe[n]=new je(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){Xe[n]=new je(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){Xe[n]=new je(n,5,!1,n.toLowerCase(),null,!1,!1)});var Pt=/[\-:]([a-z])/g;function mt(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var a=n.replace(Pt,mt);Xe[a]=new je(a,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var a=n.replace(Pt,mt);Xe[a]=new je(a,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var a=n.replace(Pt,mt);Xe[a]=new je(a,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){Xe[n]=new je(n,1,!1,n.toLowerCase(),null,!1,!1)}),Xe.xlinkHref=new je("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){Xe[n]=new je(n,1,!1,n.toLowerCase(),null,!0,!0)});function St(n,a,h,y){var b=Xe.hasOwnProperty(a)?Xe[a]:null;(b!==null?b.type!==0:y||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(et(a,h,b,y)&&(h=null),y||b===null?ne(a)&&(h===null?n.removeAttribute(a):n.setAttribute(a,""+h)):b.mustUseProperty?n[b.propertyName]=h===null?b.type===3?!1:"":h:(a=b.attributeName,y=b.attributeNamespace,h===null?n.removeAttribute(a):(b=b.type,h=b===3||b===4&&h===!0?"":""+h,y?n.setAttributeNS(y,a,h):n.setAttribute(a,h))))}var ar=T.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ur=Symbol.for("react.element"),gr=Symbol.for("react.portal"),Vt=Symbol.for("react.fragment"),zr=Symbol.for("react.strict_mode"),xr=Symbol.for("react.profiler"),Br=Symbol.for("react.provider"),Et=Symbol.for("react.context"),Hr=Symbol.for("react.forward_ref"),kr=Symbol.for("react.suspense"),_r=Symbol.for("react.suspense_list"),ti=Symbol.for("react.memo"),Wr=Symbol.for("react.lazy"),wr=Symbol.for("react.offscreen"),ft=Symbol.iterator;function Mt(n){return n===null||typeof n!="object"?null:(n=ft&&n[ft]||n["@@iterator"],typeof n=="function"?n:null)}var xt=Object.assign,ke;function He(n){if(ke===void 0)try{throw Error()}catch(h){var a=h.stack.trim().match(/\n( *(at )?)/);ke=a&&a[1]||""}return`
`+ke+n}var Gt=!1;function Tt(n,a){if(!n||Gt)return"";Gt=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(Be){var y=Be}Reflect.construct(n,[],a)}else{try{a.call()}catch(Be){y=Be}n.call(a.prototype)}else{try{throw Error()}catch(Be){y=Be}n()}}catch(Be){if(Be&&y&&typeof Be.stack=="string"){for(var b=Be.stack.split(`
`),E=y.stack.split(`
`),Z=b.length-1,ce=E.length-1;1<=Z&&0<=ce&&b[Z]!==E[ce];)ce--;for(;1<=Z&&0<=ce;Z--,ce--)if(b[Z]!==E[ce]){if(Z!==1||ce!==1)do if(Z--,ce--,0>ce||b[Z]!==E[ce]){var _e=`
`+b[Z].replace(" at new "," at ");return n.displayName&&_e.includes("<anonymous>")&&(_e=_e.replace("<anonymous>",n.displayName)),_e}while(1<=Z&&0<=ce);break}}}finally{Gt=!1,Error.prepareStackTrace=h}return(n=n?n.displayName||n.name:"")?He(n):""}function $t(n){switch(n.tag){case 5:return He(n.type);case 16:return He("Lazy");case 13:return He("Suspense");case 19:return He("SuspenseList");case 0:case 2:case 15:return n=Tt(n.type,!1),n;case 11:return n=Tt(n.type.render,!1),n;case 1:return n=Tt(n.type,!0),n;default:return""}}function rr(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Vt:return"Fragment";case gr:return"Portal";case xr:return"Profiler";case zr:return"StrictMode";case kr:return"Suspense";case _r:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case Et:return(n.displayName||"Context")+".Consumer";case Br:return(n._context.displayName||"Context")+".Provider";case Hr:var a=n.render;return n=n.displayName,n||(n=a.displayName||a.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case ti:return a=n.displayName||null,a!==null?a:rr(n.type)||"Memo";case Wr:a=n._payload,n=n._init;try{return rr(n(a))}catch{}}return null}function tr(n){var a=n.type;switch(n.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=a.render,n=n.displayName||n.name||"",a.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return rr(a);case 8:return a===zr?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function cr(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Ar(n){var a=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function bi(n){var a=Ar(n)?"checked":"value",h=Object.getOwnPropertyDescriptor(n.constructor.prototype,a),y=""+n[a];if(!n.hasOwnProperty(a)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var b=h.get,E=h.set;return Object.defineProperty(n,a,{configurable:!0,get:function(){return b.call(this)},set:function(Z){y=""+Z,E.call(this,Z)}}),Object.defineProperty(n,a,{enumerable:h.enumerable}),{getValue:function(){return y},setValue:function(Z){y=""+Z},stopTracking:function(){n._valueTracker=null,delete n[a]}}}}function Pn(n){n._valueTracker||(n._valueTracker=bi(n))}function di(n){if(!n)return!1;var a=n._valueTracker;if(!a)return!0;var h=a.getValue(),y="";return n&&(y=Ar(n)?n.checked?"true":"false":n.value),n=y,n!==h?(a.setValue(n),!0):!1}function en(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function wo(n,a){var h=a.checked;return xt({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??n._wrapperState.initialChecked})}function Ia(n,a){var h=a.defaultValue==null?"":a.defaultValue,y=a.checked!=null?a.checked:a.defaultChecked;h=cr(a.value!=null?a.value:h),n._wrapperState={initialChecked:y,initialValue:h,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function Fe(n,a){a=a.checked,a!=null&&St(n,"checked",a,!1)}function Si(n,a){Fe(n,a);var h=cr(a.value),y=a.type;if(h!=null)y==="number"?(h===0&&n.value===""||n.value!=h)&&(n.value=""+h):n.value!==""+h&&(n.value=""+h);else if(y==="submit"||y==="reset"){n.removeAttribute("value");return}a.hasOwnProperty("value")?Er(n,a.type,h):a.hasOwnProperty("defaultValue")&&Er(n,a.type,cr(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(n.defaultChecked=!!a.defaultChecked)}function ua(n,a,h){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var y=a.type;if(!(y!=="submit"&&y!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+n._wrapperState.initialValue,h||a===n.value||(n.value=a),n.defaultValue=a}h=n.name,h!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,h!==""&&(n.name=h)}function Er(n,a,h){(a!=="number"||en(n.ownerDocument)!==n)&&(h==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+h&&(n.defaultValue=""+h))}var qr=Array.isArray;function bo(n,a,h,y){if(n=n.options,a){a={};for(var b=0;b<h.length;b++)a["$"+h[b]]=!0;for(h=0;h<n.length;h++)b=a.hasOwnProperty("$"+n[h].value),n[h].selected!==b&&(n[h].selected=b),b&&y&&(n[h].defaultSelected=!0)}else{for(h=""+cr(h),a=null,b=0;b<n.length;b++){if(n[b].value===h){n[b].selected=!0,y&&(n[b].defaultSelected=!0);return}a!==null||n[b].disabled||(a=n[b])}a!==null&&(a.selected=!0)}}function So(n,a){if(a.dangerouslySetInnerHTML!=null)throw Error(I(91));return xt({},a,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function ko(n,a){var h=a.value;if(h==null){if(h=a.children,a=a.defaultValue,h!=null){if(a!=null)throw Error(I(92));if(qr(h)){if(1<h.length)throw Error(I(93));h=h[0]}a=h}a==null&&(a=""),h=a}n._wrapperState={initialValue:cr(h)}}function Pa(n,a){var h=cr(a.value),y=cr(a.defaultValue);h!=null&&(h=""+h,h!==n.value&&(n.value=h),a.defaultValue==null&&n.defaultValue!==h&&(n.defaultValue=h)),y!=null&&(n.defaultValue=""+y)}function Mn(n){var a=n.textContent;a===n._wrapperState.initialValue&&a!==""&&a!==null&&(n.value=a)}function cs(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ma(n,a){return n==null||n==="http://www.w3.org/1999/xhtml"?cs(a):n==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var rt,ao=(function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,h,y,b){MSApp.execUnsafeLocalFunction(function(){return n(a,h,y,b)})}:n})(function(n,a){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=a;else{for(rt=rt||document.createElement("div"),rt.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=rt.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;a.firstChild;)n.appendChild(a.firstChild)}});function pi(n,a){if(a){var h=n.firstChild;if(h&&h===n.lastChild&&h.nodeType===3){h.nodeValue=a;return}}n.textContent=a}var fr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ri=["Webkit","ms","Moz","O"];Object.keys(fr).forEach(function(n){ri.forEach(function(a){a=a+n.charAt(0).toUpperCase()+n.substring(1),fr[a]=fr[n]})});function at(n,a,h){return a==null||typeof a=="boolean"||a===""?"":h||typeof a!="number"||a===0||fr.hasOwnProperty(n)&&fr[n]?(""+a).trim():a+"px"}function sr(n,a){n=n.style;for(var h in a)if(a.hasOwnProperty(h)){var y=h.indexOf("--")===0,b=at(h,a[h],y);h==="float"&&(h="cssFloat"),y?n.setProperty(h,b):n[h]=b}}var Zt=xt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Gi(n,a){if(a){if(Zt[n]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(I(137,n));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(I(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(I(61))}if(a.style!=null&&typeof a.style!="object")throw Error(I(62))}}function Ni(n,a){if(n.indexOf("-")===-1)return typeof a.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ht=null;function An(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var so=null,xn=null,ln=null;function le(n){if(n=Kl(n)){if(typeof so!="function")throw Error(I(280));var a=n.stateNode;a&&(a=Jl(a),so(n.stateNode,n.type,a))}}function j(n){xn?ln?ln.push(n):ln=[n]:xn=n}function V(){if(xn){var n=xn,a=ln;if(ln=xn=null,le(n),a)for(n=0;n<a.length;n++)le(a[n])}}function X(n,a){return n(a)}function oe(){}var ge=!1;function xe(n,a,h){if(ge)return n(a,h);ge=!0;try{return X(n,a,h)}finally{ge=!1,(xn!==null||ln!==null)&&(oe(),V())}}function Te(n,a){var h=n.stateNode;if(h===null)return null;var y=Jl(h);if(y===null)return null;h=y[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(n=n.type,y=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!y;break e;default:n=!1}if(n)return null;if(h&&typeof h!="function")throw Error(I(231,a,typeof h));return h}var de=!1;if(d)try{var De={};Object.defineProperty(De,"passive",{get:function(){de=!0}}),window.addEventListener("test",De,De),window.removeEventListener("test",De,De)}catch{de=!1}function qe(n,a,h,y,b,E,Z,ce,_e){var Be=Array.prototype.slice.call(arguments,3);try{a.apply(h,Be)}catch(Qe){this.onError(Qe)}}var Ae=!1,it=null,Ct=!1,Lt=null,br={onError:function(n){Ae=!0,it=n}};function er(n,a,h,y,b,E,Z,ce,_e){Ae=!1,it=null,qe.apply(br,arguments)}function Tr(n,a,h,y,b,E,Z,ce,_e){if(er.apply(this,arguments),Ae){if(Ae){var Be=it;Ae=!1,it=null}else throw Error(I(198));Ct||(Ct=!0,Lt=Be)}}function ir(n){var a=n,h=n;if(n.alternate)for(;a.return;)a=a.return;else{n=a;do a=n,(a.flags&4098)!==0&&(h=a.return),n=a.return;while(n)}return a.tag===3?h:null}function gi(n){if(n.tag===13){var a=n.memoizedState;if(a===null&&(n=n.alternate,n!==null&&(a=n.memoizedState)),a!==null)return a.dehydrated}return null}function Xr(n){if(ir(n)!==n)throw Error(I(188))}function hr(n){var a=n.alternate;if(!a){if(a=ir(n),a===null)throw Error(I(188));return a!==n?null:n}for(var h=n,y=a;;){var b=h.return;if(b===null)break;var E=b.alternate;if(E===null){if(y=b.return,y!==null){h=y;continue}break}if(b.child===E.child){for(E=b.child;E;){if(E===h)return Xr(b),n;if(E===y)return Xr(b),a;E=E.sibling}throw Error(I(188))}if(h.return!==y.return)h=b,y=E;else{for(var Z=!1,ce=b.child;ce;){if(ce===h){Z=!0,h=b,y=E;break}if(ce===y){Z=!0,y=b,h=E;break}ce=ce.sibling}if(!Z){for(ce=E.child;ce;){if(ce===h){Z=!0,h=E,y=b;break}if(ce===y){Z=!0,y=E,h=b;break}ce=ce.sibling}if(!Z)throw Error(I(189))}}if(h.alternate!==y)throw Error(I(190))}if(h.tag!==3)throw Error(I(188));return h.stateNode.current===h?n:a}function Or(n){return n=hr(n),n!==null?Kr(n):null}function Kr(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var a=Kr(n);if(a!==null)return a;n=n.sibling}return null}var yi=D.unstable_scheduleCallback,Pi=D.unstable_cancelCallback,ji=D.unstable_shouldYield,Aa=D.unstable_requestPaint,Xt=D.unstable_now,Bl=D.unstable_getCurrentPriorityLevel,hs=D.unstable_ImmediatePriority,wn=D.unstable_UserBlockingPriority,tn=D.unstable_NormalPriority,Zu=D.unstable_LowPriority,Dn=D.unstable_IdlePriority,Hi=null,rn=null;function $o(n){if(rn&&typeof rn.onCommitFiberRoot=="function")try{rn.onCommitFiberRoot(Hi,n,void 0,(n.current.flags&128)===128)}catch{}}var Vr=Math.clz32?Math.clz32:Nr,As=Math.log,lo=Math.LN2;function Nr(n){return n>>>=0,n===0?32:31-(As(n)/lo|0)|0}var Zo=64,un=4194304;function Da(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function cn(n,a){var h=n.pendingLanes;if(h===0)return 0;var y=0,b=n.suspendedLanes,E=n.pingedLanes,Z=h&268435455;if(Z!==0){var ce=Z&~b;ce!==0?y=Da(ce):(E&=Z,E!==0&&(y=Da(E)))}else Z=h&~b,Z!==0?y=Da(Z):E!==0&&(y=Da(E));if(y===0)return 0;if(a!==0&&a!==y&&(a&b)===0&&(b=y&-y,E=a&-a,b>=E||b===16&&(E&4194240)!==0))return a;if((y&4)!==0&&(y|=h&16),a=n.entangledLanes,a!==0)for(n=n.entanglements,a&=y;0<a;)h=31-Vr(a),b=1<<h,y|=n[h],a&=~b;return y}function Ol(n,a){switch(n){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function La(n,a){for(var h=n.suspendedLanes,y=n.pingedLanes,b=n.expirationTimes,E=n.pendingLanes;0<E;){var Z=31-Vr(E),ce=1<<Z,_e=b[Z];_e===-1?((ce&h)===0||(ce&y)!==0)&&(b[Z]=Ol(ce,a)):_e<=a&&(n.expiredLanes|=ce),E&=~ce}}function Ln(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Un(){var n=Zo;return Zo<<=1,(Zo&4194240)===0&&(Zo=64),n}function Cr(n){for(var a=[],h=0;31>h;h++)a.push(n);return a}function Ra(n,a,h){n.pendingLanes|=a,a!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,a=31-Vr(a),n[a]=h}function ca(n,a){var h=n.pendingLanes&~a;n.pendingLanes=a,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=a,n.mutableReadLanes&=a,n.entangledLanes&=a,a=n.entanglements;var y=n.eventTimes;for(n=n.expirationTimes;0<h;){var b=31-Vr(h),E=1<<b;a[b]=0,y[b]=-1,n[b]=-1,h&=~E}}function ha(n,a){var h=n.entangledLanes|=a;for(n=n.entanglements;h;){var y=31-Vr(h),b=1<<y;b&a|n[y]&a&&(n[y]|=a),h&=~b}}var jr=0;function Ds(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var Fa,ds,Ba,Nl,gu,Qs=!1,el=[],bn=null,$n=null,ki=null,Vi=new Map,da=new Map,nn=[],tl="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jl(n,a){switch(n){case"focusin":case"focusout":bn=null;break;case"dragenter":case"dragleave":$n=null;break;case"mouseover":case"mouseout":ki=null;break;case"pointerover":case"pointerout":Vi.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":da.delete(a.pointerId)}}function To(n,a,h,y,b,E){return n===null||n.nativeEvent!==E?(n={blockedOn:a,domEventName:h,eventSystemFlags:y,nativeEvent:E,targetContainers:[b]},a!==null&&(a=Kl(a),a!==null&&ds(a)),n):(n.eventSystemFlags|=y,a=n.targetContainers,b!==null&&a.indexOf(b)===-1&&a.push(b),n)}function qu(n,a,h,y,b){switch(a){case"focusin":return bn=To(bn,n,a,h,y,b),!0;case"dragenter":return $n=To($n,n,a,h,y,b),!0;case"mouseover":return ki=To(ki,n,a,h,y,b),!0;case"pointerover":var E=b.pointerId;return Vi.set(E,To(Vi.get(E)||null,n,a,h,y,b)),!0;case"gotpointercapture":return E=b.pointerId,da.set(E,To(da.get(E)||null,n,a,h,y,b)),!0}return!1}function Ls(n){var a=Ka(n.target);if(a!==null){var h=ir(a);if(h!==null){if(a=h.tag,a===13){if(a=gi(h),a!==null){n.blockedOn=a,gu(n.priority,function(){Ba(h)});return}}else if(a===3&&h.stateNode.current.memoizedState.isDehydrated){n.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}n.blockedOn=null}function ps(n){if(n.blockedOn!==null)return!1;for(var a=n.targetContainers;0<a.length;){var h=Rs(n.domEventName,n.eventSystemFlags,a[0],n.nativeEvent);if(h===null){h=n.nativeEvent;var y=new h.constructor(h.type,h);Ht=y,h.target.dispatchEvent(y),Ht=null}else return a=Kl(h),a!==null&&ds(a),n.blockedOn=h,!1;a.shift()}return!0}function yu(n,a,h){ps(n)&&h.delete(a)}function Gu(){Qs=!1,bn!==null&&ps(bn)&&(bn=null),$n!==null&&ps($n)&&($n=null),ki!==null&&ps(ki)&&(ki=null),Vi.forEach(yu),da.forEach(yu)}function Sn(n,a){n.blockedOn===a&&(n.blockedOn=null,Qs||(Qs=!0,D.unstable_scheduleCallback(D.unstable_NormalPriority,Gu)))}function qo(n){function a(b){return Sn(b,n)}if(0<el.length){Sn(el[0],n);for(var h=1;h<el.length;h++){var y=el[h];y.blockedOn===n&&(y.blockedOn=null)}}for(bn!==null&&Sn(bn,n),$n!==null&&Sn($n,n),ki!==null&&Sn(ki,n),Vi.forEach(a),da.forEach(a),h=0;h<nn.length;h++)y=nn[h],y.blockedOn===n&&(y.blockedOn=null);for(;0<nn.length&&(h=nn[0],h.blockedOn===null);)Ls(h),h.blockedOn===null&&nn.shift()}var pa=ar.ReactCurrentBatchConfig,fa=!0;function Vl(n,a,h,y){var b=jr,E=pa.transition;pa.transition=null;try{jr=1,Zn(n,a,h,y)}finally{jr=b,pa.transition=E}}function rl(n,a,h,y){var b=jr,E=pa.transition;pa.transition=null;try{jr=4,Zn(n,a,h,y)}finally{jr=b,pa.transition=E}}function Zn(n,a,h,y){if(fa){var b=Rs(n,a,h,y);if(b===null)Xl(n,a,y,il,h),jl(n,y);else if(qu(b,n,a,h,y))y.stopPropagation();else if(jl(n,y),a&4&&-1<tl.indexOf(n)){for(;b!==null;){var E=Kl(b);if(E!==null&&Fa(E),E=Rs(n,a,h,y),E===null&&Xl(n,a,y,il,h),E===b)break;b=E}b!==null&&y.stopPropagation()}else Xl(n,a,y,null,h)}}var il=null;function Rs(n,a,h,y){if(il=null,n=An(y),n=Ka(n),n!==null)if(a=ir(n),a===null)n=null;else if(h=a.tag,h===13){if(n=gi(a),n!==null)return n;n=null}else if(h===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;n=null}else a!==n&&(n=null);return il=n,null}function ma(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Bl()){case hs:return 1;case wn:return 4;case tn:case Zu:return 16;case Dn:return 536870912;default:return 16}default:return 16}}var hn=null,Ir=null,Oa=null;function N(){if(Oa)return Oa;var n,a=Ir,h=a.length,y,b="value"in hn?hn.value:hn.textContent,E=b.length;for(n=0;n<h&&a[n]===b[n];n++);var Z=h-n;for(y=1;y<=Z&&a[h-y]===b[E-y];y++);return Oa=b.slice(n,1<y?1-y:void 0)}function z(n){var a=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&a===13&&(n=13)):n=a,n===10&&(n=13),32<=n||n===13?n:0}function M(){return!0}function q(){return!1}function Y(n){function a(h,y,b,E,Z){this._reactName=h,this._targetInst=b,this.type=y,this.nativeEvent=E,this.target=Z,this.currentTarget=null;for(var ce in n)n.hasOwnProperty(ce)&&(h=n[ce],this[ce]=h?h(E):E[ce]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?M:q,this.isPropagationStopped=q,this}return xt(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=M)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=M)},persist:function(){},isPersistent:M}),a}var pe={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fe=Y(pe),Ce=xt({},pe,{view:0,detail:0}),$e=Y(Ce),Ne,Ke,We,st=xt({},Ce,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:uo,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==We&&(We&&n.type==="mousemove"?(Ne=n.screenX-We.screenX,Ke=n.screenY-We.screenY):Ke=Ne=0,We=n),Ne)},movementY:function(n){return"movementY"in n?n.movementY:Ke}}),Dr=Y(st),si=xt({},st,{dataTransfer:0}),yr=Y(si),Mi=xt({},Ce,{relatedTarget:0}),li=Y(Mi),dn=xt({},pe,{animationName:0,elapsedTime:0,pseudoElement:0}),Wi=Y(dn),zo=xt({},pe,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Ai=Y(zo),Rn=xt({},pe,{data:0}),ii=Y(Rn),Na={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ui={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Di={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Li(n){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(n):(n=Di[n])?!!a[n]:!1}function uo(){return Li}var kn=xt({},Ce,{key:function(n){if(n.key){var a=Na[n.key]||n.key;if(a!=="Unidentified")return a}return n.type==="keypress"?(n=z(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Ui[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:uo,charCode:function(n){return n.type==="keypress"?z(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?z(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),qn=Y(kn),ga=xt({},st,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$i=Y(ga),Gn=xt({},Ce,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:uo}),Eo=Y(Gn),nr=xt({},pe,{propertyName:0,elapsedTime:0,pseudoElement:0}),fs=Y(nr),Kt=xt({},st,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),ms=Y(Kt),Lr=[9,13,27,32],Rr=d&&"CompositionEvent"in window,pn=null;d&&"documentMode"in document&&(pn=document.documentMode);var ja=d&&"TextEvent"in window&&!pn,ya=d&&(!Rr||pn&&8<pn&&11>=pn),Fs=" ",Go=!1;function Va(n,a){switch(n){case"keyup":return Lr.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Tn(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Ho=!1;function nl(n,a){switch(n){case"compositionend":return Tn(a);case"keypress":return a.which!==32?null:(Go=!0,Fs);case"textInput":return n=a.data,n===Fs&&Go?null:n;default:return null}}function Hu(n,a){if(Ho)return n==="compositionend"||!Rr&&Va(n,a)?(n=N(),Oa=Ir=hn=null,Ho=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return ya&&a.locale!=="ko"?null:a.data;default:return null}}var Bs={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ol(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a==="input"?!!Bs[n.type]:a==="textarea"}function al(n,a,h,y){j(y),a=dl(a,"onChange"),0<a.length&&(h=new fe("onChange","change",null,h,y),n.push({event:h,listeners:a}))}var _a=null,Ua=null;function _u(n){Su(n,0)}function $a(n){var a=Jo(n);if(di(a))return n}function sl(n,a){if(n==="change")return a}var Wu=!1;if(d){var Ul;if(d){var Pr="oninput"in document;if(!Pr){var $l=document.createElement("div");$l.setAttribute("oninput","return;"),Pr=typeof $l.oninput=="function"}Ul=Pr}else Ul=!1;Wu=Ul&&(!document.documentMode||9<document.documentMode)}function Oc(){_a&&(_a.detachEvent("onpropertychange",Xu),Ua=_a=null)}function Xu(n){if(n.propertyName==="value"&&$a(Ua)){var a=[];al(a,Ua,n,An(n)),xe(_u,a)}}function ll(n,a,h){n==="focusin"?(Oc(),_a=a,Ua=h,_a.attachEvent("onpropertychange",Xu)):n==="focusout"&&Oc()}function Nc(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return $a(Ua)}function vu(n,a){if(n==="click")return $a(a)}function jc(n,a){if(n==="input"||n==="change")return $a(a)}function Vc(n,a){return n===a&&(n!==0||1/n===1/a)||n!==n&&a!==a}var Hn=typeof Object.is=="function"?Object.is:Vc;function gs(n,a){if(Hn(n,a))return!0;if(typeof n!="object"||n===null||typeof a!="object"||a===null)return!1;var h=Object.keys(n),y=Object.keys(a);if(h.length!==y.length)return!1;for(y=0;y<h.length;y++){var b=h[y];if(!Se.call(a,b)||!Hn(n[b],a[b]))return!1}return!0}function Os(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Ns(n,a){var h=Os(n);n=0;for(var y;h;){if(h.nodeType===3){if(y=n+h.textContent.length,n<=a&&y>=a)return{node:h,offset:a-n};n=y}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Os(h)}}function js(n,a){return n&&a?n===a?!0:n&&n.nodeType===3?!1:a&&a.nodeType===3?js(n,a.parentNode):"contains"in n?n.contains(a):n.compareDocumentPosition?!!(n.compareDocumentPosition(a)&16):!1:!1}function xu(){for(var n=window,a=en();a instanceof n.HTMLIFrameElement;){try{var h=typeof a.contentWindow.location.href=="string"}catch{h=!1}if(h)n=a.contentWindow;else break;a=en(n.document)}return a}function ys(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a&&(a==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||a==="textarea"||n.contentEditable==="true")}function Zl(n){var a=xu(),h=n.focusedElem,y=n.selectionRange;if(a!==h&&h&&h.ownerDocument&&js(h.ownerDocument.documentElement,h)){if(y!==null&&ys(h)){if(a=y.start,n=y.end,n===void 0&&(n=a),"selectionStart"in h)h.selectionStart=a,h.selectionEnd=Math.min(n,h.value.length);else if(n=(a=h.ownerDocument||document)&&a.defaultView||window,n.getSelection){n=n.getSelection();var b=h.textContent.length,E=Math.min(y.start,b);y=y.end===void 0?E:Math.min(y.end,b),!n.extend&&E>y&&(b=y,y=E,E=b),b=Ns(h,E);var Z=Ns(h,y);b&&Z&&(n.rangeCount!==1||n.anchorNode!==b.node||n.anchorOffset!==b.offset||n.focusNode!==Z.node||n.focusOffset!==Z.offset)&&(a=a.createRange(),a.setStart(b.node,b.offset),n.removeAllRanges(),E>y?(n.addRange(a),n.extend(Z.node,Z.offset)):(a.setEnd(Z.node,Z.offset),n.addRange(a)))}}for(a=[],n=h;n=n.parentNode;)n.nodeType===1&&a.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<a.length;h++)n=a[h],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var wu=d&&"documentMode"in document&&11>=document.documentMode,Za=null,ql=null,Gl=null,bu=!1;function Hl(n,a,h){var y=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;bu||Za==null||Za!==en(y)||(y=Za,"selectionStart"in y&&ys(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),Gl&&gs(Gl,y)||(Gl=y,y=dl(ql,"onSelect"),0<y.length&&(a=new fe("onSelect","select",null,a,h),n.push({event:a,listeners:y}),a.target=Za)))}function ul(n,a){var h={};return h[n.toLowerCase()]=a.toLowerCase(),h["Webkit"+n]="webkit"+a,h["Moz"+n]="moz"+a,h}var va={animationend:ul("Animation","AnimationEnd"),animationiteration:ul("Animation","AnimationIteration"),animationstart:ul("Animation","AnimationStart"),transitionend:ul("Transition","TransitionEnd")},Vs={},fn={};d&&(fn=document.createElement("div").style,"AnimationEvent"in window||(delete va.animationend.animation,delete va.animationiteration.animation,delete va.animationstart.animation),"TransitionEvent"in window||delete va.transitionend.transition);function xa(n){if(Vs[n])return Vs[n];if(!va[n])return n;var a=va[n],h;for(h in a)if(a.hasOwnProperty(h)&&h in fn)return Vs[n]=a[h];return n}var Ku=xa("animationend"),Ju=xa("animationiteration"),Ti=xa("animationstart"),Co=xa("transitionend"),Wn=new Map,cl="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function wa(n,a){Wn.set(n,a),ee(a,[n])}for(var hl=0;hl<cl.length;hl++){var _s=cl[hl],qa=_s.toLowerCase(),Yu=_s[0].toUpperCase()+_s.slice(1);wa(qa,"on"+Yu)}wa(Ku,"onAnimationEnd"),wa(Ju,"onAnimationIteration"),wa(Ti,"onAnimationStart"),wa("dblclick","onDoubleClick"),wa("focusin","onFocus"),wa("focusout","onBlur"),wa(Co,"onTransitionEnd"),A("onMouseEnter",["mouseout","mouseover"]),A("onMouseLeave",["mouseout","mouseover"]),A("onPointerEnter",["pointerout","pointerover"]),A("onPointerLeave",["pointerout","pointerover"]),ee("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ee("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ee("onBeforeInput",["compositionend","keypress","textInput","paste"]),ee("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ee("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ee("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qu=new Set("cancel close invalid load scroll toggle".split(" ").concat(vs));function Wl(n,a,h){var y=n.type||"unknown-event";n.currentTarget=h,Tr(y,a,void 0,n),n.currentTarget=null}function Su(n,a){a=(a&4)!==0;for(var h=0;h<n.length;h++){var y=n[h],b=y.event;y=y.listeners;e:{var E=void 0;if(a)for(var Z=y.length-1;0<=Z;Z--){var ce=y[Z],_e=ce.instance,Be=ce.currentTarget;if(ce=ce.listener,_e!==E&&b.isPropagationStopped())break e;Wl(b,ce,Be),E=_e}else for(Z=0;Z<y.length;Z++){if(ce=y[Z],_e=ce.instance,Be=ce.currentTarget,ce=ce.listener,_e!==E&&b.isPropagationStopped())break e;Wl(b,ce,Be),E=_e}}}if(Ct)throw n=Lt,Ct=!1,Lt=null,n}function ni(n,a){var h=a[vr];h===void 0&&(h=a[vr]=new Set);var y=n+"__bubble";h.has(y)||(ku(a,n,2,!1),h.add(y))}function Ga(n,a,h){var y=0;a&&(y|=4),ku(h,n,y,a)}var Us="_reactListening"+Math.random().toString(36).slice(2);function Ha(n){if(!n[Us]){n[Us]=!0,H.forEach(function(h){h!=="selectionchange"&&(Qu.has(h)||Ga(h,!1,n),Ga(h,!0,n))});var a=n.nodeType===9?n:n.ownerDocument;a===null||a[Us]||(a[Us]=!0,Ga("selectionchange",!1,a))}}function ku(n,a,h,y){switch(ma(a)){case 1:var b=Vl;break;case 4:b=rl;break;default:b=Zn}h=b.bind(null,a,h,n),b=void 0,!de||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(b=!0),y?b!==void 0?n.addEventListener(a,h,{capture:!0,passive:b}):n.addEventListener(a,h,!0):b!==void 0?n.addEventListener(a,h,{passive:b}):n.addEventListener(a,h,!1)}function Xl(n,a,h,y,b){var E=y;if((a&1)===0&&(a&2)===0&&y!==null)e:for(;;){if(y===null)return;var Z=y.tag;if(Z===3||Z===4){var ce=y.stateNode.containerInfo;if(ce===b||ce.nodeType===8&&ce.parentNode===b)break;if(Z===4)for(Z=y.return;Z!==null;){var _e=Z.tag;if((_e===3||_e===4)&&(_e=Z.stateNode.containerInfo,_e===b||_e.nodeType===8&&_e.parentNode===b))return;Z=Z.return}for(;ce!==null;){if(Z=Ka(ce),Z===null)return;if(_e=Z.tag,_e===5||_e===6){y=E=Z;continue e}ce=ce.parentNode}}y=y.return}xe(function(){var Be=E,Qe=An(h),nt=[];e:{var Ye=Wn.get(n);if(Ye!==void 0){var yt=fe,At=n;switch(n){case"keypress":if(z(h)===0)break e;case"keydown":case"keyup":yt=qn;break;case"focusin":At="focus",yt=li;break;case"focusout":At="blur",yt=li;break;case"beforeblur":case"afterblur":yt=li;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":yt=Dr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":yt=yr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":yt=Eo;break;case Ku:case Ju:case Ti:yt=Wi;break;case Co:yt=fs;break;case"scroll":yt=$e;break;case"wheel":yt=ms;break;case"copy":case"cut":case"paste":yt=Ai;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":yt=$i}var Ot=(a&4)!==0,Zi=!Ot&&n==="scroll",Me=Ot?Ye!==null?Ye+"Capture":null:Ye;Ot=[];for(var we=Be,Re;we!==null;){Re=we;var ht=Re.stateNode;if(Re.tag===5&&ht!==null&&(Re=ht,Me!==null&&(ht=Te(we,Me),ht!=null&&Ot.push($s(we,ht,Re)))),Zi)break;we=we.return}0<Ot.length&&(Ye=new yt(Ye,At,null,h,Qe),nt.push({event:Ye,listeners:Ot}))}}if((a&7)===0){e:{if(Ye=n==="mouseover"||n==="pointerover",yt=n==="mouseout"||n==="pointerout",Ye&&h!==Ht&&(At=h.relatedTarget||h.fromElement)&&(Ka(At)||At[Ko]))break e;if((yt||Ye)&&(Ye=Qe.window===Qe?Qe:(Ye=Qe.ownerDocument)?Ye.defaultView||Ye.parentWindow:window,yt?(At=h.relatedTarget||h.toElement,yt=Be,At=At?Ka(At):null,At!==null&&(Zi=ir(At),At!==Zi||At.tag!==5&&At.tag!==6)&&(At=null)):(yt=null,At=Be),yt!==At)){if(Ot=Dr,ht="onMouseLeave",Me="onMouseEnter",we="mouse",(n==="pointerout"||n==="pointerover")&&(Ot=$i,ht="onPointerLeave",Me="onPointerEnter",we="pointer"),Zi=yt==null?Ye:Jo(yt),Re=At==null?Ye:Jo(At),Ye=new Ot(ht,we+"leave",yt,h,Qe),Ye.target=Zi,Ye.relatedTarget=Re,ht=null,Ka(Qe)===Be&&(Ot=new Ot(Me,we+"enter",At,h,Qe),Ot.target=Re,Ot.relatedTarget=Zi,ht=Ot),Zi=ht,yt&&At)t:{for(Ot=yt,Me=At,we=0,Re=Ot;Re;Re=Wa(Re))we++;for(Re=0,ht=Me;ht;ht=Wa(ht))Re++;for(;0<we-Re;)Ot=Wa(Ot),we--;for(;0<Re-we;)Me=Wa(Me),Re--;for(;we--;){if(Ot===Me||Me!==null&&Ot===Me.alternate)break t;Ot=Wa(Ot),Me=Wa(Me)}Ot=null}else Ot=null;yt!==null&&pl(nt,Ye,yt,Ot,!1),At!==null&&Zi!==null&&pl(nt,Zi,At,Ot,!0)}}e:{if(Ye=Be?Jo(Be):window,yt=Ye.nodeName&&Ye.nodeName.toLowerCase(),yt==="select"||yt==="input"&&Ye.type==="file")var jt=sl;else if(ol(Ye))if(Wu)jt=jc;else{jt=Nc;var Yt=ll}else(yt=Ye.nodeName)&&yt.toLowerCase()==="input"&&(Ye.type==="checkbox"||Ye.type==="radio")&&(jt=vu);if(jt&&(jt=jt(n,Be))){al(nt,jt,h,Qe);break e}Yt&&Yt(n,Ye,Be),n==="focusout"&&(Yt=Ye._wrapperState)&&Yt.controlled&&Ye.type==="number"&&Er(Ye,"number",Ye.value)}switch(Yt=Be?Jo(Be):window,n){case"focusin":(ol(Yt)||Yt.contentEditable==="true")&&(Za=Yt,ql=Be,Gl=null);break;case"focusout":Gl=ql=Za=null;break;case"mousedown":bu=!0;break;case"contextmenu":case"mouseup":case"dragend":bu=!1,Hl(nt,h,Qe);break;case"selectionchange":if(wu)break;case"keydown":case"keyup":Hl(nt,h,Qe)}var Ut;if(Rr)e:{switch(n){case"compositionstart":var lr="onCompositionStart";break e;case"compositionend":lr="onCompositionEnd";break e;case"compositionupdate":lr="onCompositionUpdate";break e}lr=void 0}else Ho?Va(n,h)&&(lr="onCompositionEnd"):n==="keydown"&&h.keyCode===229&&(lr="onCompositionStart");lr&&(ya&&h.locale!=="ko"&&(Ho||lr!=="onCompositionStart"?lr==="onCompositionEnd"&&Ho&&(Ut=N()):(hn=Qe,Ir="value"in hn?hn.value:hn.textContent,Ho=!0)),Yt=dl(Be,lr),0<Yt.length&&(lr=new ii(lr,n,null,h,Qe),nt.push({event:lr,listeners:Yt}),Ut?lr.data=Ut:(Ut=Tn(h),Ut!==null&&(lr.data=Ut)))),(Ut=ja?nl(n,h):Hu(n,h))&&(Be=dl(Be,"onBeforeInput"),0<Be.length&&(Qe=new ii("onBeforeInput","beforeinput",null,h,Qe),nt.push({event:Qe,listeners:Be}),Qe.data=Ut))}Su(nt,a)})}function $s(n,a,h){return{instance:n,listener:a,currentTarget:h}}function dl(n,a){for(var h=a+"Capture",y=[];n!==null;){var b=n,E=b.stateNode;b.tag===5&&E!==null&&(b=E,E=Te(n,h),E!=null&&y.unshift($s(n,E,b)),E=Te(n,a),E!=null&&y.push($s(n,E,b))),n=n.return}return y}function Wa(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function pl(n,a,h,y,b){for(var E=a._reactName,Z=[];h!==null&&h!==y;){var ce=h,_e=ce.alternate,Be=ce.stateNode;if(_e!==null&&_e===y)break;ce.tag===5&&Be!==null&&(ce=Be,b?(_e=Te(h,E),_e!=null&&Z.unshift($s(h,_e,ce))):b||(_e=Te(h,E),_e!=null&&Z.push($s(h,_e,ce)))),h=h.return}Z.length!==0&&n.push({event:a,listeners:Z})}var Uc=/\r\n?/g,Io=/\u0000|\uFFFD/g;function Wo(n){return(typeof n=="string"?n:""+n).replace(Uc,`
`).replace(Io,"")}function fl(n,a,h){if(a=Wo(a),Wo(n)!==a&&h)throw Error(I(425))}function Xn(){}var Xa=null,ec=null;function tc(n,a){return n==="textarea"||n==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Tu=typeof setTimeout=="function"?setTimeout:void 0,$c=typeof clearTimeout=="function"?clearTimeout:void 0,zu=typeof Promise=="function"?Promise:void 0,ml=typeof queueMicrotask=="function"?queueMicrotask:typeof zu<"u"?function(n){return zu.resolve(null).then(n).catch(Po)}:Tu;function Po(n){setTimeout(function(){throw n})}function wt(n,a){var h=a,y=0;do{var b=h.nextSibling;if(n.removeChild(h),b&&b.nodeType===8)if(h=b.data,h==="/$"){if(y===0){n.removeChild(b),qo(a);return}y--}else h!=="$"&&h!=="$?"&&h!=="$!"||y++;h=b}while(h);qo(a)}function Xo(n){for(;n!=null;n=n.nextSibling){var a=n.nodeType;if(a===1||a===3)break;if(a===8){if(a=n.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return n}function Eu(n){n=n.previousSibling;for(var a=0;n;){if(n.nodeType===8){var h=n.data;if(h==="$"||h==="$!"||h==="$?"){if(a===0)return n;a--}else h==="/$"&&a++}n=n.previousSibling}return null}var Zs=Math.random().toString(36).slice(2),Fn="__reactFiber$"+Zs,ba="__reactProps$"+Zs,Ko="__reactContainer$"+Zs,vr="__reactEvents$"+Zs,rc="__reactListeners$"+Zs,Ih="__reactHandles$"+Zs;function Ka(n){var a=n[Fn];if(a)return a;for(var h=n.parentNode;h;){if(a=h[Ko]||h[Fn]){if(h=a.alternate,a.child!==null||h!==null&&h.child!==null)for(n=Eu(n);n!==null;){if(h=n[Fn])return h;n=Eu(n)}return a}n=h,h=n.parentNode}return null}function Kl(n){return n=n[Fn]||n[Ko],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Jo(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(I(33))}function Jl(n){return n[ba]||null}var Yl=[],qs=-1;function xs(n){return{current:n}}function oi(n){0>qs||(n.current=Yl[qs],Yl[qs]=null,qs--)}function ui(n,a){qs++,Yl[qs]=n.current,n.current=a}var ws={},Jr=xs(ws),Sr=xs(!1),Mo=ws;function Ja(n,a){var h=n.type.contextTypes;if(!h)return ws;var y=n.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===a)return y.__reactInternalMemoizedMaskedChildContext;var b={},E;for(E in h)b[E]=a[E];return y&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=a,n.__reactInternalMemoizedMaskedChildContext=b),b}function mn(n){return n=n.childContextTypes,n!=null}function Ql(){oi(Sr),oi(Jr)}function gl(n,a,h){if(Jr.current!==ws)throw Error(I(168));ui(Jr,a),ui(Sr,h)}function yl(n,a,h){var y=n.stateNode;if(a=a.childContextTypes,typeof y.getChildContext!="function")return h;y=y.getChildContext();for(var b in y)if(!(b in a))throw Error(I(108,tr(n)||"Unknown",b));return xt({},h,y)}function co(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||ws,Mo=Jr.current,ui(Jr,n),ui(Sr,Sr.current),!0}function _l(n,a,h){var y=n.stateNode;if(!y)throw Error(I(169));h?(n=yl(n,a,Mo),y.__reactInternalMemoizedMergedChildContext=n,oi(Sr),oi(Jr),ui(Jr,n)):oi(Sr),ui(Sr,h)}var bt=null,Nt=!1,vl=!1;function eu(n){bt===null?bt=[n]:bt.push(n)}function ic(n){Nt=!0,eu(n)}function f(){if(!vl&&bt!==null){vl=!0;var n=0,a=jr;try{var h=bt;for(jr=1;n<h.length;n++){var y=h[n];do y=y(!0);while(y!==null)}bt=null,Nt=!1}catch(b){throw bt!==null&&(bt=bt.slice(n+1)),yi(hs,f),b}finally{jr=a,vl=!1}}return null}var e=[],o=0,l=null,u=0,p=[],v=0,w=null,S=1,C="";function F(n,a){e[o++]=u,e[o++]=l,l=n,u=a}function B(n,a,h){p[v++]=S,p[v++]=C,p[v++]=w,w=n;var y=S;n=C;var b=32-Vr(y)-1;y&=~(1<<b),h+=1;var E=32-Vr(a)+b;if(30<E){var Z=b-b%5;E=(y&(1<<Z)-1).toString(32),y>>=Z,b-=Z,S=1<<32-Vr(a)+b|h<<b|y,C=E+n}else S=1<<E|h<<b|y,C=n}function $(n){n.return!==null&&(F(n,1),B(n,1,0))}function K(n){for(;n===l;)l=e[--o],e[o]=null,u=e[--o],e[o]=null;for(;n===w;)w=p[--v],p[v]=null,C=p[--v],p[v]=null,S=p[--v],p[v]=null}var Q=null,te=null,ae=!1,ue=null;function me(n,a){var h=Oo(5,null,null,0);h.elementType="DELETED",h.stateNode=a,h.return=n,a=n.deletions,a===null?(n.deletions=[h],n.flags|=16):a.push(h)}function ie(n,a){switch(n.tag){case 5:var h=n.type;return a=a.nodeType!==1||h.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(n.stateNode=a,Q=n,te=Xo(a.firstChild),!0):!1;case 6:return a=n.pendingProps===""||a.nodeType!==3?null:a,a!==null?(n.stateNode=a,Q=n,te=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(h=w!==null?{id:S,overflow:C}:null,n.memoizedState={dehydrated:a,treeContext:h,retryLane:1073741824},h=Oo(18,null,null,0),h.stateNode=a,h.return=n,n.child=h,Q=n,te=null,!0):!1;default:return!1}}function ve(n){return(n.mode&1)!==0&&(n.flags&128)===0}function be(n){if(ae){var a=te;if(a){var h=a;if(!ie(n,a)){if(ve(n))throw Error(I(418));a=Xo(h.nextSibling);var y=Q;a&&ie(n,a)?me(y,h):(n.flags=n.flags&-4097|2,ae=!1,Q=n)}}else{if(ve(n))throw Error(I(418));n.flags=n.flags&-4097|2,ae=!1,Q=n}}}function Ie(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Q=n}function Ue(n){if(n!==Q)return!1;if(!ae)return Ie(n),ae=!0,!1;var a;if((a=n.tag!==3)&&!(a=n.tag!==5)&&(a=n.type,a=a!=="head"&&a!=="body"&&!tc(n.type,n.memoizedProps)),a&&(a=te)){if(ve(n))throw tt(),Error(I(418));for(;a;)me(n,a),a=Xo(a.nextSibling)}if(Ie(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(I(317));e:{for(n=n.nextSibling,a=0;n;){if(n.nodeType===8){var h=n.data;if(h==="/$"){if(a===0){te=Xo(n.nextSibling);break e}a--}else h!=="$"&&h!=="$!"&&h!=="$?"||a++}n=n.nextSibling}te=null}}else te=Q?Xo(n.stateNode.nextSibling):null;return!0}function tt(){for(var n=te;n;)n=Xo(n.nextSibling)}function lt(){te=Q=null,ae=!1}function gt(n){ue===null?ue=[n]:ue.push(n)}var ut=ar.ReactCurrentBatchConfig;function ot(n,a,h){if(n=h.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(I(309));var y=h.stateNode}if(!y)throw Error(I(147,n));var b=y,E=""+n;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===E?a.ref:(a=function(Z){var ce=b.refs;Z===null?delete ce[E]:ce[E]=Z},a._stringRef=E,a)}if(typeof n!="string")throw Error(I(284));if(!h._owner)throw Error(I(290,n))}return n}function zt(n,a){throw n=Object.prototype.toString.call(a),Error(I(31,n==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":n))}function Jt(n){var a=n._init;return a(n._payload)}function ct(n){function a(Me,we){if(n){var Re=Me.deletions;Re===null?(Me.deletions=[we],Me.flags|=16):Re.push(we)}}function h(Me,we){if(!n)return null;for(;we!==null;)a(Me,we),we=we.sibling;return null}function y(Me,we){for(Me=new Map;we!==null;)we.key!==null?Me.set(we.key,we):Me.set(we.index,we),we=we.sibling;return Me}function b(Me,we){return Me=Ml(Me,we),Me.index=0,Me.sibling=null,Me}function E(Me,we,Re){return Me.index=Re,n?(Re=Me.alternate,Re!==null?(Re=Re.index,Re<we?(Me.flags|=2,we):Re):(Me.flags|=2,we)):(Me.flags|=1048576,we)}function Z(Me){return n&&Me.alternate===null&&(Me.flags|=2),Me}function ce(Me,we,Re,ht){return we===null||we.tag!==6?(we=za(Re,Me.mode,ht),we.return=Me,we):(we=b(we,Re),we.return=Me,we)}function _e(Me,we,Re,ht){var jt=Re.type;return jt===Vt?Qe(Me,we,Re.props.children,ht,Re.key):we!==null&&(we.elementType===jt||typeof jt=="object"&&jt!==null&&jt.$$typeof===Wr&&Jt(jt)===we.type)?(ht=b(we,Re.props),ht.ref=ot(Me,we,Re),ht.return=Me,ht):(ht=Mc(Re.type,Re.key,Re.props,null,Me.mode,ht),ht.ref=ot(Me,we,Re),ht.return=Me,ht)}function Be(Me,we,Re,ht){return we===null||we.tag!==4||we.stateNode.containerInfo!==Re.containerInfo||we.stateNode.implementation!==Re.implementation?(we=zs(Re,Me.mode,ht),we.return=Me,we):(we=b(we,Re.children||[]),we.return=Me,we)}function Qe(Me,we,Re,ht,jt){return we===null||we.tag!==7?(we=Al(Re,Me.mode,ht,jt),we.return=Me,we):(we=b(we,Re),we.return=Me,we)}function nt(Me,we,Re){if(typeof we=="string"&&we!==""||typeof we=="number")return we=za(""+we,Me.mode,Re),we.return=Me,we;if(typeof we=="object"&&we!==null){switch(we.$$typeof){case ur:return Re=Mc(we.type,we.key,we.props,null,Me.mode,Re),Re.ref=ot(Me,null,we),Re.return=Me,Re;case gr:return we=zs(we,Me.mode,Re),we.return=Me,we;case Wr:var ht=we._init;return nt(Me,ht(we._payload),Re)}if(qr(we)||Mt(we))return we=Al(we,Me.mode,Re,null),we.return=Me,we;zt(Me,we)}return null}function Ye(Me,we,Re,ht){var jt=we!==null?we.key:null;if(typeof Re=="string"&&Re!==""||typeof Re=="number")return jt!==null?null:ce(Me,we,""+Re,ht);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case ur:return Re.key===jt?_e(Me,we,Re,ht):null;case gr:return Re.key===jt?Be(Me,we,Re,ht):null;case Wr:return jt=Re._init,Ye(Me,we,jt(Re._payload),ht)}if(qr(Re)||Mt(Re))return jt!==null?null:Qe(Me,we,Re,ht,null);zt(Me,Re)}return null}function yt(Me,we,Re,ht,jt){if(typeof ht=="string"&&ht!==""||typeof ht=="number")return Me=Me.get(Re)||null,ce(we,Me,""+ht,jt);if(typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case ur:return Me=Me.get(ht.key===null?Re:ht.key)||null,_e(we,Me,ht,jt);case gr:return Me=Me.get(ht.key===null?Re:ht.key)||null,Be(we,Me,ht,jt);case Wr:var Yt=ht._init;return yt(Me,we,Re,Yt(ht._payload),jt)}if(qr(ht)||Mt(ht))return Me=Me.get(Re)||null,Qe(we,Me,ht,jt,null);zt(we,ht)}return null}function At(Me,we,Re,ht){for(var jt=null,Yt=null,Ut=we,lr=we=0,vn=null;Ut!==null&&lr<Re.length;lr++){Ut.index>lr?(vn=Ut,Ut=null):vn=Ut.sibling;var Zr=Ye(Me,Ut,Re[lr],ht);if(Zr===null){Ut===null&&(Ut=vn);break}n&&Ut&&Zr.alternate===null&&a(Me,Ut),we=E(Zr,we,lr),Yt===null?jt=Zr:Yt.sibling=Zr,Yt=Zr,Ut=vn}if(lr===Re.length)return h(Me,Ut),ae&&F(Me,lr),jt;if(Ut===null){for(;lr<Re.length;lr++)Ut=nt(Me,Re[lr],ht),Ut!==null&&(we=E(Ut,we,lr),Yt===null?jt=Ut:Yt.sibling=Ut,Yt=Ut);return ae&&F(Me,lr),jt}for(Ut=y(Me,Ut);lr<Re.length;lr++)vn=yt(Ut,Me,lr,Re[lr],ht),vn!==null&&(n&&vn.alternate!==null&&Ut.delete(vn.key===null?lr:vn.key),we=E(vn,we,lr),Yt===null?jt=vn:Yt.sibling=vn,Yt=vn);return n&&Ut.forEach(function(Xs){return a(Me,Xs)}),ae&&F(Me,lr),jt}function Ot(Me,we,Re,ht){var jt=Mt(Re);if(typeof jt!="function")throw Error(I(150));if(Re=jt.call(Re),Re==null)throw Error(I(151));for(var Yt=jt=null,Ut=we,lr=we=0,vn=null,Zr=Re.next();Ut!==null&&!Zr.done;lr++,Zr=Re.next()){Ut.index>lr?(vn=Ut,Ut=null):vn=Ut.sibling;var Xs=Ye(Me,Ut,Zr.value,ht);if(Xs===null){Ut===null&&(Ut=vn);break}n&&Ut&&Xs.alternate===null&&a(Me,Ut),we=E(Xs,we,lr),Yt===null?jt=Xs:Yt.sibling=Xs,Yt=Xs,Ut=vn}if(Zr.done)return h(Me,Ut),ae&&F(Me,lr),jt;if(Ut===null){for(;!Zr.done;lr++,Zr=Re.next())Zr=nt(Me,Zr.value,ht),Zr!==null&&(we=E(Zr,we,lr),Yt===null?jt=Zr:Yt.sibling=Zr,Yt=Zr);return ae&&F(Me,lr),jt}for(Ut=y(Me,Ut);!Zr.done;lr++,Zr=Re.next())Zr=yt(Ut,Me,lr,Zr.value,ht),Zr!==null&&(n&&Zr.alternate!==null&&Ut.delete(Zr.key===null?lr:Zr.key),we=E(Zr,we,lr),Yt===null?jt=Zr:Yt.sibling=Zr,Yt=Zr);return n&&Ut.forEach(function(Ep){return a(Me,Ep)}),ae&&F(Me,lr),jt}function Zi(Me,we,Re,ht){if(typeof Re=="object"&&Re!==null&&Re.type===Vt&&Re.key===null&&(Re=Re.props.children),typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case ur:e:{for(var jt=Re.key,Yt=we;Yt!==null;){if(Yt.key===jt){if(jt=Re.type,jt===Vt){if(Yt.tag===7){h(Me,Yt.sibling),we=b(Yt,Re.props.children),we.return=Me,Me=we;break e}}else if(Yt.elementType===jt||typeof jt=="object"&&jt!==null&&jt.$$typeof===Wr&&Jt(jt)===Yt.type){h(Me,Yt.sibling),we=b(Yt,Re.props),we.ref=ot(Me,Yt,Re),we.return=Me,Me=we;break e}h(Me,Yt);break}else a(Me,Yt);Yt=Yt.sibling}Re.type===Vt?(we=Al(Re.props.children,Me.mode,ht,Re.key),we.return=Me,Me=we):(ht=Mc(Re.type,Re.key,Re.props,null,Me.mode,ht),ht.ref=ot(Me,we,Re),ht.return=Me,Me=ht)}return Z(Me);case gr:e:{for(Yt=Re.key;we!==null;){if(we.key===Yt)if(we.tag===4&&we.stateNode.containerInfo===Re.containerInfo&&we.stateNode.implementation===Re.implementation){h(Me,we.sibling),we=b(we,Re.children||[]),we.return=Me,Me=we;break e}else{h(Me,we);break}else a(Me,we);we=we.sibling}we=zs(Re,Me.mode,ht),we.return=Me,Me=we}return Z(Me);case Wr:return Yt=Re._init,Zi(Me,we,Yt(Re._payload),ht)}if(qr(Re))return At(Me,we,Re,ht);if(Mt(Re))return Ot(Me,we,Re,ht);zt(Me,Re)}return typeof Re=="string"&&Re!==""||typeof Re=="number"?(Re=""+Re,we!==null&&we.tag===6?(h(Me,we.sibling),we=b(we,Re),we.return=Me,Me=we):(h(Me,we),we=za(Re,Me.mode,ht),we.return=Me,Me=we),Z(Me)):h(Me,we)}return Zi}var dt=ct(!0),Wt=ct(!1),Gr=xs(null),or=null,dr=null,Yr=null;function on(){Yr=dr=or=null}function ho(n){var a=Gr.current;oi(Gr),n._currentValue=a}function Qr(n,a,h){for(;n!==null;){var y=n.alternate;if((n.childLanes&a)!==a?(n.childLanes|=a,y!==null&&(y.childLanes|=a)):y!==null&&(y.childLanes&a)!==a&&(y.childLanes|=a),n===h)break;n=n.return}}function Xi(n,a){or=n,Yr=dr=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&a)!==0&&(go=!0),n.firstContext=null)}function ci(n){var a=n._currentValue;if(Yr!==n)if(n={context:n,memoizedValue:a,next:null},dr===null){if(or===null)throw Error(I(308));dr=n,or.dependencies={lanes:0,firstContext:n}}else dr=dr.next=n;return a}var Ci=null;function gn(n){Ci===null?Ci=[n]:Ci.push(n)}function Yo(n,a,h,y){var b=a.interleaved;return b===null?(h.next=h,gn(a)):(h.next=b.next,b.next=h),a.interleaved=h,Kn(n,y)}function Kn(n,a){n.lanes|=a;var h=n.alternate;for(h!==null&&(h.lanes|=a),h=n,n=n.return;n!==null;)n.childLanes|=a,h=n.alternate,h!==null&&(h.childLanes|=a),h=n,n=n.return;return h.tag===3?h.stateNode:null}var Qo=!1;function bs(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function po(n,a){n=n.updateQueue,a.updateQueue===n&&(a.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Ao(n,a){return{eventTime:n,lane:a,tag:0,payload:null,callback:null,next:null}}function Sa(n,a,h){var y=n.updateQueue;if(y===null)return null;if(y=y.shared,(Ur&2)!==0){var b=y.pending;return b===null?a.next=a:(a.next=b.next,b.next=a),y.pending=a,Kn(n,h)}return b=y.interleaved,b===null?(a.next=a,gn(y)):(a.next=b.next,b.next=a),y.interleaved=a,Kn(n,h)}function Bn(n,a,h){if(a=a.updateQueue,a!==null&&(a=a.shared,(h&4194240)!==0)){var y=a.lanes;y&=n.pendingLanes,h|=y,a.lanes=h,ha(n,h)}}function fo(n,a){var h=n.updateQueue,y=n.alternate;if(y!==null&&(y=y.updateQueue,h===y)){var b=null,E=null;if(h=h.firstBaseUpdate,h!==null){do{var Z={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};E===null?b=E=Z:E=E.next=Z,h=h.next}while(h!==null);E===null?b=E=a:E=E.next=a}else b=E=a;h={baseState:y.baseState,firstBaseUpdate:b,lastBaseUpdate:E,shared:y.shared,effects:y.effects},n.updateQueue=h;return}n=h.lastBaseUpdate,n===null?h.firstBaseUpdate=a:n.next=a,h.lastBaseUpdate=a}function ea(n,a,h,y){var b=n.updateQueue;Qo=!1;var E=b.firstBaseUpdate,Z=b.lastBaseUpdate,ce=b.shared.pending;if(ce!==null){b.shared.pending=null;var _e=ce,Be=_e.next;_e.next=null,Z===null?E=Be:Z.next=Be,Z=_e;var Qe=n.alternate;Qe!==null&&(Qe=Qe.updateQueue,ce=Qe.lastBaseUpdate,ce!==Z&&(ce===null?Qe.firstBaseUpdate=Be:ce.next=Be,Qe.lastBaseUpdate=_e))}if(E!==null){var nt=b.baseState;Z=0,Qe=Be=_e=null,ce=E;do{var Ye=ce.lane,yt=ce.eventTime;if((y&Ye)===Ye){Qe!==null&&(Qe=Qe.next={eventTime:yt,lane:0,tag:ce.tag,payload:ce.payload,callback:ce.callback,next:null});e:{var At=n,Ot=ce;switch(Ye=a,yt=h,Ot.tag){case 1:if(At=Ot.payload,typeof At=="function"){nt=At.call(yt,nt,Ye);break e}nt=At;break e;case 3:At.flags=At.flags&-65537|128;case 0:if(At=Ot.payload,Ye=typeof At=="function"?At.call(yt,nt,Ye):At,Ye==null)break e;nt=xt({},nt,Ye);break e;case 2:Qo=!0}}ce.callback!==null&&ce.lane!==0&&(n.flags|=64,Ye=b.effects,Ye===null?b.effects=[ce]:Ye.push(ce))}else yt={eventTime:yt,lane:Ye,tag:ce.tag,payload:ce.payload,callback:ce.callback,next:null},Qe===null?(Be=Qe=yt,_e=nt):Qe=Qe.next=yt,Z|=Ye;if(ce=ce.next,ce===null){if(ce=b.shared.pending,ce===null)break;Ye=ce,ce=Ye.next,Ye.next=null,b.lastBaseUpdate=Ye,b.shared.pending=null}}while(!0);if(Qe===null&&(_e=nt),b.baseState=_e,b.firstBaseUpdate=Be,b.lastBaseUpdate=Qe,a=b.shared.interleaved,a!==null){b=a;do Z|=b.lane,b=b.next;while(b!==a)}else E===null&&(b.shared.lanes=0);au|=Z,n.lanes=Z,n.memoizedState=nt}}function Do(n,a,h){if(n=a.effects,a.effects=null,n!==null)for(a=0;a<n.length;a++){var y=n[a],b=y.callback;if(b!==null){if(y.callback=null,y=h,typeof b!="function")throw Error(I(191,b));b.call(y)}}}var Ri={},fi=xs(Ri),yn=xs(Ri),mr=xs(Ri);function mo(n){if(n===Ri)throw Error(I(174));return n}function Ss(n,a){switch(ui(mr,a),ui(yn,n),ui(fi,Ri),n=a.nodeType,n){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:Ma(null,"");break;default:n=n===8?a.parentNode:a,a=n.namespaceURI||null,n=n.tagName,a=Ma(a,n)}oi(fi),ui(fi,a)}function ta(){oi(fi),oi(yn),oi(mr)}function nc(n){mo(mr.current);var a=mo(fi.current),h=Ma(a,n.type);a!==h&&(ui(yn,n),ui(fi,h))}function oc(n){yn.current===n&&(oi(fi),oi(yn))}var _i=xs(0);function ra(n){for(var a=n;a!==null;){if(a.tag===13){var h=a.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Cu=[];function xl(){for(var n=0;n<Cu.length;n++)Cu[n]._workInProgressVersionPrimary=null;Cu.length=0}var ks=ar.ReactCurrentDispatcher,wl=ar.ReactCurrentBatchConfig,ka=0,ei=null,zi=null,Ki=null,ac=!1,Iu=!1,sc=0,Ph=0;function an(){throw Error(I(321))}function bl(n,a){if(a===null)return!1;for(var h=0;h<a.length&&h<n.length;h++)if(!Hn(n[h],a[h]))return!1;return!0}function Ya(n,a,h,y,b,E){if(ka=E,ei=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,ks.current=n===null||n.memoizedState===null?Kc:mp,n=h(y,b),Iu){E=0;do{if(Iu=!1,sc=0,25<=E)throw Error(I(301));E+=1,Ki=zi=null,a.updateQueue=null,ks.current=_d,n=h(y,b)}while(Iu)}if(ks.current=Xc,a=zi!==null&&zi.next!==null,ka=0,Ki=zi=ei=null,ac=!1,a)throw Error(I(300));return n}function ia(){var n=sc!==0;return sc=0,n}function On(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ki===null?ei.memoizedState=Ki=n:Ki=Ki.next=n,Ki}function na(){if(zi===null){var n=ei.alternate;n=n!==null?n.memoizedState:null}else n=zi.next;var a=Ki===null?ei.memoizedState:Ki.next;if(a!==null)Ki=a,zi=n;else{if(n===null)throw Error(I(310));zi=n,n={memoizedState:zi.memoizedState,baseState:zi.baseState,baseQueue:zi.baseQueue,queue:zi.queue,next:null},Ki===null?ei.memoizedState=Ki=n:Ki=Ki.next=n}return Ki}function Qa(n,a){return typeof a=="function"?a(n):a}function Mh(n){var a=na(),h=a.queue;if(h===null)throw Error(I(311));h.lastRenderedReducer=n;var y=zi,b=y.baseQueue,E=h.pending;if(E!==null){if(b!==null){var Z=b.next;b.next=E.next,E.next=Z}y.baseQueue=b=E,h.pending=null}if(b!==null){E=b.next,y=y.baseState;var ce=Z=null,_e=null,Be=E;do{var Qe=Be.lane;if((ka&Qe)===Qe)_e!==null&&(_e=_e.next={lane:0,action:Be.action,hasEagerState:Be.hasEagerState,eagerState:Be.eagerState,next:null}),y=Be.hasEagerState?Be.eagerState:n(y,Be.action);else{var nt={lane:Qe,action:Be.action,hasEagerState:Be.hasEagerState,eagerState:Be.eagerState,next:null};_e===null?(ce=_e=nt,Z=y):_e=_e.next=nt,ei.lanes|=Qe,au|=Qe}Be=Be.next}while(Be!==null&&Be!==E);_e===null?Z=y:_e.next=ce,Hn(y,a.memoizedState)||(go=!0),a.memoizedState=y,a.baseState=Z,a.baseQueue=_e,h.lastRenderedState=y}if(n=h.interleaved,n!==null){b=n;do E=b.lane,ei.lanes|=E,au|=E,b=b.next;while(b!==n)}else b===null&&(h.lanes=0);return[a.memoizedState,h.dispatch]}function Zc(n){var a=na(),h=a.queue;if(h===null)throw Error(I(311));h.lastRenderedReducer=n;var y=h.dispatch,b=h.pending,E=a.memoizedState;if(b!==null){h.pending=null;var Z=b=b.next;do E=n(E,Z.action),Z=Z.next;while(Z!==b);Hn(E,a.memoizedState)||(go=!0),a.memoizedState=E,a.baseQueue===null&&(a.baseState=E),h.lastRenderedState=E}return[E,y]}function Fi(){}function qc(n,a){var h=ei,y=na(),b=a(),E=!Hn(y.memoizedState,b);if(E&&(y.memoizedState=b,go=!0),y=y.queue,cc(kl.bind(null,h,y,n),[n]),y.getSnapshot!==a||E||Ki!==null&&Ki.memoizedState.tag&1){if(h.flags|=2048,uc(9,Sl.bind(null,h,y,b,a),void 0,null),_n===null)throw Error(I(349));(ka&30)!==0||Ah(h,a,b)}return b}function Ah(n,a,h){n.flags|=16384,n={getSnapshot:a,value:h},a=ei.updateQueue,a===null?(a={lastEffect:null,stores:null},ei.updateQueue=a,a.stores=[n]):(h=a.stores,h===null?a.stores=[n]:h.push(n))}function Sl(n,a,h,y){a.value=h,a.getSnapshot=y,lc(a)&&Gc(n)}function kl(n,a,h){return h(function(){lc(a)&&Gc(n)})}function lc(n){var a=n.getSnapshot;n=n.value;try{var h=a();return!Hn(n,h)}catch{return!0}}function Gc(n){var a=Kn(n,1);a!==null&&ts(a,n,1,-1)}function Dh(n){var a=On();return typeof n=="function"&&(n=n()),a.memoizedState=a.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Qa,lastRenderedState:n},a.queue=n,n=n.dispatch=Mu.bind(null,ei,n),[a.memoizedState,n]}function uc(n,a,h,y){return n={tag:n,create:a,destroy:h,deps:y,next:null},a=ei.updateQueue,a===null?(a={lastEffect:null,stores:null},ei.updateQueue=a,a.lastEffect=n.next=n):(h=a.lastEffect,h===null?a.lastEffect=n.next=n:(y=h.next,h.next=n,n.next=y,a.lastEffect=n)),n}function Lh(){return na().memoizedState}function Hc(n,a,h,y){var b=On();ei.flags|=n,b.memoizedState=uc(1|a,h,void 0,y===void 0?null:y)}function Pu(n,a,h,y){var b=na();y=y===void 0?null:y;var E=void 0;if(zi!==null){var Z=zi.memoizedState;if(E=Z.destroy,y!==null&&bl(y,Z.deps)){b.memoizedState=uc(a,h,E,y);return}}ei.flags|=n,b.memoizedState=uc(1|a,h,E,y)}function fd(n,a){return Hc(8390656,8,n,a)}function cc(n,a){return Pu(2048,8,n,a)}function Rh(n,a){return Pu(4,2,n,a)}function Fh(n,a){return Pu(4,4,n,a)}function tu(n,a){if(typeof a=="function")return n=n(),a(n),function(){a(null)};if(a!=null)return n=n(),a.current=n,function(){a.current=null}}function md(n,a,h){return h=h!=null?h.concat([n]):null,Pu(4,4,tu.bind(null,a,n),h)}function ru(){}function hc(n,a){var h=na();a=a===void 0?null:a;var y=h.memoizedState;return y!==null&&a!==null&&bl(a,y[1])?y[0]:(h.memoizedState=[n,a],n)}function dc(n,a){var h=na();a=a===void 0?null:a;var y=h.memoizedState;return y!==null&&a!==null&&bl(a,y[1])?y[0]:(n=n(),h.memoizedState=[n,a],n)}function Bh(n,a,h){return(ka&21)===0?(n.baseState&&(n.baseState=!1,go=!0),n.memoizedState=h):(Hn(h,a)||(h=Un(),ei.lanes|=h,au|=h,n.baseState=!0),a)}function gd(n,a){var h=jr;jr=h!==0&&4>h?h:4,n(!0);var y=wl.transition;wl.transition={};try{n(!1),a()}finally{jr=h,wl.transition=y}}function yd(){return na().memoizedState}function Jn(n,a,h){var y=Pl(n);if(h={lane:y,action:h,hasEagerState:!1,eagerState:null,next:null},Wc(n))Oh(a,h);else if(h=Yo(n,a,h,y),h!==null){var b=yo();ts(h,n,y,b),Au(h,a,y)}}function Mu(n,a,h){var y=Pl(n),b={lane:y,action:h,hasEagerState:!1,eagerState:null,next:null};if(Wc(n))Oh(a,b);else{var E=n.alternate;if(n.lanes===0&&(E===null||E.lanes===0)&&(E=a.lastRenderedReducer,E!==null))try{var Z=a.lastRenderedState,ce=E(Z,h);if(b.hasEagerState=!0,b.eagerState=ce,Hn(ce,Z)){var _e=a.interleaved;_e===null?(b.next=b,gn(a)):(b.next=_e.next,_e.next=b),a.interleaved=b;return}}catch{}h=Yo(n,a,b,y),h!==null&&(b=yo(),ts(h,n,y,b),Au(h,a,y))}}function Wc(n){var a=n.alternate;return n===ei||a!==null&&a===ei}function Oh(n,a){Iu=ac=!0;var h=n.pending;h===null?a.next=a:(a.next=h.next,h.next=a),n.pending=a}function Au(n,a,h){if((h&4194240)!==0){var y=a.lanes;y&=n.pendingLanes,h|=y,a.lanes=h,ha(n,h)}}var Xc={readContext:ci,useCallback:an,useContext:an,useEffect:an,useImperativeHandle:an,useInsertionEffect:an,useLayoutEffect:an,useMemo:an,useReducer:an,useRef:an,useState:an,useDebugValue:an,useDeferredValue:an,useTransition:an,useMutableSource:an,useSyncExternalStore:an,useId:an,unstable_isNewReconciler:!1},Kc={readContext:ci,useCallback:function(n,a){return On().memoizedState=[n,a===void 0?null:a],n},useContext:ci,useEffect:fd,useImperativeHandle:function(n,a,h){return h=h!=null?h.concat([n]):null,Hc(4194308,4,tu.bind(null,a,n),h)},useLayoutEffect:function(n,a){return Hc(4194308,4,n,a)},useInsertionEffect:function(n,a){return Hc(4,2,n,a)},useMemo:function(n,a){var h=On();return a=a===void 0?null:a,n=n(),h.memoizedState=[n,a],n},useReducer:function(n,a,h){var y=On();return a=h!==void 0?h(a):a,y.memoizedState=y.baseState=a,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:a},y.queue=n,n=n.dispatch=Jn.bind(null,ei,n),[y.memoizedState,n]},useRef:function(n){var a=On();return n={current:n},a.memoizedState=n},useState:Dh,useDebugValue:ru,useDeferredValue:function(n){return On().memoizedState=n},useTransition:function(){var n=Dh(!1),a=n[0];return n=gd.bind(null,n[1]),On().memoizedState=n,[a,n]},useMutableSource:function(){},useSyncExternalStore:function(n,a,h){var y=ei,b=On();if(ae){if(h===void 0)throw Error(I(407));h=h()}else{if(h=a(),_n===null)throw Error(I(349));(ka&30)!==0||Ah(y,a,h)}b.memoizedState=h;var E={value:h,getSnapshot:a};return b.queue=E,fd(kl.bind(null,y,E,n),[n]),y.flags|=2048,uc(9,Sl.bind(null,y,E,h,a),void 0,null),h},useId:function(){var n=On(),a=_n.identifierPrefix;if(ae){var h=C,y=S;h=(y&~(1<<32-Vr(y)-1)).toString(32)+h,a=":"+a+"R"+h,h=sc++,0<h&&(a+="H"+h.toString(32)),a+=":"}else h=Ph++,a=":"+a+"r"+h.toString(32)+":";return n.memoizedState=a},unstable_isNewReconciler:!1},mp={readContext:ci,useCallback:hc,useContext:ci,useEffect:cc,useImperativeHandle:md,useInsertionEffect:Rh,useLayoutEffect:Fh,useMemo:dc,useReducer:Mh,useRef:Lh,useState:function(){return Mh(Qa)},useDebugValue:ru,useDeferredValue:function(n){var a=na();return Bh(a,zi.memoizedState,n)},useTransition:function(){var n=Mh(Qa)[0],a=na().memoizedState;return[n,a]},useMutableSource:Fi,useSyncExternalStore:qc,useId:yd,unstable_isNewReconciler:!1},_d={readContext:ci,useCallback:hc,useContext:ci,useEffect:cc,useImperativeHandle:md,useInsertionEffect:Rh,useLayoutEffect:Fh,useMemo:dc,useReducer:Zc,useRef:Lh,useState:function(){return Zc(Qa)},useDebugValue:ru,useDeferredValue:function(n){var a=na();return zi===null?a.memoizedState=n:Bh(a,zi.memoizedState,n)},useTransition:function(){var n=Zc(Qa)[0],a=na().memoizedState;return[n,a]},useMutableSource:Fi,useSyncExternalStore:qc,useId:yd,unstable_isNewReconciler:!1};function Ta(n,a){if(n&&n.defaultProps){a=xt({},a),n=n.defaultProps;for(var h in n)a[h]===void 0&&(a[h]=n[h]);return a}return a}function Jc(n,a,h,y){a=n.memoizedState,h=h(y,a),h=h==null?a:xt({},a,h),n.memoizedState=h,n.lanes===0&&(n.updateQueue.baseState=h)}var Yc={isMounted:function(n){return(n=n._reactInternals)?ir(n)===n:!1},enqueueSetState:function(n,a,h){n=n._reactInternals;var y=yo(),b=Pl(n),E=Ao(y,b);E.payload=a,h!=null&&(E.callback=h),a=Sa(n,E,b),a!==null&&(ts(a,n,b,y),Bn(a,n,b))},enqueueReplaceState:function(n,a,h){n=n._reactInternals;var y=yo(),b=Pl(n),E=Ao(y,b);E.tag=1,E.payload=a,h!=null&&(E.callback=h),a=Sa(n,E,b),a!==null&&(ts(a,n,b,y),Bn(a,n,b))},enqueueForceUpdate:function(n,a){n=n._reactInternals;var h=yo(),y=Pl(n),b=Ao(h,y);b.tag=2,a!=null&&(b.callback=a),a=Sa(n,b,y),a!==null&&(ts(a,n,y,h),Bn(a,n,y))}};function Qc(n,a,h,y,b,E,Z){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(y,E,Z):a.prototype&&a.prototype.isPureReactComponent?!gs(h,y)||!gs(b,E):!0}function Nh(n,a,h){var y=!1,b=ws,E=a.contextType;return typeof E=="object"&&E!==null?E=ci(E):(b=mn(a)?Mo:Jr.current,y=a.contextTypes,E=(y=y!=null)?Ja(n,b):ws),a=new a(h,E),n.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=Yc,n.stateNode=a,a._reactInternals=n,y&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=b,n.__reactInternalMemoizedMaskedChildContext=E),a}function eh(n,a,h,y){n=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(h,y),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(h,y),a.state!==n&&Yc.enqueueReplaceState(a,a.state,null)}function iu(n,a,h,y){var b=n.stateNode;b.props=h,b.state=n.memoizedState,b.refs={},bs(n);var E=a.contextType;typeof E=="object"&&E!==null?b.context=ci(E):(E=mn(a)?Mo:Jr.current,b.context=Ja(n,E)),b.state=n.memoizedState,E=a.getDerivedStateFromProps,typeof E=="function"&&(Jc(n,a,E,h),b.state=n.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(a=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),a!==b.state&&Yc.enqueueReplaceState(b,b.state,null),ea(n,h,b,y),b.state=n.memoizedState),typeof b.componentDidMount=="function"&&(n.flags|=4194308)}function zn(n,a){try{var h="",y=a;do h+=$t(y),y=y.return;while(y);var b=h}catch(E){b=`
Error generating stack: `+E.message+`
`+E.stack}return{value:n,source:a,stack:b,digest:null}}function th(n,a,h){return{value:n,source:null,stack:h??null,digest:a??null}}function pc(n,a){try{console.error(a.value)}catch(h){setTimeout(function(){throw h})}}var gp=typeof WeakMap=="function"?WeakMap:Map;function jh(n,a,h){h=Ao(-1,h),h.tag=3,h.payload={element:null};var y=a.value;return h.callback=function(){Sc||(Sc=!0,dh=y),pc(n,a)},h}function vd(n,a,h){h=Ao(-1,h),h.tag=3;var y=n.type.getDerivedStateFromError;if(typeof y=="function"){var b=a.value;h.payload=function(){return y(b)},h.callback=function(){pc(n,a)}}var E=n.stateNode;return E!==null&&typeof E.componentDidCatch=="function"&&(h.callback=function(){pc(n,a),typeof y!="function"&&(Mr===null?Mr=new Set([this]):Mr.add(this));var Z=a.stack;this.componentDidCatch(a.value,{componentStack:Z!==null?Z:""})}),h}function xd(n,a,h){var y=n.pingCache;if(y===null){y=n.pingCache=new gp;var b=new Set;y.set(a,b)}else b=y.get(a),b===void 0&&(b=new Set,y.set(a,b));b.has(h)||(b.add(h),n=bp.bind(null,n,a,h),a.then(n,n))}function wd(n){do{var a;if((a=n.tag===13)&&(a=n.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return n;n=n.return}while(n!==null);return null}function bd(n,a,h,y,b){return(n.mode&1)===0?(n===a?n.flags|=65536:(n.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(a=Ao(-1,1),a.tag=2,Sa(h,a,1))),h.lanes|=1),n):(n.flags|=65536,n.lanes=b,n)}var Sd=ar.ReactCurrentOwner,go=!1;function Ji(n,a,h,y){a.child=n===null?Wt(a,null,h,y):dt(a,n.child,h,y)}function Du(n,a,h,y,b){h=h.render;var E=a.ref;return Xi(a,b),y=Ya(n,a,h,y,E,b),h=ia(),n!==null&&!go?(a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~b,oa(n,a,b)):(ae&&h&&$(a),a.flags|=1,Ji(n,a,y,b),a.child)}function kd(n,a,h,y,b){if(n===null){var E=h.type;return typeof E=="function"&&!Pc(E)&&E.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(a.tag=15,a.type=E,Td(n,a,E,y,b)):(n=Mc(h.type,null,y,a,a.mode,b),n.ref=a.ref,n.return=a,a.child=n)}if(E=n.child,(n.lanes&b)===0){var Z=E.memoizedProps;if(h=h.compare,h=h!==null?h:gs,h(Z,y)&&n.ref===a.ref)return oa(n,a,b)}return a.flags|=1,n=Ml(E,y),n.ref=a.ref,n.return=a,a.child=n}function Td(n,a,h,y,b){if(n!==null){var E=n.memoizedProps;if(gs(E,y)&&n.ref===a.ref)if(go=!1,a.pendingProps=y=E,(n.lanes&b)!==0)(n.flags&131072)!==0&&(go=!0);else return a.lanes=n.lanes,oa(n,a,b)}return Vh(n,a,h,y,b)}function zd(n,a,h){var y=a.pendingProps,b=y.children,E=n!==null?n.memoizedState:null;if(y.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},ui(Fu,eo),eo|=h;else{if((h&1073741824)===0)return n=E!==null?E.baseLanes|h:h,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:n,cachePool:null,transitions:null},a.updateQueue=null,ui(Fu,eo),eo|=n,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=E!==null?E.baseLanes:h,ui(Fu,eo),eo|=y}else E!==null?(y=E.baseLanes|h,a.memoizedState=null):y=h,ui(Fu,eo),eo|=y;return Ji(n,a,b,h),a.child}function Ed(n,a){var h=a.ref;(n===null&&h!==null||n!==null&&n.ref!==h)&&(a.flags|=512,a.flags|=2097152)}function Vh(n,a,h,y,b){var E=mn(h)?Mo:Jr.current;return E=Ja(a,E),Xi(a,b),h=Ya(n,a,h,y,E,b),y=ia(),n!==null&&!go?(a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~b,oa(n,a,b)):(ae&&y&&$(a),a.flags|=1,Ji(n,a,h,b),a.child)}function Cd(n,a,h,y,b){if(mn(h)){var E=!0;co(a)}else E=!1;if(Xi(a,b),a.stateNode===null)gc(n,a),Nh(a,h,y),iu(a,h,y,b),y=!0;else if(n===null){var Z=a.stateNode,ce=a.memoizedProps;Z.props=ce;var _e=Z.context,Be=h.contextType;typeof Be=="object"&&Be!==null?Be=ci(Be):(Be=mn(h)?Mo:Jr.current,Be=Ja(a,Be));var Qe=h.getDerivedStateFromProps,nt=typeof Qe=="function"||typeof Z.getSnapshotBeforeUpdate=="function";nt||typeof Z.UNSAFE_componentWillReceiveProps!="function"&&typeof Z.componentWillReceiveProps!="function"||(ce!==y||_e!==Be)&&eh(a,Z,y,Be),Qo=!1;var Ye=a.memoizedState;Z.state=Ye,ea(a,y,Z,b),_e=a.memoizedState,ce!==y||Ye!==_e||Sr.current||Qo?(typeof Qe=="function"&&(Jc(a,h,Qe,y),_e=a.memoizedState),(ce=Qo||Qc(a,h,ce,y,Ye,_e,Be))?(nt||typeof Z.UNSAFE_componentWillMount!="function"&&typeof Z.componentWillMount!="function"||(typeof Z.componentWillMount=="function"&&Z.componentWillMount(),typeof Z.UNSAFE_componentWillMount=="function"&&Z.UNSAFE_componentWillMount()),typeof Z.componentDidMount=="function"&&(a.flags|=4194308)):(typeof Z.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=y,a.memoizedState=_e),Z.props=y,Z.state=_e,Z.context=Be,y=ce):(typeof Z.componentDidMount=="function"&&(a.flags|=4194308),y=!1)}else{Z=a.stateNode,po(n,a),ce=a.memoizedProps,Be=a.type===a.elementType?ce:Ta(a.type,ce),Z.props=Be,nt=a.pendingProps,Ye=Z.context,_e=h.contextType,typeof _e=="object"&&_e!==null?_e=ci(_e):(_e=mn(h)?Mo:Jr.current,_e=Ja(a,_e));var yt=h.getDerivedStateFromProps;(Qe=typeof yt=="function"||typeof Z.getSnapshotBeforeUpdate=="function")||typeof Z.UNSAFE_componentWillReceiveProps!="function"&&typeof Z.componentWillReceiveProps!="function"||(ce!==nt||Ye!==_e)&&eh(a,Z,y,_e),Qo=!1,Ye=a.memoizedState,Z.state=Ye,ea(a,y,Z,b);var At=a.memoizedState;ce!==nt||Ye!==At||Sr.current||Qo?(typeof yt=="function"&&(Jc(a,h,yt,y),At=a.memoizedState),(Be=Qo||Qc(a,h,Be,y,Ye,At,_e)||!1)?(Qe||typeof Z.UNSAFE_componentWillUpdate!="function"&&typeof Z.componentWillUpdate!="function"||(typeof Z.componentWillUpdate=="function"&&Z.componentWillUpdate(y,At,_e),typeof Z.UNSAFE_componentWillUpdate=="function"&&Z.UNSAFE_componentWillUpdate(y,At,_e)),typeof Z.componentDidUpdate=="function"&&(a.flags|=4),typeof Z.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof Z.componentDidUpdate!="function"||ce===n.memoizedProps&&Ye===n.memoizedState||(a.flags|=4),typeof Z.getSnapshotBeforeUpdate!="function"||ce===n.memoizedProps&&Ye===n.memoizedState||(a.flags|=1024),a.memoizedProps=y,a.memoizedState=At),Z.props=y,Z.state=At,Z.context=_e,y=Be):(typeof Z.componentDidUpdate!="function"||ce===n.memoizedProps&&Ye===n.memoizedState||(a.flags|=4),typeof Z.getSnapshotBeforeUpdate!="function"||ce===n.memoizedProps&&Ye===n.memoizedState||(a.flags|=1024),y=!1)}return Uh(n,a,h,y,E,b)}function Uh(n,a,h,y,b,E){Ed(n,a);var Z=(a.flags&128)!==0;if(!y&&!Z)return b&&_l(a,h,!1),oa(n,a,E);y=a.stateNode,Sd.current=a;var ce=Z&&typeof h.getDerivedStateFromError!="function"?null:y.render();return a.flags|=1,n!==null&&Z?(a.child=dt(a,n.child,null,E),a.child=dt(a,null,ce,E)):Ji(n,a,ce,E),a.memoizedState=y.state,b&&_l(a,h,!0),a.child}function rh(n){var a=n.stateNode;a.pendingContext?gl(n,a.pendingContext,a.pendingContext!==a.context):a.context&&gl(n,a.context,!1),Ss(n,a.containerInfo)}function Id(n,a,h,y,b){return lt(),gt(b),a.flags|=256,Ji(n,a,h,y),a.child}var Tl={dehydrated:null,treeContext:null,retryLane:0};function $h(n){return{baseLanes:n,cachePool:null,transitions:null}}function Ii(n,a,h){var y=a.pendingProps,b=_i.current,E=!1,Z=(a.flags&128)!==0,ce;if((ce=Z)||(ce=n!==null&&n.memoizedState===null?!1:(b&2)!==0),ce?(E=!0,a.flags&=-129):(n===null||n.memoizedState!==null)&&(b|=1),ui(_i,b&1),n===null)return be(a),n=a.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((a.mode&1)===0?a.lanes=1:n.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(Z=y.children,n=y.fallback,E?(y=a.mode,E=a.child,Z={mode:"hidden",children:Z},(y&1)===0&&E!==null?(E.childLanes=0,E.pendingProps=Z):E=Dl(Z,y,0,null),n=Al(n,y,h,null),E.return=a,n.return=a,E.sibling=n,a.child=E,a.child.memoizedState=$h(h),a.memoizedState=Tl,n):Lu(a,Z));if(b=n.memoizedState,b!==null&&(ce=b.dehydrated,ce!==null))return ih(n,a,Z,y,ce,b,h);if(E){E=y.fallback,Z=a.mode,b=n.child,ce=b.sibling;var _e={mode:"hidden",children:y.children};return(Z&1)===0&&a.child!==b?(y=a.child,y.childLanes=0,y.pendingProps=_e,a.deletions=null):(y=Ml(b,_e),y.subtreeFlags=b.subtreeFlags&14680064),ce!==null?E=Ml(ce,E):(E=Al(E,Z,h,null),E.flags|=2),E.return=a,y.return=a,y.sibling=E,a.child=y,y=E,E=a.child,Z=n.child.memoizedState,Z=Z===null?$h(h):{baseLanes:Z.baseLanes|h,cachePool:null,transitions:Z.transitions},E.memoizedState=Z,E.childLanes=n.childLanes&~h,a.memoizedState=Tl,y}return E=n.child,n=E.sibling,y=Ml(E,{mode:"visible",children:y.children}),(a.mode&1)===0&&(y.lanes=h),y.return=a,y.sibling=null,n!==null&&(h=a.deletions,h===null?(a.deletions=[n],a.flags|=16):h.push(n)),a.child=y,a.memoizedState=null,y}function Lu(n,a){return a=Dl({mode:"visible",children:a},n.mode,0,null),a.return=n,n.child=a}function fc(n,a,h,y){return y!==null&&gt(y),dt(a,n.child,null,h),n=Lu(a,a.pendingProps.children),n.flags|=2,a.memoizedState=null,n}function ih(n,a,h,y,b,E,Z){if(h)return a.flags&256?(a.flags&=-257,y=th(Error(I(422))),fc(n,a,Z,y)):a.memoizedState!==null?(a.child=n.child,a.flags|=128,null):(E=y.fallback,b=a.mode,y=Dl({mode:"visible",children:y.children},b,0,null),E=Al(E,b,Z,null),E.flags|=2,y.return=a,E.return=a,y.sibling=E,a.child=y,(a.mode&1)!==0&&dt(a,n.child,null,Z),a.child.memoizedState=$h(Z),a.memoizedState=Tl,E);if((a.mode&1)===0)return fc(n,a,Z,null);if(b.data==="$!"){if(y=b.nextSibling&&b.nextSibling.dataset,y)var ce=y.dgst;return y=ce,E=Error(I(419)),y=th(E,y,void 0),fc(n,a,Z,y)}if(ce=(Z&n.childLanes)!==0,go||ce){if(y=_n,y!==null){switch(Z&-Z){case 4:b=2;break;case 16:b=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:b=32;break;case 536870912:b=268435456;break;default:b=0}b=(b&(y.suspendedLanes|Z))!==0?0:b,b!==0&&b!==E.retryLane&&(E.retryLane=b,Kn(n,b),ts(y,n,b,-1))}return mh(),y=th(Error(I(421))),fc(n,a,Z,y)}return b.data==="$?"?(a.flags|=128,a.child=n.child,a=qd.bind(null,n),b._reactRetry=a,null):(n=E.treeContext,te=Xo(b.nextSibling),Q=a,ae=!0,ue=null,n!==null&&(p[v++]=S,p[v++]=C,p[v++]=w,S=n.id,C=n.overflow,w=a),a=Lu(a,y.children),a.flags|=4096,a)}function mc(n,a,h){n.lanes|=a;var y=n.alternate;y!==null&&(y.lanes|=a),Qr(n.return,a,h)}function nu(n,a,h,y,b){var E=n.memoizedState;E===null?n.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:y,tail:h,tailMode:b}:(E.isBackwards=a,E.rendering=null,E.renderingStartTime=0,E.last=y,E.tail=h,E.tailMode=b)}function Zh(n,a,h){var y=a.pendingProps,b=y.revealOrder,E=y.tail;if(Ji(n,a,y.children,h),y=_i.current,(y&2)!==0)y=y&1|2,a.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=a.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&mc(n,h,a);else if(n.tag===19)mc(n,h,a);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===a)break e;for(;n.sibling===null;){if(n.return===null||n.return===a)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}y&=1}if(ui(_i,y),(a.mode&1)===0)a.memoizedState=null;else switch(b){case"forwards":for(h=a.child,b=null;h!==null;)n=h.alternate,n!==null&&ra(n)===null&&(b=h),h=h.sibling;h=b,h===null?(b=a.child,a.child=null):(b=h.sibling,h.sibling=null),nu(a,!1,b,h,E);break;case"backwards":for(h=null,b=a.child,a.child=null;b!==null;){if(n=b.alternate,n!==null&&ra(n)===null){a.child=b;break}n=b.sibling,b.sibling=h,h=b,b=n}nu(a,!0,h,null,E);break;case"together":nu(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function gc(n,a){(a.mode&1)===0&&n!==null&&(n.alternate=null,a.alternate=null,a.flags|=2)}function oa(n,a,h){if(n!==null&&(a.dependencies=n.dependencies),au|=a.lanes,(h&a.childLanes)===0)return null;if(n!==null&&a.child!==n.child)throw Error(I(153));if(a.child!==null){for(n=a.child,h=Ml(n,n.pendingProps),a.child=h,h.return=a;n.sibling!==null;)n=n.sibling,h=h.sibling=Ml(n,n.pendingProps),h.return=a;h.sibling=null}return a.child}function qh(n,a,h){switch(a.tag){case 3:rh(a),lt();break;case 5:nc(a);break;case 1:mn(a.type)&&co(a);break;case 4:Ss(a,a.stateNode.containerInfo);break;case 10:var y=a.type._context,b=a.memoizedProps.value;ui(Gr,y._currentValue),y._currentValue=b;break;case 13:if(y=a.memoizedState,y!==null)return y.dehydrated!==null?(ui(_i,_i.current&1),a.flags|=128,null):(h&a.child.childLanes)!==0?Ii(n,a,h):(ui(_i,_i.current&1),n=oa(n,a,h),n!==null?n.sibling:null);ui(_i,_i.current&1);break;case 19:if(y=(h&a.childLanes)!==0,(n.flags&128)!==0){if(y)return Zh(n,a,h);a.flags|=128}if(b=a.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),ui(_i,_i.current),y)break;return null;case 22:case 23:return a.lanes=0,zd(n,a,h)}return oa(n,a,h)}var nh,yc,oh,Gh;nh=function(n,a){for(var h=a.child;h!==null;){if(h.tag===5||h.tag===6)n.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===a)break;for(;h.sibling===null;){if(h.return===null||h.return===a)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},yc=function(){},oh=function(n,a,h,y){var b=n.memoizedProps;if(b!==y){n=a.stateNode,mo(fi.current);var E=null;switch(h){case"input":b=wo(n,b),y=wo(n,y),E=[];break;case"select":b=xt({},b,{value:void 0}),y=xt({},y,{value:void 0}),E=[];break;case"textarea":b=So(n,b),y=So(n,y),E=[];break;default:typeof b.onClick!="function"&&typeof y.onClick=="function"&&(n.onclick=Xn)}Gi(h,y);var Z;h=null;for(Be in b)if(!y.hasOwnProperty(Be)&&b.hasOwnProperty(Be)&&b[Be]!=null)if(Be==="style"){var ce=b[Be];for(Z in ce)ce.hasOwnProperty(Z)&&(h||(h={}),h[Z]="")}else Be!=="dangerouslySetInnerHTML"&&Be!=="children"&&Be!=="suppressContentEditableWarning"&&Be!=="suppressHydrationWarning"&&Be!=="autoFocus"&&(W.hasOwnProperty(Be)?E||(E=[]):(E=E||[]).push(Be,null));for(Be in y){var _e=y[Be];if(ce=b?.[Be],y.hasOwnProperty(Be)&&_e!==ce&&(_e!=null||ce!=null))if(Be==="style")if(ce){for(Z in ce)!ce.hasOwnProperty(Z)||_e&&_e.hasOwnProperty(Z)||(h||(h={}),h[Z]="");for(Z in _e)_e.hasOwnProperty(Z)&&ce[Z]!==_e[Z]&&(h||(h={}),h[Z]=_e[Z])}else h||(E||(E=[]),E.push(Be,h)),h=_e;else Be==="dangerouslySetInnerHTML"?(_e=_e?_e.__html:void 0,ce=ce?ce.__html:void 0,_e!=null&&ce!==_e&&(E=E||[]).push(Be,_e)):Be==="children"?typeof _e!="string"&&typeof _e!="number"||(E=E||[]).push(Be,""+_e):Be!=="suppressContentEditableWarning"&&Be!=="suppressHydrationWarning"&&(W.hasOwnProperty(Be)?(_e!=null&&Be==="onScroll"&&ni("scroll",n),E||ce===_e||(E=[])):(E=E||[]).push(Be,_e))}h&&(E=E||[]).push("style",h);var Be=E;(a.updateQueue=Be)&&(a.flags|=4)}},Gh=function(n,a,h,y){h!==y&&(a.flags|=4)};function Ru(n,a){if(!ae)switch(n.tailMode){case"hidden":a=n.tail;for(var h=null;a!==null;)a.alternate!==null&&(h=a),a=a.sibling;h===null?n.tail=null:h.sibling=null;break;case"collapsed":h=n.tail;for(var y=null;h!==null;)h.alternate!==null&&(y=h),h=h.sibling;y===null?a||n.tail===null?n.tail=null:n.tail.sibling=null:y.sibling=null}}function Yn(n){var a=n.alternate!==null&&n.alternate.child===n.child,h=0,y=0;if(a)for(var b=n.child;b!==null;)h|=b.lanes|b.childLanes,y|=b.subtreeFlags&14680064,y|=b.flags&14680064,b.return=n,b=b.sibling;else for(b=n.child;b!==null;)h|=b.lanes|b.childLanes,y|=b.subtreeFlags,y|=b.flags,b.return=n,b=b.sibling;return n.subtreeFlags|=y,n.childLanes=h,a}function yp(n,a,h){var y=a.pendingProps;switch(K(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yn(a),null;case 1:return mn(a.type)&&Ql(),Yn(a),null;case 3:return y=a.stateNode,ta(),oi(Sr),oi(Jr),xl(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(n===null||n.child===null)&&(Ue(a)?a.flags|=4:n===null||n.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,ue!==null&&(Kh(ue),ue=null))),yc(n,a),Yn(a),null;case 5:oc(a);var b=mo(mr.current);if(h=a.type,n!==null&&a.stateNode!=null)oh(n,a,h,y,b),n.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!y){if(a.stateNode===null)throw Error(I(166));return Yn(a),null}if(n=mo(fi.current),Ue(a)){y=a.stateNode,h=a.type;var E=a.memoizedProps;switch(y[Fn]=a,y[ba]=E,n=(a.mode&1)!==0,h){case"dialog":ni("cancel",y),ni("close",y);break;case"iframe":case"object":case"embed":ni("load",y);break;case"video":case"audio":for(b=0;b<vs.length;b++)ni(vs[b],y);break;case"source":ni("error",y);break;case"img":case"image":case"link":ni("error",y),ni("load",y);break;case"details":ni("toggle",y);break;case"input":Ia(y,E),ni("invalid",y);break;case"select":y._wrapperState={wasMultiple:!!E.multiple},ni("invalid",y);break;case"textarea":ko(y,E),ni("invalid",y)}Gi(h,E),b=null;for(var Z in E)if(E.hasOwnProperty(Z)){var ce=E[Z];Z==="children"?typeof ce=="string"?y.textContent!==ce&&(E.suppressHydrationWarning!==!0&&fl(y.textContent,ce,n),b=["children",ce]):typeof ce=="number"&&y.textContent!==""+ce&&(E.suppressHydrationWarning!==!0&&fl(y.textContent,ce,n),b=["children",""+ce]):W.hasOwnProperty(Z)&&ce!=null&&Z==="onScroll"&&ni("scroll",y)}switch(h){case"input":Pn(y),ua(y,E,!0);break;case"textarea":Pn(y),Mn(y);break;case"select":case"option":break;default:typeof E.onClick=="function"&&(y.onclick=Xn)}y=b,a.updateQueue=y,y!==null&&(a.flags|=4)}else{Z=b.nodeType===9?b:b.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=cs(h)),n==="http://www.w3.org/1999/xhtml"?h==="script"?(n=Z.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof y.is=="string"?n=Z.createElement(h,{is:y.is}):(n=Z.createElement(h),h==="select"&&(Z=n,y.multiple?Z.multiple=!0:y.size&&(Z.size=y.size))):n=Z.createElementNS(n,h),n[Fn]=a,n[ba]=y,nh(n,a,!1,!1),a.stateNode=n;e:{switch(Z=Ni(h,y),h){case"dialog":ni("cancel",n),ni("close",n),b=y;break;case"iframe":case"object":case"embed":ni("load",n),b=y;break;case"video":case"audio":for(b=0;b<vs.length;b++)ni(vs[b],n);b=y;break;case"source":ni("error",n),b=y;break;case"img":case"image":case"link":ni("error",n),ni("load",n),b=y;break;case"details":ni("toggle",n),b=y;break;case"input":Ia(n,y),b=wo(n,y),ni("invalid",n);break;case"option":b=y;break;case"select":n._wrapperState={wasMultiple:!!y.multiple},b=xt({},y,{value:void 0}),ni("invalid",n);break;case"textarea":ko(n,y),b=So(n,y),ni("invalid",n);break;default:b=y}Gi(h,b),ce=b;for(E in ce)if(ce.hasOwnProperty(E)){var _e=ce[E];E==="style"?sr(n,_e):E==="dangerouslySetInnerHTML"?(_e=_e?_e.__html:void 0,_e!=null&&ao(n,_e)):E==="children"?typeof _e=="string"?(h!=="textarea"||_e!=="")&&pi(n,_e):typeof _e=="number"&&pi(n,""+_e):E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&E!=="autoFocus"&&(W.hasOwnProperty(E)?_e!=null&&E==="onScroll"&&ni("scroll",n):_e!=null&&St(n,E,_e,Z))}switch(h){case"input":Pn(n),ua(n,y,!1);break;case"textarea":Pn(n),Mn(n);break;case"option":y.value!=null&&n.setAttribute("value",""+cr(y.value));break;case"select":n.multiple=!!y.multiple,E=y.value,E!=null?bo(n,!!y.multiple,E,!1):y.defaultValue!=null&&bo(n,!!y.multiple,y.defaultValue,!0);break;default:typeof b.onClick=="function"&&(n.onclick=Xn)}switch(h){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}}y&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return Yn(a),null;case 6:if(n&&a.stateNode!=null)Gh(n,a,n.memoizedProps,y);else{if(typeof y!="string"&&a.stateNode===null)throw Error(I(166));if(h=mo(mr.current),mo(fi.current),Ue(a)){if(y=a.stateNode,h=a.memoizedProps,y[Fn]=a,(E=y.nodeValue!==h)&&(n=Q,n!==null))switch(n.tag){case 3:fl(y.nodeValue,h,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&fl(y.nodeValue,h,(n.mode&1)!==0)}E&&(a.flags|=4)}else y=(h.nodeType===9?h:h.ownerDocument).createTextNode(y),y[Fn]=a,a.stateNode=y}return Yn(a),null;case 13:if(oi(_i),y=a.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(ae&&te!==null&&(a.mode&1)!==0&&(a.flags&128)===0)tt(),lt(),a.flags|=98560,E=!1;else if(E=Ue(a),y!==null&&y.dehydrated!==null){if(n===null){if(!E)throw Error(I(318));if(E=a.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(I(317));E[Fn]=a}else lt(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Yn(a),E=!1}else ue!==null&&(Kh(ue),ue=null),E=!0;if(!E)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=h,a):(y=y!==null,y!==(n!==null&&n.memoizedState!==null)&&y&&(a.child.flags|=8192,(a.mode&1)!==0&&(n===null||(_i.current&1)!==0?sn===0&&(sn=3):mh())),a.updateQueue!==null&&(a.flags|=4),Yn(a),null);case 4:return ta(),yc(n,a),n===null&&Ha(a.stateNode.containerInfo),Yn(a),null;case 10:return ho(a.type._context),Yn(a),null;case 17:return mn(a.type)&&Ql(),Yn(a),null;case 19:if(oi(_i),E=a.memoizedState,E===null)return Yn(a),null;if(y=(a.flags&128)!==0,Z=E.rendering,Z===null)if(y)Ru(E,!1);else{if(sn!==0||n!==null&&(n.flags&128)!==0)for(n=a.child;n!==null;){if(Z=ra(n),Z!==null){for(a.flags|=128,Ru(E,!1),y=Z.updateQueue,y!==null&&(a.updateQueue=y,a.flags|=4),a.subtreeFlags=0,y=h,h=a.child;h!==null;)E=h,n=y,E.flags&=14680066,Z=E.alternate,Z===null?(E.childLanes=0,E.lanes=n,E.child=null,E.subtreeFlags=0,E.memoizedProps=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null,E.stateNode=null):(E.childLanes=Z.childLanes,E.lanes=Z.lanes,E.child=Z.child,E.subtreeFlags=0,E.deletions=null,E.memoizedProps=Z.memoizedProps,E.memoizedState=Z.memoizedState,E.updateQueue=Z.updateQueue,E.type=Z.type,n=Z.dependencies,E.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),h=h.sibling;return ui(_i,_i.current&1|2),a.child}n=n.sibling}E.tail!==null&&Xt()>vi&&(a.flags|=128,y=!0,Ru(E,!1),a.lanes=4194304)}else{if(!y)if(n=ra(Z),n!==null){if(a.flags|=128,y=!0,h=n.updateQueue,h!==null&&(a.updateQueue=h,a.flags|=4),Ru(E,!0),E.tail===null&&E.tailMode==="hidden"&&!Z.alternate&&!ae)return Yn(a),null}else 2*Xt()-E.renderingStartTime>vi&&h!==1073741824&&(a.flags|=128,y=!0,Ru(E,!1),a.lanes=4194304);E.isBackwards?(Z.sibling=a.child,a.child=Z):(h=E.last,h!==null?h.sibling=Z:a.child=Z,E.last=Z)}return E.tail!==null?(a=E.tail,E.rendering=a,E.tail=a.sibling,E.renderingStartTime=Xt(),a.sibling=null,h=_i.current,ui(_i,y?h&1|2:h&1),a):(Yn(a),null);case 22:case 23:return zc(),y=a.memoizedState!==null,n!==null&&n.memoizedState!==null!==y&&(a.flags|=8192),y&&(a.mode&1)!==0?(eo&1073741824)!==0&&(Yn(a),a.subtreeFlags&6&&(a.flags|=8192)):Yn(a),null;case 24:return null;case 25:return null}throw Error(I(156,a.tag))}function _p(n,a){switch(K(a),a.tag){case 1:return mn(a.type)&&Ql(),n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 3:return ta(),oi(Sr),oi(Jr),xl(),n=a.flags,(n&65536)!==0&&(n&128)===0?(a.flags=n&-65537|128,a):null;case 5:return oc(a),null;case 13:if(oi(_i),n=a.memoizedState,n!==null&&n.dehydrated!==null){if(a.alternate===null)throw Error(I(340));lt()}return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 19:return oi(_i),null;case 4:return ta(),null;case 10:return ho(a.type._context),null;case 22:case 23:return zc(),null;case 24:return null;default:return null}}var ah=!1,Qn=!1,zl=typeof WeakSet=="function"?WeakSet:Set,Ft=null;function ou(n,a){var h=n.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(y){Ei(n,a,y)}else h.current=null}function El(n,a,h){try{h()}catch(y){Ei(n,a,y)}}var Pd=!1;function vp(n,a){if(Xa=fa,n=xu(),ys(n)){if("selectionStart"in n)var h={start:n.selectionStart,end:n.selectionEnd};else e:{h=(h=n.ownerDocument)&&h.defaultView||window;var y=h.getSelection&&h.getSelection();if(y&&y.rangeCount!==0){h=y.anchorNode;var b=y.anchorOffset,E=y.focusNode;y=y.focusOffset;try{h.nodeType,E.nodeType}catch{h=null;break e}var Z=0,ce=-1,_e=-1,Be=0,Qe=0,nt=n,Ye=null;t:for(;;){for(var yt;nt!==h||b!==0&&nt.nodeType!==3||(ce=Z+b),nt!==E||y!==0&&nt.nodeType!==3||(_e=Z+y),nt.nodeType===3&&(Z+=nt.nodeValue.length),(yt=nt.firstChild)!==null;)Ye=nt,nt=yt;for(;;){if(nt===n)break t;if(Ye===h&&++Be===b&&(ce=Z),Ye===E&&++Qe===y&&(_e=Z),(yt=nt.nextSibling)!==null)break;nt=Ye,Ye=nt.parentNode}nt=yt}h=ce===-1||_e===-1?null:{start:ce,end:_e}}else h=null}h=h||{start:0,end:0}}else h=null;for(ec={focusedElem:n,selectionRange:h},fa=!1,Ft=a;Ft!==null;)if(a=Ft,n=a.child,(a.subtreeFlags&1028)!==0&&n!==null)n.return=a,Ft=n;else for(;Ft!==null;){a=Ft;try{var At=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(At!==null){var Ot=At.memoizedProps,Zi=At.memoizedState,Me=a.stateNode,we=Me.getSnapshotBeforeUpdate(a.elementType===a.type?Ot:Ta(a.type,Ot),Zi);Me.__reactInternalSnapshotBeforeUpdate=we}break;case 3:var Re=a.stateNode.containerInfo;Re.nodeType===1?Re.textContent="":Re.nodeType===9&&Re.documentElement&&Re.removeChild(Re.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(I(163))}}catch(ht){Ei(a,a.return,ht)}if(n=a.sibling,n!==null){n.return=a.return,Ft=n;break}Ft=a.return}return At=Pd,Pd=!1,At}function _c(n,a,h){var y=a.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var b=y=y.next;do{if((b.tag&n)===n){var E=b.destroy;b.destroy=void 0,E!==void 0&&El(a,h,E)}b=b.next}while(b!==y)}}function vc(n,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var h=a=a.next;do{if((h.tag&n)===n){var y=h.create;h.destroy=y()}h=h.next}while(h!==a)}}function sh(n){var a=n.ref;if(a!==null){var h=n.stateNode;n.tag,n=h,typeof a=="function"?a(n):a.current=n}}function Md(n){var a=n.alternate;a!==null&&(n.alternate=null,Md(a)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(a=n.stateNode,a!==null&&(delete a[Fn],delete a[ba],delete a[vr],delete a[rc],delete a[Ih])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Ad(n){return n.tag===5||n.tag===3||n.tag===4}function Dd(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Ad(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Hh(n,a,h){var y=n.tag;if(y===5||y===6)n=n.stateNode,a?h.nodeType===8?h.parentNode.insertBefore(n,a):h.insertBefore(n,a):(h.nodeType===8?(a=h.parentNode,a.insertBefore(n,h)):(a=h,a.appendChild(n)),h=h._reactRootContainer,h!=null||a.onclick!==null||(a.onclick=Xn));else if(y!==4&&(n=n.child,n!==null))for(Hh(n,a,h),n=n.sibling;n!==null;)Hh(n,a,h),n=n.sibling}function xc(n,a,h){var y=n.tag;if(y===5||y===6)n=n.stateNode,a?h.insertBefore(n,a):h.appendChild(n);else if(y!==4&&(n=n.child,n!==null))for(xc(n,a,h),n=n.sibling;n!==null;)xc(n,a,h),n=n.sibling}var Yi=null,aa=!1;function Cl(n,a,h){for(h=h.child;h!==null;)Ld(n,a,h),h=h.sibling}function Ld(n,a,h){if(rn&&typeof rn.onCommitFiberUnmount=="function")try{rn.onCommitFiberUnmount(Hi,h)}catch{}switch(h.tag){case 5:Qn||ou(h,a);case 6:var y=Yi,b=aa;Yi=null,Cl(n,a,h),Yi=y,aa=b,Yi!==null&&(aa?(n=Yi,h=h.stateNode,n.nodeType===8?n.parentNode.removeChild(h):n.removeChild(h)):Yi.removeChild(h.stateNode));break;case 18:Yi!==null&&(aa?(n=Yi,h=h.stateNode,n.nodeType===8?wt(n.parentNode,h):n.nodeType===1&&wt(n,h),qo(n)):wt(Yi,h.stateNode));break;case 4:y=Yi,b=aa,Yi=h.stateNode.containerInfo,aa=!0,Cl(n,a,h),Yi=y,aa=b;break;case 0:case 11:case 14:case 15:if(!Qn&&(y=h.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){b=y=y.next;do{var E=b,Z=E.destroy;E=E.tag,Z!==void 0&&((E&2)!==0||(E&4)!==0)&&El(h,a,Z),b=b.next}while(b!==y)}Cl(n,a,h);break;case 1:if(!Qn&&(ou(h,a),y=h.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=h.memoizedProps,y.state=h.memoizedState,y.componentWillUnmount()}catch(ce){Ei(h,a,ce)}Cl(n,a,h);break;case 21:Cl(n,a,h);break;case 22:h.mode&1?(Qn=(y=Qn)||h.memoizedState!==null,Cl(n,a,h),Qn=y):Cl(n,a,h);break;default:Cl(n,a,h)}}function Wh(n){var a=n.updateQueue;if(a!==null){n.updateQueue=null;var h=n.stateNode;h===null&&(h=n.stateNode=new zl),a.forEach(function(y){var b=Gd.bind(null,n,y);h.has(y)||(h.add(y),y.then(b,b))})}}function es(n,a){var h=a.deletions;if(h!==null)for(var y=0;y<h.length;y++){var b=h[y];try{var E=n,Z=a,ce=Z;e:for(;ce!==null;){switch(ce.tag){case 5:Yi=ce.stateNode,aa=!1;break e;case 3:Yi=ce.stateNode.containerInfo,aa=!0;break e;case 4:Yi=ce.stateNode.containerInfo,aa=!0;break e}ce=ce.return}if(Yi===null)throw Error(I(160));Ld(E,Z,b),Yi=null,aa=!1;var _e=b.alternate;_e!==null&&(_e.return=null),b.return=null}catch(Be){Ei(b,a,Be)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)Rd(a,n),a=a.sibling}function Rd(n,a){var h=n.alternate,y=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(es(a,n),Lo(n),y&4){try{_c(3,n,n.return),vc(3,n)}catch(Ot){Ei(n,n.return,Ot)}try{_c(5,n,n.return)}catch(Ot){Ei(n,n.return,Ot)}}break;case 1:es(a,n),Lo(n),y&512&&h!==null&&ou(h,h.return);break;case 5:if(es(a,n),Lo(n),y&512&&h!==null&&ou(h,h.return),n.flags&32){var b=n.stateNode;try{pi(b,"")}catch(Ot){Ei(n,n.return,Ot)}}if(y&4&&(b=n.stateNode,b!=null)){var E=n.memoizedProps,Z=h!==null?h.memoizedProps:E,ce=n.type,_e=n.updateQueue;if(n.updateQueue=null,_e!==null)try{ce==="input"&&E.type==="radio"&&E.name!=null&&Fe(b,E),Ni(ce,Z);var Be=Ni(ce,E);for(Z=0;Z<_e.length;Z+=2){var Qe=_e[Z],nt=_e[Z+1];Qe==="style"?sr(b,nt):Qe==="dangerouslySetInnerHTML"?ao(b,nt):Qe==="children"?pi(b,nt):St(b,Qe,nt,Be)}switch(ce){case"input":Si(b,E);break;case"textarea":Pa(b,E);break;case"select":var Ye=b._wrapperState.wasMultiple;b._wrapperState.wasMultiple=!!E.multiple;var yt=E.value;yt!=null?bo(b,!!E.multiple,yt,!1):Ye!==!!E.multiple&&(E.defaultValue!=null?bo(b,!!E.multiple,E.defaultValue,!0):bo(b,!!E.multiple,E.multiple?[]:"",!1))}b[ba]=E}catch(Ot){Ei(n,n.return,Ot)}}break;case 6:if(es(a,n),Lo(n),y&4){if(n.stateNode===null)throw Error(I(162));b=n.stateNode,E=n.memoizedProps;try{b.nodeValue=E}catch(Ot){Ei(n,n.return,Ot)}}break;case 3:if(es(a,n),Lo(n),y&4&&h!==null&&h.memoizedState.isDehydrated)try{qo(a.containerInfo)}catch(Ot){Ei(n,n.return,Ot)}break;case 4:es(a,n),Lo(n);break;case 13:es(a,n),Lo(n),b=n.child,b.flags&8192&&(E=b.memoizedState!==null,b.stateNode.isHidden=E,!E||b.alternate!==null&&b.alternate.memoizedState!==null||(su=Xt())),y&4&&Wh(n);break;case 22:if(Qe=h!==null&&h.memoizedState!==null,n.mode&1?(Qn=(Be=Qn)||Qe,es(a,n),Qn=Be):es(a,n),Lo(n),y&8192){if(Be=n.memoizedState!==null,(n.stateNode.isHidden=Be)&&!Qe&&(n.mode&1)!==0)for(Ft=n,Qe=n.child;Qe!==null;){for(nt=Ft=Qe;Ft!==null;){switch(Ye=Ft,yt=Ye.child,Ye.tag){case 0:case 11:case 14:case 15:_c(4,Ye,Ye.return);break;case 1:ou(Ye,Ye.return);var At=Ye.stateNode;if(typeof At.componentWillUnmount=="function"){y=Ye,h=Ye.return;try{a=y,At.props=a.memoizedProps,At.state=a.memoizedState,At.componentWillUnmount()}catch(Ot){Ei(y,h,Ot)}}break;case 5:ou(Ye,Ye.return);break;case 22:if(Ye.memoizedState!==null){Nd(nt);continue}}yt!==null?(yt.return=Ye,Ft=yt):Nd(nt)}Qe=Qe.sibling}e:for(Qe=null,nt=n;;){if(nt.tag===5){if(Qe===null){Qe=nt;try{b=nt.stateNode,Be?(E=b.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none"):(ce=nt.stateNode,_e=nt.memoizedProps.style,Z=_e!=null&&_e.hasOwnProperty("display")?_e.display:null,ce.style.display=at("display",Z))}catch(Ot){Ei(n,n.return,Ot)}}}else if(nt.tag===6){if(Qe===null)try{nt.stateNode.nodeValue=Be?"":nt.memoizedProps}catch(Ot){Ei(n,n.return,Ot)}}else if((nt.tag!==22&&nt.tag!==23||nt.memoizedState===null||nt===n)&&nt.child!==null){nt.child.return=nt,nt=nt.child;continue}if(nt===n)break e;for(;nt.sibling===null;){if(nt.return===null||nt.return===n)break e;Qe===nt&&(Qe=null),nt=nt.return}Qe===nt&&(Qe=null),nt.sibling.return=nt.return,nt=nt.sibling}}break;case 19:es(a,n),Lo(n),y&4&&Wh(n);break;case 21:break;default:es(a,n),Lo(n)}}function Lo(n){var a=n.flags;if(a&2){try{e:{for(var h=n.return;h!==null;){if(Ad(h)){var y=h;break e}h=h.return}throw Error(I(160))}switch(y.tag){case 5:var b=y.stateNode;y.flags&32&&(pi(b,""),y.flags&=-33);var E=Dd(n);xc(n,E,b);break;case 3:case 4:var Z=y.stateNode.containerInfo,ce=Dd(n);Hh(n,ce,Z);break;default:throw Error(I(161))}}catch(_e){Ei(n,n.return,_e)}n.flags&=-3}a&4096&&(n.flags&=-4097)}function Fd(n,a,h){Ft=n,Bd(n)}function Bd(n,a,h){for(var y=(n.mode&1)!==0;Ft!==null;){var b=Ft,E=b.child;if(b.tag===22&&y){var Z=b.memoizedState!==null||ah;if(!Z){var ce=b.alternate,_e=ce!==null&&ce.memoizedState!==null||Qn;ce=ah;var Be=Qn;if(ah=Z,(Qn=_e)&&!Be)for(Ft=b;Ft!==null;)Z=Ft,_e=Z.child,Z.tag===22&&Z.memoizedState!==null?jd(b):_e!==null?(_e.return=Z,Ft=_e):jd(b);for(;E!==null;)Ft=E,Bd(E),E=E.sibling;Ft=b,ah=ce,Qn=Be}Od(n)}else(b.subtreeFlags&8772)!==0&&E!==null?(E.return=b,Ft=E):Od(n)}}function Od(n){for(;Ft!==null;){var a=Ft;if((a.flags&8772)!==0){var h=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:Qn||vc(5,a);break;case 1:var y=a.stateNode;if(a.flags&4&&!Qn)if(h===null)y.componentDidMount();else{var b=a.elementType===a.type?h.memoizedProps:Ta(a.type,h.memoizedProps);y.componentDidUpdate(b,h.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var E=a.updateQueue;E!==null&&Do(a,E,y);break;case 3:var Z=a.updateQueue;if(Z!==null){if(h=null,a.child!==null)switch(a.child.tag){case 5:h=a.child.stateNode;break;case 1:h=a.child.stateNode}Do(a,Z,h)}break;case 5:var ce=a.stateNode;if(h===null&&a.flags&4){h=ce;var _e=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":_e.autoFocus&&h.focus();break;case"img":_e.src&&(h.src=_e.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var Be=a.alternate;if(Be!==null){var Qe=Be.memoizedState;if(Qe!==null){var nt=Qe.dehydrated;nt!==null&&qo(nt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(I(163))}Qn||a.flags&512&&sh(a)}catch(Ye){Ei(a,a.return,Ye)}}if(a===n){Ft=null;break}if(h=a.sibling,h!==null){h.return=a.return,Ft=h;break}Ft=a.return}}function Nd(n){for(;Ft!==null;){var a=Ft;if(a===n){Ft=null;break}var h=a.sibling;if(h!==null){h.return=a.return,Ft=h;break}Ft=a.return}}function jd(n){for(;Ft!==null;){var a=Ft;try{switch(a.tag){case 0:case 11:case 15:var h=a.return;try{vc(4,a)}catch(_e){Ei(a,h,_e)}break;case 1:var y=a.stateNode;if(typeof y.componentDidMount=="function"){var b=a.return;try{y.componentDidMount()}catch(_e){Ei(a,b,_e)}}var E=a.return;try{sh(a)}catch(_e){Ei(a,E,_e)}break;case 5:var Z=a.return;try{sh(a)}catch(_e){Ei(a,Z,_e)}}}catch(_e){Ei(a,a.return,_e)}if(a===n){Ft=null;break}var ce=a.sibling;if(ce!==null){ce.return=a.return,Ft=ce;break}Ft=a.return}}var xp=Math.ceil,lh=ar.ReactCurrentDispatcher,uh=ar.ReactCurrentOwner,Ro=ar.ReactCurrentBatchConfig,Ur=0,_n=null,Qi=null,Nn=0,eo=0,Fu=xs(0),sn=0,wc=null,au=0,ch=0,hh=0,bc=null,Fo=null,su=0,vi=1/0,Ts=null,Sc=!1,dh=null,Mr=null,Bu=!1,Gs=null,kc=0,sa=0,Il=null,Tc=-1,ph=0;function yo(){return(Ur&6)!==0?Xt():Tc!==-1?Tc:Tc=Xt()}function Pl(n){return(n.mode&1)===0?1:(Ur&2)!==0&&Nn!==0?Nn&-Nn:ut.transition!==null?(ph===0&&(ph=Un()),ph):(n=jr,n!==0||(n=window.event,n=n===void 0?16:ma(n.type)),n)}function ts(n,a,h,y){if(50<sa)throw sa=0,Il=null,Error(I(185));Ra(n,h,y),((Ur&2)===0||n!==_n)&&(n===_n&&((Ur&2)===0&&(ch|=h),sn===4&&rs(n,Nn)),Bo(n,y),h===1&&Ur===0&&(a.mode&1)===0&&(vi=Xt()+500,Nt&&f()))}function Bo(n,a){var h=n.callbackNode;La(n,a);var y=cn(n,n===_n?Nn:0);if(y===0)h!==null&&Pi(h),n.callbackNode=null,n.callbackPriority=0;else if(a=y&-y,n.callbackPriority!==a){if(h!=null&&Pi(h),a===1)n.tag===0?ic(lu.bind(null,n)):eu(lu.bind(null,n)),ml(function(){(Ur&6)===0&&f()}),h=null;else{switch(Ds(y)){case 1:h=hs;break;case 4:h=wn;break;case 16:h=tn;break;case 536870912:h=Dn;break;default:h=tn}h=Qh(h,Vd.bind(null,n))}n.callbackPriority=a,n.callbackNode=h}}function Vd(n,a){if(Tc=-1,ph=0,(Ur&6)!==0)throw Error(I(327));var h=n.callbackNode;if(ns()&&n.callbackNode!==h)return null;var y=cn(n,n===_n?Nn:0);if(y===0)return null;if((y&30)!==0||(y&n.expiredLanes)!==0||a)a=Ec(n,y);else{a=y;var b=Ur;Ur|=2;var E=$d();(_n!==n||Nn!==a)&&(Ts=null,vi=Xt()+500,uu(n,a));do try{Jh();break}catch(ce){Ud(n,ce)}while(!0);on(),lh.current=E,Ur=b,Qi!==null?a=0:(_n=null,Nn=0,a=sn)}if(a!==0){if(a===2&&(b=Ln(n),b!==0&&(y=b,a=Xh(n,b))),a===1)throw h=wc,uu(n,0),rs(n,y),Bo(n,Xt()),h;if(a===6)rs(n,y);else{if(b=n.current.alternate,(y&30)===0&&!wp(b)&&(a=Ec(n,y),a===2&&(E=Ln(n),E!==0&&(y=E,a=Xh(n,E))),a===1))throw h=wc,uu(n,0),rs(n,y),Bo(n,Xt()),h;switch(n.finishedWork=b,n.finishedLanes=y,a){case 0:case 1:throw Error(I(345));case 2:is(n,Fo,Ts);break;case 3:if(rs(n,y),(y&130023424)===y&&(a=su+500-Xt(),10<a)){if(cn(n,0)!==0)break;if(b=n.suspendedLanes,(b&y)!==y){yo(),n.pingedLanes|=n.suspendedLanes&b;break}n.timeoutHandle=Tu(is.bind(null,n,Fo,Ts),a);break}is(n,Fo,Ts);break;case 4:if(rs(n,y),(y&4194240)===y)break;for(a=n.eventTimes,b=-1;0<y;){var Z=31-Vr(y);E=1<<Z,Z=a[Z],Z>b&&(b=Z),y&=~E}if(y=b,y=Xt()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*xp(y/1960))-y,10<y){n.timeoutHandle=Tu(is.bind(null,n,Fo,Ts),y);break}is(n,Fo,Ts);break;case 5:is(n,Fo,Ts);break;default:throw Error(I(329))}}}return Bo(n,Xt()),n.callbackNode===h?Vd.bind(null,n):null}function Xh(n,a){var h=bc;return n.current.memoizedState.isDehydrated&&(uu(n,a).flags|=256),n=Ec(n,a),n!==2&&(a=Fo,Fo=h,a!==null&&Kh(a)),n}function Kh(n){Fo===null?Fo=n:Fo.push.apply(Fo,n)}function wp(n){for(var a=n;;){if(a.flags&16384){var h=a.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var y=0;y<h.length;y++){var b=h[y],E=b.getSnapshot;b=b.value;try{if(!Hn(E(),b))return!1}catch{return!1}}}if(h=a.child,a.subtreeFlags&16384&&h!==null)h.return=a,a=h;else{if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function rs(n,a){for(a&=~hh,a&=~ch,n.suspendedLanes|=a,n.pingedLanes&=~a,n=n.expirationTimes;0<a;){var h=31-Vr(a),y=1<<h;n[h]=-1,a&=~y}}function lu(n){if((Ur&6)!==0)throw Error(I(327));ns();var a=cn(n,0);if((a&1)===0)return Bo(n,Xt()),null;var h=Ec(n,a);if(n.tag!==0&&h===2){var y=Ln(n);y!==0&&(a=y,h=Xh(n,y))}if(h===1)throw h=wc,uu(n,0),rs(n,a),Bo(n,Xt()),h;if(h===6)throw Error(I(345));return n.finishedWork=n.current.alternate,n.finishedLanes=a,is(n,Fo,Ts),Bo(n,Xt()),null}function fh(n,a){var h=Ur;Ur|=1;try{return n(a)}finally{Ur=h,Ur===0&&(vi=Xt()+500,Nt&&f())}}function Hs(n){Gs!==null&&Gs.tag===0&&(Ur&6)===0&&ns();var a=Ur;Ur|=1;var h=Ro.transition,y=jr;try{if(Ro.transition=null,jr=1,n)return n()}finally{jr=y,Ro.transition=h,Ur=a,(Ur&6)===0&&f()}}function zc(){eo=Fu.current,oi(Fu)}function uu(n,a){n.finishedWork=null,n.finishedLanes=0;var h=n.timeoutHandle;if(h!==-1&&(n.timeoutHandle=-1,$c(h)),Qi!==null)for(h=Qi.return;h!==null;){var y=h;switch(K(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&Ql();break;case 3:ta(),oi(Sr),oi(Jr),xl();break;case 5:oc(y);break;case 4:ta();break;case 13:oi(_i);break;case 19:oi(_i);break;case 10:ho(y.type._context);break;case 22:case 23:zc()}h=h.return}if(_n=n,Qi=n=Ml(n.current,null),Nn=eo=a,sn=0,wc=null,hh=ch=au=0,Fo=bc=null,Ci!==null){for(a=0;a<Ci.length;a++)if(h=Ci[a],y=h.interleaved,y!==null){h.interleaved=null;var b=y.next,E=h.pending;if(E!==null){var Z=E.next;E.next=b,y.next=Z}h.pending=y}Ci=null}return n}function Ud(n,a){do{var h=Qi;try{if(on(),ks.current=Xc,ac){for(var y=ei.memoizedState;y!==null;){var b=y.queue;b!==null&&(b.pending=null),y=y.next}ac=!1}if(ka=0,Ki=zi=ei=null,Iu=!1,sc=0,uh.current=null,h===null||h.return===null){sn=1,wc=a,Qi=null;break}e:{var E=n,Z=h.return,ce=h,_e=a;if(a=Nn,ce.flags|=32768,_e!==null&&typeof _e=="object"&&typeof _e.then=="function"){var Be=_e,Qe=ce,nt=Qe.tag;if((Qe.mode&1)===0&&(nt===0||nt===11||nt===15)){var Ye=Qe.alternate;Ye?(Qe.updateQueue=Ye.updateQueue,Qe.memoizedState=Ye.memoizedState,Qe.lanes=Ye.lanes):(Qe.updateQueue=null,Qe.memoizedState=null)}var yt=wd(Z);if(yt!==null){yt.flags&=-257,bd(yt,Z,ce,E,a),yt.mode&1&&xd(E,Be,a),a=yt,_e=Be;var At=a.updateQueue;if(At===null){var Ot=new Set;Ot.add(_e),a.updateQueue=Ot}else At.add(_e);break e}else{if((a&1)===0){xd(E,Be,a),mh();break e}_e=Error(I(426))}}else if(ae&&ce.mode&1){var Zi=wd(Z);if(Zi!==null){(Zi.flags&65536)===0&&(Zi.flags|=256),bd(Zi,Z,ce,E,a),gt(zn(_e,ce));break e}}E=_e=zn(_e,ce),sn!==4&&(sn=2),bc===null?bc=[E]:bc.push(E),E=Z;do{switch(E.tag){case 3:E.flags|=65536,a&=-a,E.lanes|=a;var Me=jh(E,_e,a);fo(E,Me);break e;case 1:ce=_e;var we=E.type,Re=E.stateNode;if((E.flags&128)===0&&(typeof we.getDerivedStateFromError=="function"||Re!==null&&typeof Re.componentDidCatch=="function"&&(Mr===null||!Mr.has(Re)))){E.flags|=65536,a&=-a,E.lanes|=a;var ht=vd(E,ce,a);fo(E,ht);break e}}E=E.return}while(E!==null)}Ws(h)}catch(jt){a=jt,Qi===h&&h!==null&&(Qi=h=h.return);continue}break}while(!0)}function $d(){var n=lh.current;return lh.current=Xc,n===null?Xc:n}function mh(){(sn===0||sn===3||sn===2)&&(sn=4),_n===null||(au&268435455)===0&&(ch&268435455)===0||rs(_n,Nn)}function Ec(n,a){var h=Ur;Ur|=2;var y=$d();(_n!==n||Nn!==a)&&(Ts=null,uu(n,a));do try{_o();break}catch(b){Ud(n,b)}while(!0);if(on(),Ur=h,lh.current=y,Qi!==null)throw Error(I(261));return _n=null,Nn=0,sn}function _o(){for(;Qi!==null;)Yh(Qi)}function Jh(){for(;Qi!==null&&!ji();)Yh(Qi)}function Yh(n){var a=Hd(n.alternate,n,eo);n.memoizedProps=n.pendingProps,a===null?Ws(n):Qi=a,uh.current=null}function Ws(n){var a=n;do{var h=a.alternate;if(n=a.return,(a.flags&32768)===0){if(h=yp(h,a,eo),h!==null){Qi=h;return}}else{if(h=_p(h,a),h!==null){h.flags&=32767,Qi=h;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{sn=6,Qi=null;return}}if(a=a.sibling,a!==null){Qi=a;return}Qi=a=n}while(a!==null);sn===0&&(sn=5)}function is(n,a,h){var y=jr,b=Ro.transition;try{Ro.transition=null,jr=1,Cc(n,a,h,y)}finally{Ro.transition=b,jr=y}return null}function Cc(n,a,h,y){do ns();while(Gs!==null);if((Ur&6)!==0)throw Error(I(327));h=n.finishedWork;var b=n.finishedLanes;if(h===null)return null;if(n.finishedWork=null,n.finishedLanes=0,h===n.current)throw Error(I(177));n.callbackNode=null,n.callbackPriority=0;var E=h.lanes|h.childLanes;if(ca(n,E),n===_n&&(Qi=_n=null,Nn=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||Bu||(Bu=!0,Qh(tn,function(){return ns(),null})),E=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||E){E=Ro.transition,Ro.transition=null;var Z=jr;jr=1;var ce=Ur;Ur|=4,uh.current=null,vp(n,h),Rd(h,n),Zl(ec),fa=!!Xa,ec=Xa=null,n.current=h,Fd(h),Aa(),Ur=ce,jr=Z,Ro.transition=E}else n.current=h;if(Bu&&(Bu=!1,Gs=n,kc=b),E=n.pendingLanes,E===0&&(Mr=null),$o(h.stateNode),Bo(n,Xt()),a!==null)for(y=n.onRecoverableError,h=0;h<a.length;h++)b=a[h],y(b.value,{componentStack:b.stack,digest:b.digest});if(Sc)throw Sc=!1,n=dh,dh=null,n;return(kc&1)!==0&&n.tag!==0&&ns(),E=n.pendingLanes,(E&1)!==0?n===Il?sa++:(sa=0,Il=n):sa=0,f(),null}function ns(){if(Gs!==null){var n=Ds(kc),a=Ro.transition,h=jr;try{if(Ro.transition=null,jr=16>n?16:n,Gs===null)var y=!1;else{if(n=Gs,Gs=null,kc=0,(Ur&6)!==0)throw Error(I(331));var b=Ur;for(Ur|=4,Ft=n.current;Ft!==null;){var E=Ft,Z=E.child;if((Ft.flags&16)!==0){var ce=E.deletions;if(ce!==null){for(var _e=0;_e<ce.length;_e++){var Be=ce[_e];for(Ft=Be;Ft!==null;){var Qe=Ft;switch(Qe.tag){case 0:case 11:case 15:_c(8,Qe,E)}var nt=Qe.child;if(nt!==null)nt.return=Qe,Ft=nt;else for(;Ft!==null;){Qe=Ft;var Ye=Qe.sibling,yt=Qe.return;if(Md(Qe),Qe===Be){Ft=null;break}if(Ye!==null){Ye.return=yt,Ft=Ye;break}Ft=yt}}}var At=E.alternate;if(At!==null){var Ot=At.child;if(Ot!==null){At.child=null;do{var Zi=Ot.sibling;Ot.sibling=null,Ot=Zi}while(Ot!==null)}}Ft=E}}if((E.subtreeFlags&2064)!==0&&Z!==null)Z.return=E,Ft=Z;else e:for(;Ft!==null;){if(E=Ft,(E.flags&2048)!==0)switch(E.tag){case 0:case 11:case 15:_c(9,E,E.return)}var Me=E.sibling;if(Me!==null){Me.return=E.return,Ft=Me;break e}Ft=E.return}}var we=n.current;for(Ft=we;Ft!==null;){Z=Ft;var Re=Z.child;if((Z.subtreeFlags&2064)!==0&&Re!==null)Re.return=Z,Ft=Re;else e:for(Z=we;Ft!==null;){if(ce=Ft,(ce.flags&2048)!==0)try{switch(ce.tag){case 0:case 11:case 15:vc(9,ce)}}catch(jt){Ei(ce,ce.return,jt)}if(ce===Z){Ft=null;break e}var ht=ce.sibling;if(ht!==null){ht.return=ce.return,Ft=ht;break e}Ft=ce.return}}if(Ur=b,f(),rn&&typeof rn.onPostCommitFiberRoot=="function")try{rn.onPostCommitFiberRoot(Hi,n)}catch{}y=!0}return y}finally{jr=h,Ro.transition=a}}return!1}function Ic(n,a,h){a=zn(h,a),a=jh(n,a,1),n=Sa(n,a,1),a=yo(),n!==null&&(Ra(n,1,a),Bo(n,a))}function Ei(n,a,h){if(n.tag===3)Ic(n,n,h);else for(;a!==null;){if(a.tag===3){Ic(a,n,h);break}else if(a.tag===1){var y=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(Mr===null||!Mr.has(y))){n=zn(h,n),n=vd(a,n,1),a=Sa(a,n,1),n=yo(),a!==null&&(Ra(a,1,n),Bo(a,n));break}}a=a.return}}function bp(n,a,h){var y=n.pingCache;y!==null&&y.delete(a),a=yo(),n.pingedLanes|=n.suspendedLanes&h,_n===n&&(Nn&h)===h&&(sn===4||sn===3&&(Nn&130023424)===Nn&&500>Xt()-su?uu(n,0):hh|=h),Bo(n,a)}function Zd(n,a){a===0&&((n.mode&1)===0?a=1:(a=un,un<<=1,(un&130023424)===0&&(un=4194304)));var h=yo();n=Kn(n,a),n!==null&&(Ra(n,a,h),Bo(n,h))}function qd(n){var a=n.memoizedState,h=0;a!==null&&(h=a.retryLane),Zd(n,h)}function Gd(n,a){var h=0;switch(n.tag){case 13:var y=n.stateNode,b=n.memoizedState;b!==null&&(h=b.retryLane);break;case 19:y=n.stateNode;break;default:throw Error(I(314))}y!==null&&y.delete(a),Zd(n,h)}var Hd;Hd=function(n,a,h){if(n!==null)if(n.memoizedProps!==a.pendingProps||Sr.current)go=!0;else{if((n.lanes&h)===0&&(a.flags&128)===0)return go=!1,qh(n,a,h);go=(n.flags&131072)!==0}else go=!1,ae&&(a.flags&1048576)!==0&&B(a,u,a.index);switch(a.lanes=0,a.tag){case 2:var y=a.type;gc(n,a),n=a.pendingProps;var b=Ja(a,Jr.current);Xi(a,h),b=Ya(null,a,y,n,b,h);var E=ia();return a.flags|=1,typeof b=="object"&&b!==null&&typeof b.render=="function"&&b.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,mn(y)?(E=!0,co(a)):E=!1,a.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,bs(a),b.updater=Yc,a.stateNode=b,b._reactInternals=a,iu(a,y,n,h),a=Uh(null,a,y,!0,E,h)):(a.tag=0,ae&&E&&$(a),Ji(null,a,b,h),a=a.child),a;case 16:y=a.elementType;e:{switch(gc(n,a),n=a.pendingProps,b=y._init,y=b(y._payload),a.type=y,b=a.tag=Sp(y),n=Ta(y,n),b){case 0:a=Vh(null,a,y,n,h);break e;case 1:a=Cd(null,a,y,n,h);break e;case 11:a=Du(null,a,y,n,h);break e;case 14:a=kd(null,a,y,Ta(y.type,n),h);break e}throw Error(I(306,y,""))}return a;case 0:return y=a.type,b=a.pendingProps,b=a.elementType===y?b:Ta(y,b),Vh(n,a,y,b,h);case 1:return y=a.type,b=a.pendingProps,b=a.elementType===y?b:Ta(y,b),Cd(n,a,y,b,h);case 3:e:{if(rh(a),n===null)throw Error(I(387));y=a.pendingProps,E=a.memoizedState,b=E.element,po(n,a),ea(a,y,null,h);var Z=a.memoizedState;if(y=Z.element,E.isDehydrated)if(E={element:y,isDehydrated:!1,cache:Z.cache,pendingSuspenseBoundaries:Z.pendingSuspenseBoundaries,transitions:Z.transitions},a.updateQueue.baseState=E,a.memoizedState=E,a.flags&256){b=zn(Error(I(423)),a),a=Id(n,a,y,h,b);break e}else if(y!==b){b=zn(Error(I(424)),a),a=Id(n,a,y,h,b);break e}else for(te=Xo(a.stateNode.containerInfo.firstChild),Q=a,ae=!0,ue=null,h=Wt(a,null,y,h),a.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(lt(),y===b){a=oa(n,a,h);break e}Ji(n,a,y,h)}a=a.child}return a;case 5:return nc(a),n===null&&be(a),y=a.type,b=a.pendingProps,E=n!==null?n.memoizedProps:null,Z=b.children,tc(y,b)?Z=null:E!==null&&tc(y,E)&&(a.flags|=32),Ed(n,a),Ji(n,a,Z,h),a.child;case 6:return n===null&&be(a),null;case 13:return Ii(n,a,h);case 4:return Ss(a,a.stateNode.containerInfo),y=a.pendingProps,n===null?a.child=dt(a,null,y,h):Ji(n,a,y,h),a.child;case 11:return y=a.type,b=a.pendingProps,b=a.elementType===y?b:Ta(y,b),Du(n,a,y,b,h);case 7:return Ji(n,a,a.pendingProps,h),a.child;case 8:return Ji(n,a,a.pendingProps.children,h),a.child;case 12:return Ji(n,a,a.pendingProps.children,h),a.child;case 10:e:{if(y=a.type._context,b=a.pendingProps,E=a.memoizedProps,Z=b.value,ui(Gr,y._currentValue),y._currentValue=Z,E!==null)if(Hn(E.value,Z)){if(E.children===b.children&&!Sr.current){a=oa(n,a,h);break e}}else for(E=a.child,E!==null&&(E.return=a);E!==null;){var ce=E.dependencies;if(ce!==null){Z=E.child;for(var _e=ce.firstContext;_e!==null;){if(_e.context===y){if(E.tag===1){_e=Ao(-1,h&-h),_e.tag=2;var Be=E.updateQueue;if(Be!==null){Be=Be.shared;var Qe=Be.pending;Qe===null?_e.next=_e:(_e.next=Qe.next,Qe.next=_e),Be.pending=_e}}E.lanes|=h,_e=E.alternate,_e!==null&&(_e.lanes|=h),Qr(E.return,h,a),ce.lanes|=h;break}_e=_e.next}}else if(E.tag===10)Z=E.type===a.type?null:E.child;else if(E.tag===18){if(Z=E.return,Z===null)throw Error(I(341));Z.lanes|=h,ce=Z.alternate,ce!==null&&(ce.lanes|=h),Qr(Z,h,a),Z=E.sibling}else Z=E.child;if(Z!==null)Z.return=E;else for(Z=E;Z!==null;){if(Z===a){Z=null;break}if(E=Z.sibling,E!==null){E.return=Z.return,Z=E;break}Z=Z.return}E=Z}Ji(n,a,b.children,h),a=a.child}return a;case 9:return b=a.type,y=a.pendingProps.children,Xi(a,h),b=ci(b),y=y(b),a.flags|=1,Ji(n,a,y,h),a.child;case 14:return y=a.type,b=Ta(y,a.pendingProps),b=Ta(y.type,b),kd(n,a,y,b,h);case 15:return Td(n,a,a.type,a.pendingProps,h);case 17:return y=a.type,b=a.pendingProps,b=a.elementType===y?b:Ta(y,b),gc(n,a),a.tag=1,mn(y)?(n=!0,co(a)):n=!1,Xi(a,h),Nh(a,y,b),iu(a,y,b,h),Uh(null,a,y,!0,n,h);case 19:return Zh(n,a,h);case 22:return zd(n,a,h)}throw Error(I(156,a.tag))};function Qh(n,a){return yi(n,a)}function Wd(n,a,h,y){this.tag=n,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Oo(n,a,h,y){return new Wd(n,a,h,y)}function Pc(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Sp(n){if(typeof n=="function")return Pc(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Hr)return 11;if(n===ti)return 14}return 2}function Ml(n,a){var h=n.alternate;return h===null?(h=Oo(n.tag,a,n.key,n.mode),h.elementType=n.elementType,h.type=n.type,h.stateNode=n.stateNode,h.alternate=n,n.alternate=h):(h.pendingProps=a,h.type=n.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=n.flags&14680064,h.childLanes=n.childLanes,h.lanes=n.lanes,h.child=n.child,h.memoizedProps=n.memoizedProps,h.memoizedState=n.memoizedState,h.updateQueue=n.updateQueue,a=n.dependencies,h.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},h.sibling=n.sibling,h.index=n.index,h.ref=n.ref,h}function Mc(n,a,h,y,b,E){var Z=2;if(y=n,typeof n=="function")Pc(n)&&(Z=1);else if(typeof n=="string")Z=5;else e:switch(n){case Vt:return Al(h.children,b,E,a);case zr:Z=8,b|=8;break;case xr:return n=Oo(12,h,a,b|2),n.elementType=xr,n.lanes=E,n;case kr:return n=Oo(13,h,a,b),n.elementType=kr,n.lanes=E,n;case _r:return n=Oo(19,h,a,b),n.elementType=_r,n.lanes=E,n;case wr:return Dl(h,b,E,a);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Br:Z=10;break e;case Et:Z=9;break e;case Hr:Z=11;break e;case ti:Z=14;break e;case Wr:Z=16,y=null;break e}throw Error(I(130,n==null?n:typeof n,""))}return a=Oo(Z,h,a,b),a.elementType=n,a.type=y,a.lanes=E,a}function Al(n,a,h,y){return n=Oo(7,n,y,a),n.lanes=h,n}function Dl(n,a,h,y){return n=Oo(22,n,y,a),n.elementType=wr,n.lanes=h,n.stateNode={isHidden:!1},n}function za(n,a,h){return n=Oo(6,n,null,a),n.lanes=h,n}function zs(n,a,h){return a=Oo(4,n.children!==null?n.children:[],n.key,a),a.lanes=h,a.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},a}function Xd(n,a,h,y,b){this.tag=a,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Cr(0),this.expirationTimes=Cr(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cr(0),this.identifierPrefix=y,this.onRecoverableError=b,this.mutableSourceEagerHydrationData=null}function Ac(n,a,h,y,b,E,Z,ce,_e){return n=new Xd(n,a,h,ce,_e),a===1?(a=1,E===!0&&(a|=8)):a=0,E=Oo(3,null,null,a),n.current=E,E.stateNode=n,E.memoizedState={element:y,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},bs(E),n}function kp(n,a,h){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:gr,key:y==null?null:""+y,children:n,containerInfo:a,implementation:h}}function Kd(n){if(!n)return ws;n=n._reactInternals;e:{if(ir(n)!==n||n.tag!==1)throw Error(I(170));var a=n;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(mn(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(I(171))}if(n.tag===1){var h=n.type;if(mn(h))return yl(n,h,a)}return a}function Dc(n,a,h,y,b,E,Z,ce,_e){return n=Ac(h,y,!0,n,b,E,Z,ce,_e),n.context=Kd(null),h=n.current,y=yo(),b=Pl(h),E=Ao(y,b),E.callback=a??null,Sa(h,E,b),n.current.lanes=b,Ra(n,b,y),Bo(n,y),n}function Ou(n,a,h,y){var b=a.current,E=yo(),Z=Pl(b);return h=Kd(h),a.context===null?a.context=h:a.pendingContext=h,a=Ao(E,Z),a.payload={element:n},y=y===void 0?null:y,y!==null&&(a.callback=y),n=Sa(b,a,Z),n!==null&&(ts(n,b,Z,E),Bn(n,b,Z)),Z}function gh(n){return n=n.current,n.child?(n.child.tag===5,n.child.stateNode):null}function yh(n,a){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var h=n.retryLane;n.retryLane=h!==0&&h<a?h:a}}function Lc(n,a){yh(n,a),(n=n.alternate)&&yh(n,a)}function Nu(){return null}var ed=typeof reportError=="function"?reportError:function(n){console.error(n)};function _h(n){this._internalRoot=n}ju.prototype.render=_h.prototype.render=function(n){var a=this._internalRoot;if(a===null)throw Error(I(409));Ou(n,a,null,null)},ju.prototype.unmount=_h.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var a=n.containerInfo;Hs(function(){Ou(null,n,null,null)}),a[Ko]=null}};function ju(n){this._internalRoot=n}ju.prototype.unstable_scheduleHydration=function(n){if(n){var a=Nl();n={blockedOn:null,target:n,priority:a};for(var h=0;h<nn.length&&a!==0&&a<nn[h].priority;h++);nn.splice(h,0,n),h===0&&Ls(n)}};function vh(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function cu(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function td(){}function Tp(n,a,h,y,b){if(b){if(typeof y=="function"){var E=y;y=function(){var Be=gh(Z);E.call(Be)}}var Z=Dc(a,y,n,0,null,!1,!1,"",td);return n._reactRootContainer=Z,n[Ko]=Z.current,Ha(n.nodeType===8?n.parentNode:n),Hs(),Z}for(;b=n.lastChild;)n.removeChild(b);if(typeof y=="function"){var ce=y;y=function(){var Be=gh(_e);ce.call(Be)}}var _e=Ac(n,0,!1,null,null,!1,!1,"",td);return n._reactRootContainer=_e,n[Ko]=_e.current,Ha(n.nodeType===8?n.parentNode:n),Hs(function(){Ou(a,_e,h,y)}),_e}function xh(n,a,h,y,b){var E=h._reactRootContainer;if(E){var Z=E;if(typeof b=="function"){var ce=b;b=function(){var _e=gh(Z);ce.call(_e)}}Ou(a,Z,n,b)}else Z=Tp(h,a,n,b,y);return gh(Z)}Fa=function(n){switch(n.tag){case 3:var a=n.stateNode;if(a.current.memoizedState.isDehydrated){var h=Da(a.pendingLanes);h!==0&&(ha(a,h|1),Bo(a,Xt()),(Ur&6)===0&&(vi=Xt()+500,f()))}break;case 13:Hs(function(){var y=Kn(n,1);if(y!==null){var b=yo();ts(y,n,1,b)}}),Lc(n,1)}},ds=function(n){if(n.tag===13){var a=Kn(n,134217728);if(a!==null){var h=yo();ts(a,n,134217728,h)}Lc(n,134217728)}},Ba=function(n){if(n.tag===13){var a=Pl(n),h=Kn(n,a);if(h!==null){var y=yo();ts(h,n,a,y)}Lc(n,a)}},Nl=function(){return jr},gu=function(n,a){var h=jr;try{return jr=n,a()}finally{jr=h}},so=function(n,a,h){switch(a){case"input":if(Si(n,h),a=h.name,h.type==="radio"&&a!=null){for(h=n;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<h.length;a++){var y=h[a];if(y!==n&&y.form===n.form){var b=Jl(y);if(!b)throw Error(I(90));di(y),Si(y,b)}}}break;case"textarea":Pa(n,h);break;case"select":a=h.value,a!=null&&bo(n,!!h.multiple,a,!1)}},X=fh,oe=Hs;var Jd={usingClientEntryPoint:!1,Events:[Kl,Jo,Jl,j,V,fh]},Rc={findFiberByHostInstance:Ka,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zp={bundleType:Rc.bundleType,version:Rc.version,rendererPackageName:Rc.rendererPackageName,rendererConfig:Rc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ar.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Or(n),n===null?null:n.stateNode},findFiberByHostInstance:Rc.findFiberByHostInstance||Nu,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wh.isDisabled&&wh.supportsFiber)try{Hi=wh.inject(zp),rn=wh}catch{}}return Ca.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Jd,Ca.createPortal=function(n,a){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vh(a))throw Error(I(200));return kp(n,a,null,h)},Ca.createRoot=function(n,a){if(!vh(n))throw Error(I(299));var h=!1,y="",b=ed;return a!=null&&(a.unstable_strictMode===!0&&(h=!0),a.identifierPrefix!==void 0&&(y=a.identifierPrefix),a.onRecoverableError!==void 0&&(b=a.onRecoverableError)),a=Ac(n,1,!1,null,null,h,!1,y,b),n[Ko]=a.current,Ha(n.nodeType===8?n.parentNode:n),new _h(a)},Ca.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var a=n._reactInternals;if(a===void 0)throw typeof n.render=="function"?Error(I(188)):(n=Object.keys(n).join(","),Error(I(268,n)));return n=Or(a),n=n===null?null:n.stateNode,n},Ca.flushSync=function(n){return Hs(n)},Ca.hydrate=function(n,a,h){if(!cu(a))throw Error(I(200));return xh(null,n,a,!0,h)},Ca.hydrateRoot=function(n,a,h){if(!vh(n))throw Error(I(405));var y=h!=null&&h.hydratedSources||null,b=!1,E="",Z=ed;if(h!=null&&(h.unstable_strictMode===!0&&(b=!0),h.identifierPrefix!==void 0&&(E=h.identifierPrefix),h.onRecoverableError!==void 0&&(Z=h.onRecoverableError)),a=Dc(a,null,n,1,h??null,b,!1,E,Z),n[Ko]=a.current,Ha(n),y)for(n=0;n<y.length;n++)h=y[n],b=h._getVersion,b=b(h._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[h,b]:a.mutableSourceEagerHydrationData.push(h,b);return new ju(a)},Ca.render=function(n,a,h){if(!cu(a))throw Error(I(200));return xh(null,n,a,!1,h)},Ca.unmountComponentAtNode=function(n){if(!cu(n))throw Error(I(40));return n._reactRootContainer?(Hs(function(){xh(null,null,n,!1,function(){n._reactRootContainer=null,n[Ko]=null})}),!0):!1},Ca.unstable_batchedUpdates=fh,Ca.unstable_renderSubtreeIntoContainer=function(n,a,h,y){if(!cu(h))throw Error(I(200));if(n==null||n._reactInternals===void 0)throw Error(I(38));return xh(n,a,h,!1,y)},Ca.version="18.3.1-next-f1338f8080-20240426",Ca}var $f;function Fy(){if($f)return Zp.exports;$f=1;function T(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(T)}catch(D){console.error(D)}}return T(),Zp.exports=Ry(),Zp.exports}var op={},Zf;function By(){if(Zf)return op;Zf=1;var T=Fy();return op.createRoot=T.createRoot,op.hydrateRoot=T.hydrateRoot,op}var Oy=By();const Ny=tf(Oy);var up={exports:{}};var jy=up.exports,qf;function Vy(){return qf||(qf=1,(function(T,D){(function(I,H){T.exports=H()})(jy,(function(){var I={},H={};function W(A,d,Se){if(H[A]=Se,A==="index"){var Pe="var sharedModule = {}; ("+H.shared+")(sharedModule); ("+H.worker+")(sharedModule);",Le={};return H.shared(Le),H.index(I,Le),typeof window<"u"&&I.setWorkerUrl(window.URL.createObjectURL(new Blob([Pe],{type:"text/javascript"}))),I}}W("shared",["exports"],(function(A){function d(r,t,i,s){return new(i||(i=Promise))((function(c,m){function g(k){try{x(s.next(k))}catch(P){m(P)}}function _(k){try{x(s.throw(k))}catch(P){m(P)}}function x(k){var P;k.done?c(k.value):(P=k.value,P instanceof i?P:new i((function(R){R(P)}))).then(g,_)}x((s=s.apply(r,t||[])).next())}))}function Se(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}typeof SuppressedError=="function"&&SuppressedError;var Pe=Le;function Le(r,t){this.x=r,this.y=t}Le.prototype={clone:function(){return new Le(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,t){return this.clone()._rotateAround(r,t)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var t=r.x-this.x,i=r.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,t){return Math.atan2(this.x*t-this.y*r,this.x*r+this.y*t)},_matMult:function(r){var t=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=t,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var t=Math.cos(r),i=Math.sin(r),s=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=s,this},_rotateAround:function(r,t){var i=Math.cos(r),s=Math.sin(r),c=t.y+s*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-s*(this.y-t.y),this.y=c,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Le.convert=function(r){return r instanceof Le?r:Array.isArray(r)?new Le(r[0],r[1]):r};var re=Se(Pe),ne=Ge;function Ge(r,t,i,s){this.cx=3*r,this.bx=3*(i-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(s-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=t,this.p2x=i,this.p2y=s}Ge.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,t){if(t===void 0&&(t=1e-6),r<0)return 0;if(r>1)return 1;for(var i=r,s=0;s<8;s++){var c=this.sampleCurveX(i)-r;if(Math.abs(c)<t)return i;var m=this.sampleCurveDerivativeX(i);if(Math.abs(m)<1e-6)break;i-=c/m}var g=0,_=1;for(i=r,s=0;s<20&&(c=this.sampleCurveX(i),!(Math.abs(c-r)<t));s++)r>c?g=i:_=i,i=.5*(_-g)+g;return i},solve:function(r,t){return this.sampleCurveY(this.solveCurveX(r,t))}};var et=Se(ne);let je,Xe;function Pt(){return je==null&&(je=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),je}function mt(){if(Xe==null&&(Xe=!1,Pt())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let s=0;s<25;s++){const c=4*s;t.fillStyle=`rgb(${c},${c+1},${c+2})`,t.fillRect(s%5,Math.floor(s/5),1,1)}const i=t.getImageData(0,0,5,5).data;for(let s=0;s<100;s++)if(s%4!=3&&i[s]!==s){Xe=!0;break}}}return Xe||!1}function St(r,t,i,s){const c=new et(r,t,i,s);return m=>c.solve(m)}const ar=St(.25,.1,.25,1);function ur(r,t,i){return Math.min(i,Math.max(t,r))}function gr(r,t,i){const s=i-t,c=((r-t)%s+s)%s+t;return c===t?i:c}function Vt(r,...t){for(const i of t)for(const s in i)r[s]=i[s];return r}let zr=1;function xr(r,t,i){const s={};for(const c in r)s[c]=t.call(this,r[c],c,r);return s}function Br(r,t,i){const s={};for(const c in r)t.call(this,r[c],c,r)&&(s[c]=r[c]);return s}function Et(r){return Array.isArray(r)?r.map(Et):typeof r=="object"&&r?xr(r,Et):r}const Hr={};function kr(r){Hr[r]||(typeof console<"u"&&console.warn(r),Hr[r]=!0)}function _r(r,t,i){return(i.y-r.y)*(t.x-r.x)>(t.y-r.y)*(i.x-r.x)}function ti(r){return typeof WorkerGlobalScope<"u"&&r!==void 0&&r instanceof WorkerGlobalScope}let Wr=null;function wr(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap}const ft="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Mt(r,t,i,s,c){return d(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const m=new VideoFrame(r,{timestamp:0});try{const g=m?.format;if(!g||!g.startsWith("BGR")&&!g.startsWith("RGB"))throw new Error(`Unrecognized format ${g}`);const _=g.startsWith("BGR"),x=new Uint8ClampedArray(s*c*4);if(yield m.copyTo(x,(function(k,P,R,O,U){const G=4*Math.max(-P,0),J=(Math.max(0,R)-R)*O*4+G,se=4*O,he=Math.max(0,P),Ee=Math.max(0,R);return{rect:{x:he,y:Ee,width:Math.min(k.width,P+O)-he,height:Math.min(k.height,R+U)-Ee},layout:[{offset:J,stride:se}]}})(r,t,i,s,c)),_)for(let k=0;k<x.length;k+=4){const P=x[k];x[k]=x[k+2],x[k+2]=P}return x}finally{m.close()}}))}let xt,ke;const He="AbortError";function Gt(){return new Error(He)}const Tt={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function $t(r){return Tt.REGISTERED_PROTOCOLS[r.substring(0,r.indexOf("://"))]}const rr="global-dispatcher";class tr extends Error{constructor(t,i,s,c){super(`AJAXError: ${i} (${t}): ${s}`),this.status=t,this.statusText=i,this.url=s,this.body=c}}const cr=()=>ti(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ar=function(r,t){if(/:\/\//.test(r.url)&&!/^https?:|^file:/.test(r.url)){const s=$t(r.url);if(s)return s(r,t);if(ti(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,targetMapId:rr},t)}if(!(/^file:/.test(i=r.url)||/^file:/.test(cr())&&!/^\w+:/.test(i))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(s,c){return d(this,void 0,void 0,(function*(){const m=new Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,cache:s.cache,referrer:cr(),signal:c.signal});s.type!=="json"||m.headers.has("Accept")||m.headers.set("Accept","application/json");const g=yield fetch(m);if(!g.ok){const k=yield g.blob();throw new tr(g.status,g.statusText,s.url,k)}let _;_=s.type==="arrayBuffer"||s.type==="image"?g.arrayBuffer():s.type==="json"?g.json():g.text();const x=yield _;if(c.signal.aborted)throw Gt();return{data:x,cacheControl:g.headers.get("Cache-Control"),expires:g.headers.get("Expires")}}))})(r,t);if(ti(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,mustQueue:!0,targetMapId:rr},t)}var i;return(function(s,c){return new Promise(((m,g)=>{var _;const x=new XMLHttpRequest;x.open(s.method||"GET",s.url,!0),s.type!=="arrayBuffer"&&s.type!=="image"||(x.responseType="arraybuffer");for(const k in s.headers)x.setRequestHeader(k,s.headers[k]);s.type==="json"&&(x.responseType="text",!((_=s.headers)===null||_===void 0)&&_.Accept||x.setRequestHeader("Accept","application/json")),x.withCredentials=s.credentials==="include",x.onerror=()=>{g(new Error(x.statusText))},x.onload=()=>{if(!c.signal.aborted)if((x.status>=200&&x.status<300||x.status===0)&&x.response!==null){let k=x.response;if(s.type==="json")try{k=JSON.parse(x.response)}catch(P){return void g(P)}m({data:k,cacheControl:x.getResponseHeader("Cache-Control"),expires:x.getResponseHeader("Expires")})}else{const k=new Blob([x.response],{type:x.getResponseHeader("Content-Type")});g(new tr(x.status,x.statusText,s.url,k))}},c.signal.addEventListener("abort",(()=>{x.abort(),g(Gt())})),x.send(s.body)}))})(r,t)};function bi(r){if(!r||r.indexOf("://")<=0||r.indexOf("data:image/")===0||r.indexOf("blob:")===0)return!0;const t=new URL(r),i=window.location;return t.protocol===i.protocol&&t.host===i.host}function Pn(r,t,i){i[r]&&i[r].indexOf(t)!==-1||(i[r]=i[r]||[],i[r].push(t))}function di(r,t,i){if(i&&i[r]){const s=i[r].indexOf(t);s!==-1&&i[r].splice(s,1)}}class en{constructor(t,i={}){Vt(this,i),this.type=t}}class wo extends en{constructor(t,i={}){super("error",Vt({error:t},i))}}class Ia{on(t,i){return this._listeners=this._listeners||{},Pn(t,i,this._listeners),this}off(t,i){return di(t,i,this._listeners),di(t,i,this._oneTimeListeners),this}once(t,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},Pn(t,i,this._oneTimeListeners),this):new Promise((s=>this.once(t,s)))}fire(t,i){typeof t=="string"&&(t=new en(t,i||{}));const s=t.type;if(this.listens(s)){t.target=this;const c=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const _ of c)_.call(this,t);const m=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const _ of m)di(s,_,this._oneTimeListeners),_.call(this,t);const g=this._eventedParent;g&&(Vt(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),g.fire(t))}else t instanceof wo&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,i){return this._eventedParent=t,this._eventedParentData=i,this}}var Fe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Si=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function ua(r,t){const i={};for(const s in r)s!=="ref"&&(i[s]=r[s]);return Si.forEach((s=>{s in t&&(i[s]=t[s])})),i}function Er(r,t){if(Array.isArray(r)){if(!Array.isArray(t)||r.length!==t.length)return!1;for(let i=0;i<r.length;i++)if(!Er(r[i],t[i]))return!1;return!0}if(typeof r=="object"&&r!==null&&t!==null){if(typeof t!="object"||Object.keys(r).length!==Object.keys(t).length)return!1;for(const i in r)if(!Er(r[i],t[i]))return!1;return!0}return r===t}function qr(r,t){r.push(t)}function bo(r,t,i){qr(i,{command:"addSource",args:[r,t[r]]})}function So(r,t,i){qr(t,{command:"removeSource",args:[r]}),i[r]=!0}function ko(r,t,i,s){So(r,i,s),bo(r,t,i)}function Pa(r,t,i){let s;for(s in r[i])if(Object.prototype.hasOwnProperty.call(r[i],s)&&s!=="data"&&!Er(r[i][s],t[i][s]))return!1;for(s in t[i])if(Object.prototype.hasOwnProperty.call(t[i],s)&&s!=="data"&&!Er(r[i][s],t[i][s]))return!1;return!0}function Mn(r,t,i,s,c,m){r=r||{},t=t||{};for(const g in r)Object.prototype.hasOwnProperty.call(r,g)&&(Er(r[g],t[g])||i.push({command:m,args:[s,g,t[g],c]}));for(const g in t)Object.prototype.hasOwnProperty.call(t,g)&&!Object.prototype.hasOwnProperty.call(r,g)&&(Er(r[g],t[g])||i.push({command:m,args:[s,g,t[g],c]}))}function cs(r){return r.id}function Ma(r,t){return r[t.id]=t,r}class rt{constructor(t,i,s,c){this.message=(t?`${t}: `:"")+s,c&&(this.identifier=c),i!=null&&i.__line__&&(this.line=i.__line__)}}function ao(r,...t){for(const i of t)for(const s in i)r[s]=i[s];return r}class pi extends Error{constructor(t,i){super(i),this.message=i,this.key=t}}class fr{constructor(t,i=[]){this.parent=t,this.bindings={};for(const[s,c]of i)this.bindings[s]=c}concat(t){return new fr(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const ri={kind:"null"},at={kind:"number"},sr={kind:"string"},Zt={kind:"boolean"},Gi={kind:"color"},Ni={kind:"object"},Ht={kind:"value"},An={kind:"collator"},so={kind:"formatted"},xn={kind:"padding"},ln={kind:"resolvedImage"},le={kind:"variableAnchorOffsetCollection"};function j(r,t){return{kind:"array",itemType:r,N:t}}function V(r){if(r.kind==="array"){const t=V(r.itemType);return typeof r.N=="number"?`array<${t}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${t}>`}return r.kind}const X=[ri,at,sr,Zt,Gi,so,Ni,j(Ht),xn,ln,le];function oe(r,t){if(t.kind==="error")return null;if(r.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!oe(r.itemType,t.itemType))&&(typeof r.N!="number"||r.N===t.N))return null}else{if(r.kind===t.kind)return null;if(r.kind==="value"){for(const i of X)if(!oe(i,t))return null}}return`Expected ${V(r)} but found ${V(t)} instead.`}function ge(r,t){return t.some((i=>i.kind===r.kind))}function xe(r,t){return t.some((i=>i==="null"?r===null:i==="array"?Array.isArray(r):i==="object"?r&&!Array.isArray(r)&&typeof r=="object":i===typeof r))}function Te(r,t){return r.kind==="array"&&t.kind==="array"?r.itemType.kind===t.itemType.kind&&typeof r.N=="number":r.kind===t.kind}const de=.96422,De=.82521,qe=4/29,Ae=6/29,it=3*Ae*Ae,Ct=Ae*Ae*Ae,Lt=Math.PI/180,br=180/Math.PI;function er(r){return(r%=360)<0&&(r+=360),r}function Tr([r,t,i,s]){let c,m;const g=gi((.2225045*(r=ir(r))+.7168786*(t=ir(t))+.0606169*(i=ir(i)))/1);r===t&&t===i?c=m=g:(c=gi((.4360747*r+.3850649*t+.1430804*i)/de),m=gi((.0139322*r+.0971045*t+.7141733*i)/De));const _=116*g-16;return[_<0?0:_,500*(c-g),200*(g-m),s]}function ir(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function gi(r){return r>Ct?Math.pow(r,1/3):r/it+qe}function Xr([r,t,i,s]){let c=(r+16)/116,m=isNaN(t)?c:c+t/500,g=isNaN(i)?c:c-i/200;return c=1*Or(c),m=de*Or(m),g=De*Or(g),[hr(3.1338561*m-1.6168667*c-.4906146*g),hr(-.9787684*m+1.9161415*c+.033454*g),hr(.0719453*m-.2289914*c+1.4052427*g),s]}function hr(r){return(r=r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055)<0?0:r>1?1:r}function Or(r){return r>Ae?r*r*r:it*(r-qe)}function Kr(r){return parseInt(r.padEnd(2,r),16)/255}function yi(r,t){return Pi(t?r/100:r,0,1)}function Pi(r,t,i){return Math.min(Math.max(t,r),i)}function ji(r){return!r.some(Number.isNaN)}const Aa={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Xt{constructor(t,i,s,c=1,m=!0){this.r=t,this.g=i,this.b=s,this.a=c,m||(this.r*=c,this.g*=c,this.b*=c,c||this.overwriteGetter("rgb",[t,i,s,c]))}static parse(t){if(t instanceof Xt)return t;if(typeof t!="string")return;const i=(function(s){if((s=s.toLowerCase().trim())==="transparent")return[0,0,0,0];const c=Aa[s];if(c){const[g,_,x]=c;return[g/255,_/255,x/255,1]}if(s.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(s)){const g=s.length<6?1:2;let _=1;return[Kr(s.slice(_,_+=g)),Kr(s.slice(_,_+=g)),Kr(s.slice(_,_+=g)),Kr(s.slice(_,_+g)||"ff")]}if(s.startsWith("rgb")){const g=s.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(g){const[_,x,k,P,R,O,U,G,J,se,he,Ee]=g,ye=[P||" ",U||" ",se].join("");if(ye==="  "||ye==="  /"||ye===",,"||ye===",,,"){const ze=[k,O,J].join(""),Oe=ze==="%%%"?100:ze===""?255:0;if(Oe){const Je=[Pi(+x/Oe,0,1),Pi(+R/Oe,0,1),Pi(+G/Oe,0,1),he?yi(+he,Ee):1];if(ji(Je))return Je}}return}}const m=s.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(m){const[g,_,x,k,P,R,O,U,G]=m,J=[x||" ",P||" ",O].join("");if(J==="  "||J==="  /"||J===",,"||J===",,,"){const se=[+_,Pi(+k,0,100),Pi(+R,0,100),U?yi(+U,G):1];if(ji(se))return(function([he,Ee,ye,ze]){function Oe(Je){const vt=(Je+he/30)%12,qt=Ee*Math.min(ye,1-ye);return ye-qt*Math.max(-1,Math.min(vt-3,9-vt,1))}return he=er(he),Ee/=100,ye/=100,[Oe(0),Oe(8),Oe(4),ze]})(se)}}})(t);return i?new Xt(...i,!1):void 0}get rgb(){const{r:t,g:i,b:s,a:c}=this,m=c||1/0;return this.overwriteGetter("rgb",[t/m,i/m,s/m,c])}get hcl(){return this.overwriteGetter("hcl",(function(t){const[i,s,c,m]=Tr(t),g=Math.sqrt(s*s+c*c);return[Math.round(1e4*g)?er(Math.atan2(c,s)*br):NaN,g,i,m]})(this.rgb))}get lab(){return this.overwriteGetter("lab",Tr(this.rgb))}overwriteGetter(t,i){return Object.defineProperty(this,t,{value:i}),i}toString(){const[t,i,s,c]=this.rgb;return`rgba(${[t,i,s].map((m=>Math.round(255*m))).join(",")},${c})`}}Xt.black=new Xt(0,0,0,1),Xt.white=new Xt(1,1,1,1),Xt.transparent=new Xt(0,0,0,0),Xt.red=new Xt(1,0,0,1);class Bl{constructor(t,i,s){this.sensitivity=t?i?"variant":"case":i?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,i){return this.collator.compare(t,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class hs{constructor(t,i,s,c,m){this.text=t,this.image=i,this.scale=s,this.fontStack=c,this.textColor=m}}class wn{constructor(t){this.sections=t}static fromString(t){return new wn([new hs(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((t=>t.text.length!==0||t.image&&t.image.name.length!==0))}static factory(t){return t instanceof wn?t:wn.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map((t=>t.text)).join("")}}class tn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof tn)return t;if(typeof t=="number")return new tn([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const i of t)if(typeof i!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new tn(t)}}toString(){return JSON.stringify(this.values)}}const Zu=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Dn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Dn)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let i=0;i<t.length;i+=2){const s=t[i],c=t[i+1];if(typeof s!="string"||!Zu.has(s)||!Array.isArray(c)||c.length!==2||typeof c[0]!="number"||typeof c[1]!="number")return}return new Dn(t)}}toString(){return JSON.stringify(this.values)}}class Hi{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Hi({name:t,available:!1}):null}}function rn(r,t,i,s){return typeof r=="number"&&r>=0&&r<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?s===void 0||typeof s=="number"&&s>=0&&s<=1?null:`Invalid rgba value [${[r,t,i,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof s=="number"?[r,t,i,s]:[r,t,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function $o(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof Xt||r instanceof Bl||r instanceof wn||r instanceof tn||r instanceof Dn||r instanceof Hi)return!0;if(Array.isArray(r)){for(const t of r)if(!$o(t))return!1;return!0}if(typeof r=="object"){for(const t in r)if(!$o(r[t]))return!1;return!0}return!1}function Vr(r){if(r===null)return ri;if(typeof r=="string")return sr;if(typeof r=="boolean")return Zt;if(typeof r=="number")return at;if(r instanceof Xt)return Gi;if(r instanceof Bl)return An;if(r instanceof wn)return so;if(r instanceof tn)return xn;if(r instanceof Dn)return le;if(r instanceof Hi)return ln;if(Array.isArray(r)){const t=r.length;let i;for(const s of r){const c=Vr(s);if(i){if(i===c)continue;i=Ht;break}i=c}return j(i||Ht,t)}return Ni}function As(r){const t=typeof r;return r===null?"":t==="string"||t==="number"||t==="boolean"?String(r):r instanceof Xt||r instanceof wn||r instanceof tn||r instanceof Dn||r instanceof Hi?r.toString():JSON.stringify(r)}class lo{constructor(t,i){this.type=t,this.value=i}static parse(t,i){if(t.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!$o(t[1]))return i.error("invalid value");const s=t[1];let c=Vr(s);const m=i.expectedType;return c.kind!=="array"||c.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(c=m),new lo(c,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Nr{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const Zo={string:sr,number:at,boolean:Zt,object:Ni};class un{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");let s,c=1;const m=t[0];if(m==="array"){let _,x;if(t.length>2){const k=t[1];if(typeof k!="string"||!(k in Zo)||k==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);_=Zo[k],c++}else _=Ht;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return i.error('The length argument to "array" must be a positive integer literal',2);x=t[2],c++}s=j(_,x)}else{if(!Zo[m])throw new Error(`Types doesn't contain name = ${m}`);s=Zo[m]}const g=[];for(;c<t.length;c++){const _=i.parse(t[c],c,Ht);if(!_)return null;g.push(_)}return new un(s,g)}evaluate(t){for(let i=0;i<this.args.length;i++){const s=this.args[i].evaluate(t);if(!oe(this.type,Vr(s)))return s;if(i===this.args.length-1)throw new Nr(`Expected value to be of type ${V(this.type)}, but found ${V(Vr(s))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const Da={"to-boolean":Zt,"to-color":Gi,"to-number":at,"to-string":sr};class cn{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");const s=t[0];if(!Da[s])throw new Error(`Can't parse ${s} as it is not part of the known types`);if((s==="to-boolean"||s==="to-string")&&t.length!==2)return i.error("Expected one argument.");const c=Da[s],m=[];for(let g=1;g<t.length;g++){const _=i.parse(t[g],g,Ht);if(!_)return null;m.push(_)}return new cn(c,m)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let i,s;for(const c of this.args){if(i=c.evaluate(t),s=null,i instanceof Xt)return i;if(typeof i=="string"){const m=t.parseColor(i);if(m)return m}else if(Array.isArray(i)&&(s=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:rn(i[0],i[1],i[2],i[3]),!s))return new Xt(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new Nr(s||`Could not parse color from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"padding":{let i;for(const s of this.args){i=s.evaluate(t);const c=tn.parse(i);if(c)return c}throw new Nr(`Could not parse padding from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"variableAnchorOffsetCollection":{let i;for(const s of this.args){i=s.evaluate(t);const c=Dn.parse(i);if(c)return c}throw new Nr(`Could not parse variableAnchorOffsetCollection from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"number":{let i=null;for(const s of this.args){if(i=s.evaluate(t),i===null)return 0;const c=Number(i);if(!isNaN(c))return c}throw new Nr(`Could not convert ${JSON.stringify(i)} to number.`)}case"formatted":return wn.fromString(As(this.args[0].evaluate(t)));case"resolvedImage":return Hi.fromString(As(this.args[0].evaluate(t)));default:return As(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const Ol=["Unknown","Point","LineString","Polygon"];class La{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ol[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let i=this._parseColorCache[t];return i||(i=this._parseColorCache[t]=Xt.parse(t)),i}}class Ln{constructor(t,i,s=[],c,m=new fr,g=[]){this.registry=t,this.path=s,this.key=s.map((_=>`[${_}]`)).join(""),this.scope=m,this.errors=g,this.expectedType=c,this._isConstant=i}parse(t,i,s,c,m={}){return i?this.concat(i,s,c)._parse(t,m):this._parse(t,m)}_parse(t,i){function s(c,m,g){return g==="assert"?new un(m,[c]):g==="coerce"?new cn(m,[c]):c}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const c=t[0];if(typeof c!="string")return this.error(`Expression name must be a string, but found ${typeof c} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[c];if(m){let g=m.parse(t,this);if(!g)return null;if(this.expectedType){const _=this.expectedType,x=g.type;if(_.kind!=="string"&&_.kind!=="number"&&_.kind!=="boolean"&&_.kind!=="object"&&_.kind!=="array"||x.kind!=="value")if(_.kind!=="color"&&_.kind!=="formatted"&&_.kind!=="resolvedImage"||x.kind!=="value"&&x.kind!=="string")if(_.kind!=="padding"||x.kind!=="value"&&x.kind!=="number"&&x.kind!=="array")if(_.kind!=="variableAnchorOffsetCollection"||x.kind!=="value"&&x.kind!=="array"){if(this.checkSubtype(_,x))return null}else g=s(g,_,i.typeAnnotation||"coerce");else g=s(g,_,i.typeAnnotation||"coerce");else g=s(g,_,i.typeAnnotation||"coerce");else g=s(g,_,i.typeAnnotation||"assert")}if(!(g instanceof lo)&&g.type.kind!=="resolvedImage"&&this._isConstant(g)){const _=new La;try{g=new lo(g.type,g.evaluate(_))}catch(x){return this.error(x.message),null}}return g}return this.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,i,s){const c=typeof t=="number"?this.path.concat(t):this.path,m=s?this.scope.concat(s):this.scope;return new Ln(this.registry,this._isConstant,c,i||null,m,this.errors)}error(t,...i){const s=`${this.key}${i.map((c=>`[${c}]`)).join("")}`;this.errors.push(new pi(s,t))}checkSubtype(t,i){const s=oe(t,i);return s&&this.error(s),s}}class Un{constructor(t,i){this.type=i.type,this.bindings=[].concat(t),this.result=i}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const i of this.bindings)t(i[1]);t(this.result)}static parse(t,i){if(t.length<4)return i.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const s=[];for(let m=1;m<t.length-1;m+=2){const g=t[m];if(typeof g!="string")return i.error(`Expected string, but found ${typeof g} instead.`,m);if(/[^a-zA-Z0-9_]/.test(g))return i.error("Variable names must contain only alphanumeric characters or '_'.",m);const _=i.parse(t[m+1],m+1);if(!_)return null;s.push([g,_])}const c=i.parse(t[t.length-1],t.length-1,i.expectedType,s);return c?new Un(s,c):null}outputDefined(){return this.result.outputDefined()}}class Cr{constructor(t,i){this.type=i.type,this.name=t,this.boundExpression=i}static parse(t,i){if(t.length!==2||typeof t[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const s=t[1];return i.scope.has(s)?new Cr(s,i.scope.get(s)):i.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Ra{constructor(t,i,s){this.type=t,this.index=i,this.input=s}static parse(t,i){if(t.length!==3)return i.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const s=i.parse(t[1],1,at),c=i.parse(t[2],2,j(i.expectedType||Ht));return s&&c?new Ra(c.type.itemType,s,c):null}evaluate(t){const i=this.index.evaluate(t),s=this.input.evaluate(t);if(i<0)throw new Nr(`Array index out of bounds: ${i} < 0.`);if(i>=s.length)throw new Nr(`Array index out of bounds: ${i} > ${s.length-1}.`);if(i!==Math.floor(i))throw new Nr(`Array index must be an integer, but found ${i} instead.`);return s[i]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class ca{constructor(t,i){this.type=Zt,this.needle=t,this.haystack=i}static parse(t,i){if(t.length!==3)return i.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const s=i.parse(t[1],1,Ht),c=i.parse(t[2],2,Ht);return s&&c?ge(s.type,[Zt,sr,at,ri,Ht])?new ca(s,c):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${V(s.type)} instead`):null}evaluate(t){const i=this.needle.evaluate(t),s=this.haystack.evaluate(t);if(!s)return!1;if(!xe(i,["boolean","string","number","null"]))throw new Nr(`Expected first argument to be of type boolean, string, number or null, but found ${V(Vr(i))} instead.`);if(!xe(s,["string","array"]))throw new Nr(`Expected second argument to be of type array or string, but found ${V(Vr(s))} instead.`);return s.indexOf(i)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class ha{constructor(t,i,s){this.type=at,this.needle=t,this.haystack=i,this.fromIndex=s}static parse(t,i){if(t.length<=2||t.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const s=i.parse(t[1],1,Ht),c=i.parse(t[2],2,Ht);if(!s||!c)return null;if(!ge(s.type,[Zt,sr,at,ri,Ht]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${V(s.type)} instead`);if(t.length===4){const m=i.parse(t[3],3,at);return m?new ha(s,c,m):null}return new ha(s,c)}evaluate(t){const i=this.needle.evaluate(t),s=this.haystack.evaluate(t);if(!xe(i,["boolean","string","number","null"]))throw new Nr(`Expected first argument to be of type boolean, string, number or null, but found ${V(Vr(i))} instead.`);let c;if(this.fromIndex&&(c=this.fromIndex.evaluate(t)),xe(s,["string"])){const m=s.indexOf(i,c);return m===-1?-1:[...s.slice(0,m)].length}if(xe(s,["array"]))return s.indexOf(i,c);throw new Nr(`Expected second argument to be of type array or string, but found ${V(Vr(s))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class jr{constructor(t,i,s,c,m,g){this.inputType=t,this.type=i,this.input=s,this.cases=c,this.outputs=m,this.otherwise=g}static parse(t,i){if(t.length<5)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return i.error("Expected an even number of arguments.");let s,c;i.expectedType&&i.expectedType.kind!=="value"&&(c=i.expectedType);const m={},g=[];for(let k=2;k<t.length-1;k+=2){let P=t[k];const R=t[k+1];Array.isArray(P)||(P=[P]);const O=i.concat(k);if(P.length===0)return O.error("Expected at least one branch label.");for(const G of P){if(typeof G!="number"&&typeof G!="string")return O.error("Branch labels must be numbers or strings.");if(typeof G=="number"&&Math.abs(G)>Number.MAX_SAFE_INTEGER)return O.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof G=="number"&&Math.floor(G)!==G)return O.error("Numeric branch labels must be integer values.");if(s){if(O.checkSubtype(s,Vr(G)))return null}else s=Vr(G);if(m[String(G)]!==void 0)return O.error("Branch labels must be unique.");m[String(G)]=g.length}const U=i.parse(R,k,c);if(!U)return null;c=c||U.type,g.push(U)}const _=i.parse(t[1],1,Ht);if(!_)return null;const x=i.parse(t[t.length-1],t.length-1,c);return x?_.type.kind!=="value"&&i.concat(1).checkSubtype(s,_.type)?null:new jr(s,c,_,m,g,x):null}evaluate(t){const i=this.input.evaluate(t);return(Vr(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}}class Ds{constructor(t,i,s){this.type=t,this.branches=i,this.otherwise=s}static parse(t,i){if(t.length<4)return i.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return i.error("Expected an odd number of arguments.");let s;i.expectedType&&i.expectedType.kind!=="value"&&(s=i.expectedType);const c=[];for(let g=1;g<t.length-1;g+=2){const _=i.parse(t[g],g,Zt);if(!_)return null;const x=i.parse(t[g+1],g+1,s);if(!x)return null;c.push([_,x]),s=s||x.type}const m=i.parse(t[t.length-1],t.length-1,s);if(!m)return null;if(!s)throw new Error("Can't infer output type");return new Ds(s,c,m)}evaluate(t){for(const[i,s]of this.branches)if(i.evaluate(t))return s.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[i,s]of this.branches)t(i),t(s);t(this.otherwise)}outputDefined(){return this.branches.every((([t,i])=>i.outputDefined()))&&this.otherwise.outputDefined()}}class Fa{constructor(t,i,s,c){this.type=t,this.input=i,this.beginIndex=s,this.endIndex=c}static parse(t,i){if(t.length<=2||t.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const s=i.parse(t[1],1,Ht),c=i.parse(t[2],2,at);if(!s||!c)return null;if(!ge(s.type,[j(Ht),sr,Ht]))return i.error(`Expected first argument to be of type array or string, but found ${V(s.type)} instead`);if(t.length===4){const m=i.parse(t[3],3,at);return m?new Fa(s.type,s,c,m):null}return new Fa(s.type,s,c)}evaluate(t){const i=this.input.evaluate(t),s=this.beginIndex.evaluate(t);let c;if(this.endIndex&&(c=this.endIndex.evaluate(t)),xe(i,["string"]))return[...i].slice(s,c).join("");if(xe(i,["array"]))return i.slice(s,c);throw new Nr(`Expected first argument to be of type array or string, but found ${V(Vr(i))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function ds(r,t){const i=r.length-1;let s,c,m=0,g=i,_=0;for(;m<=g;)if(_=Math.floor((m+g)/2),s=r[_],c=r[_+1],s<=t){if(_===i||t<c)return _;m=_+1}else{if(!(s>t))throw new Nr("Input is not a number.");g=_-1}return 0}class Ba{constructor(t,i,s){this.type=t,this.input=i,this.labels=[],this.outputs=[];for(const[c,m]of s)this.labels.push(c),this.outputs.push(m)}static parse(t,i){if(t.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");const s=i.parse(t[1],1,at);if(!s)return null;const c=[];let m=null;i.expectedType&&i.expectedType.kind!=="value"&&(m=i.expectedType);for(let g=1;g<t.length;g+=2){const _=g===1?-1/0:t[g],x=t[g+1],k=g,P=g+1;if(typeof _!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(c.length&&c[c.length-1][0]>=_)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const R=i.parse(x,P,m);if(!R)return null;m=m||R.type,c.push([_,R])}return new Ba(m,s,c)}evaluate(t){const i=this.labels,s=this.outputs;if(i.length===1)return s[0].evaluate(t);const c=this.input.evaluate(t);if(c<=i[0])return s[0].evaluate(t);const m=i.length;return c>=i[m-1]?s[m-1].evaluate(t):s[ds(i,c)].evaluate(t)}eachChild(t){t(this.input);for(const i of this.outputs)t(i)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function Nl(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var gu=Qs;function Qs(r,t,i,s){this.cx=3*r,this.bx=3*(i-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(s-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=t,this.p2x=i,this.p2y=s}Qs.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,t){if(t===void 0&&(t=1e-6),r<0)return 0;if(r>1)return 1;for(var i=r,s=0;s<8;s++){var c=this.sampleCurveX(i)-r;if(Math.abs(c)<t)return i;var m=this.sampleCurveDerivativeX(i);if(Math.abs(m)<1e-6)break;i-=c/m}var g=0,_=1;for(i=r,s=0;s<20&&(c=this.sampleCurveX(i),!(Math.abs(c-r)<t));s++)r>c?g=i:_=i,i=.5*(_-g)+g;return i},solve:function(r,t){return this.sampleCurveY(this.solveCurveX(r,t))}};var el=Nl(gu);function bn(r,t,i){return r+i*(t-r)}function $n(r,t,i){return r.map(((s,c)=>bn(s,t[c],i)))}const ki={number:bn,color:function(r,t,i,s="rgb"){switch(s){case"rgb":{const[c,m,g,_]=$n(r.rgb,t.rgb,i);return new Xt(c,m,g,_,!1)}case"hcl":{const[c,m,g,_]=r.hcl,[x,k,P,R]=t.hcl;let O,U;if(isNaN(c)||isNaN(x))isNaN(c)?isNaN(x)?O=NaN:(O=x,g!==1&&g!==0||(U=k)):(O=c,P!==1&&P!==0||(U=m));else{let Ee=x-c;x>c&&Ee>180?Ee-=360:x<c&&c-x>180&&(Ee+=360),O=c+i*Ee}const[G,J,se,he]=(function([Ee,ye,ze,Oe]){return Ee=isNaN(Ee)?0:Ee*Lt,Xr([ze,Math.cos(Ee)*ye,Math.sin(Ee)*ye,Oe])})([O,U??bn(m,k,i),bn(g,P,i),bn(_,R,i)]);return new Xt(G,J,se,he,!1)}case"lab":{const[c,m,g,_]=Xr($n(r.lab,t.lab,i));return new Xt(c,m,g,_,!1)}}},array:$n,padding:function(r,t,i){return new tn($n(r.values,t.values,i))},variableAnchorOffsetCollection:function(r,t,i){const s=r.values,c=t.values;if(s.length!==c.length)throw new Nr(`Cannot interpolate values of different length. from: ${r.toString()}, to: ${t.toString()}`);const m=[];for(let g=0;g<s.length;g+=2){if(s[g]!==c[g])throw new Nr(`Cannot interpolate values containing mismatched anchors. from[${g}]: ${s[g]}, to[${g}]: ${c[g]}`);m.push(s[g]);const[_,x]=s[g+1],[k,P]=c[g+1];m.push([bn(_,k,i),bn(x,P,i)])}return new Dn(m)}};class Vi{constructor(t,i,s,c,m){this.type=t,this.operator=i,this.interpolation=s,this.input=c,this.labels=[],this.outputs=[];for(const[g,_]of m)this.labels.push(g),this.outputs.push(_)}static interpolationFactor(t,i,s,c){let m=0;if(t.name==="exponential")m=da(i,t.base,s,c);else if(t.name==="linear")m=da(i,1,s,c);else if(t.name==="cubic-bezier"){const g=t.controlPoints;m=new el(g[0],g[1],g[2],g[3]).solve(da(i,1,s,c))}return m}static parse(t,i){let[s,c,m,...g]=t;if(!Array.isArray(c)||c.length===0)return i.error("Expected an interpolation type expression.",1);if(c[0]==="linear")c={name:"linear"};else if(c[0]==="exponential"){const k=c[1];if(typeof k!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);c={name:"exponential",base:k}}else{if(c[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(c[0])}`,1,0);{const k=c.slice(1);if(k.length!==4||k.some((P=>typeof P!="number"||P<0||P>1)))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);c={name:"cubic-bezier",controlPoints:k}}}if(t.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(m=i.parse(m,2,at),!m)return null;const _=[];let x=null;s==="interpolate-hcl"||s==="interpolate-lab"?x=Gi:i.expectedType&&i.expectedType.kind!=="value"&&(x=i.expectedType);for(let k=0;k<g.length;k+=2){const P=g[k],R=g[k+1],O=k+3,U=k+4;if(typeof P!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(_.length&&_[_.length-1][0]>=P)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',O);const G=i.parse(R,U,x);if(!G)return null;x=x||G.type,_.push([P,G])}return Te(x,at)||Te(x,Gi)||Te(x,xn)||Te(x,le)||Te(x,j(at))?new Vi(x,s,c,m,_):i.error(`Type ${V(x)} is not interpolatable.`)}evaluate(t){const i=this.labels,s=this.outputs;if(i.length===1)return s[0].evaluate(t);const c=this.input.evaluate(t);if(c<=i[0])return s[0].evaluate(t);const m=i.length;if(c>=i[m-1])return s[m-1].evaluate(t);const g=ds(i,c),_=Vi.interpolationFactor(this.interpolation,c,i[g],i[g+1]),x=s[g].evaluate(t),k=s[g+1].evaluate(t);switch(this.operator){case"interpolate":return ki[this.type.kind](x,k,_);case"interpolate-hcl":return ki.color(x,k,_,"hcl");case"interpolate-lab":return ki.color(x,k,_,"lab")}}eachChild(t){t(this.input);for(const i of this.outputs)t(i)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function da(r,t,i,s){const c=s-i,m=r-i;return c===0?0:t===1?m/c:(Math.pow(t,m)-1)/(Math.pow(t,c)-1)}class nn{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expectected at least one argument.");let s=null;const c=i.expectedType;c&&c.kind!=="value"&&(s=c);const m=[];for(const _ of t.slice(1)){const x=i.parse(_,1+m.length,s,void 0,{typeAnnotation:"omit"});if(!x)return null;s=s||x.type,m.push(x)}if(!s)throw new Error("No output type");const g=c&&m.some((_=>oe(c,_.type)));return new nn(g?Ht:s,m)}evaluate(t){let i,s=null,c=0;for(const m of this.args)if(c++,s=m.evaluate(t),s&&s instanceof Hi&&!s.available&&(i||(i=s.name),s=null,c===this.args.length&&(s=i)),s!==null)break;return s}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}function tl(r,t){return r==="=="||r==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function jl(r,t,i,s){return s.compare(t,i)===0}function To(r,t,i){const s=r!=="=="&&r!=="!=";return class fm{constructor(m,g,_){this.type=Zt,this.lhs=m,this.rhs=g,this.collator=_,this.hasUntypedArgument=m.type.kind==="value"||g.type.kind==="value"}static parse(m,g){if(m.length!==3&&m.length!==4)return g.error("Expected two or three arguments.");const _=m[0];let x=g.parse(m[1],1,Ht);if(!x)return null;if(!tl(_,x.type))return g.concat(1).error(`"${_}" comparisons are not supported for type '${V(x.type)}'.`);let k=g.parse(m[2],2,Ht);if(!k)return null;if(!tl(_,k.type))return g.concat(2).error(`"${_}" comparisons are not supported for type '${V(k.type)}'.`);if(x.type.kind!==k.type.kind&&x.type.kind!=="value"&&k.type.kind!=="value")return g.error(`Cannot compare types '${V(x.type)}' and '${V(k.type)}'.`);s&&(x.type.kind==="value"&&k.type.kind!=="value"?x=new un(k.type,[x]):x.type.kind!=="value"&&k.type.kind==="value"&&(k=new un(x.type,[k])));let P=null;if(m.length===4){if(x.type.kind!=="string"&&k.type.kind!=="string"&&x.type.kind!=="value"&&k.type.kind!=="value")return g.error("Cannot use collator to compare non-string types.");if(P=g.parse(m[3],3,An),!P)return null}return new fm(x,k,P)}evaluate(m){const g=this.lhs.evaluate(m),_=this.rhs.evaluate(m);if(s&&this.hasUntypedArgument){const x=Vr(g),k=Vr(_);if(x.kind!==k.kind||x.kind!=="string"&&x.kind!=="number")throw new Nr(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${x.kind}, ${k.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){const x=Vr(g),k=Vr(_);if(x.kind!=="string"||k.kind!=="string")return t(m,g,_)}return this.collator?i(m,g,_,this.collator.evaluate(m)):t(m,g,_)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}}}const qu=To("==",(function(r,t,i){return t===i}),jl),Ls=To("!=",(function(r,t,i){return t!==i}),(function(r,t,i,s){return!jl(0,t,i,s)})),ps=To("<",(function(r,t,i){return t<i}),(function(r,t,i,s){return s.compare(t,i)<0})),yu=To(">",(function(r,t,i){return t>i}),(function(r,t,i,s){return s.compare(t,i)>0})),Gu=To("<=",(function(r,t,i){return t<=i}),(function(r,t,i,s){return s.compare(t,i)<=0})),Sn=To(">=",(function(r,t,i){return t>=i}),(function(r,t,i,s){return s.compare(t,i)>=0}));class qo{constructor(t,i,s){this.type=An,this.locale=s,this.caseSensitive=t,this.diacriticSensitive=i}static parse(t,i){if(t.length!==2)return i.error("Expected one argument.");const s=t[1];if(typeof s!="object"||Array.isArray(s))return i.error("Collator options argument must be an object.");const c=i.parse(s["case-sensitive"]!==void 0&&s["case-sensitive"],1,Zt);if(!c)return null;const m=i.parse(s["diacritic-sensitive"]!==void 0&&s["diacritic-sensitive"],1,Zt);if(!m)return null;let g=null;return s.locale&&(g=i.parse(s.locale,1,sr),!g)?null:new qo(c,m,g)}evaluate(t){return new Bl(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class pa{constructor(t,i,s,c,m){this.type=sr,this.number=t,this.locale=i,this.currency=s,this.minFractionDigits=c,this.maxFractionDigits=m}static parse(t,i){if(t.length!==3)return i.error("Expected two arguments.");const s=i.parse(t[1],1,at);if(!s)return null;const c=t[2];if(typeof c!="object"||Array.isArray(c))return i.error("NumberFormat options argument must be an object.");let m=null;if(c.locale&&(m=i.parse(c.locale,1,sr),!m))return null;let g=null;if(c.currency&&(g=i.parse(c.currency,1,sr),!g))return null;let _=null;if(c["min-fraction-digits"]&&(_=i.parse(c["min-fraction-digits"],1,at),!_))return null;let x=null;return c["max-fraction-digits"]&&(x=i.parse(c["max-fraction-digits"],1,at),!x)?null:new pa(s,m,g,_,x)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class fa{constructor(t){this.type=so,this.sections=t}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");const s=t[1];if(!Array.isArray(s)&&typeof s=="object")return i.error("First argument must be an image or text section.");const c=[];let m=!1;for(let g=1;g<=t.length-1;++g){const _=t[g];if(m&&typeof _=="object"&&!Array.isArray(_)){m=!1;let x=null;if(_["font-scale"]&&(x=i.parse(_["font-scale"],1,at),!x))return null;let k=null;if(_["text-font"]&&(k=i.parse(_["text-font"],1,j(sr)),!k))return null;let P=null;if(_["text-color"]&&(P=i.parse(_["text-color"],1,Gi),!P))return null;const R=c[c.length-1];R.scale=x,R.font=k,R.textColor=P}else{const x=i.parse(t[g],1,Ht);if(!x)return null;const k=x.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,c.push({content:x,scale:null,font:null,textColor:null})}}return new fa(c)}evaluate(t){return new wn(this.sections.map((i=>{const s=i.content.evaluate(t);return Vr(s)===ln?new hs("",s,null,null,null):new hs(As(s),null,i.scale?i.scale.evaluate(t):null,i.font?i.font.evaluate(t).join(","):null,i.textColor?i.textColor.evaluate(t):null)})))}eachChild(t){for(const i of this.sections)t(i.content),i.scale&&t(i.scale),i.font&&t(i.font),i.textColor&&t(i.textColor)}outputDefined(){return!1}}class Vl{constructor(t){this.type=ln,this.input=t}static parse(t,i){if(t.length!==2)return i.error("Expected two arguments.");const s=i.parse(t[1],1,sr);return s?new Vl(s):i.error("No image name provided.")}evaluate(t){const i=this.input.evaluate(t),s=Hi.fromString(i);return s&&t.availableImages&&(s.available=t.availableImages.indexOf(i)>-1),s}eachChild(t){t(this.input)}outputDefined(){return!1}}class rl{constructor(t){this.type=at,this.input=t}static parse(t,i){if(t.length!==2)return i.error(`Expected 1 argument, but found ${t.length-1} instead.`);const s=i.parse(t[1],1);return s?s.type.kind!=="array"&&s.type.kind!=="string"&&s.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${V(s.type)} instead.`):new rl(s):null}evaluate(t){const i=this.input.evaluate(t);if(typeof i=="string")return[...i].length;if(Array.isArray(i))return i.length;throw new Nr(`Expected value to be of type string or array, but found ${V(Vr(i))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Zn=8192;function il(r,t){const i=(180+r[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,c=Math.pow(2,t.z);return[Math.round(i*c*Zn),Math.round(s*c*Zn)]}function Rs(r,t){const i=Math.pow(2,t.z);return[(c=(r[0]/Zn+t.x)/i,360*c-180),(s=(r[1]/Zn+t.y)/i,360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90)];var s,c}function ma(r,t){r[0]=Math.min(r[0],t[0]),r[1]=Math.min(r[1],t[1]),r[2]=Math.max(r[2],t[0]),r[3]=Math.max(r[3],t[1])}function hn(r,t){return!(r[0]<=t[0]||r[2]>=t[2]||r[1]<=t[1]||r[3]>=t[3])}function Ir(r,t,i){const s=r[0]-t[0],c=r[1]-t[1],m=r[0]-i[0],g=r[1]-i[1];return s*g-m*c==0&&s*m<=0&&c*g<=0}function Oa(r,t,i,s){return(c=[s[0]-i[0],s[1]-i[1]])[0]*(m=[t[0]-r[0],t[1]-r[1]])[1]-c[1]*m[0]!=0&&!(!pe(r,t,i,s)||!pe(i,s,r,t));var c,m}function N(r,t,i){for(const s of i)for(let c=0;c<s.length-1;++c)if(Oa(r,t,s[c],s[c+1]))return!0;return!1}function z(r,t,i=!1){let s=!1;for(const _ of t)for(let x=0;x<_.length-1;x++){if(Ir(r,_[x],_[x+1]))return i;(m=_[x])[1]>(c=r)[1]!=(g=_[x+1])[1]>c[1]&&c[0]<(g[0]-m[0])*(c[1]-m[1])/(g[1]-m[1])+m[0]&&(s=!s)}var c,m,g;return s}function M(r,t){for(const i of t)if(z(r,i))return!0;return!1}function q(r,t){for(const i of r)if(!z(i,t))return!1;for(let i=0;i<r.length-1;++i)if(N(r[i],r[i+1],t))return!1;return!0}function Y(r,t){for(const i of t)if(q(r,i))return!0;return!1}function pe(r,t,i,s){const c=s[0]-i[0],m=s[1]-i[1],g=(r[0]-i[0])*m-c*(r[1]-i[1]),_=(t[0]-i[0])*m-c*(t[1]-i[1]);return g>0&&_<0||g<0&&_>0}function fe(r,t,i){const s=[];for(let c=0;c<r.length;c++){const m=[];for(let g=0;g<r[c].length;g++){const _=il(r[c][g],i);ma(t,_),m.push(_)}s.push(m)}return s}function Ce(r,t,i){const s=[];for(let c=0;c<r.length;c++){const m=fe(r[c],t,i);s.push(m)}return s}function $e(r,t,i,s){if(r[0]<i[0]||r[0]>i[2]){const c=.5*s;let m=r[0]-i[0]>c?-s:i[0]-r[0]>c?s:0;m===0&&(m=r[0]-i[2]>c?-s:i[2]-r[0]>c?s:0),r[0]+=m}ma(t,r)}function Ne(r,t,i,s){const c=Math.pow(2,s.z)*Zn,m=[s.x*Zn,s.y*Zn],g=[];for(const _ of r)for(const x of _){const k=[x.x+m[0],x.y+m[1]];$e(k,t,i,c),g.push(k)}return g}function Ke(r,t,i,s){const c=Math.pow(2,s.z)*Zn,m=[s.x*Zn,s.y*Zn],g=[];for(const x of r){const k=[];for(const P of x){const R=[P.x+m[0],P.y+m[1]];ma(t,R),k.push(R)}g.push(k)}if(t[2]-t[0]<=c/2){(_=t)[0]=_[1]=1/0,_[2]=_[3]=-1/0;for(const x of g)for(const k of x)$e(k,t,i,c)}var _;return g}class We{constructor(t,i){this.type=Zt,this.geojson=t,this.geometries=i}static parse(t,i){if(t.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if($o(t[1])){const s=t[1];if(s.type==="FeatureCollection"){const c=[];for(const m of s.features){const{type:g,coordinates:_}=m.geometry;g==="Polygon"&&c.push(_),g==="MultiPolygon"&&c.push(..._)}if(c.length)return new We(s,{type:"MultiPolygon",coordinates:c})}else if(s.type==="Feature"){const c=s.geometry.type;if(c==="Polygon"||c==="MultiPolygon")return new We(s,s.geometry)}else if(s.type==="Polygon"||s.type==="MultiPolygon")return new We(s,s)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return(function(i,s){const c=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],g=i.canonicalID();if(s.type==="Polygon"){const _=fe(s.coordinates,m,g),x=Ne(i.geometry(),c,m,g);if(!hn(c,m))return!1;for(const k of x)if(!z(k,_))return!1}if(s.type==="MultiPolygon"){const _=Ce(s.coordinates,m,g),x=Ne(i.geometry(),c,m,g);if(!hn(c,m))return!1;for(const k of x)if(!M(k,_))return!1}return!0})(t,this.geometries);if(t.geometryType()==="LineString")return(function(i,s){const c=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],g=i.canonicalID();if(s.type==="Polygon"){const _=fe(s.coordinates,m,g),x=Ke(i.geometry(),c,m,g);if(!hn(c,m))return!1;for(const k of x)if(!q(k,_))return!1}if(s.type==="MultiPolygon"){const _=Ce(s.coordinates,m,g),x=Ke(i.geometry(),c,m,g);if(!hn(c,m))return!1;for(const k of x)if(!Y(k,_))return!1}return!0})(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let st=class{constructor(r=[],t=((i,s)=>i<s?-1:i>s?1:0)){if(this.data=r,this.length=this.data.length,this.compare=t,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:t,compare:i}=this,s=t[r];for(;r>0;){const c=r-1>>1,m=t[c];if(i(s,m)>=0)break;t[r]=m,r=c}t[r]=s}_down(r){const{data:t,compare:i}=this,s=this.length>>1,c=t[r];for(;r<s;){let m=1+(r<<1);const g=m+1;if(g<this.length&&i(t[g],t[m])<0&&(m=g),i(t[m],c)>=0)break;t[r]=t[m],r=m}t[r]=c}};function Dr(r,t,i,s,c){si(r,t,i,s||r.length-1,c||Mi)}function si(r,t,i,s,c){for(;s>i;){if(s-i>600){var m=s-i+1,g=t-i+1,_=Math.log(m),x=.5*Math.exp(2*_/3),k=.5*Math.sqrt(_*x*(m-x)/m)*(g-m/2<0?-1:1);si(r,t,Math.max(i,Math.floor(t-g*x/m+k)),Math.min(s,Math.floor(t+(m-g)*x/m+k)),c)}var P=r[t],R=i,O=s;for(yr(r,i,t),c(r[s],P)>0&&yr(r,i,s);R<O;){for(yr(r,R,O),R++,O--;c(r[R],P)<0;)R++;for(;c(r[O],P)>0;)O--}c(r[i],P)===0?yr(r,i,O):yr(r,++O,s),O<=t&&(i=O+1),t<=O&&(s=O-1)}}function yr(r,t,i){var s=r[t];r[t]=r[i],r[i]=s}function Mi(r,t){return r<t?-1:r>t?1:0}function li(r,t){if(r.length<=1)return[r];const i=[];let s,c;for(const m of r){const g=Wi(m);g!==0&&(m.area=Math.abs(g),c===void 0&&(c=g<0),c===g<0?(s&&i.push(s),s=[m]):s.push(m))}if(s&&i.push(s),t>1)for(let m=0;m<i.length;m++)i[m].length<=t||(Dr(i[m],t,1,i[m].length-1,dn),i[m]=i[m].slice(0,t));return i}function dn(r,t){return t.area-r.area}function Wi(r){let t=0;for(let i,s,c=0,m=r.length,g=m-1;c<m;g=c++)i=r[c],s=r[g],t+=(s.x-i.x)*(i.y+s.y);return t}const zo=1/298.257223563,Ai=zo*(2-zo),Rn=Math.PI/180;class ii{constructor(t){const i=6378.137*Rn*1e3,s=Math.cos(t*Rn),c=1/(1-Ai*(1-s*s)),m=Math.sqrt(c);this.kx=i*m*s,this.ky=i*m*c*(1-Ai)}distance(t,i){const s=this.wrap(t[0]-i[0])*this.kx,c=(t[1]-i[1])*this.ky;return Math.sqrt(s*s+c*c)}pointOnLine(t,i){let s,c,m,g,_=1/0;for(let x=0;x<t.length-1;x++){let k=t[x][0],P=t[x][1],R=this.wrap(t[x+1][0]-k)*this.kx,O=(t[x+1][1]-P)*this.ky,U=0;R===0&&O===0||(U=(this.wrap(i[0]-k)*this.kx*R+(i[1]-P)*this.ky*O)/(R*R+O*O),U>1?(k=t[x+1][0],P=t[x+1][1]):U>0&&(k+=R/this.kx*U,P+=O/this.ky*U)),R=this.wrap(i[0]-k)*this.kx,O=(i[1]-P)*this.ky;const G=R*R+O*O;G<_&&(_=G,s=k,c=P,m=x,g=U)}return{point:[s,c],index:m,t:Math.max(0,Math.min(1,g))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function Na(r,t){return t[0]-r[0]}function Ui(r){return r[1]-r[0]+1}function Di(r,t){return r[1]>=r[0]&&r[1]<t}function Li(r,t){if(r[0]>r[1])return[null,null];const i=Ui(r);if(t){if(i===2)return[r,null];const c=Math.floor(i/2);return[[r[0],r[0]+c],[r[0]+c,r[1]]]}if(i===1)return[r,null];const s=Math.floor(i/2)-1;return[[r[0],r[0]+s],[r[0]+s+1,r[1]]]}function uo(r,t){if(!Di(t,r.length))return[1/0,1/0,-1/0,-1/0];const i=[1/0,1/0,-1/0,-1/0];for(let s=t[0];s<=t[1];++s)ma(i,r[s]);return i}function kn(r){const t=[1/0,1/0,-1/0,-1/0];for(const i of r)for(const s of i)ma(t,s);return t}function qn(r){return r[0]!==-1/0&&r[1]!==-1/0&&r[2]!==1/0&&r[3]!==1/0}function ga(r,t,i){if(!qn(r)||!qn(t))return NaN;let s=0,c=0;return r[2]<t[0]&&(s=t[0]-r[2]),r[0]>t[2]&&(s=r[0]-t[2]),r[1]>t[3]&&(c=r[1]-t[3]),r[3]<t[1]&&(c=t[1]-r[3]),i.distance([0,0],[s,c])}function $i(r,t,i){const s=i.pointOnLine(t,r);return i.distance(r,s.point)}function Gn(r,t,i,s,c){const m=Math.min($i(r,[i,s],c),$i(t,[i,s],c)),g=Math.min($i(i,[r,t],c),$i(s,[r,t],c));return Math.min(m,g)}function Eo(r,t,i,s,c){if(!Di(t,r.length)||!Di(s,i.length))return 1/0;let m=1/0;for(let g=t[0];g<t[1];++g){const _=r[g],x=r[g+1];for(let k=s[0];k<s[1];++k){const P=i[k],R=i[k+1];if(Oa(_,x,P,R))return 0;m=Math.min(m,Gn(_,x,P,R,c))}}return m}function nr(r,t,i,s,c){if(!Di(t,r.length)||!Di(s,i.length))return NaN;let m=1/0;for(let g=t[0];g<=t[1];++g)for(let _=s[0];_<=s[1];++_)if(m=Math.min(m,c.distance(r[g],i[_])),m===0)return m;return m}function fs(r,t,i){if(z(r,t,!0))return 0;let s=1/0;for(const c of t){const m=c[0],g=c[c.length-1];if(m!==g&&(s=Math.min(s,$i(r,[g,m],i)),s===0))return s;const _=i.pointOnLine(c,r);if(s=Math.min(s,i.distance(r,_.point)),s===0)return s}return s}function Kt(r,t,i,s){if(!Di(t,r.length))return NaN;for(let m=t[0];m<=t[1];++m)if(z(r[m],i,!0))return 0;let c=1/0;for(let m=t[0];m<t[1];++m){const g=r[m],_=r[m+1];for(const x of i)for(let k=0,P=x.length,R=P-1;k<P;R=k++){const O=x[R],U=x[k];if(Oa(g,_,O,U))return 0;c=Math.min(c,Gn(g,_,O,U,s))}}return c}function ms(r,t){for(const i of r)for(const s of i)if(z(s,t,!0))return!0;return!1}function Lr(r,t,i,s=1/0){const c=kn(r),m=kn(t);if(s!==1/0&&ga(c,m,i)>=s)return s;if(hn(c,m)){if(ms(r,t))return 0}else if(ms(t,r))return 0;let g=1/0;for(const _ of r)for(let x=0,k=_.length,P=k-1;x<k;P=x++){const R=_[P],O=_[x];for(const U of t)for(let G=0,J=U.length,se=J-1;G<J;se=G++){const he=U[se],Ee=U[G];if(Oa(R,O,he,Ee))return 0;g=Math.min(g,Gn(R,O,he,Ee,i))}}return g}function Rr(r,t,i,s,c,m){if(!m)return;const g=ga(uo(s,m),c,i);g<t&&r.push([g,m,[0,0]])}function pn(r,t,i,s,c,m,g){if(!m||!g)return;const _=ga(uo(s,m),uo(c,g),i);_<t&&r.push([_,m,g])}function ja(r,t,i,s,c=1/0){let m=Math.min(s.distance(r[0],i[0][0]),c);if(m===0)return m;const g=new st([[0,[0,r.length-1],[0,0]]],Na),_=kn(i);for(;g.length>0;){const x=g.pop();if(x[0]>=m)continue;const k=x[1],P=t?50:100;if(Ui(k)<=P){if(!Di(k,r.length))return NaN;if(t){const R=Kt(r,k,i,s);if(isNaN(R)||R===0)return R;m=Math.min(m,R)}else for(let R=k[0];R<=k[1];++R){const O=fs(r[R],i,s);if(m=Math.min(m,O),m===0)return 0}}else{const R=Li(k,t);Rr(g,m,s,r,_,R[0]),Rr(g,m,s,r,_,R[1])}}return m}function ya(r,t,i,s,c,m=1/0){let g=Math.min(m,c.distance(r[0],i[0]));if(g===0)return g;const _=new st([[0,[0,r.length-1],[0,i.length-1]]],Na);for(;_.length>0;){const x=_.pop();if(x[0]>=g)continue;const k=x[1],P=x[2],R=t?50:100,O=s?50:100;if(Ui(k)<=R&&Ui(P)<=O){if(!Di(k,r.length)&&Di(P,i.length))return NaN;let U;if(t&&s)U=Eo(r,k,i,P,c),g=Math.min(g,U);else if(t&&!s){const G=r.slice(k[0],k[1]+1);for(let J=P[0];J<=P[1];++J)if(U=$i(i[J],G,c),g=Math.min(g,U),g===0)return g}else if(!t&&s){const G=i.slice(P[0],P[1]+1);for(let J=k[0];J<=k[1];++J)if(U=$i(r[J],G,c),g=Math.min(g,U),g===0)return g}else U=nr(r,k,i,P,c),g=Math.min(g,U)}else{const U=Li(k,t),G=Li(P,s);pn(_,g,c,r,i,U[0],G[0]),pn(_,g,c,r,i,U[0],G[1]),pn(_,g,c,r,i,U[1],G[0]),pn(_,g,c,r,i,U[1],G[1])}}return g}function Fs(r){return r.type==="MultiPolygon"?r.coordinates.map((t=>({type:"Polygon",coordinates:t}))):r.type==="MultiLineString"?r.coordinates.map((t=>({type:"LineString",coordinates:t}))):r.type==="MultiPoint"?r.coordinates.map((t=>({type:"Point",coordinates:t}))):[r]}class Go{constructor(t,i){this.type=at,this.geojson=t,this.geometries=i}static parse(t,i){if(t.length!==2)return i.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if($o(t[1])){const s=t[1];if(s.type==="FeatureCollection")return new Go(s,s.features.map((c=>Fs(c.geometry))).flat());if(s.type==="Feature")return new Go(s,Fs(s.geometry));if("type"in s&&"coordinates"in s)return new Go(s,Fs(s))}return i.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return(function(i,s){const c=i.geometry(),m=c.flat().map((x=>Rs([x.x,x.y],i.canonical)));if(c.length===0)return NaN;const g=new ii(m[0][1]);let _=1/0;for(const x of s){switch(x.type){case"Point":_=Math.min(_,ya(m,!1,[x.coordinates],!1,g,_));break;case"LineString":_=Math.min(_,ya(m,!1,x.coordinates,!0,g,_));break;case"Polygon":_=Math.min(_,ja(m,!1,x.coordinates,g,_))}if(_===0)return _}return _})(t,this.geometries);if(t.geometryType()==="LineString")return(function(i,s){const c=i.geometry(),m=c.flat().map((x=>Rs([x.x,x.y],i.canonical)));if(c.length===0)return NaN;const g=new ii(m[0][1]);let _=1/0;for(const x of s){switch(x.type){case"Point":_=Math.min(_,ya(m,!0,[x.coordinates],!1,g,_));break;case"LineString":_=Math.min(_,ya(m,!0,x.coordinates,!0,g,_));break;case"Polygon":_=Math.min(_,ja(m,!0,x.coordinates,g,_))}if(_===0)return _}return _})(t,this.geometries);if(t.geometryType()==="Polygon")return(function(i,s){const c=i.geometry();if(c.length===0||c[0].length===0)return NaN;const m=li(c,0).map((x=>x.map((k=>k.map((P=>Rs([P.x,P.y],i.canonical))))))),g=new ii(m[0][0][0][1]);let _=1/0;for(const x of s)for(const k of m){switch(x.type){case"Point":_=Math.min(_,ja([x.coordinates],!1,k,g,_));break;case"LineString":_=Math.min(_,ja(x.coordinates,!0,k,g,_));break;case"Polygon":_=Math.min(_,Lr(k,x.coordinates,g,_))}if(_===0)return _}return _})(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Va={"==":qu,"!=":Ls,">":yu,"<":ps,">=":Sn,"<=":Gu,array:un,at:Ra,boolean:un,case:Ds,coalesce:nn,collator:qo,format:fa,image:Vl,in:ca,"index-of":ha,interpolate:Vi,"interpolate-hcl":Vi,"interpolate-lab":Vi,length:rl,let:Un,literal:lo,match:jr,number:un,"number-format":pa,object:un,slice:Fa,step:Ba,string:un,"to-boolean":cn,"to-color":cn,"to-number":cn,"to-string":cn,var:Cr,within:We,distance:Go};class Tn{constructor(t,i,s,c){this.name=t,this.type=i,this._evaluate=s,this.args=c}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,i){const s=t[0],c=Tn.definitions[s];if(!c)return i.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(c)?c[0]:c.type,g=Array.isArray(c)?[[c[1],c[2]]]:c.overloads,_=g.filter((([k])=>!Array.isArray(k)||k.length===t.length-1));let x=null;for(const[k,P]of _){x=new Ln(i.registry,ol,i.path,null,i.scope);const R=[];let O=!1;for(let U=1;U<t.length;U++){const G=t[U],J=Array.isArray(k)?k[U-1]:k.type,se=x.parse(G,1+R.length,J);if(!se){O=!0;break}R.push(se)}if(!O)if(Array.isArray(k)&&k.length!==R.length)x.error(`Expected ${k.length} arguments, but found ${R.length} instead.`);else{for(let U=0;U<R.length;U++){const G=Array.isArray(k)?k[U]:k.type,J=R[U];x.concat(U+1).checkSubtype(G,J.type)}if(x.errors.length===0)return new Tn(s,m,P,R)}}if(_.length===1)i.errors.push(...x.errors);else{const k=(_.length?_:g).map((([R])=>{return O=R,Array.isArray(O)?`(${O.map(V).join(", ")})`:`(${V(O.type)}...)`;var O})).join(" | "),P=[];for(let R=1;R<t.length;R++){const O=i.parse(t[R],1+P.length);if(!O)return null;P.push(V(O.type))}i.error(`Expected arguments of type ${k}, but found (${P.join(", ")}) instead.`)}return null}static register(t,i){Tn.definitions=i;for(const s in i)t[s]=Tn}}function Ho(r,[t,i,s,c]){t=t.evaluate(r),i=i.evaluate(r),s=s.evaluate(r);const m=c?c.evaluate(r):1,g=rn(t,i,s,m);if(g)throw new Nr(g);return new Xt(t/255,i/255,s/255,m,!1)}function nl(r,t){return r in t}function Hu(r,t){const i=t[r];return i===void 0?null:i}function Bs(r){return{type:r}}function ol(r){if(r instanceof Cr)return ol(r.boundExpression);if(r instanceof Tn&&r.name==="error"||r instanceof qo||r instanceof We||r instanceof Go)return!1;const t=r instanceof cn||r instanceof un;let i=!0;return r.eachChild((s=>{i=t?i&&ol(s):i&&s instanceof lo})),!!i&&al(r)&&Ua(r,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function al(r){if(r instanceof Tn&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof We||r instanceof Go)return!1;let t=!0;return r.eachChild((i=>{t&&!al(i)&&(t=!1)})),t}function _a(r){if(r instanceof Tn&&r.name==="feature-state")return!1;let t=!0;return r.eachChild((i=>{t&&!_a(i)&&(t=!1)})),t}function Ua(r,t){if(r instanceof Tn&&t.indexOf(r.name)>=0)return!1;let i=!0;return r.eachChild((s=>{i&&!Ua(s,t)&&(i=!1)})),i}function _u(r){return{result:"success",value:r}}function $a(r){return{result:"error",value:r}}function sl(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function Wu(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function Ul(r){return!!r.expression&&r.expression.interpolated}function Pr(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function $l(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function Oc(r){return r}function Xu(r,t){const i=t.type==="color",s=r.stops&&typeof r.stops[0][0]=="object",c=s||!(s||r.property!==void 0),m=r.type||(Ul(t)?"exponential":"interval");if(i||t.type==="padding"){const P=i?Xt.parse:tn.parse;(r=ao({},r)).stops&&(r.stops=r.stops.map((R=>[R[0],P(R[1])]))),r.default=P(r.default?r.default:t.default)}if(r.colorSpace&&(g=r.colorSpace)!=="rgb"&&g!=="hcl"&&g!=="lab")throw new Error(`Unknown color space: "${r.colorSpace}"`);var g;let _,x,k;if(m==="exponential")_=jc;else if(m==="interval")_=vu;else if(m==="categorical"){_=Nc,x=Object.create(null);for(const P of r.stops)x[P[0]]=P[1];k=typeof r.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);_=Vc}if(s){const P={},R=[];for(let G=0;G<r.stops.length;G++){const J=r.stops[G],se=J[0].zoom;P[se]===void 0&&(P[se]={zoom:se,type:r.type,property:r.property,default:r.default,stops:[]},R.push(se)),P[se].stops.push([J[0].value,J[1]])}const O=[];for(const G of R)O.push([P[G].zoom,Xu(P[G],t)]);const U={name:"linear"};return{kind:"composite",interpolationType:U,interpolationFactor:Vi.interpolationFactor.bind(void 0,U),zoomStops:O.map((G=>G[0])),evaluate:({zoom:G},J)=>jc({stops:O,base:r.base},t,G).evaluate(G,J)}}if(c){const P=m==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:P,interpolationFactor:Vi.interpolationFactor.bind(void 0,P),zoomStops:r.stops.map((R=>R[0])),evaluate:({zoom:R})=>_(r,t,R,x,k)}}return{kind:"source",evaluate(P,R){const O=R&&R.properties?R.properties[r.property]:void 0;return O===void 0?ll(r.default,t.default):_(r,t,O,x,k)}}}function ll(r,t,i){return r!==void 0?r:t!==void 0?t:i!==void 0?i:void 0}function Nc(r,t,i,s,c){return ll(typeof i===c?s[i]:void 0,r.default,t.default)}function vu(r,t,i){if(Pr(i)!=="number")return ll(r.default,t.default);const s=r.stops.length;if(s===1||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[s-1][0])return r.stops[s-1][1];const c=ds(r.stops.map((m=>m[0])),i);return r.stops[c][1]}function jc(r,t,i){const s=r.base!==void 0?r.base:1;if(Pr(i)!=="number")return ll(r.default,t.default);const c=r.stops.length;if(c===1||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[c-1][0])return r.stops[c-1][1];const m=ds(r.stops.map((P=>P[0])),i),g=(function(P,R,O,U){const G=U-O,J=P-O;return G===0?0:R===1?J/G:(Math.pow(R,J)-1)/(Math.pow(R,G)-1)})(i,s,r.stops[m][0],r.stops[m+1][0]),_=r.stops[m][1],x=r.stops[m+1][1],k=ki[t.type]||Oc;return typeof _.evaluate=="function"?{evaluate(...P){const R=_.evaluate.apply(void 0,P),O=x.evaluate.apply(void 0,P);if(R!==void 0&&O!==void 0)return k(R,O,g,r.colorSpace)}}:k(_,x,g,r.colorSpace)}function Vc(r,t,i){switch(t.type){case"color":i=Xt.parse(i);break;case"formatted":i=wn.fromString(i.toString());break;case"resolvedImage":i=Hi.fromString(i.toString());break;case"padding":i=tn.parse(i);break;default:Pr(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0)}return ll(i,r.default,t.default)}Tn.register(Va,{error:[{kind:"error"},[sr],(r,[t])=>{throw new Nr(t.evaluate(r))}],typeof:[sr,[Ht],(r,[t])=>V(Vr(t.evaluate(r)))],"to-rgba":[j(at,4),[Gi],(r,[t])=>{const[i,s,c,m]=t.evaluate(r).rgb;return[255*i,255*s,255*c,m]}],rgb:[Gi,[at,at,at],Ho],rgba:[Gi,[at,at,at,at],Ho],has:{type:Zt,overloads:[[[sr],(r,[t])=>nl(t.evaluate(r),r.properties())],[[sr,Ni],(r,[t,i])=>nl(t.evaluate(r),i.evaluate(r))]]},get:{type:Ht,overloads:[[[sr],(r,[t])=>Hu(t.evaluate(r),r.properties())],[[sr,Ni],(r,[t,i])=>Hu(t.evaluate(r),i.evaluate(r))]]},"feature-state":[Ht,[sr],(r,[t])=>Hu(t.evaluate(r),r.featureState||{})],properties:[Ni,[],r=>r.properties()],"geometry-type":[sr,[],r=>r.geometryType()],id:[Ht,[],r=>r.id()],zoom:[at,[],r=>r.globals.zoom],"heatmap-density":[at,[],r=>r.globals.heatmapDensity||0],"line-progress":[at,[],r=>r.globals.lineProgress||0],accumulated:[Ht,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[at,Bs(at),(r,t)=>{let i=0;for(const s of t)i+=s.evaluate(r);return i}],"*":[at,Bs(at),(r,t)=>{let i=1;for(const s of t)i*=s.evaluate(r);return i}],"-":{type:at,overloads:[[[at,at],(r,[t,i])=>t.evaluate(r)-i.evaluate(r)],[[at],(r,[t])=>-t.evaluate(r)]]},"/":[at,[at,at],(r,[t,i])=>t.evaluate(r)/i.evaluate(r)],"%":[at,[at,at],(r,[t,i])=>t.evaluate(r)%i.evaluate(r)],ln2:[at,[],()=>Math.LN2],pi:[at,[],()=>Math.PI],e:[at,[],()=>Math.E],"^":[at,[at,at],(r,[t,i])=>Math.pow(t.evaluate(r),i.evaluate(r))],sqrt:[at,[at],(r,[t])=>Math.sqrt(t.evaluate(r))],log10:[at,[at],(r,[t])=>Math.log(t.evaluate(r))/Math.LN10],ln:[at,[at],(r,[t])=>Math.log(t.evaluate(r))],log2:[at,[at],(r,[t])=>Math.log(t.evaluate(r))/Math.LN2],sin:[at,[at],(r,[t])=>Math.sin(t.evaluate(r))],cos:[at,[at],(r,[t])=>Math.cos(t.evaluate(r))],tan:[at,[at],(r,[t])=>Math.tan(t.evaluate(r))],asin:[at,[at],(r,[t])=>Math.asin(t.evaluate(r))],acos:[at,[at],(r,[t])=>Math.acos(t.evaluate(r))],atan:[at,[at],(r,[t])=>Math.atan(t.evaluate(r))],min:[at,Bs(at),(r,t)=>Math.min(...t.map((i=>i.evaluate(r))))],max:[at,Bs(at),(r,t)=>Math.max(...t.map((i=>i.evaluate(r))))],abs:[at,[at],(r,[t])=>Math.abs(t.evaluate(r))],round:[at,[at],(r,[t])=>{const i=t.evaluate(r);return i<0?-Math.round(-i):Math.round(i)}],floor:[at,[at],(r,[t])=>Math.floor(t.evaluate(r))],ceil:[at,[at],(r,[t])=>Math.ceil(t.evaluate(r))],"filter-==":[Zt,[sr,Ht],(r,[t,i])=>r.properties()[t.value]===i.value],"filter-id-==":[Zt,[Ht],(r,[t])=>r.id()===t.value],"filter-type-==":[Zt,[sr],(r,[t])=>r.geometryType()===t.value],"filter-<":[Zt,[sr,Ht],(r,[t,i])=>{const s=r.properties()[t.value],c=i.value;return typeof s==typeof c&&s<c}],"filter-id-<":[Zt,[Ht],(r,[t])=>{const i=r.id(),s=t.value;return typeof i==typeof s&&i<s}],"filter->":[Zt,[sr,Ht],(r,[t,i])=>{const s=r.properties()[t.value],c=i.value;return typeof s==typeof c&&s>c}],"filter-id->":[Zt,[Ht],(r,[t])=>{const i=r.id(),s=t.value;return typeof i==typeof s&&i>s}],"filter-<=":[Zt,[sr,Ht],(r,[t,i])=>{const s=r.properties()[t.value],c=i.value;return typeof s==typeof c&&s<=c}],"filter-id-<=":[Zt,[Ht],(r,[t])=>{const i=r.id(),s=t.value;return typeof i==typeof s&&i<=s}],"filter->=":[Zt,[sr,Ht],(r,[t,i])=>{const s=r.properties()[t.value],c=i.value;return typeof s==typeof c&&s>=c}],"filter-id->=":[Zt,[Ht],(r,[t])=>{const i=r.id(),s=t.value;return typeof i==typeof s&&i>=s}],"filter-has":[Zt,[Ht],(r,[t])=>t.value in r.properties()],"filter-has-id":[Zt,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[Zt,[j(sr)],(r,[t])=>t.value.indexOf(r.geometryType())>=0],"filter-id-in":[Zt,[j(Ht)],(r,[t])=>t.value.indexOf(r.id())>=0],"filter-in-small":[Zt,[sr,j(Ht)],(r,[t,i])=>i.value.indexOf(r.properties()[t.value])>=0],"filter-in-large":[Zt,[sr,j(Ht)],(r,[t,i])=>(function(s,c,m,g){for(;m<=g;){const _=m+g>>1;if(c[_]===s)return!0;c[_]>s?g=_-1:m=_+1}return!1})(r.properties()[t.value],i.value,0,i.value.length-1)],all:{type:Zt,overloads:[[[Zt,Zt],(r,[t,i])=>t.evaluate(r)&&i.evaluate(r)],[Bs(Zt),(r,t)=>{for(const i of t)if(!i.evaluate(r))return!1;return!0}]]},any:{type:Zt,overloads:[[[Zt,Zt],(r,[t,i])=>t.evaluate(r)||i.evaluate(r)],[Bs(Zt),(r,t)=>{for(const i of t)if(i.evaluate(r))return!0;return!1}]]},"!":[Zt,[Zt],(r,[t])=>!t.evaluate(r)],"is-supported-script":[Zt,[sr],(r,[t])=>{const i=r.globals&&r.globals.isSupportedScript;return!i||i(t.evaluate(r))}],upcase:[sr,[sr],(r,[t])=>t.evaluate(r).toUpperCase()],downcase:[sr,[sr],(r,[t])=>t.evaluate(r).toLowerCase()],concat:[sr,Bs(Ht),(r,t)=>t.map((i=>As(i.evaluate(r)))).join("")],"resolved-locale":[sr,[An],(r,[t])=>t.evaluate(r).resolvedLocale()]});class Hn{constructor(t,i){var s;this.expression=t,this._warningHistory={},this._evaluator=new La,this._defaultValue=i?(s=i).type==="color"&&$l(s.default)?new Xt(0,0,0,0):s.type==="color"?Xt.parse(s.default)||null:s.type==="padding"?tn.parse(s.default)||null:s.type==="variableAnchorOffsetCollection"?Dn.parse(s.default)||null:s.default===void 0?null:s.default:null,this._enumValues=i&&i.type==="enum"?i.values:null}evaluateWithoutErrorHandling(t,i,s,c,m,g){return this._evaluator.globals=t,this._evaluator.feature=i,this._evaluator.featureState=s,this._evaluator.canonical=c,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=g,this.expression.evaluate(this._evaluator)}evaluate(t,i,s,c,m,g){this._evaluator.globals=t,this._evaluator.feature=i||null,this._evaluator.featureState=s||null,this._evaluator.canonical=c,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=g||null;try{const _=this.expression.evaluate(this._evaluator);if(_==null||typeof _=="number"&&_!=_)return this._defaultValue;if(this._enumValues&&!(_ in this._enumValues))throw new Nr(`Expected value to be one of ${Object.keys(this._enumValues).map((x=>JSON.stringify(x))).join(", ")}, but found ${JSON.stringify(_)} instead.`);return _}catch(_){return this._warningHistory[_.message]||(this._warningHistory[_.message]=!0,typeof console<"u"&&console.warn(_.message)),this._defaultValue}}}function gs(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in Va}function Os(r,t){const i=new Ln(Va,ol,[],t?(function(c){const m={color:Gi,string:sr,number:at,enum:sr,boolean:Zt,formatted:so,padding:xn,resolvedImage:ln,variableAnchorOffsetCollection:le};return c.type==="array"?j(m[c.value]||Ht,c.length):m[c.type]})(t):void 0),s=i.parse(r,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return s?_u(new Hn(s,t)):$a(i.errors)}class Ns{constructor(t,i){this.kind=t,this._styleExpression=i,this.isStateDependent=t!=="constant"&&!_a(i.expression)}evaluateWithoutErrorHandling(t,i,s,c,m,g){return this._styleExpression.evaluateWithoutErrorHandling(t,i,s,c,m,g)}evaluate(t,i,s,c,m,g){return this._styleExpression.evaluate(t,i,s,c,m,g)}}class js{constructor(t,i,s,c){this.kind=t,this.zoomStops=s,this._styleExpression=i,this.isStateDependent=t!=="camera"&&!_a(i.expression),this.interpolationType=c}evaluateWithoutErrorHandling(t,i,s,c,m,g){return this._styleExpression.evaluateWithoutErrorHandling(t,i,s,c,m,g)}evaluate(t,i,s,c,m,g){return this._styleExpression.evaluate(t,i,s,c,m,g)}interpolationFactor(t,i,s){return this.interpolationType?Vi.interpolationFactor(this.interpolationType,t,i,s):0}}function xu(r,t){const i=Os(r,t);if(i.result==="error")return i;const s=i.value.expression,c=al(s);if(!c&&!sl(t))return $a([new pi("","data expressions not supported")]);const m=Ua(s,["zoom"]);if(!m&&!Wu(t))return $a([new pi("","zoom expressions not supported")]);const g=Zl(s);return g||m?g instanceof pi?$a([g]):g instanceof Vi&&!Ul(t)?$a([new pi("",'"interpolate" expressions cannot be used with this property')]):_u(g?new js(c?"camera":"composite",i.value,g.labels,g instanceof Vi?g.interpolation:void 0):new Ns(c?"constant":"source",i.value)):$a([new pi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ys{constructor(t,i){this._parameters=t,this._specification=i,ao(this,Xu(this._parameters,this._specification))}static deserialize(t){return new ys(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Zl(r){let t=null;if(r instanceof Un)t=Zl(r.result);else if(r instanceof nn){for(const i of r.args)if(t=Zl(i),t)break}else(r instanceof Ba||r instanceof Vi)&&r.input instanceof Tn&&r.input.name==="zoom"&&(t=r);return t instanceof pi||r.eachChild((i=>{const s=Zl(i);s instanceof pi?t=s:!t&&s?t=new pi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&s&&t!==s&&(t=new pi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}function wu(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const t of r.slice(1))if(!wu(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const Za={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ql(r){if(r==null)return{filter:()=>!0,needGeometry:!1};wu(r)||(r=Hl(r));const t=Os(r,Za);if(t.result==="error")throw new Error(t.value.map((i=>`${i.key}: ${i.message}`)).join(", "));return{filter:(i,s,c)=>t.value.evaluate(i,s,{},c),needGeometry:bu(r)}}function Gl(r,t){return r<t?-1:r>t?1:0}function bu(r){if(!Array.isArray(r))return!1;if(r[0]==="within"||r[0]==="distance")return!0;for(let t=1;t<r.length;t++)if(bu(r[t]))return!0;return!1}function Hl(r){if(!r)return!0;const t=r[0];return r.length<=1?t!=="any":t==="=="?ul(r[1],r[2],"=="):t==="!="?fn(ul(r[1],r[2],"==")):t==="<"||t===">"||t==="<="||t===">="?ul(r[1],r[2],t):t==="any"?(i=r.slice(1),["any"].concat(i.map(Hl))):t==="all"?["all"].concat(r.slice(1).map(Hl)):t==="none"?["all"].concat(r.slice(1).map(Hl).map(fn)):t==="in"?va(r[1],r.slice(2)):t==="!in"?fn(va(r[1],r.slice(2))):t==="has"?Vs(r[1]):t!=="!has"||fn(Vs(r[1]));var i}function ul(r,t,i){switch(r){case"$type":return[`filter-type-${i}`,t];case"$id":return[`filter-id-${i}`,t];default:return[`filter-${i}`,r,t]}}function va(r,t){if(t.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((i=>typeof i!=typeof t[0]))?["filter-in-large",r,["literal",t.sort(Gl)]]:["filter-in-small",r,["literal",t]]}}function Vs(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function fn(r){return["!",r]}function xa(r){const t=typeof r;if(t==="number"||t==="boolean"||t==="string"||r==null)return JSON.stringify(r);if(Array.isArray(r)){let c="[";for(const m of r)c+=`${xa(m)},`;return`${c}]`}const i=Object.keys(r).sort();let s="{";for(let c=0;c<i.length;c++)s+=`${JSON.stringify(i[c])}:${xa(r[i[c]])},`;return`${s}}`}function Ku(r){let t="";for(const i of Si)t+=`/${xa(r[i])}`;return t}function Ju(r){const t=r.value;return t?[new rt(r.key,t,"constants have been deprecated as of v8")]:[]}function Ti(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function Co(r){if(Array.isArray(r))return r.map(Co);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const t={};for(const i in r)t[i]=Co(r[i]);return t}return Ti(r)}function Wn(r){const t=r.key,i=r.value,s=r.valueSpec||{},c=r.objectElementValidators||{},m=r.style,g=r.styleSpec,_=r.validateSpec;let x=[];const k=Pr(i);if(k!=="object")return[new rt(t,i,`object expected, ${k} found`)];for(const P in i){const R=P.split(".")[0],O=s[R]||s["*"];let U;if(c[R])U=c[R];else if(s[R])U=_;else if(c["*"])U=c["*"];else{if(!s["*"]){x.push(new rt(t,i[P],`unknown property "${P}"`));continue}U=_}x=x.concat(U({key:(t&&`${t}.`)+P,value:i[P],valueSpec:O,style:m,styleSpec:g,object:i,objectKey:P,validateSpec:_},i))}for(const P in s)c[P]||s[P].required&&s[P].default===void 0&&i[P]===void 0&&x.push(new rt(t,i,`missing required property "${P}"`));return x}function cl(r){const t=r.value,i=r.valueSpec,s=r.style,c=r.styleSpec,m=r.key,g=r.arrayElementValidator||r.validateSpec;if(Pr(t)!=="array")return[new rt(m,t,`array expected, ${Pr(t)} found`)];if(i.length&&t.length!==i.length)return[new rt(m,t,`array length ${i.length} expected, length ${t.length} found`)];if(i["min-length"]&&t.length<i["min-length"])return[new rt(m,t,`array length at least ${i["min-length"]} expected, length ${t.length} found`)];let _={type:i.value,values:i.values};c.$version<7&&(_.function=i.function),Pr(i.value)==="object"&&(_=i.value);let x=[];for(let k=0;k<t.length;k++)x=x.concat(g({array:t,arrayIndex:k,value:t[k],valueSpec:_,validateSpec:r.validateSpec,style:s,styleSpec:c,key:`${m}[${k}]`}));return x}function wa(r){const t=r.key,i=r.value,s=r.valueSpec;let c=Pr(i);return c==="number"&&i!=i&&(c="NaN"),c!=="number"?[new rt(t,i,`number expected, ${c} found`)]:"minimum"in s&&i<s.minimum?[new rt(t,i,`${i} is less than the minimum value ${s.minimum}`)]:"maximum"in s&&i>s.maximum?[new rt(t,i,`${i} is greater than the maximum value ${s.maximum}`)]:[]}function hl(r){const t=r.valueSpec,i=Ti(r.value.type);let s,c,m,g={};const _=i!=="categorical"&&r.value.property===void 0,x=!_,k=Pr(r.value.stops)==="array"&&Pr(r.value.stops[0])==="array"&&Pr(r.value.stops[0][0])==="object",P=Wn({key:r.key,value:r.value,valueSpec:r.styleSpec.function,validateSpec:r.validateSpec,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(U){if(i==="identity")return[new rt(U.key,U.value,'identity function may not have a "stops" property')];let G=[];const J=U.value;return G=G.concat(cl({key:U.key,value:J,valueSpec:U.valueSpec,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec,arrayElementValidator:R})),Pr(J)==="array"&&J.length===0&&G.push(new rt(U.key,J,"array must have at least one stop")),G},default:function(U){return U.validateSpec({key:U.key,value:U.value,valueSpec:t,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec})}}});return i==="identity"&&_&&P.push(new rt(r.key,r.value,'missing required property "property"')),i==="identity"||r.value.stops||P.push(new rt(r.key,r.value,'missing required property "stops"')),i==="exponential"&&r.valueSpec.expression&&!Ul(r.valueSpec)&&P.push(new rt(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(x&&!sl(r.valueSpec)?P.push(new rt(r.key,r.value,"property functions not supported")):_&&!Wu(r.valueSpec)&&P.push(new rt(r.key,r.value,"zoom functions not supported"))),i!=="categorical"&&!k||r.value.property!==void 0||P.push(new rt(r.key,r.value,'"property" property is required')),P;function R(U){let G=[];const J=U.value,se=U.key;if(Pr(J)!=="array")return[new rt(se,J,`array expected, ${Pr(J)} found`)];if(J.length!==2)return[new rt(se,J,`array length 2 expected, length ${J.length} found`)];if(k){if(Pr(J[0])!=="object")return[new rt(se,J,`object expected, ${Pr(J[0])} found`)];if(J[0].zoom===void 0)return[new rt(se,J,"object stop key must have zoom")];if(J[0].value===void 0)return[new rt(se,J,"object stop key must have value")];if(m&&m>Ti(J[0].zoom))return[new rt(se,J[0].zoom,"stop zoom values must appear in ascending order")];Ti(J[0].zoom)!==m&&(m=Ti(J[0].zoom),c=void 0,g={}),G=G.concat(Wn({key:`${se}[0]`,value:J[0],valueSpec:{zoom:{}},validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec,objectElementValidators:{zoom:wa,value:O}}))}else G=G.concat(O({key:`${se}[0]`,value:J[0],validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec},J));return gs(Co(J[1]))?G.concat([new rt(`${se}[1]`,J[1],"expressions are not allowed in function stops.")]):G.concat(U.validateSpec({key:`${se}[1]`,value:J[1],valueSpec:t,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec}))}function O(U,G){const J=Pr(U.value),se=Ti(U.value),he=U.value!==null?U.value:G;if(s){if(J!==s)return[new rt(U.key,he,`${J} stop domain type must match previous stop domain type ${s}`)]}else s=J;if(J!=="number"&&J!=="string"&&J!=="boolean")return[new rt(U.key,he,"stop domain value must be a number, string, or boolean")];if(J!=="number"&&i!=="categorical"){let Ee=`number expected, ${J} found`;return sl(t)&&i===void 0&&(Ee+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new rt(U.key,he,Ee)]}return i!=="categorical"||J!=="number"||isFinite(se)&&Math.floor(se)===se?i!=="categorical"&&J==="number"&&c!==void 0&&se<c?[new rt(U.key,he,"stop domain values must appear in ascending order")]:(c=se,i==="categorical"&&se in g?[new rt(U.key,he,"stop domain values must be unique")]:(g[se]=!0,[])):[new rt(U.key,he,`integer expected, found ${se}`)]}}function _s(r){const t=(r.expressionContext==="property"?xu:Os)(Co(r.value),r.valueSpec);if(t.result==="error")return t.value.map((s=>new rt(`${r.key}${s.key}`,r.value,s.message)));const i=t.value.expression||t.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!i.outputDefined())return[new rt(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!_a(i))return[new rt(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!_a(i))return[new rt(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!Ua(i,["zoom","feature-state"]))return[new rt(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!al(i))return[new rt(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function qa(r){const t=r.key,i=r.value,s=r.valueSpec,c=[];return Array.isArray(s.values)?s.values.indexOf(Ti(i))===-1&&c.push(new rt(t,i,`expected one of [${s.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(s.values).indexOf(Ti(i))===-1&&c.push(new rt(t,i,`expected one of [${Object.keys(s.values).join(", ")}], ${JSON.stringify(i)} found`)),c}function Yu(r){return wu(Co(r.value))?_s(ao({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):vs(r)}function vs(r){const t=r.value,i=r.key;if(Pr(t)!=="array")return[new rt(i,t,`array expected, ${Pr(t)} found`)];const s=r.styleSpec;let c,m=[];if(t.length<1)return[new rt(i,t,"filter array must have at least 1 element")];switch(m=m.concat(qa({key:`${i}[0]`,value:t[0],valueSpec:s.filter_operator,style:r.style,styleSpec:r.styleSpec})),Ti(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Ti(t[1])==="$type"&&m.push(new rt(i,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&m.push(new rt(i,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(c=Pr(t[1]),c!=="string"&&m.push(new rt(`${i}[1]`,t[1],`string expected, ${c} found`)));for(let g=2;g<t.length;g++)c=Pr(t[g]),Ti(t[1])==="$type"?m=m.concat(qa({key:`${i}[${g}]`,value:t[g],valueSpec:s.geometry_type,style:r.style,styleSpec:r.styleSpec})):c!=="string"&&c!=="number"&&c!=="boolean"&&m.push(new rt(`${i}[${g}]`,t[g],`string, number, or boolean expected, ${c} found`));break;case"any":case"all":case"none":for(let g=1;g<t.length;g++)m=m.concat(vs({key:`${i}[${g}]`,value:t[g],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":c=Pr(t[1]),t.length!==2?m.push(new rt(i,t,`filter array for "${t[0]}" operator must have 2 elements`)):c!=="string"&&m.push(new rt(`${i}[1]`,t[1],`string expected, ${c} found`))}return m}function Qu(r,t){const i=r.key,s=r.validateSpec,c=r.style,m=r.styleSpec,g=r.value,_=r.objectKey,x=m[`${t}_${r.layerType}`];if(!x)return[];const k=_.match(/^(.*)-transition$/);if(t==="paint"&&k&&x[k[1]]&&x[k[1]].transition)return s({key:i,value:g,valueSpec:m.transition,style:c,styleSpec:m});const P=r.valueSpec||x[_];if(!P)return[new rt(i,g,`unknown property "${_}"`)];let R;if(Pr(g)==="string"&&sl(P)&&!P.tokens&&(R=/^{([^}]+)}$/.exec(g)))return[new rt(i,g,`"${_}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(R[1])} }\`.`)];const O=[];return r.layerType==="symbol"&&(_==="text-field"&&c&&!c.glyphs&&O.push(new rt(i,g,'use of "text-field" requires a style "glyphs" property')),_==="text-font"&&$l(Co(g))&&Ti(g.type)==="identity"&&O.push(new rt(i,g,'"text-font" does not support identity functions'))),O.concat(s({key:r.key,value:g,valueSpec:P,style:c,styleSpec:m,expressionContext:"property",propertyType:t,propertyKey:_}))}function Wl(r){return Qu(r,"paint")}function Su(r){return Qu(r,"layout")}function ni(r){let t=[];const i=r.value,s=r.key,c=r.style,m=r.styleSpec;i.type||i.ref||t.push(new rt(s,i,'either "type" or "ref" is required'));let g=Ti(i.type);const _=Ti(i.ref);if(i.id){const x=Ti(i.id);for(let k=0;k<r.arrayIndex;k++){const P=c.layers[k];Ti(P.id)===x&&t.push(new rt(s,i.id,`duplicate layer id "${i.id}", previously used at line ${P.id.__line__}`))}}if("ref"in i){let x;["type","source","source-layer","filter","layout"].forEach((k=>{k in i&&t.push(new rt(s,i[k],`"${k}" is prohibited for ref layers`))})),c.layers.forEach((k=>{Ti(k.id)===_&&(x=k)})),x?x.ref?t.push(new rt(s,i.ref,"ref cannot reference another ref layer")):g=Ti(x.type):t.push(new rt(s,i.ref,`ref layer "${_}" not found`))}else if(g!=="background")if(i.source){const x=c.sources&&c.sources[i.source],k=x&&Ti(x.type);x?k==="vector"&&g==="raster"?t.push(new rt(s,i.source,`layer "${i.id}" requires a raster source`)):k!=="raster-dem"&&g==="hillshade"?t.push(new rt(s,i.source,`layer "${i.id}" requires a raster-dem source`)):k==="raster"&&g!=="raster"?t.push(new rt(s,i.source,`layer "${i.id}" requires a vector source`)):k!=="vector"||i["source-layer"]?k==="raster-dem"&&g!=="hillshade"?t.push(new rt(s,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):g!=="line"||!i.paint||!i.paint["line-gradient"]||k==="geojson"&&x.lineMetrics||t.push(new rt(s,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new rt(s,i,`layer "${i.id}" must specify a "source-layer"`)):t.push(new rt(s,i.source,`source "${i.source}" not found`))}else t.push(new rt(s,i,'missing required property "source"'));return t=t.concat(Wn({key:s,value:i,valueSpec:m.layer,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,objectElementValidators:{"*":()=>[],type:()=>r.validateSpec({key:`${s}.type`,value:i.type,valueSpec:m.layer.type,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,object:i,objectKey:"type"}),filter:Yu,layout:x=>Wn({layer:i,key:x.key,value:x.value,style:x.style,styleSpec:x.styleSpec,validateSpec:x.validateSpec,objectElementValidators:{"*":k=>Su(ao({layerType:g},k))}}),paint:x=>Wn({layer:i,key:x.key,value:x.value,style:x.style,styleSpec:x.styleSpec,validateSpec:x.validateSpec,objectElementValidators:{"*":k=>Wl(ao({layerType:g},k))}})}})),t}function Ga(r){const t=r.value,i=r.key,s=Pr(t);return s!=="string"?[new rt(i,t,`string expected, ${s} found`)]:[]}const Us={promoteId:function({key:r,value:t}){if(Pr(t)==="string")return Ga({key:r,value:t});{const i=[];for(const s in t)i.push(...Ga({key:`${r}.${s}`,value:t[s]}));return i}}};function Ha(r){const t=r.value,i=r.key,s=r.styleSpec,c=r.style,m=r.validateSpec;if(!t.type)return[new rt(i,t,'"type" is required')];const g=Ti(t.type);let _;switch(g){case"vector":case"raster":return _=Wn({key:i,value:t,valueSpec:s[`source_${g.replace("-","_")}`],style:r.style,styleSpec:s,objectElementValidators:Us,validateSpec:m}),_;case"raster-dem":return _=(function(x){var k;const P=(k=x.sourceName)!==null&&k!==void 0?k:"",R=x.value,O=x.styleSpec,U=O.source_raster_dem,G=x.style;let J=[];const se=Pr(R);if(R===void 0)return J;if(se!=="object")return J.push(new rt("source_raster_dem",R,`object expected, ${se} found`)),J;const he=Ti(R.encoding)==="custom",Ee=["redFactor","greenFactor","blueFactor","baseShift"],ye=x.value.encoding?`"${x.value.encoding}"`:"Default";for(const ze in R)!he&&Ee.includes(ze)?J.push(new rt(ze,R[ze],`In "${P}": "${ze}" is only valid when "encoding" is set to "custom". ${ye} encoding found`)):U[ze]?J=J.concat(x.validateSpec({key:ze,value:R[ze],valueSpec:U[ze],validateSpec:x.validateSpec,style:G,styleSpec:O})):J.push(new rt(ze,R[ze],`unknown property "${ze}"`));return J})({sourceName:i,value:t,style:r.style,styleSpec:s,validateSpec:m}),_;case"geojson":if(_=Wn({key:i,value:t,valueSpec:s.source_geojson,style:c,styleSpec:s,validateSpec:m,objectElementValidators:Us}),t.cluster)for(const x in t.clusterProperties){const[k,P]=t.clusterProperties[x],R=typeof k=="string"?[k,["accumulated"],["get",x]]:k;_.push(..._s({key:`${i}.${x}.map`,value:P,expressionContext:"cluster-map"})),_.push(..._s({key:`${i}.${x}.reduce`,value:R,expressionContext:"cluster-reduce"}))}return _;case"video":return Wn({key:i,value:t,valueSpec:s.source_video,style:c,validateSpec:m,styleSpec:s});case"image":return Wn({key:i,value:t,valueSpec:s.source_image,style:c,validateSpec:m,styleSpec:s});case"canvas":return[new rt(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return qa({key:`${i}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function ku(r){const t=r.value,i=r.styleSpec,s=i.light,c=r.style;let m=[];const g=Pr(t);if(t===void 0)return m;if(g!=="object")return m=m.concat([new rt("light",t,`object expected, ${g} found`)]),m;for(const _ in t){const x=_.match(/^(.*)-transition$/);m=m.concat(x&&s[x[1]]&&s[x[1]].transition?r.validateSpec({key:_,value:t[_],valueSpec:i.transition,validateSpec:r.validateSpec,style:c,styleSpec:i}):s[_]?r.validateSpec({key:_,value:t[_],valueSpec:s[_],validateSpec:r.validateSpec,style:c,styleSpec:i}):[new rt(_,t[_],`unknown property "${_}"`)])}return m}function Xl(r){const t=r.value,i=r.styleSpec,s=i.sky,c=r.style,m=Pr(t);if(t===void 0)return[];if(m!=="object")return[new rt("sky",t,`object expected, ${m} found`)];let g=[];for(const _ in t)g=g.concat(s[_]?r.validateSpec({key:_,value:t[_],valueSpec:s[_],style:c,styleSpec:i}):[new rt(_,t[_],`unknown property "${_}"`)]);return g}function $s(r){const t=r.value,i=r.styleSpec,s=i.terrain,c=r.style;let m=[];const g=Pr(t);if(t===void 0)return m;if(g!=="object")return m=m.concat([new rt("terrain",t,`object expected, ${g} found`)]),m;for(const _ in t)m=m.concat(s[_]?r.validateSpec({key:_,value:t[_],valueSpec:s[_],validateSpec:r.validateSpec,style:c,styleSpec:i}):[new rt(_,t[_],`unknown property "${_}"`)]);return m}function dl(r){let t=[];const i=r.value,s=r.key;if(Array.isArray(i)){const c=[],m=[];for(const g in i)i[g].id&&c.includes(i[g].id)&&t.push(new rt(s,i,`all the sprites' ids must be unique, but ${i[g].id} is duplicated`)),c.push(i[g].id),i[g].url&&m.includes(i[g].url)&&t.push(new rt(s,i,`all the sprites' URLs must be unique, but ${i[g].url} is duplicated`)),m.push(i[g].url),t=t.concat(Wn({key:`${s}[${g}]`,value:i[g],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:r.validateSpec}));return t}return Ga({key:s,value:i})}const Wa={"*":()=>[],array:cl,boolean:function(r){const t=r.value,i=r.key,s=Pr(t);return s!=="boolean"?[new rt(i,t,`boolean expected, ${s} found`)]:[]},number:wa,color:function(r){const t=r.key,i=r.value,s=Pr(i);return s!=="string"?[new rt(t,i,`color expected, ${s} found`)]:Xt.parse(String(i))?[]:[new rt(t,i,`color expected, "${i}" found`)]},constants:Ju,enum:qa,filter:Yu,function:hl,layer:ni,object:Wn,source:Ha,light:ku,sky:Xl,terrain:$s,projection:function(r){const t=r.value,i=r.styleSpec,s=i.projection,c=r.style,m=Pr(t);if(t===void 0)return[];if(m!=="object")return[new rt("projection",t,`object expected, ${m} found`)];let g=[];for(const _ in t)g=g.concat(s[_]?r.validateSpec({key:_,value:t[_],valueSpec:s[_],style:c,styleSpec:i}):[new rt(_,t[_],`unknown property "${_}"`)]);return g},string:Ga,formatted:function(r){return Ga(r).length===0?[]:_s(r)},resolvedImage:function(r){return Ga(r).length===0?[]:_s(r)},padding:function(r){const t=r.key,i=r.value;if(Pr(i)==="array"){if(i.length<1||i.length>4)return[new rt(t,i,`padding requires 1 to 4 values; ${i.length} values found`)];const s={type:"number"};let c=[];for(let m=0;m<i.length;m++)c=c.concat(r.validateSpec({key:`${t}[${m}]`,value:i[m],validateSpec:r.validateSpec,valueSpec:s}));return c}return wa({key:t,value:i,valueSpec:{}})},variableAnchorOffsetCollection:function(r){const t=r.key,i=r.value,s=Pr(i),c=r.styleSpec;if(s!=="array"||i.length<1||i.length%2!=0)return[new rt(t,i,"variableAnchorOffsetCollection requires a non-empty array of even length")];let m=[];for(let g=0;g<i.length;g+=2)m=m.concat(qa({key:`${t}[${g}]`,value:i[g],valueSpec:c.layout_symbol["text-anchor"]})),m=m.concat(cl({key:`${t}[${g+1}]`,value:i[g+1],valueSpec:{length:2,value:"number"},validateSpec:r.validateSpec,style:r.style,styleSpec:c}));return m},sprite:dl};function pl(r){const t=r.value,i=r.valueSpec,s=r.styleSpec;return r.validateSpec=pl,i.expression&&$l(Ti(t))?hl(r):i.expression&&gs(Co(t))?_s(r):i.type&&Wa[i.type]?Wa[i.type](r):Wn(ao({},r,{valueSpec:i.type?s[i.type]:i}))}function Uc(r){const t=r.value,i=r.key,s=Ga(r);return s.length||(t.indexOf("{fontstack}")===-1&&s.push(new rt(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&s.push(new rt(i,t,'"glyphs" url must include a "{range}" token'))),s}function Io(r,t=Fe){let i=[];return i=i.concat(pl({key:"",value:r,valueSpec:t.$root,styleSpec:t,style:r,validateSpec:pl,objectElementValidators:{glyphs:Uc,"*":()=>[]}})),r.constants&&(i=i.concat(Ju({key:"constants",value:r.constants}))),fl(i)}function Wo(r){return function(t){return r({...t,validateSpec:pl})}}function fl(r){return[].concat(r).sort(((t,i)=>t.line-i.line))}function Xn(r){return function(...t){return fl(r.apply(this,t))}}Io.source=Xn(Wo(Ha)),Io.sprite=Xn(Wo(dl)),Io.glyphs=Xn(Wo(Uc)),Io.light=Xn(Wo(ku)),Io.sky=Xn(Wo(Xl)),Io.terrain=Xn(Wo($s)),Io.layer=Xn(Wo(ni)),Io.filter=Xn(Wo(Yu)),Io.paintProperty=Xn(Wo(Wl)),Io.layoutProperty=Xn(Wo(Su));const Xa=Io,ec=Xa.light,tc=Xa.sky,Tu=Xa.paintProperty,$c=Xa.layoutProperty;function zu(r,t){let i=!1;if(t&&t.length)for(const s of t)r.fire(new wo(new Error(s.message))),i=!0;return i}class ml{constructor(t,i,s){const c=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const g=new Int32Array(this.arrayBuffer);t=g[0],this.d=(i=g[1])+2*(s=g[2]);for(let x=0;x<this.d*this.d;x++){const k=g[3+x],P=g[3+x+1];c.push(k===P?null:g.subarray(k,P))}const _=g[3+c.length+1];this.keys=g.subarray(g[3+c.length],_),this.bboxes=g.subarray(_),this.insert=this._insertReadonly}else{this.d=i+2*s;for(let g=0;g<this.d*this.d;g++)c.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=t,this.padding=s,this.scale=i/t,this.uid=0;const m=s/i*t;this.min=-m,this.max=t+m}insert(t,i,s,c,m){this._forEachCell(i,s,c,m,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(i),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(m)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,i,s,c,m,g){this.cells[m].push(g)}query(t,i,s,c,m){const g=this.min,_=this.max;if(t<=g&&i<=g&&_<=s&&_<=c&&!m)return Array.prototype.slice.call(this.keys);{const x=[];return this._forEachCell(t,i,s,c,this._queryCell,x,{},m),x}}_queryCell(t,i,s,c,m,g,_,x){const k=this.cells[m];if(k!==null){const P=this.keys,R=this.bboxes;for(let O=0;O<k.length;O++){const U=k[O];if(_[U]===void 0){const G=4*U;(x?x(R[G+0],R[G+1],R[G+2],R[G+3]):t<=R[G+2]&&i<=R[G+3]&&s>=R[G+0]&&c>=R[G+1])?(_[U]=!0,g.push(P[U])):_[U]=!1}}}}_forEachCell(t,i,s,c,m,g,_,x){const k=this._convertToCellCoord(t),P=this._convertToCellCoord(i),R=this._convertToCellCoord(s),O=this._convertToCellCoord(c);for(let U=k;U<=R;U++)for(let G=P;G<=O;G++){const J=this.d*G+U;if((!x||x(this._convertFromCellCoord(U),this._convertFromCellCoord(G),this._convertFromCellCoord(U+1),this._convertFromCellCoord(G+1)))&&m.call(this,t,i,s,c,J,g,_,x))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,i=3+this.cells.length+1+1;let s=0;for(let g=0;g<this.cells.length;g++)s+=this.cells[g].length;const c=new Int32Array(i+s+this.keys.length+this.bboxes.length);c[0]=this.extent,c[1]=this.n,c[2]=this.padding;let m=i;for(let g=0;g<t.length;g++){const _=t[g];c[3+g]=m,c.set(_,m),m+=_.length}return c[3+t.length]=m,c.set(this.keys,m),m+=this.keys.length,c[3+t.length+1]=m,c.set(this.bboxes,m),m+=this.bboxes.length,c.buffer}static serialize(t,i){const s=t.toArrayBuffer();return i&&i.push(s),{buffer:s}}static deserialize(t){return new ml(t.buffer)}}const Po={};function wt(r,t,i={}){if(Po[r])throw new Error(`${r} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:r,writeable:!1}),Po[r]={klass:t,omit:i.omit||[],shallow:i.shallow||[]}}wt("Object",Object),wt("TransferableGridIndex",ml),wt("Color",Xt),wt("Error",Error),wt("AJAXError",tr),wt("ResolvedImage",Hi),wt("StylePropertyFunction",ys),wt("StyleExpression",Hn,{omit:["_evaluator"]}),wt("ZoomDependentExpression",js),wt("ZoomConstantExpression",Ns),wt("CompoundExpression",Tn,{omit:["_evaluate"]});for(const r in Va)Va[r]._classRegistryKey||wt(`Expression_${r}`,Va[r]);function Xo(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function Eu(r){return r.$name||r.constructor._classRegistryKey}function Zs(r){return!(function(t){if(t===null||typeof t!="object")return!1;const i=Eu(t);return!(!i||i==="Object")})(r)&&(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||r instanceof Error||Xo(r)||wr(r)||ArrayBuffer.isView(r)||r instanceof ImageData)}function Fn(r,t){if(Zs(r))return(Xo(r)||wr(r))&&t&&t.push(r),ArrayBuffer.isView(r)&&t&&t.push(r.buffer),r instanceof ImageData&&t&&t.push(r.data.buffer),r;if(Array.isArray(r)){const m=[];for(const g of r)m.push(Fn(g,t));return m}if(typeof r!="object")throw new Error("can't serialize object of type "+typeof r);const i=Eu(r);if(!i)throw new Error(`can't serialize object of unregistered class ${r.constructor.name}`);if(!Po[i])throw new Error(`${i} is not registered.`);const{klass:s}=Po[i],c=s.serialize?s.serialize(r,t):{};if(s.serialize){if(t&&c===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const m in r){if(!r.hasOwnProperty(m)||Po[i].omit.indexOf(m)>=0)continue;const g=r[m];c[m]=Po[i].shallow.indexOf(m)>=0?g:Fn(g,t)}r instanceof Error&&(c.message=r.message)}if(c.$name)throw new Error("$name property is reserved for worker serialization logic.");return i!=="Object"&&(c.$name=i),c}function ba(r){if(Zs(r))return r;if(Array.isArray(r))return r.map(ba);if(typeof r!="object")throw new Error("can't deserialize object of type "+typeof r);const t=Eu(r)||"Object";if(!Po[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:i}=Po[t];if(!i)throw new Error(`can't deserialize unregistered class ${t}`);if(i.deserialize)return i.deserialize(r);const s=Object.create(i.prototype);for(const c of Object.keys(r)){if(c==="$name")continue;const m=r[c];s[c]=Po[t].shallow.indexOf(c)>=0?m:ba(m)}return s}class Ko{constructor(){this.first=!0}update(t,i){const s=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=s,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=s,!0):(this.lastFloorZoom>s?(this.lastIntegerZoom=s+1,this.lastIntegerZoomTime=i):this.lastFloorZoom<s&&(this.lastIntegerZoom=s,this.lastIntegerZoomTime=i),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=s,!0))}}const vr={"Latin-1 Supplement":r=>r>=128&&r<=255,"Hangul Jamo":r=>r>=4352&&r<=4607,Khmer:r=>r>=6016&&r<=6143,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Katakana:r=>r>=12448&&r<=12543,Kanbun:r=>r>=12688&&r<=12703,"CJK Strokes":r=>r>=12736&&r<=12783,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"Private Use Area":r=>r>=57344&&r<=63743,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function rc(r){for(const t of r)if(Yl(t.charCodeAt(0)))return!0;return!1}function Ih(r){for(const t of r)if(!Jo(t.charCodeAt(0)))return!1;return!0}function Ka(r){const t=r.map((i=>{try{return new RegExp(`\\p{sc=${i}}`,"u").source}catch{return null}})).filter((i=>i));return new RegExp(t.join("|"),"u")}const Kl=Ka(["Arab","Dupl","Mong","Ougr","Syrc"]);function Jo(r){return!Kl.test(String.fromCodePoint(r))}const Jl=Ka(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Yl(r){return!(r!==746&&r!==747&&(r<4352||!(vr["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||vr["CJK Compatibility"](r)||vr["CJK Strokes"](r)||!(!vr["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||vr["Enclosed CJK Letters and Months"](r)||vr["Ideographic Description Characters"](r)||vr.Kanbun(r)||vr.Katakana(r)&&r!==12540||!(!vr["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!vr["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||vr["Vertical Forms"](r)||vr["Yijing Hexagram Symbols"](r)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(r))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(r))||Jl.test(String.fromCodePoint(r)))))}function qs(r){return!(Yl(r)||(function(t){return!!(vr["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||vr["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||vr["Letterlike Symbols"](t)||vr["Number Forms"](t)||vr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||vr["Control Pictures"](t)&&t!==9251||vr["Optical Character Recognition"](t)||vr["Enclosed Alphanumerics"](t)||vr["Geometric Shapes"](t)||vr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||vr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||vr["CJK Symbols and Punctuation"](t)||vr.Katakana(t)||vr["Private Use Area"](t)||vr["CJK Compatibility Forms"](t)||vr["Small Form Variants"](t)||vr["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)})(r))}const xs=Ka(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function oi(r){return xs.test(String.fromCodePoint(r))}function ui(r,t){return!(!t&&oi(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||vr.Khmer(r))}function ws(r){for(const t of r)if(oi(t.charCodeAt(0)))return!0;return!1}const Jr=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(r){this.pluginStatus=r.pluginStatus,this.pluginURL=r.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(r){this.applyArabicShaping=r.applyArabicShaping,this.processBidirectionalText=r.processBidirectionalText,this.processStyledBidirectionalText=r.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class Sr{constructor(t,i){this.zoom=t,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.zoomHistory=i.zoomHistory,this.transition=i.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ko,this.transition={})}isSupportedScript(t){return(function(i,s){for(const c of i)if(!ui(c.charCodeAt(0),s))return!1;return!0})(t,Jr.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,i=t-Math.floor(t),s=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:i+(1-i)*s}:{fromScale:.5,toScale:1,t:1-(1-s)*i}}}class Mo{constructor(t,i){this.property=t,this.value=i,this.expression=(function(s,c){if($l(s))return new ys(s,c);if(gs(s)){const m=xu(s,c);if(m.result==="error")throw new Error(m.value.map((g=>`${g.key}: ${g.message}`)).join(", "));return m.value}{let m=s;return c.type==="color"&&typeof s=="string"?m=Xt.parse(s):c.type!=="padding"||typeof s!="number"&&!Array.isArray(s)?c.type==="variableAnchorOffsetCollection"&&Array.isArray(s)&&(m=Dn.parse(s)):m=tn.parse(s),{kind:"constant",evaluate:()=>m}}})(i===void 0?t.specification.default:i,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,i,s){return this.property.possiblyEvaluate(this,t,i,s)}}class Ja{constructor(t){this.property=t,this.value=new Mo(t,void 0)}transitioned(t,i){return new Ql(this.property,this.value,i,Vt({},t.transition,this.transition),t.now)}untransitioned(){return new Ql(this.property,this.value,null,{},0)}}class mn{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return Et(this._values[t].value.value)}setValue(t,i){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Ja(this._values[t].property)),this._values[t].value=new Mo(this._values[t].property,i===null?void 0:Et(i))}getTransition(t){return Et(this._values[t].transition)}setTransition(t,i){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Ja(this._values[t].property)),this._values[t].transition=Et(i)||void 0}serialize(){const t={};for(const i of Object.keys(this._values)){const s=this.getValue(i);s!==void 0&&(t[i]=s);const c=this.getTransition(i);c!==void 0&&(t[`${i}-transition`]=c)}return t}transitioned(t,i){const s=new gl(this._properties);for(const c of Object.keys(this._values))s._values[c]=this._values[c].transitioned(t,i._values[c]);return s}untransitioned(){const t=new gl(this._properties);for(const i of Object.keys(this._values))t._values[i]=this._values[i].untransitioned();return t}}class Ql{constructor(t,i,s,c,m){this.property=t,this.value=i,this.begin=m+c.delay||0,this.end=this.begin+c.duration||0,t.specification.transition&&(c.delay||c.duration)&&(this.prior=s)}possiblyEvaluate(t,i,s){const c=t.now||0,m=this.value.possiblyEvaluate(t,i,s),g=this.prior;if(g){if(c>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(c<this.begin)return g.possiblyEvaluate(t,i,s);{const _=(c-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(t,i,s),m,(function(x){if(x<=0)return 0;if(x>=1)return 1;const k=x*x,P=k*x;return 4*(x<.5?P:3*(x-k)+P-.75)})(_))}}return m}}class gl{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,i,s){const c=new _l(this._properties);for(const m of Object.keys(this._values))c._values[m]=this._values[m].possiblyEvaluate(t,i,s);return c}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class yl{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return Et(this._values[t].value)}setValue(t,i){this._values[t]=new Mo(this._values[t].property,i===null?void 0:Et(i))}serialize(){const t={};for(const i of Object.keys(this._values)){const s=this.getValue(i);s!==void 0&&(t[i]=s)}return t}possiblyEvaluate(t,i,s){const c=new _l(this._properties);for(const m of Object.keys(this._values))c._values[m]=this._values[m].possiblyEvaluate(t,i,s);return c}}class co{constructor(t,i,s){this.property=t,this.value=i,this.parameters=s}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,i,s,c){return this.property.evaluate(this.value,this.parameters,t,i,s,c)}}class _l{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class bt{constructor(t){this.specification=t}possiblyEvaluate(t,i){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(i)}interpolate(t,i,s){const c=ki[this.specification.type];return c?c(t,i,s):t}}class Nt{constructor(t,i){this.specification=t,this.overrides=i}possiblyEvaluate(t,i,s,c){return new co(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(i,null,{},s,c)}:t.expression,i)}interpolate(t,i,s){if(t.value.kind!=="constant"||i.value.kind!=="constant")return t;if(t.value.value===void 0||i.value.value===void 0)return new co(this,{kind:"constant",value:void 0},t.parameters);const c=ki[this.specification.type];if(c){const m=c(t.value.value,i.value.value,s);return new co(this,{kind:"constant",value:m},t.parameters)}return t}evaluate(t,i,s,c,m,g){return t.kind==="constant"?t.value:t.evaluate(i,s,c,m,g)}}class vl extends Nt{possiblyEvaluate(t,i,s,c){if(t.value===void 0)return new co(this,{kind:"constant",value:void 0},i);if(t.expression.kind==="constant"){const m=t.expression.evaluate(i,null,{},s,c),g=t.property.specification.type==="resolvedImage"&&typeof m!="string"?m.name:m,_=this._calculate(g,g,g,i);return new co(this,{kind:"constant",value:_},i)}if(t.expression.kind==="camera"){const m=this._calculate(t.expression.evaluate({zoom:i.zoom-1}),t.expression.evaluate({zoom:i.zoom}),t.expression.evaluate({zoom:i.zoom+1}),i);return new co(this,{kind:"constant",value:m},i)}return new co(this,t.expression,i)}evaluate(t,i,s,c,m,g){if(t.kind==="source"){const _=t.evaluate(i,s,c,m,g);return this._calculate(_,_,_,i)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(i.zoom)-1},s,c),t.evaluate({zoom:Math.floor(i.zoom)},s,c),t.evaluate({zoom:Math.floor(i.zoom)+1},s,c),i):t.value}_calculate(t,i,s,c){return c.zoom>c.zoomHistory.lastIntegerZoom?{from:t,to:i}:{from:s,to:i}}interpolate(t){return t}}class eu{constructor(t){this.specification=t}possiblyEvaluate(t,i,s,c){if(t.value!==void 0){if(t.expression.kind==="constant"){const m=t.expression.evaluate(i,null,{},s,c);return this._calculate(m,m,m,i)}return this._calculate(t.expression.evaluate(new Sr(Math.floor(i.zoom-1),i)),t.expression.evaluate(new Sr(Math.floor(i.zoom),i)),t.expression.evaluate(new Sr(Math.floor(i.zoom+1),i)),i)}}_calculate(t,i,s,c){return c.zoom>c.zoomHistory.lastIntegerZoom?{from:t,to:i}:{from:s,to:i}}interpolate(t){return t}}class ic{constructor(t){this.specification=t}possiblyEvaluate(t,i,s,c){return!!t.expression.evaluate(i,null,{},s,c)}interpolate(){return!1}}class f{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const i in t){const s=t[i];s.specification.overridable&&this.overridableProperties.push(i);const c=this.defaultPropertyValues[i]=new Mo(s,void 0),m=this.defaultTransitionablePropertyValues[i]=new Ja(s);this.defaultTransitioningPropertyValues[i]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[i]=c.possiblyEvaluate({})}}}wt("DataDrivenProperty",Nt),wt("DataConstantProperty",bt),wt("CrossFadedDataDrivenProperty",vl),wt("CrossFadedProperty",eu),wt("ColorRampProperty",ic);const e="-transition";class o extends Ia{constructor(t,i){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),i.layout&&(this._unevaluatedLayout=new yl(i.layout)),i.paint)){this._transitionablePaint=new mn(i.paint);for(const s in t.paint)this.setPaintProperty(s,t.paint[s],{validate:!1});for(const s in t.layout)this.setLayoutProperty(s,t.layout[s],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new _l(i.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,i,s={}){i!=null&&this._validate($c,`layers.${this.id}.layout.${t}`,t,i,s)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,i):this.visibility=i)}getPaintProperty(t){return t.endsWith(e)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,i,s={}){if(i!=null&&this._validate(Tu,`layers.${this.id}.paint.${t}`,t,i,s))return!1;if(t.endsWith(e))return this._transitionablePaint.setTransition(t.slice(0,-11),i||void 0),!1;{const c=this._transitionablePaint._values[t],m=c.property.specification["property-type"]==="cross-faded-data-driven",g=c.value.isDataDriven(),_=c.value;this._transitionablePaint.setValue(t,i),this._handleSpecialPaintPropertyUpdate(t);const x=this._transitionablePaint._values[t].value;return x.isDataDriven()||g||m||this._handleOverridablePaintPropertyUpdate(t,_,x)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,i,s){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,i){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,i)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),Br(t,((i,s)=>!(i===void 0||s==="layout"&&!Object.keys(i).length||s==="paint"&&!Object.keys(i).length)))}_validate(t,i,s,c,m={}){return(!m||m.validate!==!1)&&zu(this,t.call(Xa,{key:i,layerType:this.type,objectKey:s,value:c,styleSpec:Fe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const i=this.paint.get(t);if(i instanceof co&&sl(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}}const l={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class u{constructor(t,i){this._structArray=t,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class p{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,i){return t._trim(),i&&(t.isTransferred=!0,i.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const i=Object.create(this.prototype);return i.arrayBuffer=t.arrayBuffer,i.length=t.length,i.capacity=t.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function v(r,t=1){let i=0,s=0;return{members:r.map((c=>{const m=l[c.type].BYTES_PER_ELEMENT,g=i=w(i,Math.max(t,m)),_=c.components||1;return s=Math.max(s,m),i+=m*_,{name:c.name,type:c.type,components:_,offset:g}})),size:w(i,Math.max(s,t)),alignment:t}}function w(r,t){return Math.ceil(r/t)*t}class S extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i){const s=this.length;return this.resize(s+1),this.emplace(s,t,i)}emplace(t,i,s){const c=2*t;return this.int16[c+0]=i,this.int16[c+1]=s,t}}S.prototype.bytesPerElement=4,wt("StructArrayLayout2i4",S);class C extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,s){const c=this.length;return this.resize(c+1),this.emplace(c,t,i,s)}emplace(t,i,s,c){const m=3*t;return this.int16[m+0]=i,this.int16[m+1]=s,this.int16[m+2]=c,t}}C.prototype.bytesPerElement=6,wt("StructArrayLayout3i6",C);class F extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,s,c){const m=this.length;return this.resize(m+1),this.emplace(m,t,i,s,c)}emplace(t,i,s,c,m){const g=4*t;return this.int16[g+0]=i,this.int16[g+1]=s,this.int16[g+2]=c,this.int16[g+3]=m,t}}F.prototype.bytesPerElement=8,wt("StructArrayLayout4i8",F);class B extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,s,c,m,g){const _=this.length;return this.resize(_+1),this.emplace(_,t,i,s,c,m,g)}emplace(t,i,s,c,m,g,_){const x=6*t;return this.int16[x+0]=i,this.int16[x+1]=s,this.int16[x+2]=c,this.int16[x+3]=m,this.int16[x+4]=g,this.int16[x+5]=_,t}}B.prototype.bytesPerElement=12,wt("StructArrayLayout2i4i12",B);class $ extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,s,c,m,g){const _=this.length;return this.resize(_+1),this.emplace(_,t,i,s,c,m,g)}emplace(t,i,s,c,m,g,_){const x=4*t,k=8*t;return this.int16[x+0]=i,this.int16[x+1]=s,this.uint8[k+4]=c,this.uint8[k+5]=m,this.uint8[k+6]=g,this.uint8[k+7]=_,t}}$.prototype.bytesPerElement=8,wt("StructArrayLayout2i4ub8",$);class K extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i){const s=this.length;return this.resize(s+1),this.emplace(s,t,i)}emplace(t,i,s){const c=2*t;return this.float32[c+0]=i,this.float32[c+1]=s,t}}K.prototype.bytesPerElement=8,wt("StructArrayLayout2f8",K);class Q extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,s,c,m,g,_,x,k,P){const R=this.length;return this.resize(R+1),this.emplace(R,t,i,s,c,m,g,_,x,k,P)}emplace(t,i,s,c,m,g,_,x,k,P,R){const O=10*t;return this.uint16[O+0]=i,this.uint16[O+1]=s,this.uint16[O+2]=c,this.uint16[O+3]=m,this.uint16[O+4]=g,this.uint16[O+5]=_,this.uint16[O+6]=x,this.uint16[O+7]=k,this.uint16[O+8]=P,this.uint16[O+9]=R,t}}Q.prototype.bytesPerElement=20,wt("StructArrayLayout10ui20",Q);class te extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,s,c,m,g,_,x,k,P,R,O){const U=this.length;return this.resize(U+1),this.emplace(U,t,i,s,c,m,g,_,x,k,P,R,O)}emplace(t,i,s,c,m,g,_,x,k,P,R,O,U){const G=12*t;return this.int16[G+0]=i,this.int16[G+1]=s,this.int16[G+2]=c,this.int16[G+3]=m,this.uint16[G+4]=g,this.uint16[G+5]=_,this.uint16[G+6]=x,this.uint16[G+7]=k,this.int16[G+8]=P,this.int16[G+9]=R,this.int16[G+10]=O,this.int16[G+11]=U,t}}te.prototype.bytesPerElement=24,wt("StructArrayLayout4i4ui4i24",te);class ae extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,s){const c=this.length;return this.resize(c+1),this.emplace(c,t,i,s)}emplace(t,i,s,c){const m=3*t;return this.float32[m+0]=i,this.float32[m+1]=s,this.float32[m+2]=c,t}}ae.prototype.bytesPerElement=12,wt("StructArrayLayout3f12",ae);class ue extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint32[1*t+0]=i,t}}ue.prototype.bytesPerElement=4,wt("StructArrayLayout1ul4",ue);class me extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,s,c,m,g,_,x,k){const P=this.length;return this.resize(P+1),this.emplace(P,t,i,s,c,m,g,_,x,k)}emplace(t,i,s,c,m,g,_,x,k,P){const R=10*t,O=5*t;return this.int16[R+0]=i,this.int16[R+1]=s,this.int16[R+2]=c,this.int16[R+3]=m,this.int16[R+4]=g,this.int16[R+5]=_,this.uint32[O+3]=x,this.uint16[R+8]=k,this.uint16[R+9]=P,t}}me.prototype.bytesPerElement=20,wt("StructArrayLayout6i1ul2ui20",me);class ie extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,s,c,m,g){const _=this.length;return this.resize(_+1),this.emplace(_,t,i,s,c,m,g)}emplace(t,i,s,c,m,g,_){const x=6*t;return this.int16[x+0]=i,this.int16[x+1]=s,this.int16[x+2]=c,this.int16[x+3]=m,this.int16[x+4]=g,this.int16[x+5]=_,t}}ie.prototype.bytesPerElement=12,wt("StructArrayLayout2i2i2i12",ie);class ve extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,s,c,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,i,s,c,m)}emplace(t,i,s,c,m,g){const _=4*t,x=8*t;return this.float32[_+0]=i,this.float32[_+1]=s,this.float32[_+2]=c,this.int16[x+6]=m,this.int16[x+7]=g,t}}ve.prototype.bytesPerElement=16,wt("StructArrayLayout2f1f2i16",ve);class be extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,s,c,m,g){const _=this.length;return this.resize(_+1),this.emplace(_,t,i,s,c,m,g)}emplace(t,i,s,c,m,g,_){const x=16*t,k=4*t,P=8*t;return this.uint8[x+0]=i,this.uint8[x+1]=s,this.float32[k+1]=c,this.float32[k+2]=m,this.int16[P+6]=g,this.int16[P+7]=_,t}}be.prototype.bytesPerElement=16,wt("StructArrayLayout2ub2f2i16",be);class Ie extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,s){const c=this.length;return this.resize(c+1),this.emplace(c,t,i,s)}emplace(t,i,s,c){const m=3*t;return this.uint16[m+0]=i,this.uint16[m+1]=s,this.uint16[m+2]=c,t}}Ie.prototype.bytesPerElement=6,wt("StructArrayLayout3ui6",Ie);class Ue extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,s,c,m,g,_,x,k,P,R,O,U,G,J,se,he){const Ee=this.length;return this.resize(Ee+1),this.emplace(Ee,t,i,s,c,m,g,_,x,k,P,R,O,U,G,J,se,he)}emplace(t,i,s,c,m,g,_,x,k,P,R,O,U,G,J,se,he,Ee){const ye=24*t,ze=12*t,Oe=48*t;return this.int16[ye+0]=i,this.int16[ye+1]=s,this.uint16[ye+2]=c,this.uint16[ye+3]=m,this.uint32[ze+2]=g,this.uint32[ze+3]=_,this.uint32[ze+4]=x,this.uint16[ye+10]=k,this.uint16[ye+11]=P,this.uint16[ye+12]=R,this.float32[ze+7]=O,this.float32[ze+8]=U,this.uint8[Oe+36]=G,this.uint8[Oe+37]=J,this.uint8[Oe+38]=se,this.uint32[ze+10]=he,this.int16[ye+22]=Ee,t}}Ue.prototype.bytesPerElement=48,wt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ue);class tt extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,s,c,m,g,_,x,k,P,R,O,U,G,J,se,he,Ee,ye,ze,Oe,Je,vt,qt,_t,pt,Rt,It){const kt=this.length;return this.resize(kt+1),this.emplace(kt,t,i,s,c,m,g,_,x,k,P,R,O,U,G,J,se,he,Ee,ye,ze,Oe,Je,vt,qt,_t,pt,Rt,It)}emplace(t,i,s,c,m,g,_,x,k,P,R,O,U,G,J,se,he,Ee,ye,ze,Oe,Je,vt,qt,_t,pt,Rt,It,kt){const Ve=32*t,Bt=16*t;return this.int16[Ve+0]=i,this.int16[Ve+1]=s,this.int16[Ve+2]=c,this.int16[Ve+3]=m,this.int16[Ve+4]=g,this.int16[Ve+5]=_,this.int16[Ve+6]=x,this.int16[Ve+7]=k,this.uint16[Ve+8]=P,this.uint16[Ve+9]=R,this.uint16[Ve+10]=O,this.uint16[Ve+11]=U,this.uint16[Ve+12]=G,this.uint16[Ve+13]=J,this.uint16[Ve+14]=se,this.uint16[Ve+15]=he,this.uint16[Ve+16]=Ee,this.uint16[Ve+17]=ye,this.uint16[Ve+18]=ze,this.uint16[Ve+19]=Oe,this.uint16[Ve+20]=Je,this.uint16[Ve+21]=vt,this.uint16[Ve+22]=qt,this.uint32[Bt+12]=_t,this.float32[Bt+13]=pt,this.float32[Bt+14]=Rt,this.uint16[Ve+30]=It,this.uint16[Ve+31]=kt,t}}tt.prototype.bytesPerElement=64,wt("StructArrayLayout8i15ui1ul2f2ui64",tt);class lt extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.float32[1*t+0]=i,t}}lt.prototype.bytesPerElement=4,wt("StructArrayLayout1f4",lt);class gt extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,s){const c=this.length;return this.resize(c+1),this.emplace(c,t,i,s)}emplace(t,i,s,c){const m=3*t;return this.uint16[6*t+0]=i,this.float32[m+1]=s,this.float32[m+2]=c,t}}gt.prototype.bytesPerElement=12,wt("StructArrayLayout1ui2f12",gt);class ut extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,s){const c=this.length;return this.resize(c+1),this.emplace(c,t,i,s)}emplace(t,i,s,c){const m=4*t;return this.uint32[2*t+0]=i,this.uint16[m+2]=s,this.uint16[m+3]=c,t}}ut.prototype.bytesPerElement=8,wt("StructArrayLayout1ul2ui8",ut);class ot extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i){const s=this.length;return this.resize(s+1),this.emplace(s,t,i)}emplace(t,i,s){const c=2*t;return this.uint16[c+0]=i,this.uint16[c+1]=s,t}}ot.prototype.bytesPerElement=4,wt("StructArrayLayout2ui4",ot);class zt extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint16[1*t+0]=i,t}}zt.prototype.bytesPerElement=2,wt("StructArrayLayout1ui2",zt);class Jt extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,s,c){const m=this.length;return this.resize(m+1),this.emplace(m,t,i,s,c)}emplace(t,i,s,c,m){const g=4*t;return this.float32[g+0]=i,this.float32[g+1]=s,this.float32[g+2]=c,this.float32[g+3]=m,t}}Jt.prototype.bytesPerElement=16,wt("StructArrayLayout4f16",Jt);class ct extends u{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new re(this.anchorPointX,this.anchorPointY)}}ct.prototype.size=20;class dt extends me{get(t){return new ct(this,t)}}wt("CollisionBoxArray",dt);class Wt extends u{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Wt.prototype.size=48;class Gr extends Ue{get(t){return new Wt(this,t)}}wt("PlacedSymbolArray",Gr);class or extends u{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}or.prototype.size=64;class dr extends tt{get(t){return new or(this,t)}}wt("SymbolInstanceArray",dr);class Yr extends lt{getoffsetX(t){return this.float32[1*t+0]}}wt("GlyphOffsetArray",Yr);class on extends C{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}wt("SymbolLineVertexArray",on);class ho extends u{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ho.prototype.size=12;class Qr extends gt{get(t){return new ho(this,t)}}wt("TextAnchorOffsetArray",Qr);class Xi extends u{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Xi.prototype.size=8;class ci extends ut{get(t){return new Xi(this,t)}}wt("FeatureIndexArray",ci);class Ci extends S{}class gn extends S{}class Yo extends S{}class Kn extends B{}class Qo extends ${}class bs extends K{}class po extends Q{}class Ao extends te{}class Sa extends ae{}class Bn extends ue{}class fo extends ie{}class ea extends be{}class Do extends Ie{}class Ri extends ot{}const fi=v([{name:"a_pos",components:2,type:"Int16"}],4),{members:yn}=fi;class mr{constructor(t=[]){this.segments=t}prepareSegment(t,i,s,c){let m=this.segments[this.segments.length-1];return t>mr.MAX_VERTEX_ARRAY_LENGTH&&kr(`Max vertices per segment is ${mr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!m||m.vertexLength+t>mr.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==c)&&(m={vertexOffset:i.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0},c!==void 0&&(m.sortKey=c),this.segments.push(m)),m}get(){return this.segments}destroy(){for(const t of this.segments)for(const i in t.vaos)t.vaos[i].destroy()}static simpleSegment(t,i,s,c){return new mr([{vertexOffset:t,primitiveOffset:i,vertexLength:s,primitiveLength:c,vaos:{},sortKey:0}])}}function mo(r,t){return 256*(r=ur(Math.floor(r),0,255))+ur(Math.floor(t),0,255)}mr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,wt("SegmentVector",mr);const Ss=v([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ta={exports:{}},nc={exports:{}};nc.exports=function(r,t){var i,s,c,m,g,_,x,k;for(s=r.length-(i=3&r.length),c=t,g=3432918353,_=461845907,k=0;k<s;)x=255&r.charCodeAt(k)|(255&r.charCodeAt(++k))<<8|(255&r.charCodeAt(++k))<<16|(255&r.charCodeAt(++k))<<24,++k,c=27492+(65535&(m=5*(65535&(c=(c^=x=(65535&(x=(x=(65535&x)*g+(((x>>>16)*g&65535)<<16)&4294967295)<<15|x>>>17))*_+(((x>>>16)*_&65535)<<16)&4294967295)<<13|c>>>19))+((5*(c>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(x=0,i){case 3:x^=(255&r.charCodeAt(k+2))<<16;case 2:x^=(255&r.charCodeAt(k+1))<<8;case 1:c^=x=(65535&(x=(x=(65535&(x^=255&r.charCodeAt(k)))*g+(((x>>>16)*g&65535)<<16)&4294967295)<<15|x>>>17))*_+(((x>>>16)*_&65535)<<16)&4294967295}return c^=r.length,c=2246822507*(65535&(c^=c>>>16))+((2246822507*(c>>>16)&65535)<<16)&4294967295,c=3266489909*(65535&(c^=c>>>13))+((3266489909*(c>>>16)&65535)<<16)&4294967295,(c^=c>>>16)>>>0};var oc=nc.exports,_i={exports:{}};_i.exports=function(r,t){for(var i,s=r.length,c=t^s,m=0;s>=4;)i=1540483477*(65535&(i=255&r.charCodeAt(m)|(255&r.charCodeAt(++m))<<8|(255&r.charCodeAt(++m))<<16|(255&r.charCodeAt(++m))<<24))+((1540483477*(i>>>16)&65535)<<16),c=1540483477*(65535&c)+((1540483477*(c>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),s-=4,++m;switch(s){case 3:c^=(255&r.charCodeAt(m+2))<<16;case 2:c^=(255&r.charCodeAt(m+1))<<8;case 1:c=1540483477*(65535&(c^=255&r.charCodeAt(m)))+((1540483477*(c>>>16)&65535)<<16)}return c=1540483477*(65535&(c^=c>>>13))+((1540483477*(c>>>16)&65535)<<16),(c^=c>>>15)>>>0};var ra=oc,Cu=_i.exports;ta.exports=ra,ta.exports.murmur3=ra,ta.exports.murmur2=Cu;var xl=Se(ta.exports);class ks{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,i,s,c){this.ids.push(wl(t)),this.positions.push(i,s,c)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const i=wl(t);let s=0,c=this.ids.length-1;for(;s<c;){const g=s+c>>1;this.ids[g]>=i?c=g:s=g+1}const m=[];for(;this.ids[s]===i;)m.push({index:this.positions[3*s],start:this.positions[3*s+1],end:this.positions[3*s+2]}),s++;return m}static serialize(t,i){const s=new Float64Array(t.ids),c=new Uint32Array(t.positions);return ka(s,c,0,s.length-1),i&&i.push(s.buffer,c.buffer),{ids:s,positions:c}}static deserialize(t){const i=new ks;return i.ids=t.ids,i.positions=t.positions,i.indexed=!0,i}}function wl(r){const t=+r;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:xl(String(r))}function ka(r,t,i,s){for(;i<s;){const c=r[i+s>>1];let m=i-1,g=s+1;for(;;){do m++;while(r[m]<c);do g--;while(r[g]>c);if(m>=g)break;ei(r,m,g),ei(t,3*m,3*g),ei(t,3*m+1,3*g+1),ei(t,3*m+2,3*g+2)}g-i<s-g?(ka(r,t,i,g),i=g+1):(ka(r,t,g+1,s),s=g)}}function ei(r,t,i){const s=r[t];r[t]=r[i],r[i]=s}wt("FeaturePositionMap",ks);class zi{constructor(t,i){this.gl=t.gl,this.location=i}}class Ki extends zi{constructor(t,i){super(t,i),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class ac extends zi{constructor(t,i){super(t,i),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Iu extends zi{constructor(t,i){super(t,i),this.current=Xt.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const sc=new Float32Array(16);function Ph(r){return[mo(255*r.r,255*r.g),mo(255*r.b,255*r.a)]}class an{constructor(t,i,s){this.value=t,this.uniformNames=i.map((c=>`u_${c}`)),this.type=s}setUniform(t,i,s){t.set(s.constantOr(this.value))}getBinding(t,i,s){return this.type==="color"?new Iu(t,i):new Ki(t,i)}}class bl{constructor(t,i){this.uniformNames=i.map((s=>`u_${s}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,i){this.pixelRatioFrom=i.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=i.tlbr,this.patternTo=t.tlbr}setUniform(t,i,s,c){const m=c==="u_pattern_to"?this.patternTo:c==="u_pattern_from"?this.patternFrom:c==="u_pixel_ratio_to"?this.pixelRatioTo:c==="u_pixel_ratio_from"?this.pixelRatioFrom:null;m&&t.set(m)}getBinding(t,i,s){return s.substr(0,9)==="u_pattern"?new ac(t,i):new Ki(t,i)}}class Ya{constructor(t,i,s,c){this.expression=t,this.type=s,this.maxValue=0,this.paintVertexAttributes=i.map((m=>({name:`a_${m}`,type:"Float32",components:s==="color"?2:1,offset:0}))),this.paintVertexArray=new c}populatePaintArray(t,i,s,c,m){const g=this.paintVertexArray.length,_=this.expression.evaluate(new Sr(0),i,{},c,[],m);this.paintVertexArray.resize(t),this._setPaintValue(g,t,_)}updatePaintArray(t,i,s,c){const m=this.expression.evaluate({zoom:0},s,c);this._setPaintValue(t,i,m)}_setPaintValue(t,i,s){if(this.type==="color"){const c=Ph(s);for(let m=t;m<i;m++)this.paintVertexArray.emplace(m,c[0],c[1])}else{for(let c=t;c<i;c++)this.paintVertexArray.emplace(c,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ia{constructor(t,i,s,c,m,g){this.expression=t,this.uniformNames=i.map((_=>`u_${_}_t`)),this.type=s,this.useIntegerZoom=c,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=i.map((_=>({name:`a_${_}`,type:"Float32",components:s==="color"?4:2,offset:0}))),this.paintVertexArray=new g}populatePaintArray(t,i,s,c,m){const g=this.expression.evaluate(new Sr(this.zoom),i,{},c,[],m),_=this.expression.evaluate(new Sr(this.zoom+1),i,{},c,[],m),x=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(x,t,g,_)}updatePaintArray(t,i,s,c){const m=this.expression.evaluate({zoom:this.zoom},s,c),g=this.expression.evaluate({zoom:this.zoom+1},s,c);this._setPaintValue(t,i,m,g)}_setPaintValue(t,i,s,c){if(this.type==="color"){const m=Ph(s),g=Ph(c);for(let _=t;_<i;_++)this.paintVertexArray.emplace(_,m[0],m[1],g[0],g[1])}else{for(let m=t;m<i;m++)this.paintVertexArray.emplace(m,s,c);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(c))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,i){const s=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,c=ur(this.expression.interpolationFactor(s,this.zoom,this.zoom+1),0,1);t.set(c)}getBinding(t,i,s){return new Ki(t,i)}}class On{constructor(t,i,s,c,m,g){this.expression=t,this.type=i,this.useIntegerZoom=s,this.zoom=c,this.layerId=g,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(t,i,s){const c=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(c,t,i.patterns&&i.patterns[this.layerId],s)}updatePaintArray(t,i,s,c,m){this._setPaintValues(t,i,s.patterns&&s.patterns[this.layerId],m)}_setPaintValues(t,i,s,c){if(!c||!s)return;const{min:m,mid:g,max:_}=s,x=c[m],k=c[g],P=c[_];if(x&&k&&P)for(let R=t;R<i;R++)this.zoomInPaintVertexArray.emplace(R,k.tl[0],k.tl[1],k.br[0],k.br[1],x.tl[0],x.tl[1],x.br[0],x.br[1],k.pixelRatio,x.pixelRatio),this.zoomOutPaintVertexArray.emplace(R,k.tl[0],k.tl[1],k.br[0],k.br[1],P.tl[0],P.tl[1],P.br[0],P.br[1],k.pixelRatio,P.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Ss.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Ss.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class na{constructor(t,i,s){this.binders={},this._buffers=[];const c=[];for(const m in t.paint._values){if(!s(m))continue;const g=t.paint.get(m);if(!(g instanceof co&&sl(g.property.specification)))continue;const _=Mh(m,t.type),x=g.value,k=g.property.specification.type,P=g.property.useIntegerZoom,R=g.property.specification["property-type"],O=R==="cross-faded"||R==="cross-faded-data-driven";if(x.kind==="constant")this.binders[m]=O?new bl(x.value,_):new an(x.value,_,k),c.push(`/u_${m}`);else if(x.kind==="source"||O){const U=Zc(m,k,"source");this.binders[m]=O?new On(x,k,P,i,U,t.id):new Ya(x,_,k,U),c.push(`/a_${m}`)}else{const U=Zc(m,k,"composite");this.binders[m]=new ia(x,_,k,P,i,U),c.push(`/z_${m}`)}}this.cacheKey=c.sort().join("")}getMaxValue(t){const i=this.binders[t];return i instanceof Ya||i instanceof ia?i.maxValue:0}populatePaintArrays(t,i,s,c,m){for(const g in this.binders){const _=this.binders[g];(_ instanceof Ya||_ instanceof ia||_ instanceof On)&&_.populatePaintArray(t,i,s,c,m)}}setConstantPatternPositions(t,i){for(const s in this.binders){const c=this.binders[s];c instanceof bl&&c.setConstantPatternPositions(t,i)}}updatePaintArrays(t,i,s,c,m){let g=!1;for(const _ in t){const x=i.getPositions(_);for(const k of x){const P=s.feature(k.index);for(const R in this.binders){const O=this.binders[R];if((O instanceof Ya||O instanceof ia||O instanceof On)&&O.expression.isStateDependent===!0){const U=c.paint.get(R);O.expression=U.value,O.updatePaintArray(k.start,k.end,P,t[_],m),g=!0}}}}return g}defines(){const t=[];for(const i in this.binders){const s=this.binders[i];(s instanceof an||s instanceof bl)&&t.push(...s.uniformNames.map((c=>`#define HAS_UNIFORM_${c}`)))}return t}getBinderAttributes(){const t=[];for(const i in this.binders){const s=this.binders[i];if(s instanceof Ya||s instanceof ia)for(let c=0;c<s.paintVertexAttributes.length;c++)t.push(s.paintVertexAttributes[c].name);else if(s instanceof On)for(let c=0;c<Ss.members.length;c++)t.push(Ss.members[c].name)}return t}getBinderUniforms(){const t=[];for(const i in this.binders){const s=this.binders[i];if(s instanceof an||s instanceof bl||s instanceof ia)for(const c of s.uniformNames)t.push(c)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,i){const s=[];for(const c in this.binders){const m=this.binders[c];if(m instanceof an||m instanceof bl||m instanceof ia){for(const g of m.uniformNames)if(i[g]){const _=m.getBinding(t,i[g],g);s.push({name:g,property:c,binding:_})}}}return s}setUniforms(t,i,s,c){for(const{name:m,property:g,binding:_}of i)this.binders[g].setUniform(_,c,s.get(g),m)}updatePaintBuffers(t){this._buffers=[];for(const i in this.binders){const s=this.binders[i];if(t&&s instanceof On){const c=t.fromScale===2?s.zoomInPaintVertexBuffer:s.zoomOutPaintVertexBuffer;c&&this._buffers.push(c)}else(s instanceof Ya||s instanceof ia)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(t){for(const i in this.binders){const s=this.binders[i];(s instanceof Ya||s instanceof ia||s instanceof On)&&s.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const i=this.binders[t];(i instanceof Ya||i instanceof ia||i instanceof On)&&i.destroy()}}}class Qa{constructor(t,i,s=(()=>!0)){this.programConfigurations={};for(const c of t)this.programConfigurations[c.id]=new na(c,i,s);this.needsUpload=!1,this._featureMap=new ks,this._bufferOffset=0}populatePaintArrays(t,i,s,c,m,g){for(const _ in this.programConfigurations)this.programConfigurations[_].populatePaintArrays(t,i,c,m,g);i.id!==void 0&&this._featureMap.add(i.id,s,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,i,s,c){for(const m of s)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(t,this._featureMap,i,m,c)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Mh(r,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(`${t}-`,"").replace(/-/g,"_")]}function Zc(r,t,i){const s={color:{source:K,composite:Jt},number:{source:lt,composite:K}},c=(function(m){return{"line-pattern":{source:po,composite:po},"fill-pattern":{source:po,composite:po},"fill-extrusion-pattern":{source:po,composite:po}}[m]})(r);return c&&c[i]||s[t][i]}wt("ConstantBinder",an),wt("CrossFadedConstantBinder",bl),wt("SourceExpressionBinder",Ya),wt("CrossFadedCompositeBinder",On),wt("CompositeExpressionBinder",ia),wt("ProgramConfiguration",na,{omit:["_buffers"]}),wt("ProgramConfigurationSet",Qa);const Fi=8192,qc=Math.pow(2,14)-1,Ah=-qc-1;function Sl(r){const t=Fi/r.extent,i=r.loadGeometry();for(let s=0;s<i.length;s++){const c=i[s];for(let m=0;m<c.length;m++){const g=c[m],_=Math.round(g.x*t),x=Math.round(g.y*t);g.x=ur(_,Ah,qc),g.y=ur(x,Ah,qc),(_<g.x||_>g.x+1||x<g.y||x>g.y+1)&&kr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return i}function kl(r,t){return{type:r.type,id:r.id,properties:r.properties,geometry:t?Sl(r):[]}}function lc(r,t,i,s,c){r.emplaceBack(2*t+(s+1)/2,2*i+(c+1)/2)}class Gc{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new gn,this.indexArray=new Do,this.segments=new mr,this.programConfigurations=new Qa(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(t,i,s){const c=this.layers[0],m=[];let g=null,_=!1;c.type==="circle"&&(g=c.layout.get("circle-sort-key"),_=!g.isConstant());for(const{feature:x,id:k,index:P,sourceLayerIndex:R}of t){const O=this.layers[0]._featureFilter.needGeometry,U=kl(x,O);if(!this.layers[0]._featureFilter.filter(new Sr(this.zoom),U,s))continue;const G=_?g.evaluate(U,{},s):void 0,J={id:k,properties:x.properties,type:x.type,sourceLayerIndex:R,index:P,geometry:O?U.geometry:Sl(x),patterns:{},sortKey:G};m.push(J)}_&&m.sort(((x,k)=>x.sortKey-k.sortKey));for(const x of m){const{geometry:k,index:P,sourceLayerIndex:R}=x,O=t[P].feature;this.addFeature(x,k,P,s),i.featureIndex.insert(O,k,P,R,this.index)}}update(t,i,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,s)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,yn),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,i,s,c){for(const m of i)for(const g of m){const _=g.x,x=g.y;if(_<0||_>=Fi||x<0||x>=Fi)continue;const k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),P=k.vertexLength;lc(this.layoutVertexArray,_,x,-1,-1),lc(this.layoutVertexArray,_,x,1,-1),lc(this.layoutVertexArray,_,x,1,1),lc(this.layoutVertexArray,_,x,-1,1),this.indexArray.emplaceBack(P,P+1,P+2),this.indexArray.emplaceBack(P,P+3,P+2),k.vertexLength+=4,k.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,{},c)}}function Dh(r,t){for(let i=0;i<r.length;i++)if(tu(t,r[i]))return!0;for(let i=0;i<t.length;i++)if(tu(r,t[i]))return!0;return!!Pu(r,t)}function uc(r,t,i){return!!tu(r,t)||!!cc(t,r,i)}function Lh(r,t){if(r.length===1)return Fh(t,r[0]);for(let i=0;i<t.length;i++){const s=t[i];for(let c=0;c<s.length;c++)if(tu(r,s[c]))return!0}for(let i=0;i<r.length;i++)if(Fh(t,r[i]))return!0;for(let i=0;i<t.length;i++)if(Pu(r,t[i]))return!0;return!1}function Hc(r,t,i){if(r.length>1){if(Pu(r,t))return!0;for(let s=0;s<t.length;s++)if(cc(t[s],r,i))return!0}for(let s=0;s<r.length;s++)if(cc(r[s],t,i))return!0;return!1}function Pu(r,t){if(r.length===0||t.length===0)return!1;for(let i=0;i<r.length-1;i++){const s=r[i],c=r[i+1];for(let m=0;m<t.length-1;m++)if(fd(s,c,t[m],t[m+1]))return!0}return!1}function fd(r,t,i,s){return _r(r,i,s)!==_r(t,i,s)&&_r(r,t,i)!==_r(r,t,s)}function cc(r,t,i){const s=i*i;if(t.length===1)return r.distSqr(t[0])<s;for(let c=1;c<t.length;c++)if(Rh(r,t[c-1],t[c])<s)return!0;return!1}function Rh(r,t,i){const s=t.distSqr(i);if(s===0)return r.distSqr(t);const c=((r.x-t.x)*(i.x-t.x)+(r.y-t.y)*(i.y-t.y))/s;return r.distSqr(c<0?t:c>1?i:i.sub(t)._mult(c)._add(t))}function Fh(r,t){let i,s,c,m=!1;for(let g=0;g<r.length;g++){i=r[g];for(let _=0,x=i.length-1;_<i.length;x=_++)s=i[_],c=i[x],s.y>t.y!=c.y>t.y&&t.x<(c.x-s.x)*(t.y-s.y)/(c.y-s.y)+s.x&&(m=!m)}return m}function tu(r,t){let i=!1;for(let s=0,c=r.length-1;s<r.length;c=s++){const m=r[s],g=r[c];m.y>t.y!=g.y>t.y&&t.x<(g.x-m.x)*(t.y-m.y)/(g.y-m.y)+m.x&&(i=!i)}return i}function md(r,t,i){const s=i[0],c=i[2];if(r.x<s.x&&t.x<s.x||r.x>c.x&&t.x>c.x||r.y<s.y&&t.y<s.y||r.y>c.y&&t.y>c.y)return!1;const m=_r(r,t,i[0]);return m!==_r(r,t,i[1])||m!==_r(r,t,i[2])||m!==_r(r,t,i[3])}function ru(r,t,i){const s=t.paint.get(r).value;return s.kind==="constant"?s.value:i.programConfigurations.get(t.id).getMaxValue(r)}function hc(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function dc(r,t,i,s,c){if(!t[0]&&!t[1])return r;const m=re.convert(t)._mult(c);i==="viewport"&&m._rotate(-s);const g=[];for(let _=0;_<r.length;_++)g.push(r[_].sub(m));return g}let Bh,gd;wt("CircleBucket",Gc,{omit:["layers"]});var yd={get paint(){return gd=gd||new f({"circle-radius":new Nt(Fe.paint_circle["circle-radius"]),"circle-color":new Nt(Fe.paint_circle["circle-color"]),"circle-blur":new Nt(Fe.paint_circle["circle-blur"]),"circle-opacity":new Nt(Fe.paint_circle["circle-opacity"]),"circle-translate":new bt(Fe.paint_circle["circle-translate"]),"circle-translate-anchor":new bt(Fe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new bt(Fe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new bt(Fe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Nt(Fe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Nt(Fe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Nt(Fe.paint_circle["circle-stroke-opacity"])})},get layout(){return Bh=Bh||new f({"circle-sort-key":new Nt(Fe.layout_circle["circle-sort-key"])})}},Jn=1e-6,Mu=typeof Float32Array<"u"?Float32Array:Array;function Wc(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Oh(r,t,i){var s=t[0],c=t[1],m=t[2],g=t[3],_=t[4],x=t[5],k=t[6],P=t[7],R=t[8],O=t[9],U=t[10],G=t[11],J=t[12],se=t[13],he=t[14],Ee=t[15],ye=i[0],ze=i[1],Oe=i[2],Je=i[3];return r[0]=ye*s+ze*_+Oe*R+Je*J,r[1]=ye*c+ze*x+Oe*O+Je*se,r[2]=ye*m+ze*k+Oe*U+Je*he,r[3]=ye*g+ze*P+Oe*G+Je*Ee,r[4]=(ye=i[4])*s+(ze=i[5])*_+(Oe=i[6])*R+(Je=i[7])*J,r[5]=ye*c+ze*x+Oe*O+Je*se,r[6]=ye*m+ze*k+Oe*U+Je*he,r[7]=ye*g+ze*P+Oe*G+Je*Ee,r[8]=(ye=i[8])*s+(ze=i[9])*_+(Oe=i[10])*R+(Je=i[11])*J,r[9]=ye*c+ze*x+Oe*O+Je*se,r[10]=ye*m+ze*k+Oe*U+Je*he,r[11]=ye*g+ze*P+Oe*G+Je*Ee,r[12]=(ye=i[12])*s+(ze=i[13])*_+(Oe=i[14])*R+(Je=i[15])*J,r[13]=ye*c+ze*x+Oe*O+Je*se,r[14]=ye*m+ze*k+Oe*U+Je*he,r[15]=ye*g+ze*P+Oe*G+Je*Ee,r}Math.hypot||(Math.hypot=function(){for(var r=0,t=arguments.length;t--;)r+=arguments[t]*arguments[t];return Math.sqrt(r)});var Au,Xc=Oh;function Kc(r,t,i){var s=t[0],c=t[1],m=t[2],g=t[3];return r[0]=i[0]*s+i[4]*c+i[8]*m+i[12]*g,r[1]=i[1]*s+i[5]*c+i[9]*m+i[13]*g,r[2]=i[2]*s+i[6]*c+i[10]*m+i[14]*g,r[3]=i[3]*s+i[7]*c+i[11]*m+i[15]*g,r}Au=new Mu(4),Mu!=Float32Array&&(Au[0]=0,Au[1]=0,Au[2]=0,Au[3]=0);class mp extends o{constructor(t){super(t,yd)}createBucket(t){return new Gc(t)}queryRadius(t){const i=t;return ru("circle-radius",this,i)+ru("circle-stroke-width",this,i)+hc(this.paint.get("circle-translate"))}queryIntersectsFeature(t,i,s,c,m,g,_,x){const k=dc(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),g.angle,_),P=this.paint.get("circle-radius").evaluate(i,s)+this.paint.get("circle-stroke-width").evaluate(i,s),R=this.paint.get("circle-pitch-alignment")==="map",O=R?k:(function(G,J){return G.map((se=>_d(se,J)))})(k,x),U=R?P*_:P;for(const G of c)for(const J of G){const se=R?J:_d(J,x);let he=U;const Ee=Kc([],[J.x,J.y,0,1],x);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?he*=Ee[3]/g.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(he*=g.cameraToCenterDistance/Ee[3]),uc(O,se,he))return!0}return!1}}function _d(r,t){const i=Kc([],[r.x,r.y,0,1],t);return new re(i[0]/i[3],i[1]/i[3])}class Ta extends Gc{}let Jc;wt("HeatmapBucket",Ta,{omit:["layers"]});var Yc={get paint(){return Jc=Jc||new f({"heatmap-radius":new Nt(Fe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Nt(Fe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new bt(Fe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ic(Fe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new bt(Fe.paint_heatmap["heatmap-opacity"])})}};function Qc(r,{width:t,height:i},s,c){if(c){if(c instanceof Uint8ClampedArray)c=new Uint8Array(c.buffer);else if(c.length!==t*i*s)throw new RangeError(`mismatched image size. expected: ${c.length} but got: ${t*i*s}`)}else c=new Uint8Array(t*i*s);return r.width=t,r.height=i,r.data=c,r}function Nh(r,{width:t,height:i},s){if(t===r.width&&i===r.height)return;const c=Qc({},{width:t,height:i},s);eh(r,c,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,t),height:Math.min(r.height,i)},s),r.width=t,r.height=i,r.data=c.data}function eh(r,t,i,s,c,m){if(c.width===0||c.height===0)return t;if(c.width>r.width||c.height>r.height||i.x>r.width-c.width||i.y>r.height-c.height)throw new RangeError("out of range source coordinates for image copy");if(c.width>t.width||c.height>t.height||s.x>t.width-c.width||s.y>t.height-c.height)throw new RangeError("out of range destination coordinates for image copy");const g=r.data,_=t.data;if(g===_)throw new Error("srcData equals dstData, so image is already copied");for(let x=0;x<c.height;x++){const k=((i.y+x)*r.width+i.x)*m,P=((s.y+x)*t.width+s.x)*m;for(let R=0;R<c.width*m;R++)_[P+R]=g[k+R]}return t}class iu{constructor(t,i){Qc(this,t,1,i)}resize(t){Nh(this,t,1)}clone(){return new iu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,i,s,c,m){eh(t,i,s,c,m,1)}}class zn{constructor(t,i){Qc(this,t,4,i)}resize(t){Nh(this,t,4)}replace(t,i){i?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new zn({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,i,s,c,m){eh(t,i,s,c,m,4)}}function th(r){const t={},i=r.resolution||256,s=r.clips?r.clips.length:1,c=r.image||new zn({width:i,height:s});if(Math.log(i)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${i}`);const m=(g,_,x)=>{t[r.evaluationKey]=x;const k=r.expression.evaluate(t);c.data[g+_+0]=Math.floor(255*k.r/k.a),c.data[g+_+1]=Math.floor(255*k.g/k.a),c.data[g+_+2]=Math.floor(255*k.b/k.a),c.data[g+_+3]=Math.floor(255*k.a)};if(r.clips)for(let g=0,_=0;g<s;++g,_+=4*i)for(let x=0,k=0;x<i;x++,k+=4){const P=x/(i-1),{start:R,end:O}=r.clips[g];m(_,k,R*(1-P)+O*P)}else for(let g=0,_=0;g<i;g++,_+=4)m(0,_,g/(i-1));return c}wt("AlphaImage",iu),wt("RGBAImage",zn);const pc="big-fb";class gp extends o{createBucket(t){return new Ta(t)}constructor(t){super(t,Yc),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=th({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(pc)&&this.heatmapFbos.delete(pc)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let jh;var vd={get paint(){return jh=jh||new f({"hillshade-illumination-direction":new bt(Fe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new bt(Fe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new bt(Fe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new bt(Fe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new bt(Fe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new bt(Fe.paint_hillshade["hillshade-accent-color"])})}};class xd extends o{constructor(t){super(t,vd)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const wd=v([{name:"a_pos",components:2,type:"Int16"}],4),{members:bd}=wd;function Sd(r,t,i=2){const s=t&&t.length,c=s?t[0]*i:r.length;let m=go(r,0,c,i,!0);const g=[];if(!m||m.next===m.prev)return g;let _,x,k;if(s&&(m=(function(P,R,O,U){const G=[];for(let J=0,se=R.length;J<se;J++){const he=go(P,R[J]*U,J<se-1?R[J+1]*U:P.length,U,!1);he===he.next&&(he.steiner=!0),G.push(Id(he))}G.sort(Vh);for(let J=0;J<G.length;J++)O=Cd(G[J],O);return O})(r,t,m,i)),r.length>80*i){_=1/0,x=1/0;let P=-1/0,R=-1/0;for(let O=i;O<c;O+=i){const U=r[O],G=r[O+1];U<_&&(_=U),G<x&&(x=G),U>P&&(P=U),G>R&&(R=G)}k=Math.max(P-_,R-x),k=k!==0?32767/k:0}return Du(m,g,i,_,x,k,0),g}function go(r,t,i,s,c){let m;if(c===(function(g,_,x,k){let P=0;for(let R=_,O=x-k;R<x;R+=k)P+=(g[O]-g[R])*(g[R+1]+g[O+1]),O=R;return P})(r,t,i,s)>0)for(let g=t;g<i;g+=s)m=gc(g/s|0,r[g],r[g+1],m);else for(let g=i-s;g>=t;g-=s)m=gc(g/s|0,r[g],r[g+1],m);return m&&Lu(m,m.next)&&(oa(m),m=m.next),m}function Ji(r,t){if(!r)return r;t||(t=r);let i,s=r;do if(i=!1,s.steiner||!Lu(s,s.next)&&Ii(s.prev,s,s.next)!==0)s=s.next;else{if(oa(s),s=t=s.prev,s===s.next)break;i=!0}while(i||s!==t);return t}function Du(r,t,i,s,c,m,g){if(!r)return;!g&&m&&(function(x,k,P,R){let O=x;do O.z===0&&(O.z=rh(O.x,O.y,k,P,R)),O.prevZ=O.prev,O.nextZ=O.next,O=O.next;while(O!==x);O.prevZ.nextZ=null,O.prevZ=null,(function(U){let G,J=1;do{let se,he=U;U=null;let Ee=null;for(G=0;he;){G++;let ye=he,ze=0;for(let Je=0;Je<J&&(ze++,ye=ye.nextZ,ye);Je++);let Oe=J;for(;ze>0||Oe>0&&ye;)ze!==0&&(Oe===0||!ye||he.z<=ye.z)?(se=he,he=he.nextZ,ze--):(se=ye,ye=ye.nextZ,Oe--),Ee?Ee.nextZ=se:U=se,se.prevZ=Ee,Ee=se;he=ye}Ee.nextZ=null,J*=2}while(G>1)})(O)})(r,s,c,m);let _=r;for(;r.prev!==r.next;){const x=r.prev,k=r.next;if(m?Td(r,s,c,m):kd(r))t.push(x.i,r.i,k.i),oa(r),r=k.next,_=k.next;else if((r=k)===_){g?g===1?Du(r=zd(Ji(r),t),t,i,s,c,m,2):g===2&&Ed(r,t,i,s,c,m):Du(Ji(r),t,i,s,c,m,1);break}}}function kd(r){const t=r.prev,i=r,s=r.next;if(Ii(t,i,s)>=0)return!1;const c=t.x,m=i.x,g=s.x,_=t.y,x=i.y,k=s.y,P=c<m?c<g?c:g:m<g?m:g,R=_<x?_<k?_:k:x<k?x:k,O=c>m?c>g?c:g:m>g?m:g,U=_>x?_>k?_:k:x>k?x:k;let G=s.next;for(;G!==t;){if(G.x>=P&&G.x<=O&&G.y>=R&&G.y<=U&&Tl(c,_,m,x,g,k,G.x,G.y)&&Ii(G.prev,G,G.next)>=0)return!1;G=G.next}return!0}function Td(r,t,i,s){const c=r.prev,m=r,g=r.next;if(Ii(c,m,g)>=0)return!1;const _=c.x,x=m.x,k=g.x,P=c.y,R=m.y,O=g.y,U=_<x?_<k?_:k:x<k?x:k,G=P<R?P<O?P:O:R<O?R:O,J=_>x?_>k?_:k:x>k?x:k,se=P>R?P>O?P:O:R>O?R:O,he=rh(U,G,t,i,s),Ee=rh(J,se,t,i,s);let ye=r.prevZ,ze=r.nextZ;for(;ye&&ye.z>=he&&ze&&ze.z<=Ee;){if(ye.x>=U&&ye.x<=J&&ye.y>=G&&ye.y<=se&&ye!==c&&ye!==g&&Tl(_,P,x,R,k,O,ye.x,ye.y)&&Ii(ye.prev,ye,ye.next)>=0||(ye=ye.prevZ,ze.x>=U&&ze.x<=J&&ze.y>=G&&ze.y<=se&&ze!==c&&ze!==g&&Tl(_,P,x,R,k,O,ze.x,ze.y)&&Ii(ze.prev,ze,ze.next)>=0))return!1;ze=ze.nextZ}for(;ye&&ye.z>=he;){if(ye.x>=U&&ye.x<=J&&ye.y>=G&&ye.y<=se&&ye!==c&&ye!==g&&Tl(_,P,x,R,k,O,ye.x,ye.y)&&Ii(ye.prev,ye,ye.next)>=0)return!1;ye=ye.prevZ}for(;ze&&ze.z<=Ee;){if(ze.x>=U&&ze.x<=J&&ze.y>=G&&ze.y<=se&&ze!==c&&ze!==g&&Tl(_,P,x,R,k,O,ze.x,ze.y)&&Ii(ze.prev,ze,ze.next)>=0)return!1;ze=ze.nextZ}return!0}function zd(r,t){let i=r;do{const s=i.prev,c=i.next.next;!Lu(s,c)&&fc(s,i,i.next,c)&&nu(s,c)&&nu(c,s)&&(t.push(s.i,i.i,c.i),oa(i),oa(i.next),i=r=c),i=i.next}while(i!==r);return Ji(i)}function Ed(r,t,i,s,c,m){let g=r;do{let _=g.next.next;for(;_!==g.prev;){if(g.i!==_.i&&$h(g,_)){let x=Zh(g,_);return g=Ji(g,g.next),x=Ji(x,x.next),Du(g,t,i,s,c,m,0),void Du(x,t,i,s,c,m,0)}_=_.next}g=g.next}while(g!==r)}function Vh(r,t){return r.x-t.x}function Cd(r,t){const i=(function(c,m){let g=m;const _=c.x,x=c.y;let k,P=-1/0;do{if(x<=g.y&&x>=g.next.y&&g.next.y!==g.y){const J=g.x+(x-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(J<=_&&J>P&&(P=J,k=g.x<g.next.x?g:g.next,J===_))return k}g=g.next}while(g!==m);if(!k)return null;const R=k,O=k.x,U=k.y;let G=1/0;g=k;do{if(_>=g.x&&g.x>=O&&_!==g.x&&Tl(x<U?_:P,x,O,U,x<U?P:_,x,g.x,g.y)){const J=Math.abs(x-g.y)/(_-g.x);nu(g,c)&&(J<G||J===G&&(g.x>k.x||g.x===k.x&&Uh(k,g)))&&(k=g,G=J)}g=g.next}while(g!==R);return k})(r,t);if(!i)return t;const s=Zh(i,r);return Ji(s,s.next),Ji(i,i.next)}function Uh(r,t){return Ii(r.prev,r,t.prev)<0&&Ii(t.next,r,r.next)<0}function rh(r,t,i,s,c){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-i)*c|0)|r<<8))|r<<4))|r<<2))|r<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-s)*c|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Id(r){let t=r,i=r;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==r);return i}function Tl(r,t,i,s,c,m,g,_){return(c-g)*(t-_)>=(r-g)*(m-_)&&(r-g)*(s-_)>=(i-g)*(t-_)&&(i-g)*(m-_)>=(c-g)*(s-_)}function $h(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!(function(i,s){let c=i;do{if(c.i!==i.i&&c.next.i!==i.i&&c.i!==s.i&&c.next.i!==s.i&&fc(c,c.next,i,s))return!0;c=c.next}while(c!==i);return!1})(r,t)&&(nu(r,t)&&nu(t,r)&&(function(i,s){let c=i,m=!1;const g=(i.x+s.x)/2,_=(i.y+s.y)/2;do c.y>_!=c.next.y>_&&c.next.y!==c.y&&g<(c.next.x-c.x)*(_-c.y)/(c.next.y-c.y)+c.x&&(m=!m),c=c.next;while(c!==i);return m})(r,t)&&(Ii(r.prev,r,t.prev)||Ii(r,t.prev,t))||Lu(r,t)&&Ii(r.prev,r,r.next)>0&&Ii(t.prev,t,t.next)>0)}function Ii(r,t,i){return(t.y-r.y)*(i.x-t.x)-(t.x-r.x)*(i.y-t.y)}function Lu(r,t){return r.x===t.x&&r.y===t.y}function fc(r,t,i,s){const c=mc(Ii(r,t,i)),m=mc(Ii(r,t,s)),g=mc(Ii(i,s,r)),_=mc(Ii(i,s,t));return c!==m&&g!==_||!(c!==0||!ih(r,i,t))||!(m!==0||!ih(r,s,t))||!(g!==0||!ih(i,r,s))||!(_!==0||!ih(i,t,s))}function ih(r,t,i){return t.x<=Math.max(r.x,i.x)&&t.x>=Math.min(r.x,i.x)&&t.y<=Math.max(r.y,i.y)&&t.y>=Math.min(r.y,i.y)}function mc(r){return r>0?1:r<0?-1:0}function nu(r,t){return Ii(r.prev,r,r.next)<0?Ii(r,t,r.next)>=0&&Ii(r,r.prev,t)>=0:Ii(r,t,r.prev)<0||Ii(r,r.next,t)<0}function Zh(r,t){const i=qh(r.i,r.x,r.y),s=qh(t.i,t.x,t.y),c=r.next,m=t.prev;return r.next=t,t.prev=r,i.next=c,c.prev=i,s.next=i,i.prev=s,m.next=s,s.prev=m,s}function gc(r,t,i,s){const c=qh(r,t,i);return s?(c.next=s.next,c.prev=s,s.next.prev=c,s.next=c):(c.prev=c,c.next=c),c}function oa(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function qh(r,t,i){return{i:r,x:t,y:i,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function nh(r,t,i){const s=i.patternDependencies;let c=!1;for(const m of t){const g=m.paint.get(`${r}-pattern`);g.isConstant()||(c=!0);const _=g.constantOr(null);_&&(c=!0,s[_.to]=!0,s[_.from]=!0)}return c}function yc(r,t,i,s,c){const m=c.patternDependencies;for(const g of t){const _=g.paint.get(`${r}-pattern`).value;if(_.kind!=="constant"){let x=_.evaluate({zoom:s-1},i,{},c.availableImages),k=_.evaluate({zoom:s},i,{},c.availableImages),P=_.evaluate({zoom:s+1},i,{},c.availableImages);x=x&&x.name?x.name:x,k=k&&k.name?k.name:k,P=P&&P.name?P.name:P,m[x]=!0,m[k]=!0,m[P]=!0,i.patterns[g.id]={min:x,mid:k,max:P}}}return i}class oh{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Yo,this.indexArray=new Do,this.indexArray2=new Ri,this.programConfigurations=new Qa(t.layers,t.zoom),this.segments=new mr,this.segments2=new mr,this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(t,i,s){this.hasPattern=nh("fill",this.layers,i);const c=this.layers[0].layout.get("fill-sort-key"),m=!c.isConstant(),g=[];for(const{feature:_,id:x,index:k,sourceLayerIndex:P}of t){const R=this.layers[0]._featureFilter.needGeometry,O=kl(_,R);if(!this.layers[0]._featureFilter.filter(new Sr(this.zoom),O,s))continue;const U=m?c.evaluate(O,{},s,i.availableImages):void 0,G={id:x,properties:_.properties,type:_.type,sourceLayerIndex:P,index:k,geometry:R?O.geometry:Sl(_),patterns:{},sortKey:U};g.push(G)}m&&g.sort(((_,x)=>_.sortKey-x.sortKey));for(const _ of g){const{geometry:x,index:k,sourceLayerIndex:P}=_;if(this.hasPattern){const R=yc("fill",this.layers,_,this.zoom,i);this.patternFeatures.push(R)}else this.addFeature(_,x,k,s,{});i.featureIndex.insert(t[k].feature,x,k,P,this.index)}}update(t,i,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,s)}addFeatures(t,i,s){for(const c of this.patternFeatures)this.addFeature(c,c.geometry,c.index,i,s)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,bd),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,i,s,c,m){for(const g of li(i,500)){let _=0;for(const U of g)_+=U.length;const x=this.segments.prepareSegment(_,this.layoutVertexArray,this.indexArray),k=x.vertexLength,P=[],R=[];for(const U of g){if(U.length===0)continue;U!==g[0]&&R.push(P.length/2);const G=this.segments2.prepareSegment(U.length,this.layoutVertexArray,this.indexArray2),J=G.vertexLength;this.layoutVertexArray.emplaceBack(U[0].x,U[0].y),this.indexArray2.emplaceBack(J+U.length-1,J),P.push(U[0].x),P.push(U[0].y);for(let se=1;se<U.length;se++)this.layoutVertexArray.emplaceBack(U[se].x,U[se].y),this.indexArray2.emplaceBack(J+se-1,J+se),P.push(U[se].x),P.push(U[se].y);G.vertexLength+=U.length,G.primitiveLength+=U.length}const O=Sd(P,R);for(let U=0;U<O.length;U+=3)this.indexArray.emplaceBack(k+O[U],k+O[U+1],k+O[U+2]);x.vertexLength+=_,x.primitiveLength+=O.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,m,c)}}let Gh,Ru;wt("FillBucket",oh,{omit:["layers","patternFeatures"]});var Yn={get paint(){return Ru=Ru||new f({"fill-antialias":new bt(Fe.paint_fill["fill-antialias"]),"fill-opacity":new Nt(Fe.paint_fill["fill-opacity"]),"fill-color":new Nt(Fe.paint_fill["fill-color"]),"fill-outline-color":new Nt(Fe.paint_fill["fill-outline-color"]),"fill-translate":new bt(Fe.paint_fill["fill-translate"]),"fill-translate-anchor":new bt(Fe.paint_fill["fill-translate-anchor"]),"fill-pattern":new vl(Fe.paint_fill["fill-pattern"])})},get layout(){return Gh=Gh||new f({"fill-sort-key":new Nt(Fe.layout_fill["fill-sort-key"])})}};class yp extends o{constructor(t){super(t,Yn)}recalculate(t,i){super.recalculate(t,i);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new oh(t)}queryRadius(){return hc(this.paint.get("fill-translate"))}queryIntersectsFeature(t,i,s,c,m,g,_){return Lh(dc(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),g.angle,_),c)}isTileClipped(){return!0}}const _p=v([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),ah=v([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Qn}=_p;var zl={},Ft=Pe,ou=El;function El(r,t,i,s,c){this.properties={},this.extent=i,this.type=0,this._pbf=r,this._geometry=-1,this._keys=s,this._values=c,r.readFields(Pd,this,t)}function Pd(r,t,i){r==1?t.id=i.readVarint():r==2?(function(s,c){for(var m=s.readVarint()+s.pos;s.pos<m;){var g=c._keys[s.readVarint()],_=c._values[s.readVarint()];c.properties[g]=_}})(i,t):r==3?t.type=i.readVarint():r==4&&(t._geometry=i.pos)}function vp(r){for(var t,i,s=0,c=0,m=r.length,g=m-1;c<m;g=c++)s+=((i=r[g]).x-(t=r[c]).x)*(t.y+i.y);return s}El.types=["Unknown","Point","LineString","Polygon"],El.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var t,i=r.readVarint()+r.pos,s=1,c=0,m=0,g=0,_=[];r.pos<i;){if(c<=0){var x=r.readVarint();s=7&x,c=x>>3}if(c--,s===1||s===2)m+=r.readSVarint(),g+=r.readSVarint(),s===1&&(t&&_.push(t),t=[]),t.push(new Ft(m,g));else{if(s!==7)throw new Error("unknown command "+s);t&&t.push(t[0].clone())}}return t&&_.push(t),_},El.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var t=r.readVarint()+r.pos,i=1,s=0,c=0,m=0,g=1/0,_=-1/0,x=1/0,k=-1/0;r.pos<t;){if(s<=0){var P=r.readVarint();i=7&P,s=P>>3}if(s--,i===1||i===2)(c+=r.readSVarint())<g&&(g=c),c>_&&(_=c),(m+=r.readSVarint())<x&&(x=m),m>k&&(k=m);else if(i!==7)throw new Error("unknown command "+i)}return[g,x,_,k]},El.prototype.toGeoJSON=function(r,t,i){var s,c,m=this.extent*Math.pow(2,i),g=this.extent*r,_=this.extent*t,x=this.loadGeometry(),k=El.types[this.type];function P(U){for(var G=0;G<U.length;G++){var J=U[G];U[G]=[360*(J.x+g)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(J.y+_)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var R=[];for(s=0;s<x.length;s++)R[s]=x[s][0];P(x=R);break;case 2:for(s=0;s<x.length;s++)P(x[s]);break;case 3:for(x=(function(U){var G=U.length;if(G<=1)return[U];for(var J,se,he=[],Ee=0;Ee<G;Ee++){var ye=vp(U[Ee]);ye!==0&&(se===void 0&&(se=ye<0),se===ye<0?(J&&he.push(J),J=[U[Ee]]):J.push(U[Ee]))}return J&&he.push(J),he})(x),s=0;s<x.length;s++)for(c=0;c<x[s].length;c++)P(x[s][c])}x.length===1?x=x[0]:k="Multi"+k;var O={type:"Feature",geometry:{type:k,coordinates:x},properties:this.properties};return"id"in this&&(O.id=this.id),O};var _c=ou,vc=sh;function sh(r,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(Md,this,t),this.length=this._features.length}function Md(r,t,i){r===15?t.version=i.readVarint():r===1?t.name=i.readString():r===5?t.extent=i.readVarint():r===2?t._features.push(i.pos):r===3?t._keys.push(i.readString()):r===4&&t._values.push((function(s){for(var c=null,m=s.readVarint()+s.pos;s.pos<m;){var g=s.readVarint()>>3;c=g===1?s.readString():g===2?s.readFloat():g===3?s.readDouble():g===4?s.readVarint64():g===5?s.readVarint():g===6?s.readSVarint():g===7?s.readBoolean():null}return c})(i))}sh.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var t=this._pbf.readVarint()+this._pbf.pos;return new _c(this._pbf,t,this.extent,this._keys,this._values)};var Ad=vc;function Dd(r,t,i){if(r===3){var s=new Ad(i,i.readVarint()+i.pos);s.length&&(t[s.name]=s)}}zl.VectorTile=function(r,t){this.layers=r.readFields(Dd,{},t)},zl.VectorTileFeature=ou,zl.VectorTileLayer=vc;const Hh=zl.VectorTileFeature.types,xc=Math.pow(2,13);function Yi(r,t,i,s,c,m,g,_){r.emplaceBack(t,i,2*Math.floor(s*xc)+g,c*xc*2,m*xc*2,Math.round(_))}class aa{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Kn,this.centroidVertexArray=new Ci,this.indexArray=new Do,this.programConfigurations=new Qa(t.layers,t.zoom),this.segments=new mr,this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(t,i,s){this.features=[],this.hasPattern=nh("fill-extrusion",this.layers,i);for(const{feature:c,id:m,index:g,sourceLayerIndex:_}of t){const x=this.layers[0]._featureFilter.needGeometry,k=kl(c,x);if(!this.layers[0]._featureFilter.filter(new Sr(this.zoom),k,s))continue;const P={id:m,sourceLayerIndex:_,index:g,geometry:x?k.geometry:Sl(c),properties:c.properties,type:c.type,patterns:{}};this.hasPattern?this.features.push(yc("fill-extrusion",this.layers,P,this.zoom,i)):this.addFeature(P,P.geometry,g,s,{}),i.featureIndex.insert(c,P.geometry,g,_,this.index,!0)}}addFeatures(t,i,s){for(const c of this.features){const{geometry:m}=c;this.addFeature(c,m,c.index,i,s)}}update(t,i,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,s)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Qn),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,ah.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,i,s,c,m){for(const g of li(i,500)){const _={x:0,y:0,vertexCount:0};let x=0;for(const G of g)x+=G.length;let k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const G of g){if(G.length===0||Ld(G))continue;let J=0;for(let se=0;se<G.length;se++){const he=G[se];if(se>=1){const Ee=G[se-1];if(!Cl(he,Ee)){k.vertexLength+4>mr.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ye=he.sub(Ee)._perp()._unit(),ze=Ee.dist(he);J+ze>32768&&(J=0),Yi(this.layoutVertexArray,he.x,he.y,ye.x,ye.y,0,0,J),Yi(this.layoutVertexArray,he.x,he.y,ye.x,ye.y,0,1,J),_.x+=2*he.x,_.y+=2*he.y,_.vertexCount+=2,J+=ze,Yi(this.layoutVertexArray,Ee.x,Ee.y,ye.x,ye.y,0,0,J),Yi(this.layoutVertexArray,Ee.x,Ee.y,ye.x,ye.y,0,1,J),_.x+=2*Ee.x,_.y+=2*Ee.y,_.vertexCount+=2;const Oe=k.vertexLength;this.indexArray.emplaceBack(Oe,Oe+2,Oe+1),this.indexArray.emplaceBack(Oe+1,Oe+2,Oe+3),k.vertexLength+=4,k.primitiveLength+=2}}}}if(k.vertexLength+x>mr.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(x,this.layoutVertexArray,this.indexArray)),Hh[t.type]!=="Polygon")continue;const P=[],R=[],O=k.vertexLength;for(const G of g)if(G.length!==0){G!==g[0]&&R.push(P.length/2);for(let J=0;J<G.length;J++){const se=G[J];Yi(this.layoutVertexArray,se.x,se.y,0,0,1,1,0),_.x+=se.x,_.y+=se.y,_.vertexCount+=1,P.push(se.x),P.push(se.y)}}const U=Sd(P,R);for(let G=0;G<U.length;G+=3)this.indexArray.emplaceBack(O+U[G],O+U[G+2],O+U[G+1]);k.primitiveLength+=U.length/3,k.vertexLength+=x;for(let G=0;G<_.vertexCount;G++){const J=Math.floor(_.x/_.vertexCount),se=Math.floor(_.y/_.vertexCount);this.centroidVertexArray.emplaceBack(J,se)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,m,c)}}function Cl(r,t){return r.x===t.x&&(r.x<0||r.x>Fi)||r.y===t.y&&(r.y<0||r.y>Fi)}function Ld(r){return r.every((t=>t.x<0))||r.every((t=>t.x>Fi))||r.every((t=>t.y<0))||r.every((t=>t.y>Fi))}let Wh;wt("FillExtrusionBucket",aa,{omit:["layers","features"]});var es={get paint(){return Wh=Wh||new f({"fill-extrusion-opacity":new bt(Fe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Nt(Fe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new bt(Fe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new bt(Fe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new vl(Fe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Nt(Fe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Nt(Fe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new bt(Fe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Rd extends o{constructor(t){super(t,es)}createBucket(t){return new aa(t)}queryRadius(){return hc(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(t,i,s,c,m,g,_,x){const k=dc(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,_),P=this.paint.get("fill-extrusion-height").evaluate(i,s),R=this.paint.get("fill-extrusion-base").evaluate(i,s),O=(function(G,J,se,he){const Ee=[];for(const ye of G){const ze=[ye.x,ye.y,0,1];Kc(ze,ze,J),Ee.push(new re(ze[0]/ze[3],ze[1]/ze[3]))}return Ee})(k,x),U=(function(G,J,se,he){const Ee=[],ye=[],ze=he[8]*J,Oe=he[9]*J,Je=he[10]*J,vt=he[11]*J,qt=he[8]*se,_t=he[9]*se,pt=he[10]*se,Rt=he[11]*se;for(const It of G){const kt=[],Ve=[];for(const Bt of It){const Dt=Bt.x,Qt=Bt.y,hi=he[0]*Dt+he[4]*Qt+he[12],ai=he[1]*Dt+he[5]*Qt+he[13],En=he[2]*Dt+he[6]*Qt+he[14],Es=he[3]*Dt+he[7]*Qt+he[15],ro=En+Je,Cn=Es+vt,No=hi+qt,jo=ai+_t,Vo=En+pt,qi=Es+Rt,In=new re((hi+ze)/Cn,(ai+Oe)/Cn);In.z=ro/Cn,kt.push(In);const vo=new re(No/qi,jo/qi);vo.z=Vo/qi,Ve.push(vo)}Ee.push(kt),ye.push(Ve)}return[Ee,ye]})(c,R,P,x);return(function(G,J,se){let he=1/0;Lh(se,J)&&(he=Fd(se,J[0]));for(let Ee=0;Ee<J.length;Ee++){const ye=J[Ee],ze=G[Ee];for(let Oe=0;Oe<ye.length-1;Oe++){const Je=ye[Oe],vt=[Je,ye[Oe+1],ze[Oe+1],ze[Oe],Je];Dh(se,vt)&&(he=Math.min(he,Fd(se,vt)))}}return he!==1/0&&he})(U[0],U[1],O)}}function Lo(r,t){return r.x*t.x+r.y*t.y}function Fd(r,t){if(r.length===1){let i=0;const s=t[i++];let c;for(;!c||s.equals(c);)if(c=t[i++],!c)return 1/0;for(;i<t.length;i++){const m=t[i],g=r[0],_=c.sub(s),x=m.sub(s),k=g.sub(s),P=Lo(_,_),R=Lo(_,x),O=Lo(x,x),U=Lo(k,_),G=Lo(k,x),J=P*O-R*R,se=(O*U-R*G)/J,he=(P*G-R*U)/J,Ee=s.z*(1-se-he)+c.z*se+m.z*he;if(isFinite(Ee))return Ee}return 1/0}{let i=1/0;for(const s of t)i=Math.min(i,s.z);return i}}const Bd=v([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Od}=Bd,Nd=v([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:jd}=Nd,xp=zl.VectorTileFeature.types,lh=Math.cos(Math.PI/180*37.5),uh=Math.pow(2,14)/.5;class Ro{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((i=>{this.gradients[i.id]={}})),this.layoutVertexArray=new Qo,this.layoutVertexArray2=new bs,this.indexArray=new Do,this.programConfigurations=new Qa(t.layers,t.zoom),this.segments=new mr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(t,i,s){this.hasPattern=nh("line",this.layers,i);const c=this.layers[0].layout.get("line-sort-key"),m=!c.isConstant(),g=[];for(const{feature:_,id:x,index:k,sourceLayerIndex:P}of t){const R=this.layers[0]._featureFilter.needGeometry,O=kl(_,R);if(!this.layers[0]._featureFilter.filter(new Sr(this.zoom),O,s))continue;const U=m?c.evaluate(O,{},s):void 0,G={id:x,properties:_.properties,type:_.type,sourceLayerIndex:P,index:k,geometry:R?O.geometry:Sl(_),patterns:{},sortKey:U};g.push(G)}m&&g.sort(((_,x)=>_.sortKey-x.sortKey));for(const _ of g){const{geometry:x,index:k,sourceLayerIndex:P}=_;if(this.hasPattern){const R=yc("line",this.layers,_,this.zoom,i);this.patternFeatures.push(R)}else this.addFeature(_,x,k,s,{});i.featureIndex.insert(t[k].feature,x,k,P,this.index)}}update(t,i,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,s)}addFeatures(t,i,s){for(const c of this.patternFeatures)this.addFeature(c,c.geometry,c.index,i,s)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,jd)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Od),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,i,s,c,m){const g=this.layers[0].layout,_=g.get("line-join").evaluate(t,{}),x=g.get("line-cap"),k=g.get("line-miter-limit"),P=g.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const R of i)this.addLine(R,t,_,x,k,P);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,m,c)}addLine(t,i,s,c,m,g){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let he=0;he<t.length-1;he++)this.totalDistance+=t[he].dist(t[he+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const _=xp[i.type]==="Polygon";let x=t.length;for(;x>=2&&t[x-1].equals(t[x-2]);)x--;let k=0;for(;k<x-1&&t[k].equals(t[k+1]);)k++;if(x<(_?3:2))return;s==="bevel"&&(m=1.05);const P=this.overscaling<=16?15*Fi/(512*this.overscaling):0,R=this.segments.prepareSegment(10*x,this.layoutVertexArray,this.indexArray);let O,U,G,J,se;this.e1=this.e2=-1,_&&(O=t[x-2],se=t[k].sub(O)._unit()._perp());for(let he=k;he<x;he++){if(G=he===x-1?_?t[k+1]:void 0:t[he+1],G&&t[he].equals(G))continue;se&&(J=se),O&&(U=O),O=t[he],se=G?G.sub(O)._unit()._perp():J,J=J||se;let Ee=J.add(se);Ee.x===0&&Ee.y===0||Ee._unit();const ye=J.x*se.x+J.y*se.y,ze=Ee.x*se.x+Ee.y*se.y,Oe=ze!==0?1/ze:1/0,Je=2*Math.sqrt(2-2*ze),vt=ze<lh&&U&&G,qt=J.x*se.y-J.y*se.x>0;if(vt&&he>k){const Rt=O.dist(U);if(Rt>2*P){const It=O.sub(O.sub(U)._mult(P/Rt)._round());this.updateDistance(U,It),this.addCurrentVertex(It,J,0,0,R),U=It}}const _t=U&&G;let pt=_t?s:_?"butt":c;if(_t&&pt==="round"&&(Oe<g?pt="miter":Oe<=2&&(pt="fakeround")),pt==="miter"&&Oe>m&&(pt="bevel"),pt==="bevel"&&(Oe>2&&(pt="flipbevel"),Oe<m&&(pt="miter")),U&&this.updateDistance(U,O),pt==="miter")Ee._mult(Oe),this.addCurrentVertex(O,Ee,0,0,R);else if(pt==="flipbevel"){if(Oe>100)Ee=se.mult(-1);else{const Rt=Oe*J.add(se).mag()/J.sub(se).mag();Ee._perp()._mult(Rt*(qt?-1:1))}this.addCurrentVertex(O,Ee,0,0,R),this.addCurrentVertex(O,Ee.mult(-1),0,0,R)}else if(pt==="bevel"||pt==="fakeround"){const Rt=-Math.sqrt(Oe*Oe-1),It=qt?Rt:0,kt=qt?0:Rt;if(U&&this.addCurrentVertex(O,J,It,kt,R),pt==="fakeround"){const Ve=Math.round(180*Je/Math.PI/20);for(let Bt=1;Bt<Ve;Bt++){let Dt=Bt/Ve;if(Dt!==.5){const hi=Dt-.5;Dt+=Dt*hi*(Dt-1)*((1.0904+ye*(ye*(3.55645-1.43519*ye)-3.2452))*hi*hi+(.848013+ye*(.215638*ye-1.06021)))}const Qt=se.sub(J)._mult(Dt)._add(J)._unit()._mult(qt?-1:1);this.addHalfVertex(O,Qt.x,Qt.y,!1,qt,0,R)}}G&&this.addCurrentVertex(O,se,-It,-kt,R)}else if(pt==="butt")this.addCurrentVertex(O,Ee,0,0,R);else if(pt==="square"){const Rt=U?1:-1;this.addCurrentVertex(O,Ee,Rt,Rt,R)}else pt==="round"&&(U&&(this.addCurrentVertex(O,J,0,0,R),this.addCurrentVertex(O,J,1,1,R,!0)),G&&(this.addCurrentVertex(O,se,-1,-1,R,!0),this.addCurrentVertex(O,se,0,0,R)));if(vt&&he<x-1){const Rt=O.dist(G);if(Rt>2*P){const It=O.add(G.sub(O)._mult(P/Rt)._round());this.updateDistance(O,It),this.addCurrentVertex(It,se,0,0,R),O=It}}}}addCurrentVertex(t,i,s,c,m,g=!1){const _=i.y*c-i.x,x=-i.y-i.x*c;this.addHalfVertex(t,i.x+i.y*s,i.y-i.x*s,g,!1,s,m),this.addHalfVertex(t,_,x,g,!0,-c,m),this.distance>uh/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,i,s,c,m,g))}addHalfVertex({x:t,y:i},s,c,m,g,_,x){const k=.5*(this.lineClips?this.scaledDistance*(uh-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(m?1:0),(i<<1)+(g?1:0),Math.round(63*s)+128,Math.round(63*c)+128,1+(_===0?0:_<0?-1:1)|(63&k)<<2,k>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const P=x.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,P),x.primitiveLength++),g?this.e2=P:this.e1=P}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,i){this.distance+=t.dist(i),this.updateScaledDistance()}}let Ur,_n;wt("LineBucket",Ro,{omit:["layers","patternFeatures"]});var Qi={get paint(){return _n=_n||new f({"line-opacity":new Nt(Fe.paint_line["line-opacity"]),"line-color":new Nt(Fe.paint_line["line-color"]),"line-translate":new bt(Fe.paint_line["line-translate"]),"line-translate-anchor":new bt(Fe.paint_line["line-translate-anchor"]),"line-width":new Nt(Fe.paint_line["line-width"]),"line-gap-width":new Nt(Fe.paint_line["line-gap-width"]),"line-offset":new Nt(Fe.paint_line["line-offset"]),"line-blur":new Nt(Fe.paint_line["line-blur"]),"line-dasharray":new eu(Fe.paint_line["line-dasharray"]),"line-pattern":new vl(Fe.paint_line["line-pattern"]),"line-gradient":new ic(Fe.paint_line["line-gradient"])})},get layout(){return Ur=Ur||new f({"line-cap":new bt(Fe.layout_line["line-cap"]),"line-join":new Nt(Fe.layout_line["line-join"]),"line-miter-limit":new bt(Fe.layout_line["line-miter-limit"]),"line-round-limit":new bt(Fe.layout_line["line-round-limit"]),"line-sort-key":new Nt(Fe.layout_line["line-sort-key"])})}};class Nn extends Nt{possiblyEvaluate(t,i){return i=new Sr(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,zoomHistory:i.zoomHistory,transition:i.transition}),super.possiblyEvaluate(t,i)}evaluate(t,i,s,c){return i=Vt({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(t,i,s,c)}}let eo;class Fu extends o{constructor(t){super(t,Qi),this.gradientVersion=0,eo||(eo=new Nn(Qi.paint.properties["line-width"].specification),eo.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const i=this.gradientExpression();this.stepInterpolant=!!(function(s){return s._styleExpression!==void 0})(i)&&i._styleExpression.expression instanceof Ba,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,i){super.recalculate(t,i),this.paint._values["line-floorwidth"]=eo.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Ro(t)}queryRadius(t){const i=t,s=sn(ru("line-width",this,i),ru("line-gap-width",this,i)),c=ru("line-offset",this,i);return s/2+Math.abs(c)+hc(this.paint.get("line-translate"))}queryIntersectsFeature(t,i,s,c,m,g,_){const x=dc(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,_),k=_/2*sn(this.paint.get("line-width").evaluate(i,s),this.paint.get("line-gap-width").evaluate(i,s)),P=this.paint.get("line-offset").evaluate(i,s);return P&&(c=(function(R,O){const U=[];for(let G=0;G<R.length;G++){const J=R[G],se=[];for(let he=0;he<J.length;he++){const Ee=J[he-1],ye=J[he],ze=J[he+1],Oe=he===0?new re(0,0):ye.sub(Ee)._unit()._perp(),Je=he===J.length-1?new re(0,0):ze.sub(ye)._unit()._perp(),vt=Oe._add(Je)._unit(),qt=vt.x*Je.x+vt.y*Je.y;qt!==0&&vt._mult(1/qt),se.push(vt._mult(O)._add(ye))}U.push(se)}return U})(c,P*_)),(function(R,O,U){for(let G=0;G<O.length;G++){const J=O[G];if(R.length>=3){for(let se=0;se<J.length;se++)if(tu(R,J[se]))return!0}if(Hc(R,J,U))return!0}return!1})(x,c,k)}isTileClipped(){return!0}}function sn(r,t){return t>0?t+2*r:r}const wc=v([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),au=v([{name:"a_projected_pos",components:3,type:"Float32"}],4);v([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const ch=v([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);v([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const hh=v([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),bc=v([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Fo(r,t,i){return r.sections.forEach((s=>{s.text=(function(c,m,g){const _=m.layout.get("text-transform").evaluate(g,{});return _==="uppercase"?c=c.toLocaleUpperCase():_==="lowercase"&&(c=c.toLocaleLowerCase()),Jr.applyArabicShaping&&(c=Jr.applyArabicShaping(c)),c})(s.text,t,i)})),r}v([{name:"triangle",components:3,type:"Uint16"}]),v([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),v([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),v([{type:"Float32",name:"offsetX"}]),v([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),v([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const su={"!":"ï¸•","#":"ï¼ƒ",$:"ï¼„","%":"ï¼…","&":"ï¼†","(":"ï¸µ",")":"ï¸¶","*":"ï¼Š","+":"ï¼‹",",":"ï¸","-":"ï¸²",".":"ãƒ»","/":"ï¼",":":"ï¸“",";":"ï¸”","<":"ï¸¿","=":"ï¼",">":"ï¹€","?":"ï¸–","@":"ï¼ ","[":"ï¹‡","\\":"ï¼¼","]":"ï¹ˆ","^":"ï¼¾",_:"ï¸³","`":"ï½€","{":"ï¸·","|":"â€•","}":"ï¸¸","~":"ï½ž","Â¢":"ï¿ ","Â£":"ï¿¡","Â¥":"ï¿¥","Â¦":"ï¿¤","Â¬":"ï¿¢","Â¯":"ï¿£","â€“":"ï¸²","â€”":"ï¸±","â€˜":"ï¹ƒ","â€™":"ï¹„","â€œ":"ï¹","â€":"ï¹‚","â€¦":"ï¸™","â€§":"ãƒ»","â‚©":"ï¿¦","ã€":"ï¸‘","ã€‚":"ï¸’","ã€ˆ":"ï¸¿","ã€‰":"ï¹€","ã€Š":"ï¸½","ã€‹":"ï¸¾","ã€Œ":"ï¹","ã€":"ï¹‚","ã€Ž":"ï¹ƒ","ã€":"ï¹„","ã€":"ï¸»","ã€‘":"ï¸¼","ã€”":"ï¸¹","ã€•":"ï¸º","ã€–":"ï¸—","ã€—":"ï¸˜","ï¼":"ï¸•","ï¼ˆ":"ï¸µ","ï¼‰":"ï¸¶","ï¼Œ":"ï¸","ï¼":"ï¸²","ï¼Ž":"ãƒ»","ï¼š":"ï¸“","ï¼›":"ï¸”","ï¼œ":"ï¸¿","ï¼ž":"ï¹€","ï¼Ÿ":"ï¸–","ï¼»":"ï¹‡","ï¼½":"ï¹ˆ","ï¼¿":"ï¸³","ï½›":"ï¸·","ï½œ":"â€•","ï½":"ï¸¸","ï½Ÿ":"ï¸µ","ï½ ":"ï¸¶","ï½¡":"ï¸’","ï½¢":"ï¹","ï½£":"ï¹‚"};var vi=24,Ts=Mr,Sc=function(r,t,i,s,c){var m,g,_=8*c-s-1,x=(1<<_)-1,k=x>>1,P=-7,R=c-1,O=-1,U=r[t+R];for(R+=O,m=U&(1<<-P)-1,U>>=-P,P+=_;P>0;m=256*m+r[t+R],R+=O,P-=8);for(g=m&(1<<-P)-1,m>>=-P,P+=s;P>0;g=256*g+r[t+R],R+=O,P-=8);if(m===0)m=1-k;else{if(m===x)return g?NaN:1/0*(U?-1:1);g+=Math.pow(2,s),m-=k}return(U?-1:1)*g*Math.pow(2,m-s)},dh=function(r,t,i,s,c,m){var g,_,x,k=8*m-c-1,P=(1<<k)-1,R=P>>1,O=c===23?Math.pow(2,-24)-Math.pow(2,-77):0,U=0,G=1,J=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(_=isNaN(t)?1:0,g=P):(g=Math.floor(Math.log(t)/Math.LN2),t*(x=Math.pow(2,-g))<1&&(g--,x*=2),(t+=g+R>=1?O/x:O*Math.pow(2,1-R))*x>=2&&(g++,x/=2),g+R>=P?(_=0,g=P):g+R>=1?(_=(t*x-1)*Math.pow(2,c),g+=R):(_=t*Math.pow(2,R-1)*Math.pow(2,c),g=0));c>=8;r[i+U]=255&_,U+=G,_/=256,c-=8);for(g=g<<c|_,k+=c;k>0;r[i+U]=255&g,U+=G,g/=256,k-=8);r[i+U-G]|=128*J};function Mr(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}Mr.Varint=0,Mr.Fixed64=1,Mr.Bytes=2,Mr.Fixed32=5;var Bu=4294967296,Gs=1/Bu,kc=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function sa(r){return r.type===Mr.Bytes?r.readVarint()+r.pos:r.pos+1}function Il(r,t,i){return i?4294967296*t+(r>>>0):4294967296*(t>>>0)+(r>>>0)}function Tc(r,t,i){var s=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(s);for(var c=i.pos-1;c>=r;c--)i.buf[c+s]=i.buf[c]}function ph(r,t){for(var i=0;i<r.length;i++)t.writeVarint(r[i])}function yo(r,t){for(var i=0;i<r.length;i++)t.writeSVarint(r[i])}function Pl(r,t){for(var i=0;i<r.length;i++)t.writeFloat(r[i])}function ts(r,t){for(var i=0;i<r.length;i++)t.writeDouble(r[i])}function Bo(r,t){for(var i=0;i<r.length;i++)t.writeBoolean(r[i])}function Vd(r,t){for(var i=0;i<r.length;i++)t.writeFixed32(r[i])}function Xh(r,t){for(var i=0;i<r.length;i++)t.writeSFixed32(r[i])}function Kh(r,t){for(var i=0;i<r.length;i++)t.writeFixed64(r[i])}function wp(r,t){for(var i=0;i<r.length;i++)t.writeSFixed64(r[i])}function rs(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+16777216*r[t+3]}function lu(r,t,i){r[i]=t,r[i+1]=t>>>8,r[i+2]=t>>>16,r[i+3]=t>>>24}function fh(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+(r[t+3]<<24)}Mr.prototype={destroy:function(){this.buf=null},readFields:function(r,t,i){for(i=i||this.length;this.pos<i;){var s=this.readVarint(),c=s>>3,m=this.pos;this.type=7&s,r(c,t,this),this.pos===m&&this.skip(s)}return t},readMessage:function(r,t){return this.readFields(r,t,this.readVarint()+this.pos)},readFixed32:function(){var r=rs(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=fh(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=rs(this.buf,this.pos)+rs(this.buf,this.pos+4)*Bu;return this.pos+=8,r},readSFixed64:function(){var r=rs(this.buf,this.pos)+fh(this.buf,this.pos+4)*Bu;return this.pos+=8,r},readFloat:function(){var r=Sc(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=Sc(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var t,i,s=this.buf;return t=127&(i=s[this.pos++]),i<128?t:(t|=(127&(i=s[this.pos++]))<<7,i<128?t:(t|=(127&(i=s[this.pos++]))<<14,i<128?t:(t|=(127&(i=s[this.pos++]))<<21,i<128?t:(function(c,m,g){var _,x,k=g.buf;if(_=(112&(x=k[g.pos++]))>>4,x<128||(_|=(127&(x=k[g.pos++]))<<3,x<128)||(_|=(127&(x=k[g.pos++]))<<10,x<128)||(_|=(127&(x=k[g.pos++]))<<17,x<128)||(_|=(127&(x=k[g.pos++]))<<24,x<128)||(_|=(1&(x=k[g.pos++]))<<31,x<128))return Il(c,_,m);throw new Error("Expected varint not more than 10 bytes")})(t|=(15&(i=s[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var r=this.readVarint()+this.pos,t=this.pos;return this.pos=r,r-t>=12&&kc?(function(i,s,c){return kc.decode(i.subarray(s,c))})(this.buf,t,r):(function(i,s,c){for(var m="",g=s;g<c;){var _,x,k,P=i[g],R=null,O=P>239?4:P>223?3:P>191?2:1;if(g+O>c)break;O===1?P<128&&(R=P):O===2?(192&(_=i[g+1]))==128&&(R=(31&P)<<6|63&_)<=127&&(R=null):O===3?(x=i[g+2],(192&(_=i[g+1]))==128&&(192&x)==128&&((R=(15&P)<<12|(63&_)<<6|63&x)<=2047||R>=55296&&R<=57343)&&(R=null)):O===4&&(x=i[g+2],k=i[g+3],(192&(_=i[g+1]))==128&&(192&x)==128&&(192&k)==128&&((R=(15&P)<<18|(63&_)<<12|(63&x)<<6|63&k)<=65535||R>=1114112)&&(R=null)),R===null?(R=65533,O=1):R>65535&&(R-=65536,m+=String.fromCharCode(R>>>10&1023|55296),R=56320|1023&R),m+=String.fromCharCode(R),g+=O}return m})(this.buf,t,r)},readBytes:function(){var r=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,r);return this.pos=r,t},readPackedVarint:function(r,t){if(this.type!==Mr.Bytes)return r.push(this.readVarint(t));var i=sa(this);for(r=r||[];this.pos<i;)r.push(this.readVarint(t));return r},readPackedSVarint:function(r){if(this.type!==Mr.Bytes)return r.push(this.readSVarint());var t=sa(this);for(r=r||[];this.pos<t;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==Mr.Bytes)return r.push(this.readBoolean());var t=sa(this);for(r=r||[];this.pos<t;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==Mr.Bytes)return r.push(this.readFloat());var t=sa(this);for(r=r||[];this.pos<t;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==Mr.Bytes)return r.push(this.readDouble());var t=sa(this);for(r=r||[];this.pos<t;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==Mr.Bytes)return r.push(this.readFixed32());var t=sa(this);for(r=r||[];this.pos<t;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==Mr.Bytes)return r.push(this.readSFixed32());var t=sa(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==Mr.Bytes)return r.push(this.readFixed64());var t=sa(this);for(r=r||[];this.pos<t;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==Mr.Bytes)return r.push(this.readSFixed64());var t=sa(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed64());return r},skip:function(r){var t=7&r;if(t===Mr.Varint)for(;this.buf[this.pos++]>127;);else if(t===Mr.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Mr.Fixed32)this.pos+=4;else{if(t!==Mr.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(r,t){this.writeVarint(r<<3|t)},realloc:function(r){for(var t=this.length||16;t<this.pos+r;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),lu(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),lu(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),lu(this.buf,-1&r,this.pos),lu(this.buf,Math.floor(r*Gs),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),lu(this.buf,-1&r,this.pos),lu(this.buf,Math.floor(r*Gs),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?(function(t,i){var s,c;if(t>=0?(s=t%4294967296|0,c=t/4294967296|0):(c=~(-t/4294967296),4294967295^(s=~(-t%4294967296))?s=s+1|0:(s=0,c=c+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),(function(m,g,_){_.buf[_.pos++]=127&m|128,m>>>=7,_.buf[_.pos++]=127&m|128,m>>>=7,_.buf[_.pos++]=127&m|128,m>>>=7,_.buf[_.pos++]=127&m|128,_.buf[_.pos]=127&(m>>>=7)})(s,0,i),(function(m,g){var _=(7&m)<<4;g.buf[g.pos++]|=_|((m>>>=3)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m)))))})(c,i)})(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(!!r)},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var t=this.pos;this.pos=(function(s,c,m){for(var g,_,x=0;x<c.length;x++){if((g=c.charCodeAt(x))>55295&&g<57344){if(!_){g>56319||x+1===c.length?(s[m++]=239,s[m++]=191,s[m++]=189):_=g;continue}if(g<56320){s[m++]=239,s[m++]=191,s[m++]=189,_=g;continue}g=_-55296<<10|g-56320|65536,_=null}else _&&(s[m++]=239,s[m++]=191,s[m++]=189,_=null);g<128?s[m++]=g:(g<2048?s[m++]=g>>6|192:(g<65536?s[m++]=g>>12|224:(s[m++]=g>>18|240,s[m++]=g>>12&63|128),s[m++]=g>>6&63|128),s[m++]=63&g|128)}return m})(this.buf,r,this.pos);var i=this.pos-t;i>=128&&Tc(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(r){this.realloc(4),dh(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),dh(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var t=r.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=r[i]},writeRawMessage:function(r,t){this.pos++;var i=this.pos;r(t,this);var s=this.pos-i;s>=128&&Tc(i,s,this),this.pos=i-1,this.writeVarint(s),this.pos+=s},writeMessage:function(r,t,i){this.writeTag(r,Mr.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(r,t){t.length&&this.writeMessage(r,ph,t)},writePackedSVarint:function(r,t){t.length&&this.writeMessage(r,yo,t)},writePackedBoolean:function(r,t){t.length&&this.writeMessage(r,Bo,t)},writePackedFloat:function(r,t){t.length&&this.writeMessage(r,Pl,t)},writePackedDouble:function(r,t){t.length&&this.writeMessage(r,ts,t)},writePackedFixed32:function(r,t){t.length&&this.writeMessage(r,Vd,t)},writePackedSFixed32:function(r,t){t.length&&this.writeMessage(r,Xh,t)},writePackedFixed64:function(r,t){t.length&&this.writeMessage(r,Kh,t)},writePackedSFixed64:function(r,t){t.length&&this.writeMessage(r,wp,t)},writeBytesField:function(r,t){this.writeTag(r,Mr.Bytes),this.writeBytes(t)},writeFixed32Field:function(r,t){this.writeTag(r,Mr.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(r,t){this.writeTag(r,Mr.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(r,t){this.writeTag(r,Mr.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(r,t){this.writeTag(r,Mr.Fixed64),this.writeSFixed64(t)},writeVarintField:function(r,t){this.writeTag(r,Mr.Varint),this.writeVarint(t)},writeSVarintField:function(r,t){this.writeTag(r,Mr.Varint),this.writeSVarint(t)},writeStringField:function(r,t){this.writeTag(r,Mr.Bytes),this.writeString(t)},writeFloatField:function(r,t){this.writeTag(r,Mr.Fixed32),this.writeFloat(t)},writeDoubleField:function(r,t){this.writeTag(r,Mr.Fixed64),this.writeDouble(t)},writeBooleanField:function(r,t){this.writeVarintField(r,!!t)}};var Hs=Se(Ts);const zc=3;function uu(r,t,i){r===1&&i.readMessage(Ud,t)}function Ud(r,t,i){if(r===3){const{id:s,bitmap:c,width:m,height:g,left:_,top:x,advance:k}=i.readMessage($d,{});t.push({id:s,bitmap:new iu({width:m+2*zc,height:g+2*zc},c),metrics:{width:m,height:g,left:_,top:x,advance:k}})}}function $d(r,t,i){r===1?t.id=i.readVarint():r===2?t.bitmap=i.readBytes():r===3?t.width=i.readVarint():r===4?t.height=i.readVarint():r===5?t.left=i.readSVarint():r===6?t.top=i.readSVarint():r===7&&(t.advance=i.readVarint())}const mh=zc;function Ec(r){let t=0,i=0;for(const g of r)t+=g.w*g.h,i=Math.max(i,g.w);r.sort(((g,_)=>_.h-g.h));const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}];let c=0,m=0;for(const g of r)for(let _=s.length-1;_>=0;_--){const x=s[_];if(!(g.w>x.w||g.h>x.h)){if(g.x=x.x,g.y=x.y,m=Math.max(m,g.y+g.h),c=Math.max(c,g.x+g.w),g.w===x.w&&g.h===x.h){const k=s.pop();_<s.length&&(s[_]=k)}else g.h===x.h?(x.x+=g.w,x.w-=g.w):g.w===x.w?(x.y+=g.h,x.h-=g.h):(s.push({x:x.x+g.w,y:x.y,w:x.w-g.w,h:g.h}),x.y+=g.h,x.h-=g.h);break}}return{w:c,h:m,fill:t/(c*m)||0}}const _o=1;class Jh{constructor(t,{pixelRatio:i,version:s,stretchX:c,stretchY:m,content:g,textFitWidth:_,textFitHeight:x}){this.paddedRect=t,this.pixelRatio=i,this.stretchX=c,this.stretchY=m,this.content=g,this.version=s,this.textFitWidth=_,this.textFitHeight=x}get tl(){return[this.paddedRect.x+_o,this.paddedRect.y+_o]}get br(){return[this.paddedRect.x+this.paddedRect.w-_o,this.paddedRect.y+this.paddedRect.h-_o]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*_o)/this.pixelRatio,(this.paddedRect.h-2*_o)/this.pixelRatio]}}class Yh{constructor(t,i){const s={},c={};this.haveRenderCallbacks=[];const m=[];this.addImages(t,s,m),this.addImages(i,c,m);const{w:g,h:_}=Ec(m),x=new zn({width:g||1,height:_||1});for(const k in t){const P=t[k],R=s[k].paddedRect;zn.copy(P.data,x,{x:0,y:0},{x:R.x+_o,y:R.y+_o},P.data)}for(const k in i){const P=i[k],R=c[k].paddedRect,O=R.x+_o,U=R.y+_o,G=P.data.width,J=P.data.height;zn.copy(P.data,x,{x:0,y:0},{x:O,y:U},P.data),zn.copy(P.data,x,{x:0,y:J-1},{x:O,y:U-1},{width:G,height:1}),zn.copy(P.data,x,{x:0,y:0},{x:O,y:U+J},{width:G,height:1}),zn.copy(P.data,x,{x:G-1,y:0},{x:O-1,y:U},{width:1,height:J}),zn.copy(P.data,x,{x:0,y:0},{x:O+G,y:U},{width:1,height:J})}this.image=x,this.iconPositions=s,this.patternPositions=c}addImages(t,i,s){for(const c in t){const m=t[c],g={x:0,y:0,w:m.data.width+2*_o,h:m.data.height+2*_o};s.push(g),i[c]=new Jh(g,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(c)}}patchUpdatedImages(t,i){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const s in t.updatedImages)this.patchUpdatedImage(this.iconPositions[s],t.getImage(s),i),this.patchUpdatedImage(this.patternPositions[s],t.getImage(s),i)}patchUpdatedImage(t,i,s){if(!t||!i||t.version===i.version)return;t.version=i.version;const[c,m]=t.tl;s.update(i.data,void 0,{x:c,y:m})}}var Ws;wt("ImagePosition",Jh),wt("ImageAtlas",Yh),A.ah=void 0,(Ws=A.ah||(A.ah={}))[Ws.none=0]="none",Ws[Ws.horizontal=1]="horizontal",Ws[Ws.vertical=2]="vertical",Ws[Ws.horizontalOnly=3]="horizontalOnly";const is=-17;class Cc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,i){const s=new Cc;return s.scale=t||1,s.fontStack=i,s}static forImage(t){const i=new Cc;return i.imageName=t,i}}class ns{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,i){const s=new ns;for(let c=0;c<t.sections.length;c++){const m=t.sections[c];m.image?s.addImageSection(m):s.addTextSection(m,i)}return s}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=(function(t){let i="";for(let s=0;s<t.length;s++){const c=t.charCodeAt(s+1)||null,m=t.charCodeAt(s-1)||null;i+=c&&qs(c)&&!su[t[s+1]]||m&&qs(m)&&!su[t[s-1]]||!su[t[s]]?t[s]:su[t[s]]}return i})(this.text)}trim(){let t=0;for(let s=0;s<this.text.length&&Ei[this.text.charCodeAt(s)];s++)t++;let i=this.text.length;for(let s=this.text.length-1;s>=0&&s>=t&&Ei[this.text.charCodeAt(s)];s--)i--;this.text=this.text.substring(t,i),this.sectionIndex=this.sectionIndex.slice(t,i)}substring(t,i){const s=new ns;return s.text=this.text.substring(t,i),s.sectionIndex=this.sectionIndex.slice(t,i),s.sections=this.sections,s}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((t,i)=>Math.max(t,this.sections[i].scale)),0)}addTextSection(t,i){this.text+=t.text,this.sections.push(Cc.forText(t.scale,t.fontStack||i));const s=this.sections.length-1;for(let c=0;c<t.text.length;++c)this.sectionIndex.push(s)}addImageSection(t){const i=t.image?t.image.name:"";if(i.length===0)return void kr("Can't add FormattedSection with an empty image.");const s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCharCode(s),this.sections.push(Cc.forImage(i)),this.sectionIndex.push(this.sections.length-1)):kr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Ic(r,t,i,s,c,m,g,_,x,k,P,R,O,U,G){const J=ns.fromFeature(r,c);let se;R===A.ah.vertical&&J.verticalizePunctuation();const{processBidirectionalText:he,processStyledBidirectionalText:Ee}=Jr;if(he&&J.sections.length===1){se=[];const Oe=he(J.toString(),Oo(J,k,m,t,s,U));for(const Je of Oe){const vt=new ns;vt.text=Je,vt.sections=J.sections;for(let qt=0;qt<Je.length;qt++)vt.sectionIndex.push(0);se.push(vt)}}else if(Ee){se=[];const Oe=Ee(J.text,J.sectionIndex,Oo(J,k,m,t,s,U));for(const Je of Oe){const vt=new ns;vt.text=Je[0],vt.sectionIndex=Je[1],vt.sections=J.sections,se.push(vt)}}else se=(function(Oe,Je){const vt=[],qt=Oe.text;let _t=0;for(const pt of Je)vt.push(Oe.substring(_t,pt)),_t=pt;return _t<qt.length&&vt.push(Oe.substring(_t,qt.length)),vt})(J,Oo(J,k,m,t,s,U));const ye=[],ze={positionedLines:ye,text:J.toString(),top:P[1],bottom:P[1],left:P[0],right:P[0],writingMode:R,iconsInText:!1,verticalizable:!1};return(function(Oe,Je,vt,qt,_t,pt,Rt,It,kt,Ve,Bt,Dt){let Qt=0,hi=is,ai=0,En=0;const Es=It==="right"?1:It==="left"?0:.5;let ro=0;for(const qi of _t){qi.trim();const In=qi.getMaxScale(),vo=(In-1)*vi,io={positionedGlyphs:[],lineOffset:0};Oe.positionedLines[ro]=io;const Uo=io.positionedGlyphs;let no=0;if(!qi.length()){hi+=pt,++ro;continue}for(let la=0;la<qi.length();la++){const $r=qi.getSection(la),mi=qi.getSectionIndex(la),xi=qi.getCharCode(la);let Ea=0,Bi=null,kh=null,Ll=null,Rl=vi;const Cs=!(kt===A.ah.horizontal||!Bt&&!Yl(xi)||Bt&&(Ei[xi]||(Cn=xi,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(Cn)))));if($r.imageName){const as=qt[$r.imageName];if(!as)continue;Ll=$r.imageName,Oe.iconsInText=Oe.iconsInText||!0,kh=as.paddedRect;const jn=as.displaySize;$r.scale=$r.scale*vi/Dt,Bi={width:jn[0],height:jn[1],left:_o,top:-mh,advance:Cs?jn[1]:jn[0]},Ea=vo+(vi-jn[1]*$r.scale),Rl=Bi.advance;const hu=Cs?jn[0]*$r.scale-vi*In:jn[1]*$r.scale-vi*In;hu>0&&hu>no&&(no=hu)}else{const as=vt[$r.fontStack],jn=as&&as[xi];if(jn&&jn.rect)kh=jn.rect,Bi=jn.metrics;else{const hu=Je[$r.fontStack],nd=hu&&hu[xi];if(!nd)continue;Bi=nd.metrics}Ea=(In-$r.scale)*vi}Cs?(Oe.verticalizable=!0,Uo.push({glyph:xi,imageName:Ll,x:Qt,y:hi+Ea,vertical:Cs,scale:$r.scale,fontStack:$r.fontStack,sectionIndex:mi,metrics:Bi,rect:kh}),Qt+=Rl*$r.scale+Ve):(Uo.push({glyph:xi,imageName:Ll,x:Qt,y:hi+Ea,vertical:Cs,scale:$r.scale,fontStack:$r.fontStack,sectionIndex:mi,metrics:Bi,rect:kh}),Qt+=Bi.advance*$r.scale+Ve)}Uo.length!==0&&(ai=Math.max(Qt-Ve,ai),Sp(Uo,0,Uo.length-1,Es,no)),Qt=0;const os=pt*In+no;io.lineOffset=Math.max(no,vo),hi+=os,En=Math.max(os,En),++ro}var Cn;const No=hi-is,{horizontalAlign:jo,verticalAlign:Vo}=Pc(Rt);(function(qi,In,vo,io,Uo,no,os,la,$r){const mi=(In-vo)*Uo;let xi=0;xi=no!==os?-la*io-is:(-io*$r+.5)*os;for(const Ea of qi)for(const Bi of Ea.positionedGlyphs)Bi.x+=mi,Bi.y+=xi})(Oe.positionedLines,Es,jo,Vo,ai,En,pt,No,_t.length),Oe.top+=-Vo*No,Oe.bottom=Oe.top+No,Oe.left+=-jo*ai,Oe.right=Oe.left+ai})(ze,t,i,s,se,g,_,x,R,k,O,G),!(function(Oe){for(const Je of Oe)if(Je.positionedGlyphs.length!==0)return!1;return!0})(ye)&&ze}const Ei={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},bp={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Zd={40:!0};function qd(r,t,i,s,c,m){if(t.imageName){const g=s[t.imageName];return g?g.displaySize[0]*t.scale*vi/m+c:0}{const g=i[t.fontStack],_=g&&g[r];return _?_.metrics.advance*t.scale+c:0}}function Gd(r,t,i,s){const c=Math.pow(r-t,2);return s?r<t?c/2:2*c:c+Math.abs(i)*i}function Hd(r,t,i){let s=0;return r===10&&(s-=1e4),i&&(s+=150),r!==40&&r!==65288||(s+=50),t!==41&&t!==65289||(s+=50),s}function Qh(r,t,i,s,c,m){let g=null,_=Gd(t,i,c,m);for(const x of s){const k=Gd(t-x.x,i,c,m)+x.badness;k<=_&&(g=x,_=k)}return{index:r,x:t,priorBreak:g,badness:_}}function Wd(r){return r?Wd(r.priorBreak).concat(r.index):[]}function Oo(r,t,i,s,c,m){if(!r)return[];const g=[],_=(function(R,O,U,G,J,se){let he=0;for(let Ee=0;Ee<R.length();Ee++){const ye=R.getSection(Ee);he+=qd(R.getCharCode(Ee),ye,G,J,O,se)}return he/Math.max(1,Math.ceil(he/U))})(r,t,i,s,c,m),x=r.text.indexOf("â€‹")>=0;let k=0;for(let R=0;R<r.length();R++){const O=r.getSection(R),U=r.getCharCode(R);if(Ei[U]||(k+=qd(U,O,s,c,t,m)),R<r.length()-1){const G=!((P=U)<11904)&&(!!vr["CJK Compatibility Forms"](P)||!!vr["CJK Compatibility"](P)||!!vr["CJK Strokes"](P)||!!vr["CJK Symbols and Punctuation"](P)||!!vr["Enclosed CJK Letters and Months"](P)||!!vr["Halfwidth and Fullwidth Forms"](P)||!!vr["Ideographic Description Characters"](P)||!!vr["Vertical Forms"](P)||Jl.test(String.fromCodePoint(P)));(bp[U]||G||O.imageName||R!==r.length()-2&&Zd[r.getCharCode(R+1)])&&g.push(Qh(R+1,k,_,g,Hd(U,r.getCharCode(R+1),G&&x),!1))}}var P;return Wd(Qh(r.length(),k,_,g,0,!0))}function Pc(r){let t=.5,i=.5;switch(r){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function Sp(r,t,i,s,c){if(!s&&!c)return;const m=r[i],g=(r[i].x+m.metrics.advance*m.scale)*s;for(let _=t;_<=i;_++)r[_].x-=g,r[_].y+=c}function Ml(r,t,i){const{horizontalAlign:s,verticalAlign:c}=Pc(i),m=t[0]-r.displaySize[0]*s,g=t[1]-r.displaySize[1]*c;return{image:r,top:g,bottom:g+r.displaySize[1],left:m,right:m+r.displaySize[0]}}function Mc(r){var t,i;let s=r.left,c=r.top,m=r.right-s,g=r.bottom-c;const _=(t=r.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",x=(i=r.image.textFitHeight)!==null&&i!==void 0?i:"stretchOrShrink",k=(r.image.content[2]-r.image.content[0])/(r.image.content[3]-r.image.content[1]);if(x==="proportional"){if(_==="stretchOnly"&&m/g<k||_==="proportional"){const P=Math.ceil(g*k);s*=P/m,m=P}}else if(_==="proportional"&&x==="stretchOnly"&&k!==0&&m/g>k){const P=Math.ceil(m/k);c*=P/g,g=P}return{x1:s,y1:c,x2:s+m,y2:c+g}}function Al(r,t,i,s,c,m){const g=r.image;let _;if(g.content){const se=g.content,he=g.pixelRatio||1;_=[se[0]/he,se[1]/he,g.displaySize[0]-se[2]/he,g.displaySize[1]-se[3]/he]}const x=t.left*m,k=t.right*m;let P,R,O,U;i==="width"||i==="both"?(U=c[0]+x-s[3],R=c[0]+k+s[1]):(U=c[0]+(x+k-g.displaySize[0])/2,R=U+g.displaySize[0]);const G=t.top*m,J=t.bottom*m;return i==="height"||i==="both"?(P=c[1]+G-s[0],O=c[1]+J+s[2]):(P=c[1]+(G+J-g.displaySize[1])/2,O=P+g.displaySize[1]),{image:g,top:P,right:R,bottom:O,left:U,collisionPadding:_}}const Dl=255,za=128,zs=Dl*za;function Xd(r,t){const{expression:i}=t;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new Sr(r+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:s,interpolationType:c}=i;let m=0;for(;m<s.length&&s[m]<=r;)m++;m=Math.max(0,m-1);let g=m;for(;g<s.length&&s[g]<r+1;)g++;g=Math.min(s.length-1,g);const _=s[m],x=s[g];return i.kind==="composite"?{kind:"composite",minZoom:_,maxZoom:x,interpolationType:c}:{kind:"camera",minZoom:_,maxZoom:x,minSize:i.evaluate(new Sr(_)),maxSize:i.evaluate(new Sr(x)),interpolationType:c}}}function Ac(r,t,i){let s="never";const c=r.get(t);return c?s=c:r.get(i)&&(s="always"),s}const kp=zl.VectorTileFeature.types,Kd=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Dc(r,t,i,s,c,m,g,_,x,k,P,R,O){const U=_?Math.min(zs,Math.round(_[0])):0,G=_?Math.min(zs,Math.round(_[1])):0;r.emplaceBack(t,i,Math.round(32*s),Math.round(32*c),m,g,(U<<1)+(x?1:0),G,16*k,16*P,256*R,256*O)}function Ou(r,t,i){r.emplaceBack(t.x,t.y,i),r.emplaceBack(t.x,t.y,i),r.emplaceBack(t.x,t.y,i),r.emplaceBack(t.x,t.y,i)}function gh(r){for(const t of r.sections)if(ws(t.text))return!0;return!1}class yh{constructor(t){this.layoutVertexArray=new Ao,this.indexArray=new Do,this.programConfigurations=t,this.segments=new mr,this.dynamicLayoutVertexArray=new Sa,this.opacityVertexArray=new Bn,this.hasVisibleVertices=!1,this.placedSymbolArray=new Gr}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,i,s,c){this.isEmpty()||(s&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,wc.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,au.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Kd,!0),this.opacityVertexBuffer.itemSize=1),(s||c)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}wt("SymbolBuffers",yh);class Lc{constructor(t,i,s){this.layoutVertexArray=new t,this.layoutAttributes=i,this.indexArray=new s,this.segments=new mr,this.collisionVertexArray=new ea}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,ch.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}wt("CollisionBuffers",Lc);class Nu{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((g=>g.id)),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Wc([]),this.placementViewportMatrix=Wc([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Xd(this.zoom,i["text-size"]),this.iconSizeData=Xd(this.zoom,i["icon-size"]);const s=this.layers[0].layout,c=s.get("symbol-sort-key"),m=s.get("symbol-z-order");this.canOverlap=Ac(s,"text-overlap","text-allow-overlap")!=="never"||Ac(s,"icon-overlap","icon-allow-overlap")!=="never"||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&!c.isConstant(),this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,s.get("symbol-placement")==="point"&&(this.writingModes=s.get("text-writing-mode").map((g=>A.ah[g]))),this.stateDependentLayerIds=this.layers.filter((g=>g.isStateDependent())).map((g=>g.id)),this.sourceID=t.sourceID}createArrays(){this.text=new yh(new Qa(this.layers,this.zoom,(t=>/^text/.test(t)))),this.icon=new yh(new Qa(this.layers,this.zoom,(t=>/^icon/.test(t)))),this.glyphOffsetArray=new Yr,this.lineVertexArray=new on,this.symbolInstances=new dr,this.textAnchorOffsets=new Qr}calculateGlyphDependencies(t,i,s,c,m){for(let g=0;g<t.length;g++)if(i[t.charCodeAt(g)]=!0,(s||c)&&m){const _=su[t.charAt(g)];_&&(i[_.charCodeAt(0)]=!0)}}populate(t,i,s){const c=this.layers[0],m=c.layout,g=m.get("text-font"),_=m.get("text-field"),x=m.get("icon-image"),k=(_.value.kind!=="constant"||_.value.value instanceof wn&&!_.value.value.isEmpty()||_.value.value.toString().length>0)&&(g.value.kind!=="constant"||g.value.value.length>0),P=x.value.kind!=="constant"||!!x.value.value||Object.keys(x.parameters).length>0,R=m.get("symbol-sort-key");if(this.features=[],!k&&!P)return;const O=i.iconDependencies,U=i.glyphDependencies,G=i.availableImages,J=new Sr(this.zoom);for(const{feature:se,id:he,index:Ee,sourceLayerIndex:ye}of t){const ze=c._featureFilter.needGeometry,Oe=kl(se,ze);if(!c._featureFilter.filter(J,Oe,s))continue;let Je,vt;if(ze||(Oe.geometry=Sl(se)),k){const _t=c.getValueAndResolveTokens("text-field",Oe,s,G),pt=wn.factory(_t),Rt=this.hasRTLText=this.hasRTLText||gh(pt);(!Rt||Jr.getRTLTextPluginStatus()==="unavailable"||Rt&&Jr.isParsed())&&(Je=Fo(pt,c,Oe))}if(P){const _t=c.getValueAndResolveTokens("icon-image",Oe,s,G);vt=_t instanceof Hi?_t:Hi.fromString(_t)}if(!Je&&!vt)continue;const qt=this.sortFeaturesByKey?R.evaluate(Oe,{},s):void 0;if(this.features.push({id:he,text:Je,icon:vt,index:Ee,sourceLayerIndex:ye,geometry:Oe.geometry,properties:se.properties,type:kp[se.type],sortKey:qt}),vt&&(O[vt.name]=!0),Je){const _t=g.evaluate(Oe,{},s).join(","),pt=m.get("text-rotation-alignment")!=="viewport"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(A.ah.vertical)>=0;for(const Rt of Je.sections)if(Rt.image)O[Rt.image.name]=!0;else{const It=rc(Je.toString()),kt=Rt.fontStack||_t,Ve=U[kt]=U[kt]||{};this.calculateGlyphDependencies(Rt.text,Ve,pt,this.allowVerticalPlacement,It)}}}m.get("symbol-placement")==="line"&&(this.features=(function(se){const he={},Ee={},ye=[];let ze=0;function Oe(_t){ye.push(se[_t]),ze++}function Je(_t,pt,Rt){const It=Ee[_t];return delete Ee[_t],Ee[pt]=It,ye[It].geometry[0].pop(),ye[It].geometry[0]=ye[It].geometry[0].concat(Rt[0]),It}function vt(_t,pt,Rt){const It=he[pt];return delete he[pt],he[_t]=It,ye[It].geometry[0].shift(),ye[It].geometry[0]=Rt[0].concat(ye[It].geometry[0]),It}function qt(_t,pt,Rt){const It=Rt?pt[0][pt[0].length-1]:pt[0][0];return`${_t}:${It.x}:${It.y}`}for(let _t=0;_t<se.length;_t++){const pt=se[_t],Rt=pt.geometry,It=pt.text?pt.text.toString():null;if(!It){Oe(_t);continue}const kt=qt(It,Rt),Ve=qt(It,Rt,!0);if(kt in Ee&&Ve in he&&Ee[kt]!==he[Ve]){const Bt=vt(kt,Ve,Rt),Dt=Je(kt,Ve,ye[Bt].geometry);delete he[kt],delete Ee[Ve],Ee[qt(It,ye[Dt].geometry,!0)]=Dt,ye[Bt].geometry=null}else kt in Ee?Je(kt,Ve,Rt):Ve in he?vt(kt,Ve,Rt):(Oe(_t),he[kt]=ze-1,Ee[Ve]=ze-1)}return ye.filter((_t=>_t.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((se,he)=>se.sortKey-he.sortKey))}update(t,i,s){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,i,this.layers,s),this.icon.programConfigurations.updatePaintArrays(t,i,this.layers,s))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,i){const s=this.lineVertexArray.length;if(t.segment!==void 0){let c=t.dist(i[t.segment+1]),m=t.dist(i[t.segment]);const g={};for(let _=t.segment+1;_<i.length;_++)g[_]={x:i[_].x,y:i[_].y,tileUnitDistanceFromAnchor:c},_<i.length-1&&(c+=i[_+1].dist(i[_]));for(let _=t.segment||0;_>=0;_--)g[_]={x:i[_].x,y:i[_].y,tileUnitDistanceFromAnchor:m},_>0&&(m+=i[_-1].dist(i[_]));for(let _=0;_<i.length;_++){const x=g[_];this.lineVertexArray.emplaceBack(x.x,x.y,x.tileUnitDistanceFromAnchor)}}return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(t,i,s,c,m,g,_,x,k,P,R,O){const U=t.indexArray,G=t.layoutVertexArray,J=t.segments.prepareSegment(4*i.length,G,U,this.canOverlap?g.sortKey:void 0),se=this.glyphOffsetArray.length,he=J.vertexLength,Ee=this.allowVerticalPlacement&&_===A.ah.vertical?Math.PI/2:0,ye=g.text&&g.text.sections;for(let ze=0;ze<i.length;ze++){const{tl:Oe,tr:Je,bl:vt,br:qt,tex:_t,pixelOffsetTL:pt,pixelOffsetBR:Rt,minFontScaleX:It,minFontScaleY:kt,glyphOffset:Ve,isSDF:Bt,sectionIndex:Dt}=i[ze],Qt=J.vertexLength,hi=Ve[1];Dc(G,x.x,x.y,Oe.x,hi+Oe.y,_t.x,_t.y,s,Bt,pt.x,pt.y,It,kt),Dc(G,x.x,x.y,Je.x,hi+Je.y,_t.x+_t.w,_t.y,s,Bt,Rt.x,pt.y,It,kt),Dc(G,x.x,x.y,vt.x,hi+vt.y,_t.x,_t.y+_t.h,s,Bt,pt.x,Rt.y,It,kt),Dc(G,x.x,x.y,qt.x,hi+qt.y,_t.x+_t.w,_t.y+_t.h,s,Bt,Rt.x,Rt.y,It,kt),Ou(t.dynamicLayoutVertexArray,x,Ee),U.emplaceBack(Qt,Qt+1,Qt+2),U.emplaceBack(Qt+1,Qt+2,Qt+3),J.vertexLength+=4,J.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ve[0]),ze!==i.length-1&&Dt===i[ze+1].sectionIndex||t.programConfigurations.populatePaintArrays(G.length,g,g.index,{},O,ye&&ye[Dt])}t.placedSymbolArray.emplaceBack(x.x,x.y,se,this.glyphOffsetArray.length-se,he,k,P,x.segment,s?s[0]:0,s?s[1]:0,c[0],c[1],_,0,!1,0,R)}_addCollisionDebugVertex(t,i,s,c,m,g){return i.emplaceBack(0,0),t.emplaceBack(s.x,s.y,c,m,Math.round(g.x),Math.round(g.y))}addCollisionDebugVertices(t,i,s,c,m,g,_){const x=m.segments.prepareSegment(4,m.layoutVertexArray,m.indexArray),k=x.vertexLength,P=m.layoutVertexArray,R=m.collisionVertexArray,O=_.anchorX,U=_.anchorY;this._addCollisionDebugVertex(P,R,g,O,U,new re(t,i)),this._addCollisionDebugVertex(P,R,g,O,U,new re(s,i)),this._addCollisionDebugVertex(P,R,g,O,U,new re(s,c)),this._addCollisionDebugVertex(P,R,g,O,U,new re(t,c)),x.vertexLength+=4;const G=m.indexArray;G.emplaceBack(k,k+1),G.emplaceBack(k+1,k+2),G.emplaceBack(k+2,k+3),G.emplaceBack(k+3,k),x.primitiveLength+=4}addDebugCollisionBoxes(t,i,s,c){for(let m=t;m<i;m++){const g=this.collisionBoxArray.get(m);this.addCollisionDebugVertices(g.x1,g.y1,g.x2,g.y2,c?this.textCollisionBox:this.iconCollisionBox,g.anchorPoint,s)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Lc(fo,hh.members,Ri),this.iconCollisionBox=new Lc(fo,hh.members,Ri);for(let t=0;t<this.symbolInstances.length;t++){const i=this.symbolInstances.get(t);this.addDebugCollisionBoxes(i.textBoxStartIndex,i.textBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.iconBoxStartIndex,i.iconBoxEndIndex,i,!1),this.addDebugCollisionBoxes(i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex,i,!1)}}_deserializeCollisionBoxesForSymbol(t,i,s,c,m,g,_,x,k){const P={};for(let R=i;R<s;R++){const O=t.get(R);P.textBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},P.textFeatureIndex=O.featureIndex;break}for(let R=c;R<m;R++){const O=t.get(R);P.verticalTextBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},P.verticalTextFeatureIndex=O.featureIndex;break}for(let R=g;R<_;R++){const O=t.get(R);P.iconBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},P.iconFeatureIndex=O.featureIndex;break}for(let R=x;R<k;R++){const O=t.get(R);P.verticalIconBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},P.verticalIconFeatureIndex=O.featureIndex;break}return P}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const s=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,i){const s=t.placedSymbolArray.get(i),c=s.vertexStartIndex+4*s.numGlyphs;for(let m=s.vertexStartIndex;m<c;m+=4)t.indexArray.emplaceBack(m,m+1,m+2),t.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(t),s=Math.cos(t),c=[],m=[],g=[];for(let _=0;_<this.symbolInstances.length;++_){g.push(_);const x=this.symbolInstances.get(_);c.push(0|Math.round(i*x.anchorX+s*x.anchorY)),m.push(x.featureIndex)}return g.sort(((_,x)=>c[_]-c[x]||m[x]-m[_])),g}addToSortKeyRanges(t,i){const s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===i?s.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const s=this.symbolInstances.get(i);this.featureSortOrder.push(s.featureIndex),[s.rightJustifiedTextSymbolIndex,s.centerJustifiedTextSymbolIndex,s.leftJustifiedTextSymbolIndex].forEach(((c,m,g)=>{c>=0&&g.indexOf(c)===m&&this.addIndicesForPlacedSymbol(this.text,c)})),s.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,s.verticalPlacedTextSymbolIndex),s.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.placedIconSymbolIndex),s.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let ed,_h;wt("SymbolBucket",Nu,{omit:["layers","collisionBoxArray","features","compareText"]}),Nu.MAX_GLYPHS=65535,Nu.addDynamicAttributes=Ou;var ju={get paint(){return _h=_h||new f({"icon-opacity":new Nt(Fe.paint_symbol["icon-opacity"]),"icon-color":new Nt(Fe.paint_symbol["icon-color"]),"icon-halo-color":new Nt(Fe.paint_symbol["icon-halo-color"]),"icon-halo-width":new Nt(Fe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Nt(Fe.paint_symbol["icon-halo-blur"]),"icon-translate":new bt(Fe.paint_symbol["icon-translate"]),"icon-translate-anchor":new bt(Fe.paint_symbol["icon-translate-anchor"]),"text-opacity":new Nt(Fe.paint_symbol["text-opacity"]),"text-color":new Nt(Fe.paint_symbol["text-color"],{runtimeType:Gi,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new Nt(Fe.paint_symbol["text-halo-color"]),"text-halo-width":new Nt(Fe.paint_symbol["text-halo-width"]),"text-halo-blur":new Nt(Fe.paint_symbol["text-halo-blur"]),"text-translate":new bt(Fe.paint_symbol["text-translate"]),"text-translate-anchor":new bt(Fe.paint_symbol["text-translate-anchor"])})},get layout(){return ed=ed||new f({"symbol-placement":new bt(Fe.layout_symbol["symbol-placement"]),"symbol-spacing":new bt(Fe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new bt(Fe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Nt(Fe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new bt(Fe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new bt(Fe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new bt(Fe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new bt(Fe.layout_symbol["icon-ignore-placement"]),"icon-optional":new bt(Fe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new bt(Fe.layout_symbol["icon-rotation-alignment"]),"icon-size":new Nt(Fe.layout_symbol["icon-size"]),"icon-text-fit":new bt(Fe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new bt(Fe.layout_symbol["icon-text-fit-padding"]),"icon-image":new Nt(Fe.layout_symbol["icon-image"]),"icon-rotate":new Nt(Fe.layout_symbol["icon-rotate"]),"icon-padding":new Nt(Fe.layout_symbol["icon-padding"]),"icon-keep-upright":new bt(Fe.layout_symbol["icon-keep-upright"]),"icon-offset":new Nt(Fe.layout_symbol["icon-offset"]),"icon-anchor":new Nt(Fe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new bt(Fe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new bt(Fe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new bt(Fe.layout_symbol["text-rotation-alignment"]),"text-field":new Nt(Fe.layout_symbol["text-field"]),"text-font":new Nt(Fe.layout_symbol["text-font"]),"text-size":new Nt(Fe.layout_symbol["text-size"]),"text-max-width":new Nt(Fe.layout_symbol["text-max-width"]),"text-line-height":new bt(Fe.layout_symbol["text-line-height"]),"text-letter-spacing":new Nt(Fe.layout_symbol["text-letter-spacing"]),"text-justify":new Nt(Fe.layout_symbol["text-justify"]),"text-radial-offset":new Nt(Fe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new bt(Fe.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Nt(Fe.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Nt(Fe.layout_symbol["text-anchor"]),"text-max-angle":new bt(Fe.layout_symbol["text-max-angle"]),"text-writing-mode":new bt(Fe.layout_symbol["text-writing-mode"]),"text-rotate":new Nt(Fe.layout_symbol["text-rotate"]),"text-padding":new bt(Fe.layout_symbol["text-padding"]),"text-keep-upright":new bt(Fe.layout_symbol["text-keep-upright"]),"text-transform":new Nt(Fe.layout_symbol["text-transform"]),"text-offset":new Nt(Fe.layout_symbol["text-offset"]),"text-allow-overlap":new bt(Fe.layout_symbol["text-allow-overlap"]),"text-overlap":new bt(Fe.layout_symbol["text-overlap"]),"text-ignore-placement":new bt(Fe.layout_symbol["text-ignore-placement"]),"text-optional":new bt(Fe.layout_symbol["text-optional"])})}};class vh{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:ri,this.defaultValue=t}evaluate(t){if(t.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(t.formattedSection))return i.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}wt("FormatSectionOverride",vh,{omit:["defaultValue"]});class cu extends o{constructor(t){super(t,ju)}recalculate(t,i){if(super.recalculate(t,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const s=this.layout.get("text-writing-mode");if(s){const c=[];for(const m of s)c.indexOf(m)<0&&c.push(m);this.layout._values["text-writing-mode"]=c}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,i,s,c){const m=this.layout.get(t).evaluate(i,{},s,c),g=this._unevaluatedLayout._values[t];return g.isDataDriven()||gs(g.value)||!m?m:(function(_,x){return x.replace(/{([^{}]+)}/g,((k,P)=>_&&P in _?String(_[P]):""))})(i.properties,m)}createBucket(t){return new Nu(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of ju.paint.overridableProperties){if(!cu.hasPaintOverride(this.layout,t))continue;const i=this.paint.get(t),s=new vh(i),c=new Hn(s,i.property.specification);let m=null;m=i.value.kind==="constant"||i.value.kind==="source"?new Ns("source",c):new js("composite",c,i.value.zoomStops),this.paint._values[t]=new co(i.property,m,i.parameters)}}_handleOverridablePaintPropertyUpdate(t,i,s){return!(!this.layout||i.isDataDriven()||s.isDataDriven())&&cu.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,i){const s=t.get("text-field"),c=ju.paint.properties[i];let m=!1;const g=_=>{for(const x of _)if(c.overrides&&c.overrides.hasOverride(x))return void(m=!0)};if(s.value.kind==="constant"&&s.value.value instanceof wn)g(s.value.value.sections);else if(s.value.kind==="source"){const _=k=>{m||(k instanceof lo&&Vr(k.value)===so?g(k.value.sections):k instanceof fa?g(k.sections):k.eachChild(_))},x=s.value;x._styleExpression&&_(x._styleExpression.expression)}return m}}let td;var Tp={get paint(){return td=td||new f({"background-color":new bt(Fe.paint_background["background-color"]),"background-pattern":new eu(Fe.paint_background["background-pattern"]),"background-opacity":new bt(Fe.paint_background["background-opacity"])})}};class xh extends o{constructor(t){super(t,Tp)}}let Jd;var Rc={get paint(){return Jd=Jd||new f({"raster-opacity":new bt(Fe.paint_raster["raster-opacity"]),"raster-hue-rotate":new bt(Fe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new bt(Fe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new bt(Fe.paint_raster["raster-brightness-max"]),"raster-saturation":new bt(Fe.paint_raster["raster-saturation"]),"raster-contrast":new bt(Fe.paint_raster["raster-contrast"]),"raster-resampling":new bt(Fe.paint_raster["raster-resampling"]),"raster-fade-duration":new bt(Fe.paint_raster["raster-fade-duration"])})}};class zp extends o{constructor(t){super(t,Rc)}}class wh extends o{constructor(t){super(t,{}),this.onAdd=i=>{this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},this.onRemove=i=>{this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class n{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const a=63710088e-1;class h{constructor(t,i){if(isNaN(t)||isNaN(i))throw new Error(`Invalid LngLat object: (${t}, ${i})`);if(this.lng=+t,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new h(gr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const i=Math.PI/180,s=this.lat*i,c=t.lat*i,m=Math.sin(s)*Math.sin(c)+Math.cos(s)*Math.cos(c)*Math.cos((t.lng-this.lng)*i);return a*Math.acos(Math.min(m,1))}static convert(t){if(t instanceof h)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new h(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new h(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const y=2*Math.PI*a;function b(r){return y*Math.cos(r*Math.PI/180)}function E(r){return(180+r)/360}function Z(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function ce(r,t){return r/b(t)}function _e(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}class Be{constructor(t,i,s=0){this.x=+t,this.y=+i,this.z=+s}static fromLngLat(t,i=0){const s=h.convert(t);return new Be(E(s.lng),Z(s.lat),ce(i,s.lat))}toLngLat(){return new h(360*this.x-180,_e(this.y))}toAltitude(){return this.z*b(_e(this.y))}meterInMercatorCoordinateUnits(){return 1/y*(t=_e(this.y),1/Math.cos(t*Math.PI/180));var t}}function Qe(r,t,i){var s=2*Math.PI*6378137/256/Math.pow(2,i);return[r*s-2*Math.PI*6378137/2,t*s-2*Math.PI*6378137/2]}class nt{constructor(t,i,s){if(!(function(c,m,g){return!(c<0||c>25||g<0||g>=Math.pow(2,c)||m<0||m>=Math.pow(2,c))})(t,i,s))throw new Error(`x=${i}, y=${s}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=i,this.y=s,this.key=At(0,t,t,i,s)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,i,s){const c=(g=this.y,_=this.z,x=Qe(256*(m=this.x),256*(g=Math.pow(2,_)-g-1),_),k=Qe(256*(m+1),256*(g+1),_),x[0]+","+x[1]+","+k[0]+","+k[1]);var m,g,_,x,k;const P=(function(R,O,U){let G,J="";for(let se=R;se>0;se--)G=1<<se-1,J+=(O&G?1:0)+(U&G?2:0);return J})(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,i>1?"@2x":"").replace(/{quadkey}/g,P).replace(/{bbox-epsg-3857}/g,c)}isChildOf(t){const i=this.z-t.z;return i>0&&t.x===this.x>>i&&t.y===this.y>>i}getTilePoint(t){const i=Math.pow(2,this.z);return new re((t.x*i-this.x)*Fi,(t.y*i-this.y)*Fi)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ye{constructor(t,i){this.wrap=t,this.canonical=i,this.key=At(t,i.z,i.z,i.x,i.y)}}class yt{constructor(t,i,s,c,m){if(t<s)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${s}`);this.overscaledZ=t,this.wrap=i,this.canonical=new nt(s,+c,+m),this.key=At(i,t,s,c,m)}clone(){return new yt(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const i=this.canonical.z-t;return t>this.canonical.z?new yt(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new yt(t,this.wrap,t,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(t,i){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-t;return t>this.canonical.z?At(this.wrap*+i,t,this.canonical.z,this.canonical.x,this.canonical.y):At(this.wrap*+i,t,t,this.canonical.x>>s,this.canonical.y>>s)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const i=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>i&&t.canonical.y===this.canonical.y>>i}children(t){if(this.overscaledZ>=t)return[new yt(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,s=2*this.canonical.x,c=2*this.canonical.y;return[new yt(i,this.wrap,i,s,c),new yt(i,this.wrap,i,s+1,c),new yt(i,this.wrap,i,s,c+1),new yt(i,this.wrap,i,s+1,c+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new yt(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new yt(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ye(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Be(t.x-this.wrap,t.y))}}function At(r,t,i,s,c){(r*=2)<0&&(r=-1*r-1);const m=1<<i;return(m*m*r+m*c+s).toString(36)+i.toString(36)+t.toString(36)}wt("CanonicalTileID",nt),wt("OverscaledTileID",yt,{omit:["posMatrix"]});class Ot{constructor(t,i,s,c=1,m=1,g=1,_=0){if(this.uid=t,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(s&&!["mapbox","terrarium","custom"].includes(s))return void kr(`"${s}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=i.height;const x=this.dim=i.height-2;switch(this.data=new Uint32Array(i.data.buffer),s){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=c,this.greenFactor=m,this.blueFactor=g,this.baseShift=_;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let k=0;k<x;k++)this.data[this._idx(-1,k)]=this.data[this._idx(0,k)],this.data[this._idx(x,k)]=this.data[this._idx(x-1,k)],this.data[this._idx(k,-1)]=this.data[this._idx(k,0)],this.data[this._idx(k,x)]=this.data[this._idx(k,x-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(x,-1)]=this.data[this._idx(x-1,0)],this.data[this._idx(-1,x)]=this.data[this._idx(0,x-1)],this.data[this._idx(x,x)]=this.data[this._idx(x-1,x-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let k=0;k<x;k++)for(let P=0;P<x;P++){const R=this.get(k,P);R>this.max&&(this.max=R),R<this.min&&(this.min=R)}}get(t,i){const s=new Uint8Array(this.data.buffer),c=4*this._idx(t,i);return this.unpack(s[c],s[c+1],s[c+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,i){if(t<-1||t>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(t+1)}unpack(t,i,s){return t*this.redFactor+i*this.greenFactor+s*this.blueFactor-this.baseShift}getPixels(){return new zn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,i,s){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let c=i*this.dim,m=i*this.dim+this.dim,g=s*this.dim,_=s*this.dim+this.dim;switch(i){case-1:c=m-1;break;case 1:m=c+1}switch(s){case-1:g=_-1;break;case 1:_=g+1}const x=-i*this.dim,k=-s*this.dim;for(let P=g;P<_;P++)for(let R=c;R<m;R++)this.data[this._idx(R,P)]=t.data[this._idx(R+x,P+k)]}}wt("DEMData",Ot);class Zi{constructor(t){this._stringToNumber={},this._numberToString=[];for(let i=0;i<t.length;i++){const s=t[i];this._stringToNumber[s]=i,this._numberToString[i]=s}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class Me{constructor(t,i,s,c,m){this.type="Feature",this._vectorTileFeature=t,t._z=i,t._x=s,t._y=c,this.properties=t.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const i in this)i!=="_geometry"&&i!=="_vectorTileFeature"&&(t[i]=this[i]);return t}}class we{constructor(t,i){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new ml(Fi,16,0),this.grid3D=new ml(Fi,16,0),this.featureIndexArray=new ci,this.promoteId=i}insert(t,i,s,c,m,g){const _=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,c,m);const x=g?this.grid3D:this.grid;for(let k=0;k<i.length;k++){const P=i[k],R=[1/0,1/0,-1/0,-1/0];for(let O=0;O<P.length;O++){const U=P[O];R[0]=Math.min(R[0],U.x),R[1]=Math.min(R[1],U.y),R[2]=Math.max(R[2],U.x),R[3]=Math.max(R[3],U.y)}R[0]<Fi&&R[1]<Fi&&R[2]>=0&&R[3]>=0&&x.insert(_,R[0],R[1],R[2],R[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new zl.VectorTile(new Hs(this.rawTileData)).layers,this.sourceLayerCoder=new Zi(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,i,s,c){this.loadVTLayers();const m=t.params||{},g=Fi/t.tileSize/t.scale,_=ql(m.filter),x=t.queryGeometry,k=t.queryPadding*g,P=ht(x),R=this.grid.query(P.minX-k,P.minY-k,P.maxX+k,P.maxY+k),O=ht(t.cameraQueryGeometry),U=this.grid3D.query(O.minX-k,O.minY-k,O.maxX+k,O.maxY+k,((se,he,Ee,ye)=>(function(ze,Oe,Je,vt,qt){for(const pt of ze)if(Oe<=pt.x&&Je<=pt.y&&vt>=pt.x&&qt>=pt.y)return!0;const _t=[new re(Oe,Je),new re(Oe,qt),new re(vt,qt),new re(vt,Je)];if(ze.length>2){for(const pt of _t)if(tu(ze,pt))return!0}for(let pt=0;pt<ze.length-1;pt++)if(md(ze[pt],ze[pt+1],_t))return!0;return!1})(t.cameraQueryGeometry,se-k,he-k,Ee+k,ye+k)));for(const se of U)R.push(se);R.sort(jt);const G={};let J;for(let se=0;se<R.length;se++){const he=R[se];if(he===J)continue;J=he;const Ee=this.featureIndexArray.get(he);let ye=null;this.loadMatchingFeature(G,Ee.bucketIndex,Ee.sourceLayerIndex,Ee.featureIndex,_,m.layers,m.availableImages,i,s,c,((ze,Oe,Je)=>(ye||(ye=Sl(ze)),Oe.queryIntersectsFeature(x,ze,Je,ye,this.z,t.transform,g,t.pixelPosMatrix))))}return G}loadMatchingFeature(t,i,s,c,m,g,_,x,k,P,R){const O=this.bucketLayerIDs[i];if(g&&!(function(se,he){for(let Ee=0;Ee<se.length;Ee++)if(he.indexOf(se[Ee])>=0)return!0;return!1})(g,O))return;const U=this.sourceLayerCoder.decode(s),G=this.vtLayers[U].feature(c);if(m.needGeometry){const se=kl(G,!0);if(!m.filter(new Sr(this.tileID.overscaledZ),se,this.tileID.canonical))return}else if(!m.filter(new Sr(this.tileID.overscaledZ),G))return;const J=this.getId(G,U);for(let se=0;se<O.length;se++){const he=O[se];if(g&&g.indexOf(he)<0)continue;const Ee=x[he];if(!Ee)continue;let ye={};J&&P&&(ye=P.getState(Ee.sourceLayer||"_geojsonTileLayer",J));const ze=Vt({},k[he]);ze.paint=Re(ze.paint,Ee.paint,G,ye,_),ze.layout=Re(ze.layout,Ee.layout,G,ye,_);const Oe=!R||R(G,Ee,ye);if(!Oe)continue;const Je=new Me(G,this.z,this.x,this.y,J);Je.layer=ze;let vt=t[he];vt===void 0&&(vt=t[he]=[]),vt.push({featureIndex:c,feature:Je,intersectionZ:Oe})}}lookupSymbolFeatures(t,i,s,c,m,g,_,x){const k={};this.loadVTLayers();const P=ql(m);for(const R of t)this.loadMatchingFeature(k,s,c,R,P,g,_,x,i);return k}hasLayer(t){for(const i of this.bucketLayerIDs)for(const s of i)if(t===s)return!0;return!1}getId(t,i){let s=t.id;return this.promoteId&&(s=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[i]],typeof s=="boolean"&&(s=Number(s))),s}}function Re(r,t,i,s,c){return xr(r,((m,g)=>{const _=t instanceof _l?t.get(g):null;return _&&_.evaluate?_.evaluate(i,s,c):_}))}function ht(r){let t=1/0,i=1/0,s=-1/0,c=-1/0;for(const m of r)t=Math.min(t,m.x),i=Math.min(i,m.y),s=Math.max(s,m.x),c=Math.max(c,m.y);return{minX:t,minY:i,maxX:s,maxY:c}}function jt(r,t){return t-r}function Yt(r,t,i,s,c){const m=[];for(let g=0;g<r.length;g++){const _=r[g];let x;for(let k=0;k<_.length-1;k++){let P=_[k],R=_[k+1];P.x<t&&R.x<t||(P.x<t?P=new re(t,P.y+(t-P.x)/(R.x-P.x)*(R.y-P.y))._round():R.x<t&&(R=new re(t,P.y+(t-P.x)/(R.x-P.x)*(R.y-P.y))._round()),P.y<i&&R.y<i||(P.y<i?P=new re(P.x+(i-P.y)/(R.y-P.y)*(R.x-P.x),i)._round():R.y<i&&(R=new re(P.x+(i-P.y)/(R.y-P.y)*(R.x-P.x),i)._round()),P.x>=s&&R.x>=s||(P.x>=s?P=new re(s,P.y+(s-P.x)/(R.x-P.x)*(R.y-P.y))._round():R.x>=s&&(R=new re(s,P.y+(s-P.x)/(R.x-P.x)*(R.y-P.y))._round()),P.y>=c&&R.y>=c||(P.y>=c?P=new re(P.x+(c-P.y)/(R.y-P.y)*(R.x-P.x),c)._round():R.y>=c&&(R=new re(P.x+(c-P.y)/(R.y-P.y)*(R.x-P.x),c)._round()),x&&P.equals(x[x.length-1])||(x=[P],m.push(x)),x.push(R)))))}}return m}wt("FeatureIndex",we,{omit:["rawTileData","sourceLayerCoder"]});class Ut extends re{constructor(t,i,s,c){super(t,i),this.angle=s,c!==void 0&&(this.segment=c)}clone(){return new Ut(this.x,this.y,this.angle,this.segment)}}function lr(r,t,i,s,c){if(t.segment===void 0||i===0)return!0;let m=t,g=t.segment+1,_=0;for(;_>-i/2;){if(g--,g<0)return!1;_-=r[g].dist(m),m=r[g]}_+=r[g].dist(r[g+1]),g++;const x=[];let k=0;for(;_<i/2;){const P=r[g],R=r[g+1];if(!R)return!1;let O=r[g-1].angleTo(P)-P.angleTo(R);for(O=Math.abs((O+3*Math.PI)%(2*Math.PI)-Math.PI),x.push({distance:_,angleDelta:O}),k+=O;_-x[0].distance>s;)k-=x.shift().angleDelta;if(k>c)return!1;g++,_+=P.dist(R)}return!0}function vn(r){let t=0;for(let i=0;i<r.length-1;i++)t+=r[i].dist(r[i+1]);return t}function Zr(r,t,i){return r?.6*t*i:0}function Xs(r,t){return Math.max(r?r.right-r.left:0,t?t.right-t.left:0)}function Ep(r,t,i,s,c,m){const g=Zr(i,c,m),_=Xs(i,s)*m;let x=0;const k=vn(r)/2;for(let P=0;P<r.length-1;P++){const R=r[P],O=r[P+1],U=R.dist(O);if(x+U>k){const G=(k-x)/U,J=ki.number(R.x,O.x,G),se=ki.number(R.y,O.y,G),he=new Ut(J,se,O.angleTo(R),P);return he._round(),!g||lr(r,he,_,g,t)?he:void 0}x+=U}}function Lm(r,t,i,s,c,m,g,_,x){const k=Zr(s,m,g),P=Xs(s,c),R=P*g,O=r[0].x===0||r[0].x===x||r[0].y===0||r[0].y===x;return t-R<t/4&&(t=R+t/4),mf(r,O?t/2*_%t:(P/2+2*m)*g*_%t,t,k,i,R,O,!1,x)}function mf(r,t,i,s,c,m,g,_,x){const k=m/2,P=vn(r);let R=0,O=t-i,U=[];for(let G=0;G<r.length-1;G++){const J=r[G],se=r[G+1],he=J.dist(se),Ee=se.angleTo(J);for(;O+i<R+he;){O+=i;const ye=(O-R)/he,ze=ki.number(J.x,se.x,ye),Oe=ki.number(J.y,se.y,ye);if(ze>=0&&ze<x&&Oe>=0&&Oe<x&&O-k>=0&&O+k<=P){const Je=new Ut(ze,Oe,Ee,G);Je._round(),s&&!lr(r,Je,m,s,c)||U.push(Je)}}R+=he}return _||U.length||g||(U=mf(r,R/2,i,s,c,m,g,!0,x)),U}wt("Anchor",Ut);const bh=_o;function gf(r,t,i,s){const c=[],m=r.image,g=m.pixelRatio,_=m.paddedRect.w-2*bh,x=m.paddedRect.h-2*bh;let k={x1:r.left,y1:r.top,x2:r.right,y2:r.bottom};const P=m.stretchX||[[0,_]],R=m.stretchY||[[0,x]],O=(Ve,Bt)=>Ve+Bt[1]-Bt[0],U=P.reduce(O,0),G=R.reduce(O,0),J=_-U,se=x-G;let he=0,Ee=U,ye=0,ze=G,Oe=0,Je=J,vt=0,qt=se;if(m.content&&s){const Ve=m.content,Bt=Ve[2]-Ve[0],Dt=Ve[3]-Ve[1];(m.textFitWidth||m.textFitHeight)&&(k=Mc(r)),he=Yd(P,0,Ve[0]),ye=Yd(R,0,Ve[1]),Ee=Yd(P,Ve[0],Ve[2]),ze=Yd(R,Ve[1],Ve[3]),Oe=Ve[0]-he,vt=Ve[1]-ye,Je=Bt-Ee,qt=Dt-ze}const _t=k.x1,pt=k.y1,Rt=k.x2-_t,It=k.y2-pt,kt=(Ve,Bt,Dt,Qt)=>{const hi=Qd(Ve.stretch-he,Ee,Rt,_t),ai=ep(Ve.fixed-Oe,Je,Ve.stretch,U),En=Qd(Bt.stretch-ye,ze,It,pt),Es=ep(Bt.fixed-vt,qt,Bt.stretch,G),ro=Qd(Dt.stretch-he,Ee,Rt,_t),Cn=ep(Dt.fixed-Oe,Je,Dt.stretch,U),No=Qd(Qt.stretch-ye,ze,It,pt),jo=ep(Qt.fixed-vt,qt,Qt.stretch,G),Vo=new re(hi,En),qi=new re(ro,En),In=new re(ro,No),vo=new re(hi,No),io=new re(ai/g,Es/g),Uo=new re(Cn/g,jo/g),no=t*Math.PI/180;if(no){const $r=Math.sin(no),mi=Math.cos(no),xi=[mi,-$r,$r,mi];Vo._matMult(xi),qi._matMult(xi),vo._matMult(xi),In._matMult(xi)}const os=Ve.stretch+Ve.fixed,la=Bt.stretch+Bt.fixed;return{tl:Vo,tr:qi,bl:vo,br:In,tex:{x:m.paddedRect.x+bh+os,y:m.paddedRect.y+bh+la,w:Dt.stretch+Dt.fixed-os,h:Qt.stretch+Qt.fixed-la},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:io,pixelOffsetBR:Uo,minFontScaleX:Je/g/Rt,minFontScaleY:qt/g/It,isSDF:i}};if(s&&(m.stretchX||m.stretchY)){const Ve=yf(P,J,U),Bt=yf(R,se,G);for(let Dt=0;Dt<Ve.length-1;Dt++){const Qt=Ve[Dt],hi=Ve[Dt+1];for(let ai=0;ai<Bt.length-1;ai++)c.push(kt(Qt,Bt[ai],hi,Bt[ai+1]))}}else c.push(kt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:_+1},{fixed:0,stretch:x+1}));return c}function Yd(r,t,i){let s=0;for(const c of r)s+=Math.max(t,Math.min(i,c[1]))-Math.max(t,Math.min(i,c[0]));return s}function yf(r,t,i){const s=[{fixed:-bh,stretch:0}];for(const[c,m]of r){const g=s[s.length-1];s.push({fixed:c-g.stretch,stretch:g.stretch}),s.push({fixed:c-g.stretch,stretch:g.stretch+(m-c)})}return s.push({fixed:t+bh,stretch:i}),s}function Qd(r,t,i,s){return r/t*i+s}function ep(r,t,i,s){return r-t*i/s}class tp{constructor(t,i,s,c,m,g,_,x,k,P){var R;if(this.boxStartIndex=t.length,k){let O=g.top,U=g.bottom;const G=g.collisionPadding;G&&(O-=G[1],U+=G[3]);let J=U-O;J>0&&(J=Math.max(10,J),this.circleDiameter=J)}else{const O=!((R=g.image)===null||R===void 0)&&R.content&&(g.image.textFitWidth||g.image.textFitHeight)?Mc(g):{x1:g.left,y1:g.top,x2:g.right,y2:g.bottom};O.y1=O.y1*_-x[0],O.y2=O.y2*_+x[2],O.x1=O.x1*_-x[3],O.x2=O.x2*_+x[1];const U=g.collisionPadding;if(U&&(O.x1-=U[0]*_,O.y1-=U[1]*_,O.x2+=U[2]*_,O.y2+=U[3]*_),P){const G=new re(O.x1,O.y1),J=new re(O.x2,O.y1),se=new re(O.x1,O.y2),he=new re(O.x2,O.y2),Ee=P*Math.PI/180;G._rotate(Ee),J._rotate(Ee),se._rotate(Ee),he._rotate(Ee),O.x1=Math.min(G.x,J.x,se.x,he.x),O.x2=Math.max(G.x,J.x,se.x,he.x),O.y1=Math.min(G.y,J.y,se.y,he.y),O.y2=Math.max(G.y,J.y,se.y,he.y)}t.emplaceBack(i.x,i.y,O.x1,O.y1,O.x2,O.y2,s,c,m)}this.boxEndIndex=t.length}}class Rm{constructor(t=[],i=((s,c)=>s<c?-1:s>c?1:0)){if(this.data=t,this.length=this.data.length,this.compare=i,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],i=this.data.pop();return--this.length>0&&(this.data[0]=i,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:i,compare:s}=this,c=i[t];for(;t>0;){const m=t-1>>1,g=i[m];if(s(c,g)>=0)break;i[t]=g,t=m}i[t]=c}_down(t){const{data:i,compare:s}=this,c=this.length>>1,m=i[t];for(;t<c;){let g=1+(t<<1);const _=g+1;if(_<this.length&&s(i[_],i[g])<0&&(g=_),s(i[g],m)>=0)break;i[t]=i[g],t=g}i[t]=m}}function Fm(r,t=1,i=!1){let s=1/0,c=1/0,m=-1/0,g=-1/0;const _=r[0];for(let U=0;U<_.length;U++){const G=_[U];(!U||G.x<s)&&(s=G.x),(!U||G.y<c)&&(c=G.y),(!U||G.x>m)&&(m=G.x),(!U||G.y>g)&&(g=G.y)}const x=Math.min(m-s,g-c);let k=x/2;const P=new Rm([],Bm);if(x===0)return new re(s,c);for(let U=s;U<m;U+=x)for(let G=c;G<g;G+=x)P.push(new Sh(U+k,G+k,k,r));let R=(function(U){let G=0,J=0,se=0;const he=U[0];for(let Ee=0,ye=he.length,ze=ye-1;Ee<ye;ze=Ee++){const Oe=he[Ee],Je=he[ze],vt=Oe.x*Je.y-Je.x*Oe.y;J+=(Oe.x+Je.x)*vt,se+=(Oe.y+Je.y)*vt,G+=3*vt}return new Sh(J/G,se/G,0,U)})(r),O=P.length;for(;P.length;){const U=P.pop();(U.d>R.d||!R.d)&&(R=U,i&&console.log("found best %d after %d probes",Math.round(1e4*U.d)/1e4,O)),U.max-R.d<=t||(k=U.h/2,P.push(new Sh(U.p.x-k,U.p.y-k,k,r)),P.push(new Sh(U.p.x+k,U.p.y-k,k,r)),P.push(new Sh(U.p.x-k,U.p.y+k,k,r)),P.push(new Sh(U.p.x+k,U.p.y+k,k,r)),O+=4)}return i&&(console.log(`num probes: ${O}`),console.log(`best distance: ${R.d}`)),R.p}function Bm(r,t){return t.max-r.max}function Sh(r,t,i,s){this.p=new re(r,t),this.h=i,this.d=(function(c,m){let g=!1,_=1/0;for(let x=0;x<m.length;x++){const k=m[x];for(let P=0,R=k.length,O=R-1;P<R;O=P++){const U=k[P],G=k[O];U.y>c.y!=G.y>c.y&&c.x<(G.x-U.x)*(c.y-U.y)/(G.y-U.y)+U.x&&(g=!g),_=Math.min(_,Rh(c,U,G))}}return(g?1:-1)*Math.sqrt(_)})(this.p,s),this.max=this.d+this.h*Math.SQRT2}var to;A.aq=void 0,(to=A.aq||(A.aq={}))[to.center=1]="center",to[to.left=2]="left",to[to.right=3]="right",to[to.top=4]="top",to[to.bottom=5]="bottom",to[to["top-left"]=6]="top-left",to[to["top-right"]=7]="top-right",to[to["bottom-left"]=8]="bottom-left",to[to["bottom-right"]=9]="bottom-right";const Vu=7,Cp=Number.POSITIVE_INFINITY;function _f(r,t){return t[1]!==Cp?(function(i,s,c){let m=0,g=0;switch(s=Math.abs(s),c=Math.abs(c),i){case"top-right":case"top-left":case"top":g=c-Vu;break;case"bottom-right":case"bottom-left":case"bottom":g=-c+Vu}switch(i){case"top-right":case"bottom-right":case"right":m=-s;break;case"top-left":case"bottom-left":case"left":m=s}return[m,g]})(r,t[0],t[1]):(function(i,s){let c=0,m=0;s<0&&(s=0);const g=s/Math.SQRT2;switch(i){case"top-right":case"top-left":m=g-Vu;break;case"bottom-right":case"bottom-left":m=-g+Vu;break;case"bottom":m=-s+Vu;break;case"top":m=s-Vu}switch(i){case"top-right":case"bottom-right":c=-g;break;case"top-left":case"bottom-left":c=g;break;case"left":c=s;break;case"right":c=-s}return[c,m]})(r,t[0])}function vf(r,t,i){var s;const c=r.layout,m=(s=c.get("text-variable-anchor-offset"))===null||s===void 0?void 0:s.evaluate(t,{},i);if(m){const _=m.values,x=[];for(let k=0;k<_.length;k+=2){const P=x[k]=_[k],R=_[k+1].map((O=>O*vi));P.startsWith("top")?R[1]-=Vu:P.startsWith("bottom")&&(R[1]+=Vu),x[k+1]=R}return new Dn(x)}const g=c.get("text-variable-anchor");if(g){let _;_=r._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[c.get("text-radial-offset").evaluate(t,{},i)*vi,Cp]:c.get("text-offset").evaluate(t,{},i).map((k=>k*vi));const x=[];for(const k of g)x.push(k,_f(k,_));return new Dn(x)}return null}function Ip(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Om(r,t,i,s,c,m,g,_,x,k,P){let R=m.textMaxSize.evaluate(t,{});R===void 0&&(R=g);const O=r.layers[0].layout,U=O.get("icon-offset").evaluate(t,{},P),G=wf(i.horizontal),J=g/24,se=r.tilePixelRatio*J,he=r.tilePixelRatio*R/24,Ee=r.tilePixelRatio*_,ye=r.tilePixelRatio*O.get("symbol-spacing"),ze=O.get("text-padding")*r.tilePixelRatio,Oe=(function(Ve,Bt,Dt,Qt=1){const hi=Ve.get("icon-padding").evaluate(Bt,{},Dt),ai=hi&&hi.values;return[ai[0]*Qt,ai[1]*Qt,ai[2]*Qt,ai[3]*Qt]})(O,t,P,r.tilePixelRatio),Je=O.get("text-max-angle")/180*Math.PI,vt=O.get("text-rotation-alignment")!=="viewport"&&O.get("symbol-placement")!=="point",qt=O.get("icon-rotation-alignment")==="map"&&O.get("symbol-placement")!=="point",_t=O.get("symbol-placement"),pt=ye/2,Rt=O.get("icon-text-fit");let It;s&&Rt!=="none"&&(r.allowVerticalPlacement&&i.vertical&&(It=Al(s,i.vertical,Rt,O.get("icon-text-fit-padding"),U,J)),G&&(s=Al(s,G,Rt,O.get("icon-text-fit-padding"),U,J)));const kt=(Ve,Bt)=>{Bt.x<0||Bt.x>=Fi||Bt.y<0||Bt.y>=Fi||(function(Dt,Qt,hi,ai,En,Es,ro,Cn,No,jo,Vo,qi,In,vo,io,Uo,no,os,la,$r,mi,xi,Ea,Bi,kh){const Ll=Dt.addToLineVertexArray(Qt,hi);let Rl,Cs,as,jn,hu=0,nd=0,Tf=0,zf=0,Bp=-1,Op=-1;const du={};let Ef=xl("");if(Dt.allowVerticalPlacement&&ai.vertical){const xo=Cn.layout.get("text-rotate").evaluate(mi,{},Bi)+90;as=new tp(No,Qt,jo,Vo,qi,ai.vertical,In,vo,io,xo),ro&&(jn=new tp(No,Qt,jo,Vo,qi,ro,no,os,io,xo))}if(En){const xo=Cn.layout.get("icon-rotate").evaluate(mi,{}),ss=Cn.layout.get("icon-text-fit")!=="none",Fc=gf(En,xo,Ea,ss),Js=ro?gf(ro,xo,Ea,ss):void 0;Cs=new tp(No,Qt,jo,Vo,qi,En,no,os,!1,xo),hu=4*Fc.length;const Bc=Dt.iconSizeData;let Fl=null;Bc.kind==="source"?(Fl=[za*Cn.layout.get("icon-size").evaluate(mi,{})],Fl[0]>zs&&kr(`${Dt.layerIds[0]}: Value for "icon-size" is >= ${Dl}. Reduce your "icon-size".`)):Bc.kind==="composite"&&(Fl=[za*xi.compositeIconSizes[0].evaluate(mi,{},Bi),za*xi.compositeIconSizes[1].evaluate(mi,{},Bi)],(Fl[0]>zs||Fl[1]>zs)&&kr(`${Dt.layerIds[0]}: Value for "icon-size" is >= ${Dl}. Reduce your "icon-size".`)),Dt.addSymbols(Dt.icon,Fc,Fl,$r,la,mi,A.ah.none,Qt,Ll.lineStartIndex,Ll.lineLength,-1,Bi),Bp=Dt.icon.placedSymbolArray.length-1,Js&&(nd=4*Js.length,Dt.addSymbols(Dt.icon,Js,Fl,$r,la,mi,A.ah.vertical,Qt,Ll.lineStartIndex,Ll.lineLength,-1,Bi),Op=Dt.icon.placedSymbolArray.length-1)}const Cf=Object.keys(ai.horizontal);for(const xo of Cf){const ss=ai.horizontal[xo];if(!Rl){Ef=xl(ss.text);const Js=Cn.layout.get("text-rotate").evaluate(mi,{},Bi);Rl=new tp(No,Qt,jo,Vo,qi,ss,In,vo,io,Js)}const Fc=ss.positionedLines.length===1;if(Tf+=xf(Dt,Qt,ss,Es,Cn,io,mi,Uo,Ll,ai.vertical?A.ah.horizontal:A.ah.horizontalOnly,Fc?Cf:[xo],du,Bp,xi,Bi),Fc)break}ai.vertical&&(zf+=xf(Dt,Qt,ai.vertical,Es,Cn,io,mi,Uo,Ll,A.ah.vertical,["vertical"],du,Op,xi,Bi));const Vm=Rl?Rl.boxStartIndex:Dt.collisionBoxArray.length,Um=Rl?Rl.boxEndIndex:Dt.collisionBoxArray.length,$m=as?as.boxStartIndex:Dt.collisionBoxArray.length,Zm=as?as.boxEndIndex:Dt.collisionBoxArray.length,qm=Cs?Cs.boxStartIndex:Dt.collisionBoxArray.length,Gm=Cs?Cs.boxEndIndex:Dt.collisionBoxArray.length,Hm=jn?jn.boxStartIndex:Dt.collisionBoxArray.length,Wm=jn?jn.boxEndIndex:Dt.collisionBoxArray.length;let Ks=-1;const ip=(xo,ss)=>xo&&xo.circleDiameter?Math.max(xo.circleDiameter,ss):ss;Ks=ip(Rl,Ks),Ks=ip(as,Ks),Ks=ip(Cs,Ks),Ks=ip(jn,Ks);const If=Ks>-1?1:0;If&&(Ks*=kh/vi),Dt.glyphOffsetArray.length>=Nu.MAX_GLYPHS&&kr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),mi.sortKey!==void 0&&Dt.addToSortKeyRanges(Dt.symbolInstances.length,mi.sortKey);const Xm=vf(Cn,mi,Bi),[Km,Jm]=(function(xo,ss){const Fc=xo.length,Js=ss?.values;if(Js?.length>0)for(let Bc=0;Bc<Js.length;Bc+=2){const Fl=Js[Bc+1];xo.emplaceBack(A.aq[Js[Bc]],Fl[0],Fl[1])}return[Fc,xo.length]})(Dt.textAnchorOffsets,Xm);Dt.symbolInstances.emplaceBack(Qt.x,Qt.y,du.right>=0?du.right:-1,du.center>=0?du.center:-1,du.left>=0?du.left:-1,du.vertical||-1,Bp,Op,Ef,Vm,Um,$m,Zm,qm,Gm,Hm,Wm,jo,Tf,zf,hu,nd,If,0,In,Ks,Km,Jm)})(r,Bt,Ve,i,s,c,It,r.layers[0],r.collisionBoxArray,t.index,t.sourceLayerIndex,r.index,se,[ze,ze,ze,ze],vt,x,Ee,Oe,qt,U,t,m,k,P,g)};if(_t==="line")for(const Ve of Yt(t.geometry,0,0,Fi,Fi)){const Bt=Lm(Ve,ye,Je,i.vertical||G,s,24,he,r.overscaling,Fi);for(const Dt of Bt)G&&Nm(r,G.text,pt,Dt)||kt(Ve,Dt)}else if(_t==="line-center"){for(const Ve of t.geometry)if(Ve.length>1){const Bt=Ep(Ve,Je,i.vertical||G,s,24,he);Bt&&kt(Ve,Bt)}}else if(t.type==="Polygon")for(const Ve of li(t.geometry,0)){const Bt=Fm(Ve,16);kt(Ve[0],new Ut(Bt.x,Bt.y,0))}else if(t.type==="LineString")for(const Ve of t.geometry)kt(Ve,new Ut(Ve[0].x,Ve[0].y,0));else if(t.type==="Point")for(const Ve of t.geometry)for(const Bt of Ve)kt([Bt],new Ut(Bt.x,Bt.y,0))}function xf(r,t,i,s,c,m,g,_,x,k,P,R,O,U,G){const J=(function(Ee,ye,ze,Oe,Je,vt,qt,_t){const pt=Oe.layout.get("text-rotate").evaluate(vt,{})*Math.PI/180,Rt=[];for(const It of ye.positionedLines)for(const kt of It.positionedGlyphs){if(!kt.rect)continue;const Ve=kt.rect||{};let Bt=mh+1,Dt=!0,Qt=1,hi=0;const ai=(Je||_t)&&kt.vertical,En=kt.metrics.advance*kt.scale/2;if(_t&&ye.verticalizable&&(hi=It.lineOffset/2-(kt.imageName?-(vi-kt.metrics.width*kt.scale)/2:(kt.scale-1)*vi)),kt.imageName){const $r=qt[kt.imageName];Dt=$r.sdf,Qt=$r.pixelRatio,Bt=_o/Qt}const Es=Je?[kt.x+En,kt.y]:[0,0];let ro=Je?[0,0]:[kt.x+En+ze[0],kt.y+ze[1]-hi],Cn=[0,0];ai&&(Cn=ro,ro=[0,0]);const No=kt.metrics.isDoubleResolution?2:1,jo=(kt.metrics.left-Bt)*kt.scale-En+ro[0],Vo=(-kt.metrics.top-Bt)*kt.scale+ro[1],qi=jo+Ve.w/No*kt.scale/Qt,In=Vo+Ve.h/No*kt.scale/Qt,vo=new re(jo,Vo),io=new re(qi,Vo),Uo=new re(jo,In),no=new re(qi,In);if(ai){const $r=new re(-En,En-is),mi=-Math.PI/2,xi=vi/2-En,Ea=new re(5-is-xi,-(kt.imageName?xi:0)),Bi=new re(...Cn);vo._rotateAround(mi,$r)._add(Ea)._add(Bi),io._rotateAround(mi,$r)._add(Ea)._add(Bi),Uo._rotateAround(mi,$r)._add(Ea)._add(Bi),no._rotateAround(mi,$r)._add(Ea)._add(Bi)}if(pt){const $r=Math.sin(pt),mi=Math.cos(pt),xi=[mi,-$r,$r,mi];vo._matMult(xi),io._matMult(xi),Uo._matMult(xi),no._matMult(xi)}const os=new re(0,0),la=new re(0,0);Rt.push({tl:vo,tr:io,bl:Uo,br:no,tex:Ve,writingMode:ye.writingMode,glyphOffset:Es,sectionIndex:kt.sectionIndex,isSDF:Dt,pixelOffsetTL:os,pixelOffsetBR:la,minFontScaleX:0,minFontScaleY:0})}return Rt})(0,i,_,c,m,g,s,r.allowVerticalPlacement),se=r.textSizeData;let he=null;se.kind==="source"?(he=[za*c.layout.get("text-size").evaluate(g,{})],he[0]>zs&&kr(`${r.layerIds[0]}: Value for "text-size" is >= ${Dl}. Reduce your "text-size".`)):se.kind==="composite"&&(he=[za*U.compositeTextSizes[0].evaluate(g,{},G),za*U.compositeTextSizes[1].evaluate(g,{},G)],(he[0]>zs||he[1]>zs)&&kr(`${r.layerIds[0]}: Value for "text-size" is >= ${Dl}. Reduce your "text-size".`)),r.addSymbols(r.text,J,he,_,m,g,k,t,x.lineStartIndex,x.lineLength,O,G);for(const Ee of P)R[Ee]=r.text.placedSymbolArray.length-1;return 4*J.length}function wf(r){for(const t in r)return r[t];return null}function Nm(r,t,i,s){const c=r.compareText;if(t in c){const m=c[t];for(let g=m.length-1;g>=0;g--)if(s.dist(m[g])<i)return!0}else c[t]=[];return c[t].push(s),!1}const bf=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Pp{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[i,s]=new Uint8Array(t,0,2);if(i!==219)throw new Error("Data does not appear to be in a KDBush format.");const c=s>>4;if(c!==1)throw new Error(`Got v${c} data when expected v1.`);const m=bf[15&s];if(!m)throw new Error("Unrecognized array type.");const[g]=new Uint16Array(t,2,1),[_]=new Uint32Array(t,4,1);return new Pp(_,g,m,t)}constructor(t,i=64,s=Float64Array,c){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+i,2),65535),this.ArrayType=s,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const m=bf.indexOf(this.ArrayType),g=2*t*this.ArrayType.BYTES_PER_ELEMENT,_=t*this.IndexArrayType.BYTES_PER_ELEMENT,x=(8-_%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${s}.`);c&&c instanceof ArrayBuffer?(this.data=c,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+_+x,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+g+_+x),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+_+x,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=t)}add(t,i){const s=this._pos>>1;return this.ids[s]=s,this.coords[this._pos++]=t,this.coords[this._pos++]=i,s}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Mp(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,i,s,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:g,nodeSize:_}=this,x=[0,m.length-1,0],k=[];for(;x.length;){const P=x.pop()||0,R=x.pop()||0,O=x.pop()||0;if(R-O<=_){for(let se=O;se<=R;se++){const he=g[2*se],Ee=g[2*se+1];he>=t&&he<=s&&Ee>=i&&Ee<=c&&k.push(m[se])}continue}const U=O+R>>1,G=g[2*U],J=g[2*U+1];G>=t&&G<=s&&J>=i&&J<=c&&k.push(m[U]),(P===0?t<=G:i<=J)&&(x.push(O),x.push(U-1),x.push(1-P)),(P===0?s>=G:c>=J)&&(x.push(U+1),x.push(R),x.push(1-P))}return k}within(t,i,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:c,coords:m,nodeSize:g}=this,_=[0,c.length-1,0],x=[],k=s*s;for(;_.length;){const P=_.pop()||0,R=_.pop()||0,O=_.pop()||0;if(R-O<=g){for(let se=O;se<=R;se++)kf(m[2*se],m[2*se+1],t,i)<=k&&x.push(c[se]);continue}const U=O+R>>1,G=m[2*U],J=m[2*U+1];kf(G,J,t,i)<=k&&x.push(c[U]),(P===0?t-s<=G:i-s<=J)&&(_.push(O),_.push(U-1),_.push(1-P)),(P===0?t+s>=G:i+s>=J)&&(_.push(U+1),_.push(R),_.push(1-P))}return x}}function Mp(r,t,i,s,c,m){if(c-s<=i)return;const g=s+c>>1;Sf(r,t,g,s,c,m),Mp(r,t,i,s,g-1,1-m),Mp(r,t,i,g+1,c,1-m)}function Sf(r,t,i,s,c,m){for(;c>s;){if(c-s>600){const k=c-s+1,P=i-s+1,R=Math.log(k),O=.5*Math.exp(2*R/3),U=.5*Math.sqrt(R*O*(k-O)/k)*(P-k/2<0?-1:1);Sf(r,t,i,Math.max(s,Math.floor(i-P*O/k+U)),Math.min(c,Math.floor(i+(k-P)*O/k+U)),m)}const g=t[2*i+m];let _=s,x=c;for(rd(r,t,s,i),t[2*c+m]>g&&rd(r,t,s,c);_<x;){for(rd(r,t,_,x),_++,x--;t[2*_+m]<g;)_++;for(;t[2*x+m]>g;)x--}t[2*s+m]===g?rd(r,t,s,x):(x++,rd(r,t,x,c)),x<=i&&(s=x+1),i<=x&&(c=x-1)}}function rd(r,t,i,s){Ap(r,i,s),Ap(t,2*i,2*s),Ap(t,2*i+1,2*s+1)}function Ap(r,t,i){const s=r[t];r[t]=r[i],r[i]=s}function kf(r,t,i,s){const c=r-i,m=t-s;return c*c+m*m}var Dp;A.bg=void 0,(Dp=A.bg||(A.bg={})).create="create",Dp.load="load",Dp.fullLoad="fullLoad";let rp=null,id=[];const Lp=1e3/60,Rp="loadTime",Fp="fullLoadTime",jm={mark(r){performance.mark(r)},frame(r){const t=r;rp!=null&&id.push(t-rp),rp=t},clearMetrics(){rp=null,id=[],performance.clearMeasures(Rp),performance.clearMeasures(Fp);for(const r in A.bg)performance.clearMarks(A.bg[r])},getPerformanceMetrics(){performance.measure(Rp,A.bg.create,A.bg.load),performance.measure(Fp,A.bg.create,A.bg.fullLoad);const r=performance.getEntriesByName(Rp)[0].duration,t=performance.getEntriesByName(Fp)[0].duration,i=id.length,s=1/(id.reduce(((m,g)=>m+g),0)/i/1e3),c=id.filter((m=>m>Lp)).reduce(((m,g)=>m+(g-Lp)/Lp),0);return{loadTime:r,fullLoadTime:t,fps:s,percentDroppedFrames:c/(i+c)*100,totalFrames:i}}};A.$=class extends F{},A.A=Mu,A.B=tc,A.C=function(r){if(Wr==null){const t=r.navigator?r.navigator.userAgent:null;Wr=!!r.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Wr},A.D=bt,A.E=Ia,A.F=class{constructor(r,t){this.target=r,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new n((()=>this.process())),this.subscription=(function(i,s,c,m){return i.addEventListener(s,c,!1),{unsubscribe:()=>{i.removeEventListener(s,c,!1)}}})(this.target,"message",(i=>this.receive(i))),this.globalScope=ti(self)?r:window}registerMessageHandler(r,t){this.messageHandlers[r]=t}sendAsync(r,t){return new Promise(((i,s)=>{const c=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[c]={resolve:i,reject:s},t&&t.signal.addEventListener("abort",(()=>{delete this.resolveRejects[c];const _={id:c,type:"<cancel>",origin:location.origin,targetMapId:r.targetMapId,sourceMapId:this.mapId};this.target.postMessage(_)}),{once:!0});const m=[],g=Object.assign(Object.assign({},r),{id:c,sourceMapId:this.mapId,origin:location.origin,data:Fn(r.data,m)});this.target.postMessage(g,{transfer:m})}))}receive(r){const t=r.data,i=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[i];const s=this.abortControllers[i];return delete this.abortControllers[i],void(s&&s.abort())}if(ti(self)||t.mustQueue)return this.tasks[i]=t,this.taskQueue.push(i),void this.invoker.trigger();this.processTask(i,t)}}process(){if(this.taskQueue.length===0)return;const r=this.taskQueue.shift(),t=this.tasks[r];delete this.tasks[r],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(r,t)}processTask(r,t){return d(this,void 0,void 0,(function*(){if(t.type==="<response>"){const c=this.resolveRejects[r];return delete this.resolveRejects[r],c?void(t.error?c.reject(ba(t.error)):c.resolve(ba(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(r,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const i=ba(t.data),s=new AbortController;this.abortControllers[r]=s;try{const c=yield this.messageHandlers[t.type](t.sourceMapId,i,s);this.completeTask(r,null,c)}catch(c){this.completeTask(r,c)}}))}completeTask(r,t,i){const s=[];delete this.abortControllers[r];const c={id:r,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?Fn(t):null,data:Fn(i,s)};this.target.postMessage(c,{transfer:s})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},A.G=rr,A.H=function(){var r=new Mu(16);return Mu!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},A.I=Jh,A.J=function(r,t,i){var s,c,m,g,_,x,k,P,R,O,U,G,J=i[0],se=i[1],he=i[2];return t===r?(r[12]=t[0]*J+t[4]*se+t[8]*he+t[12],r[13]=t[1]*J+t[5]*se+t[9]*he+t[13],r[14]=t[2]*J+t[6]*se+t[10]*he+t[14],r[15]=t[3]*J+t[7]*se+t[11]*he+t[15]):(c=t[1],m=t[2],g=t[3],_=t[4],x=t[5],k=t[6],P=t[7],R=t[8],O=t[9],U=t[10],G=t[11],r[0]=s=t[0],r[1]=c,r[2]=m,r[3]=g,r[4]=_,r[5]=x,r[6]=k,r[7]=P,r[8]=R,r[9]=O,r[10]=U,r[11]=G,r[12]=s*J+_*se+R*he+t[12],r[13]=c*J+x*se+O*he+t[13],r[14]=m*J+k*se+U*he+t[14],r[15]=g*J+P*se+G*he+t[15]),r},A.K=function(r,t,i){var s=i[0],c=i[1],m=i[2];return r[0]=t[0]*s,r[1]=t[1]*s,r[2]=t[2]*s,r[3]=t[3]*s,r[4]=t[4]*c,r[5]=t[5]*c,r[6]=t[6]*c,r[7]=t[7]*c,r[8]=t[8]*m,r[9]=t[9]*m,r[10]=t[10]*m,r[11]=t[11]*m,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},A.L=Oh,A.M=function(r,t){const i={};for(let s=0;s<t.length;s++){const c=t[s];c in r&&(i[c]=r[c])}return i},A.N=h,A.O=E,A.P=re,A.Q=Z,A.R=zn,A.S=yt,A.T=mn,A.U=Pt,A.V=mt,A.W=Mt,A.X=Fi,A.Y=v,A.Z=Be,A._=d,A.a=Tt,A.a$=function(r,t){var i=r[0],s=r[1],c=r[2],m=r[3],g=r[4],_=r[5],x=r[6],k=r[7],P=r[8],R=r[9],O=r[10],U=r[11],G=r[12],J=r[13],se=r[14],he=r[15],Ee=t[0],ye=t[1],ze=t[2],Oe=t[3],Je=t[4],vt=t[5],qt=t[6],_t=t[7],pt=t[8],Rt=t[9],It=t[10],kt=t[11],Ve=t[12],Bt=t[13],Dt=t[14],Qt=t[15];return Math.abs(i-Ee)<=Jn*Math.max(1,Math.abs(i),Math.abs(Ee))&&Math.abs(s-ye)<=Jn*Math.max(1,Math.abs(s),Math.abs(ye))&&Math.abs(c-ze)<=Jn*Math.max(1,Math.abs(c),Math.abs(ze))&&Math.abs(m-Oe)<=Jn*Math.max(1,Math.abs(m),Math.abs(Oe))&&Math.abs(g-Je)<=Jn*Math.max(1,Math.abs(g),Math.abs(Je))&&Math.abs(_-vt)<=Jn*Math.max(1,Math.abs(_),Math.abs(vt))&&Math.abs(x-qt)<=Jn*Math.max(1,Math.abs(x),Math.abs(qt))&&Math.abs(k-_t)<=Jn*Math.max(1,Math.abs(k),Math.abs(_t))&&Math.abs(P-pt)<=Jn*Math.max(1,Math.abs(P),Math.abs(pt))&&Math.abs(R-Rt)<=Jn*Math.max(1,Math.abs(R),Math.abs(Rt))&&Math.abs(O-It)<=Jn*Math.max(1,Math.abs(O),Math.abs(It))&&Math.abs(U-kt)<=Jn*Math.max(1,Math.abs(U),Math.abs(kt))&&Math.abs(G-Ve)<=Jn*Math.max(1,Math.abs(G),Math.abs(Ve))&&Math.abs(J-Bt)<=Jn*Math.max(1,Math.abs(J),Math.abs(Bt))&&Math.abs(se-Dt)<=Jn*Math.max(1,Math.abs(se),Math.abs(Dt))&&Math.abs(he-Qt)<=Jn*Math.max(1,Math.abs(he),Math.abs(Qt))},A.a0=mr,A.a1=nt,A.a2=rt,A.a3=r=>{const t=window.document.createElement("video");return t.muted=!0,new Promise((i=>{t.onloadstart=()=>{i(t)};for(const s of r){const c=window.document.createElement("source");bi(s)||(t.crossOrigin="Anonymous"),c.src=s,t.appendChild(c)}}))},A.a4=function(){return zr++},A.a5=dt,A.a6=Nu,A.a7=ql,A.a8=kl,A.a9=Me,A.aA=function(r){if(r.type==="custom")return new wh(r);switch(r.type){case"background":return new xh(r);case"circle":return new mp(r);case"fill":return new yp(r);case"fill-extrusion":return new Rd(r);case"heatmap":return new gp(r);case"hillshade":return new xd(r);case"line":return new Fu(r);case"raster":return new zp(r);case"symbol":return new cu(r)}},A.aB=Et,A.aC=function(r,t){if(!r)return[{command:"setStyle",args:[t]}];let i=[];try{if(!Er(r.version,t.version))return[{command:"setStyle",args:[t]}];Er(r.center,t.center)||i.push({command:"setCenter",args:[t.center]}),Er(r.zoom,t.zoom)||i.push({command:"setZoom",args:[t.zoom]}),Er(r.bearing,t.bearing)||i.push({command:"setBearing",args:[t.bearing]}),Er(r.pitch,t.pitch)||i.push({command:"setPitch",args:[t.pitch]}),Er(r.sprite,t.sprite)||i.push({command:"setSprite",args:[t.sprite]}),Er(r.glyphs,t.glyphs)||i.push({command:"setGlyphs",args:[t.glyphs]}),Er(r.transition,t.transition)||i.push({command:"setTransition",args:[t.transition]}),Er(r.light,t.light)||i.push({command:"setLight",args:[t.light]}),Er(r.terrain,t.terrain)||i.push({command:"setTerrain",args:[t.terrain]}),Er(r.sky,t.sky)||i.push({command:"setSky",args:[t.sky]}),Er(r.projection,t.projection)||i.push({command:"setProjection",args:[t.projection]});const s={},c=[];(function(g,_,x,k){let P;for(P in _=_||{},g=g||{})Object.prototype.hasOwnProperty.call(g,P)&&(Object.prototype.hasOwnProperty.call(_,P)||So(P,x,k));for(P in _)Object.prototype.hasOwnProperty.call(_,P)&&(Object.prototype.hasOwnProperty.call(g,P)?Er(g[P],_[P])||(g[P].type==="geojson"&&_[P].type==="geojson"&&Pa(g,_,P)?qr(x,{command:"setGeoJSONSourceData",args:[P,_[P].data]}):ko(P,_,x,k)):bo(P,_,x))})(r.sources,t.sources,c,s);const m=[];r.layers&&r.layers.forEach((g=>{"source"in g&&s[g.source]?i.push({command:"removeLayer",args:[g.id]}):m.push(g)})),i=i.concat(c),(function(g,_,x){_=_||[];const k=(g=g||[]).map(cs),P=_.map(cs),R=g.reduce(Ma,{}),O=_.reduce(Ma,{}),U=k.slice(),G=Object.create(null);let J,se,he,Ee,ye;for(let ze=0,Oe=0;ze<k.length;ze++)J=k[ze],Object.prototype.hasOwnProperty.call(O,J)?Oe++:(qr(x,{command:"removeLayer",args:[J]}),U.splice(U.indexOf(J,Oe),1));for(let ze=0,Oe=0;ze<P.length;ze++)J=P[P.length-1-ze],U[U.length-1-ze]!==J&&(Object.prototype.hasOwnProperty.call(R,J)?(qr(x,{command:"removeLayer",args:[J]}),U.splice(U.lastIndexOf(J,U.length-Oe),1)):Oe++,Ee=U[U.length-ze],qr(x,{command:"addLayer",args:[O[J],Ee]}),U.splice(U.length-ze,0,J),G[J]=!0);for(let ze=0;ze<P.length;ze++)if(J=P[ze],se=R[J],he=O[J],!G[J]&&!Er(se,he))if(Er(se.source,he.source)&&Er(se["source-layer"],he["source-layer"])&&Er(se.type,he.type)){for(ye in Mn(se.layout,he.layout,x,J,null,"setLayoutProperty"),Mn(se.paint,he.paint,x,J,null,"setPaintProperty"),Er(se.filter,he.filter)||qr(x,{command:"setFilter",args:[J,he.filter]}),Er(se.minzoom,he.minzoom)&&Er(se.maxzoom,he.maxzoom)||qr(x,{command:"setLayerZoomRange",args:[J,he.minzoom,he.maxzoom]}),se)Object.prototype.hasOwnProperty.call(se,ye)&&ye!=="layout"&&ye!=="paint"&&ye!=="filter"&&ye!=="metadata"&&ye!=="minzoom"&&ye!=="maxzoom"&&(ye.indexOf("paint.")===0?Mn(se[ye],he[ye],x,J,ye.slice(6),"setPaintProperty"):Er(se[ye],he[ye])||qr(x,{command:"setLayerProperty",args:[J,ye,he[ye]]}));for(ye in he)Object.prototype.hasOwnProperty.call(he,ye)&&!Object.prototype.hasOwnProperty.call(se,ye)&&ye!=="layout"&&ye!=="paint"&&ye!=="filter"&&ye!=="metadata"&&ye!=="minzoom"&&ye!=="maxzoom"&&(ye.indexOf("paint.")===0?Mn(se[ye],he[ye],x,J,ye.slice(6),"setPaintProperty"):Er(se[ye],he[ye])||qr(x,{command:"setLayerProperty",args:[J,ye,he[ye]]}))}else qr(x,{command:"removeLayer",args:[J]}),Ee=U[U.lastIndexOf(J)+1],qr(x,{command:"addLayer",args:[he,Ee]})})(m,t.layers,i)}catch(s){console.warn("Unable to compute style diff:",s),i=[{command:"setStyle",args:[t]}]}return i},A.aD=function(r){const t=[],i=r.id;return i===void 0&&t.push({message:`layers.${i}: missing required property "id"`}),r.render===void 0&&t.push({message:`layers.${i}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&t.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),t},A.aE=function r(t,i){if(Array.isArray(t)){if(!Array.isArray(i)||t.length!==i.length)return!1;for(let s=0;s<t.length;s++)if(!r(t[s],i[s]))return!1;return!0}if(typeof t=="object"&&t!==null&&i!==null){if(typeof i!="object"||Object.keys(t).length!==Object.keys(i).length)return!1;for(const s in t)if(!r(t[s],i[s]))return!1;return!0}return t===i},A.aF=xr,A.aG=Br,A.aH=class extends zi{constructor(r,t){super(r,t),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},A.aI=Ki,A.aJ=class extends zi{constructor(r,t){super(r,t),this.current=sc}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let t=1;t<16;t++)if(r[t]!==this.current[t]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},A.aK=ac,A.aL=Iu,A.aM=Xt,A.aN=class extends zi{constructor(r,t){super(r,t),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},A.aO=class extends zi{constructor(r,t){super(r,t),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},A.aP=function(r,t,i,s,c,m,g){var _=1/(t-i),x=1/(s-c),k=1/(m-g);return r[0]=-2*_,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*x,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*k,r[11]=0,r[12]=(t+i)*_,r[13]=(c+s)*x,r[14]=(g+m)*k,r[15]=1,r},A.aQ=Xc,A.aR=class extends ve{},A.aS=bc,A.aT=class extends Ie{},A.aU=pc,A.aV=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},A.aW=th,A.aX=Ci,A.aY=Do,A.aZ=class extends zt{},A.a_=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]&&r[8]===t[8]&&r[9]===t[9]&&r[10]===t[10]&&r[11]===t[11]&&r[12]===t[12]&&r[13]===t[13]&&r[14]===t[14]&&r[15]===t[15]},A.aa=function(r){const t={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((i,s,c,m)=>{const g=c||m;return t[s]=!g||g.toLowerCase(),""})),t["max-age"]){const i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t},A.ab=function(r,t){const i=[];for(const s in r)s in t||i.push(s);return i},A.ac=ur,A.ad=function(r,t,i){var s=Math.sin(i),c=Math.cos(i),m=t[0],g=t[1],_=t[2],x=t[3],k=t[4],P=t[5],R=t[6],O=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=m*c+k*s,r[1]=g*c+P*s,r[2]=_*c+R*s,r[3]=x*c+O*s,r[4]=k*c-m*s,r[5]=P*c-g*s,r[6]=R*c-_*s,r[7]=O*c-x*s,r},A.ae=function(r){var t=new Mu(16);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},A.af=Kc,A.ag=function(r,t){let i=0,s=0;if(r.kind==="constant")s=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:c,minZoom:m,maxZoom:g}=r,_=c?ur(Vi.interpolationFactor(c,t,m,g),0,1):0;r.kind==="camera"?s=ki.number(r.minSize,r.maxSize,_):i=_}return{uSizeT:i,uSize:s}},A.ai=function(r,{uSize:t,uSizeT:i},{lowerSize:s,upperSize:c}){return r.kind==="source"?s/za:r.kind==="composite"?ki.number(s/za,c/za,i):t},A.aj=Ou,A.ak=function(r,t,i,s){const c=t.y-r.y,m=t.x-r.x,g=s.y-i.y,_=s.x-i.x,x=g*m-_*c;if(x===0)return null;const k=(_*(r.y-i.y)-g*(r.x-i.x))/x;return new re(r.x+k*m,r.y+k*c)},A.al=Yt,A.am=Dh,A.an=Wc,A.ao=function(r){let t=1/0,i=1/0,s=-1/0,c=-1/0;for(const m of r)t=Math.min(t,m.x),i=Math.min(i,m.y),s=Math.max(s,m.x),c=Math.max(c,m.y);return[t,i,s,c]},A.ap=vi,A.ar=Ac,A.as=function(r,t){var i=t[0],s=t[1],c=t[2],m=t[3],g=t[4],_=t[5],x=t[6],k=t[7],P=t[8],R=t[9],O=t[10],U=t[11],G=t[12],J=t[13],se=t[14],he=t[15],Ee=i*_-s*g,ye=i*x-c*g,ze=i*k-m*g,Oe=s*x-c*_,Je=s*k-m*_,vt=c*k-m*x,qt=P*J-R*G,_t=P*se-O*G,pt=P*he-U*G,Rt=R*se-O*J,It=R*he-U*J,kt=O*he-U*se,Ve=Ee*kt-ye*It+ze*Rt+Oe*pt-Je*_t+vt*qt;return Ve?(r[0]=(_*kt-x*It+k*Rt)*(Ve=1/Ve),r[1]=(c*It-s*kt-m*Rt)*Ve,r[2]=(J*vt-se*Je+he*Oe)*Ve,r[3]=(O*Je-R*vt-U*Oe)*Ve,r[4]=(x*pt-g*kt-k*_t)*Ve,r[5]=(i*kt-c*pt+m*_t)*Ve,r[6]=(se*ze-G*vt-he*ye)*Ve,r[7]=(P*vt-O*ze+U*ye)*Ve,r[8]=(g*It-_*pt+k*qt)*Ve,r[9]=(s*pt-i*It-m*qt)*Ve,r[10]=(G*Je-J*ze+he*Ee)*Ve,r[11]=(R*ze-P*Je-U*Ee)*Ve,r[12]=(_*_t-g*Rt-x*qt)*Ve,r[13]=(i*Rt-s*_t+c*qt)*Ve,r[14]=(J*ye-G*Oe-se*Ee)*Ve,r[15]=(P*Oe-R*ye+O*Ee)*Ve,r):null},A.at=Ip,A.au=Pc,A.av=Pp,A.aw=function(){const r={},t=Fe.$version;for(const i in Fe.$root){const s=Fe.$root[i];if(s.required){let c=null;c=i==="version"?t:s.type==="array"?[]:{},c!=null&&(r[i]=c)}}return r},A.ax=Ko,A.ay=cr,A.az=function(r){r=r.slice();const t=Object.create(null);for(let i=0;i<r.length;i++)t[r[i].id]=r[i];for(let i=0;i<r.length;i++)"ref"in r[i]&&(r[i]=ua(r[i],t[r[i].ref]));return r},A.b=wr,A.b0=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},A.b1=function(r,t,i){return r[0]=t[0]*i[0],r[1]=t[1]*i[1],r[2]=t[2]*i[2],r[3]=t[3]*i[3],r},A.b2=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]*t[3]},A.b3=gr,A.b4=Ye,A.b5=ce,A.b6=function(r,t,i,s,c){var m,g=1/Math.tan(t/2);return r[0]=g/i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=g,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,c!=null&&c!==1/0?(r[10]=(c+s)*(m=1/(s-c)),r[14]=2*c*s*m):(r[10]=-1,r[14]=-2*s),r},A.b7=function(r,t,i){var s=Math.sin(i),c=Math.cos(i),m=t[4],g=t[5],_=t[6],x=t[7],k=t[8],P=t[9],R=t[10],O=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=m*c+k*s,r[5]=g*c+P*s,r[6]=_*c+R*s,r[7]=x*c+O*s,r[8]=k*c-m*s,r[9]=P*c-g*s,r[10]=R*c-_*s,r[11]=O*c-x*s,r},A.b8=St,A.b9=ar,A.bA=Ts,A.bB=function(r){return r.message===He},A.bC=Os,A.bD=Jr,A.ba=function(r){return r*Math.PI/180},A.bb=function(r,t){const{x:i,y:s}=Be.fromLngLat(t);return!(r<0||r>25||s<0||s>=1||i<0||i>=1)},A.bc=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},A.bd=class extends C{},A.be=a,A.bf=jm,A.bh=tr,A.bi=function(r,t){Tt.REGISTERED_PROTOCOLS[r]=t},A.bj=function(r){delete Tt.REGISTERED_PROTOCOLS[r]},A.bk=function(r,t){const i={};for(let c=0;c<r.length;c++){const m=t&&t[r[c].id]||Ku(r[c]);t&&(t[r[c].id]=m);let g=i[m];g||(g=i[m]=[]),g.push(r[c])}const s=[];for(const c in i)s.push(i[c]);return s},A.bl=wt,A.bm=Zi,A.bn=we,A.bo=Yh,A.bp=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=Fi/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;const t=r.bucket.layers[0],i=t.layout,s=t._unevaluatedLayout._values,c={layoutIconSize:s["icon-size"].possiblyEvaluate(new Sr(r.bucket.zoom+1),r.canonical),layoutTextSize:s["text-size"].possiblyEvaluate(new Sr(r.bucket.zoom+1),r.canonical),textMaxSize:s["text-size"].possiblyEvaluate(new Sr(18))};if(r.bucket.textSizeData.kind==="composite"){const{minZoom:k,maxZoom:P}=r.bucket.textSizeData;c.compositeTextSizes=[s["text-size"].possiblyEvaluate(new Sr(k),r.canonical),s["text-size"].possiblyEvaluate(new Sr(P),r.canonical)]}if(r.bucket.iconSizeData.kind==="composite"){const{minZoom:k,maxZoom:P}=r.bucket.iconSizeData;c.compositeIconSizes=[s["icon-size"].possiblyEvaluate(new Sr(k),r.canonical),s["icon-size"].possiblyEvaluate(new Sr(P),r.canonical)]}const m=i.get("text-line-height")*vi,g=i.get("text-rotation-alignment")!=="viewport"&&i.get("symbol-placement")!=="point",_=i.get("text-keep-upright"),x=i.get("text-size");for(const k of r.bucket.features){const P=i.get("text-font").evaluate(k,{},r.canonical).join(","),R=x.evaluate(k,{},r.canonical),O=c.layoutTextSize.evaluate(k,{},r.canonical),U=c.layoutIconSize.evaluate(k,{},r.canonical),G={horizontal:{},vertical:void 0},J=k.text;let se,he=[0,0];if(J){const ze=J.toString(),Oe=i.get("text-letter-spacing").evaluate(k,{},r.canonical)*vi,Je=Ih(ze)?Oe:0,vt=i.get("text-anchor").evaluate(k,{},r.canonical),qt=vf(t,k,r.canonical);if(!qt){const It=i.get("text-radial-offset").evaluate(k,{},r.canonical);he=It?_f(vt,[It*vi,Cp]):i.get("text-offset").evaluate(k,{},r.canonical).map((kt=>kt*vi))}let _t=g?"center":i.get("text-justify").evaluate(k,{},r.canonical);const pt=i.get("symbol-placement")==="point"?i.get("text-max-width").evaluate(k,{},r.canonical)*vi:1/0,Rt=()=>{r.bucket.allowVerticalPlacement&&rc(ze)&&(G.vertical=Ic(J,r.glyphMap,r.glyphPositions,r.imagePositions,P,pt,m,vt,"left",Je,he,A.ah.vertical,!0,O,R))};if(!g&&qt){const It=new Set;if(_t==="auto")for(let Ve=0;Ve<qt.values.length;Ve+=2)It.add(Ip(qt.values[Ve]));else It.add(_t);let kt=!1;for(const Ve of It)if(!G.horizontal[Ve])if(kt)G.horizontal[Ve]=G.horizontal[0];else{const Bt=Ic(J,r.glyphMap,r.glyphPositions,r.imagePositions,P,pt,m,"center",Ve,Je,he,A.ah.horizontal,!1,O,R);Bt&&(G.horizontal[Ve]=Bt,kt=Bt.positionedLines.length===1)}Rt()}else{_t==="auto"&&(_t=Ip(vt));const It=Ic(J,r.glyphMap,r.glyphPositions,r.imagePositions,P,pt,m,vt,_t,Je,he,A.ah.horizontal,!1,O,R);It&&(G.horizontal[_t]=It),Rt(),rc(ze)&&g&&_&&(G.vertical=Ic(J,r.glyphMap,r.glyphPositions,r.imagePositions,P,pt,m,vt,_t,Je,he,A.ah.vertical,!1,O,R))}}let Ee=!1;if(k.icon&&k.icon.name){const ze=r.imageMap[k.icon.name];ze&&(se=Ml(r.imagePositions[k.icon.name],i.get("icon-offset").evaluate(k,{},r.canonical),i.get("icon-anchor").evaluate(k,{},r.canonical)),Ee=!!ze.sdf,r.bucket.sdfIcons===void 0?r.bucket.sdfIcons=Ee:r.bucket.sdfIcons!==Ee&&kr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ze.pixelRatio!==r.bucket.pixelRatio||i.get("icon-rotate").constantOr(1)!==0)&&(r.bucket.iconsNeedLinear=!0))}const ye=wf(G.horizontal)||G.vertical;r.bucket.iconsInText=!!ye&&ye.iconsInText,(ye||se)&&Om(r.bucket,k,G,se,r.imageMap,c,O,U,he,Ee,r.canonical)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},A.bq=Ro,A.br=oh,A.bs=aa,A.bt=zl,A.bu=Hs,A.bv=class{constructor(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let r=performance.getEntriesByName(this._marks.measure);return r.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),r=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),r}},A.bw=function(r,t,i,s,c){return d(this,void 0,void 0,(function*(){if(mt())try{return yield Mt(r,t,i,s,c)}catch{}return(function(m,g,_,x,k){const P=m.width,R=m.height;xt&&ke||(xt=new OffscreenCanvas(P,R),ke=xt.getContext("2d",{willReadFrequently:!0})),xt.width=P,xt.height=R,ke.drawImage(m,0,0,P,R);const O=ke.getImageData(g,_,x,k);return ke.clearRect(0,0,P,R),O.data})(r,t,i,s,c)}))},A.bx=Ot,A.by=Se,A.bz=Pe,A.c=Gt,A.d=r=>d(void 0,void 0,void 0,(function*(){if(r.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(r)],{type:"image/png"});try{return createImageBitmap(t)}catch(i){throw new Error(`Could not load image because of ${i.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),A.e=Vt,A.f=r=>new Promise(((t,i)=>{const s=new Image;s.onload=()=>{t(s),URL.revokeObjectURL(s.src),s.onload=null,window.requestAnimationFrame((()=>{s.src=ft}))},s.onerror=()=>i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const c=new Blob([new Uint8Array(r)],{type:"image/png"});s.src=r.byteLength?URL.createObjectURL(c):ft})),A.g=$t,A.h=(r,t)=>Ar(Vt(r,{type:"json"}),t),A.i=ti,A.j=wo,A.k=en,A.l=(r,t)=>Ar(Vt(r,{type:"arrayBuffer"}),t),A.m=Ar,A.n=function(r){return new Hs(r).readFields(uu,[])},A.o=iu,A.p=Ec,A.q=f,A.r=ec,A.s=bi,A.t=zu,A.u=Xa,A.v=Fe,A.w=kr,A.x=function([r,t,i]){return t+=90,t*=Math.PI/180,i*=Math.PI/180,{x:r*Math.cos(t)*Math.sin(i),y:r*Math.sin(t)*Math.sin(i),z:r*Math.cos(i)}},A.y=ki,A.z=Sr})),W("worker",["./shared"],(function(A){class d{constructor(j){this.keyCache={},j&&this.replace(j)}replace(j){this._layerConfigs={},this._layers={},this.update(j,[])}update(j,V){for(const oe of j){this._layerConfigs[oe.id]=oe;const ge=this._layers[oe.id]=A.aA(oe);ge._featureFilter=A.a7(ge.filter),this.keyCache[oe.id]&&delete this.keyCache[oe.id]}for(const oe of V)delete this.keyCache[oe],delete this._layerConfigs[oe],delete this._layers[oe];this.familiesBySource={};const X=A.bk(Object.values(this._layerConfigs),this.keyCache);for(const oe of X){const ge=oe.map((Ae=>this._layers[Ae.id])),xe=ge[0];if(xe.visibility==="none")continue;const Te=xe.source||"";let de=this.familiesBySource[Te];de||(de=this.familiesBySource[Te]={});const De=xe.sourceLayer||"_geojsonTileLayer";let qe=de[De];qe||(qe=de[De]=[]),qe.push(ge)}}}class Se{constructor(j){const V={},X=[];for(const Te in j){const de=j[Te],De=V[Te]={};for(const qe in de){const Ae=de[+qe];if(!Ae||Ae.bitmap.width===0||Ae.bitmap.height===0)continue;const it={x:0,y:0,w:Ae.bitmap.width+2,h:Ae.bitmap.height+2};X.push(it),De[qe]={rect:it,metrics:Ae.metrics}}}const{w:oe,h:ge}=A.p(X),xe=new A.o({width:oe||1,height:ge||1});for(const Te in j){const de=j[Te];for(const De in de){const qe=de[+De];if(!qe||qe.bitmap.width===0||qe.bitmap.height===0)continue;const Ae=V[Te][De].rect;A.o.copy(qe.bitmap,xe,{x:0,y:0},{x:Ae.x+1,y:Ae.y+1},qe.bitmap)}}this.image=xe,this.positions=V}}A.bl("GlyphAtlas",Se);class Pe{constructor(j){this.tileID=new A.S(j.tileID.overscaledZ,j.tileID.wrap,j.tileID.canonical.z,j.tileID.canonical.x,j.tileID.canonical.y),this.uid=j.uid,this.zoom=j.zoom,this.pixelRatio=j.pixelRatio,this.tileSize=j.tileSize,this.source=j.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=j.showCollisionBoxes,this.collectResourceTiming=!!j.collectResourceTiming,this.returnDependencies=!!j.returnDependencies,this.promoteId=j.promoteId,this.inFlightDependencies=[]}parse(j,V,X,oe){return A._(this,void 0,void 0,(function*(){this.status="parsing",this.data=j,this.collisionBoxArray=new A.a5;const ge=new A.bm(Object.keys(j.layers).sort()),xe=new A.bn(this.tileID,this.promoteId);xe.bucketLayerIDs=[];const Te={},de={featureIndex:xe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:X},De=V.familiesBySource[this.source];for(const hr in De){const Or=j.layers[hr];if(!Or)continue;Or.version===1&&A.w(`Vector tile source "${this.source}" layer "${hr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Kr=ge.encode(hr),yi=[];for(let Pi=0;Pi<Or.length;Pi++){const ji=Or.feature(Pi),Aa=xe.getId(ji,hr);yi.push({feature:ji,id:Aa,index:Pi,sourceLayerIndex:Kr})}for(const Pi of De[hr]){const ji=Pi[0];ji.source!==this.source&&A.w(`layer.source = ${ji.source} does not equal this.source = ${this.source}`),ji.minzoom&&this.zoom<Math.floor(ji.minzoom)||ji.maxzoom&&this.zoom>=ji.maxzoom||ji.visibility!=="none"&&(Le(Pi,this.zoom,X),(Te[ji.id]=ji.createBucket({index:xe.bucketLayerIDs.length,layers:Pi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Kr,sourceID:this.source})).populate(yi,de,this.tileID.canonical),xe.bucketLayerIDs.push(Pi.map((Aa=>Aa.id))))}}const qe=A.aF(de.glyphDependencies,(hr=>Object.keys(hr).map(Number)));this.inFlightDependencies.forEach((hr=>hr?.abort())),this.inFlightDependencies=[];let Ae=Promise.resolve({});if(Object.keys(qe).length){const hr=new AbortController;this.inFlightDependencies.push(hr),Ae=oe.sendAsync({type:"GG",data:{stacks:qe,source:this.source,tileID:this.tileID,type:"glyphs"}},hr)}const it=Object.keys(de.iconDependencies);let Ct=Promise.resolve({});if(it.length){const hr=new AbortController;this.inFlightDependencies.push(hr),Ct=oe.sendAsync({type:"GI",data:{icons:it,source:this.source,tileID:this.tileID,type:"icons"}},hr)}const Lt=Object.keys(de.patternDependencies);let br=Promise.resolve({});if(Lt.length){const hr=new AbortController;this.inFlightDependencies.push(hr),br=oe.sendAsync({type:"GI",data:{icons:Lt,source:this.source,tileID:this.tileID,type:"patterns"}},hr)}const[er,Tr,ir]=yield Promise.all([Ae,Ct,br]),gi=new Se(er),Xr=new A.bo(Tr,ir);for(const hr in Te){const Or=Te[hr];Or instanceof A.a6?(Le(Or.layers,this.zoom,X),A.bp({bucket:Or,glyphMap:er,glyphPositions:gi.positions,imageMap:Tr,imagePositions:Xr.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Or.hasPattern&&(Or instanceof A.bq||Or instanceof A.br||Or instanceof A.bs)&&(Le(Or.layers,this.zoom,X),Or.addFeatures(de,this.tileID.canonical,Xr.patternPositions))}return this.status="done",{buckets:Object.values(Te).filter((hr=>!hr.isEmpty())),featureIndex:xe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:gi.image,imageAtlas:Xr,glyphMap:this.returnDependencies?er:null,iconMap:this.returnDependencies?Tr:null,glyphPositions:this.returnDependencies?gi.positions:null}}))}}function Le(le,j,V){const X=new A.z(j);for(const oe of le)oe.recalculate(X,V)}class re{constructor(j,V,X){this.actor=j,this.layerIndex=V,this.availableImages=X,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(j,V){return A._(this,void 0,void 0,(function*(){const X=yield A.l(j.request,V);try{return{vectorTile:new A.bt.VectorTile(new A.bu(X.data)),rawData:X.data,cacheControl:X.cacheControl,expires:X.expires}}catch(oe){const ge=new Uint8Array(X.data);let xe=`Unable to parse the tile at ${j.request.url}, `;throw xe+=ge[0]===31&&ge[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${oe.message}`,new Error(xe)}}))}loadTile(j){return A._(this,void 0,void 0,(function*(){const V=j.uid,X=!!(j&&j.request&&j.request.collectResourceTiming)&&new A.bv(j.request),oe=new Pe(j);this.loading[V]=oe;const ge=new AbortController;oe.abort=ge;try{const xe=yield this.loadVectorTile(j,ge);if(delete this.loading[V],!xe)return null;const Te=xe.rawData,de={};xe.expires&&(de.expires=xe.expires),xe.cacheControl&&(de.cacheControl=xe.cacheControl);const De={};if(X){const Ae=X.finish();Ae&&(De.resourceTiming=JSON.parse(JSON.stringify(Ae)))}oe.vectorTile=xe.vectorTile;const qe=oe.parse(xe.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[V]=oe,this.fetching[V]={rawTileData:Te,cacheControl:de,resourceTiming:De};try{const Ae=yield qe;return A.e({rawTileData:Te.slice(0)},Ae,de,De)}finally{delete this.fetching[V]}}catch(xe){throw delete this.loading[V],oe.status="done",this.loaded[V]=oe,xe}}))}reloadTile(j){return A._(this,void 0,void 0,(function*(){const V=j.uid;if(!this.loaded||!this.loaded[V])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const X=this.loaded[V];if(X.showCollisionBoxes=j.showCollisionBoxes,X.status==="parsing"){const oe=yield X.parse(X.vectorTile,this.layerIndex,this.availableImages,this.actor);let ge;if(this.fetching[V]){const{rawTileData:xe,cacheControl:Te,resourceTiming:de}=this.fetching[V];delete this.fetching[V],ge=A.e({rawTileData:xe.slice(0)},oe,Te,de)}else ge=oe;return ge}if(X.status==="done"&&X.vectorTile)return X.parse(X.vectorTile,this.layerIndex,this.availableImages,this.actor)}))}abortTile(j){return A._(this,void 0,void 0,(function*(){const V=this.loading,X=j.uid;V&&V[X]&&V[X].abort&&(V[X].abort.abort(),delete V[X])}))}removeTile(j){return A._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[j.uid]&&delete this.loaded[j.uid]}))}}class ne{constructor(){this.loaded={}}loadTile(j){return A._(this,void 0,void 0,(function*(){const{uid:V,encoding:X,rawImageData:oe,redFactor:ge,greenFactor:xe,blueFactor:Te,baseShift:de}=j,De=oe.width+2,qe=oe.height+2,Ae=A.b(oe)?new A.R({width:De,height:qe},yield A.bw(oe,-1,-1,De,qe)):oe,it=new A.bx(V,Ae,X,ge,xe,Te,de);return this.loaded=this.loaded||{},this.loaded[V]=it,it}))}removeTile(j){const V=this.loaded,X=j.uid;V&&V[X]&&delete V[X]}}function Ge(le,j){if(le.length!==0){et(le[0],j);for(var V=1;V<le.length;V++)et(le[V],!j)}}function et(le,j){for(var V=0,X=0,oe=0,ge=le.length,xe=ge-1;oe<ge;xe=oe++){var Te=(le[oe][0]-le[xe][0])*(le[xe][1]+le[oe][1]),de=V+Te;X+=Math.abs(V)>=Math.abs(Te)?V-de+Te:Te-de+V,V=de}V+X>=0!=!!j&&le.reverse()}var je=A.by((function le(j,V){var X,oe=j&&j.type;if(oe==="FeatureCollection")for(X=0;X<j.features.length;X++)le(j.features[X],V);else if(oe==="GeometryCollection")for(X=0;X<j.geometries.length;X++)le(j.geometries[X],V);else if(oe==="Feature")le(j.geometry,V);else if(oe==="Polygon")Ge(j.coordinates,V);else if(oe==="MultiPolygon")for(X=0;X<j.coordinates.length;X++)Ge(j.coordinates[X],V);return j}));const Xe=A.bt.VectorTileFeature.prototype.toGeoJSON;var Pt={exports:{}},mt=A.bz,St=A.bt.VectorTileFeature,ar=ur;function ur(le,j){this.options=j||{},this.features=le,this.length=le.length}function gr(le,j){this.id=typeof le.id=="number"?le.id:void 0,this.type=le.type,this.rawGeometry=le.type===1?[le.geometry]:le.geometry,this.properties=le.tags,this.extent=j||4096}ur.prototype.feature=function(le){return new gr(this.features[le],this.options.extent)},gr.prototype.loadGeometry=function(){var le=this.rawGeometry;this.geometry=[];for(var j=0;j<le.length;j++){for(var V=le[j],X=[],oe=0;oe<V.length;oe++)X.push(new mt(V[oe][0],V[oe][1]));this.geometry.push(X)}return this.geometry},gr.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var le=this.geometry,j=1/0,V=-1/0,X=1/0,oe=-1/0,ge=0;ge<le.length;ge++)for(var xe=le[ge],Te=0;Te<xe.length;Te++){var de=xe[Te];j=Math.min(j,de.x),V=Math.max(V,de.x),X=Math.min(X,de.y),oe=Math.max(oe,de.y)}return[j,X,V,oe]},gr.prototype.toGeoJSON=St.prototype.toGeoJSON;var Vt=A.bA,zr=ar;function xr(le){var j=new Vt;return(function(V,X){for(var oe in V.layers)X.writeMessage(3,Br,V.layers[oe])})(le,j),j.finish()}function Br(le,j){var V;j.writeVarintField(15,le.version||1),j.writeStringField(1,le.name||""),j.writeVarintField(5,le.extent||4096);var X={keys:[],values:[],keycache:{},valuecache:{}};for(V=0;V<le.length;V++)X.feature=le.feature(V),j.writeMessage(2,Et,X);var oe=X.keys;for(V=0;V<oe.length;V++)j.writeStringField(3,oe[V]);var ge=X.values;for(V=0;V<ge.length;V++)j.writeMessage(4,Wr,ge[V])}function Et(le,j){var V=le.feature;V.id!==void 0&&j.writeVarintField(1,V.id),j.writeMessage(2,Hr,le),j.writeVarintField(3,V.type),j.writeMessage(4,ti,V)}function Hr(le,j){var V=le.feature,X=le.keys,oe=le.values,ge=le.keycache,xe=le.valuecache;for(var Te in V.properties){var de=V.properties[Te],De=ge[Te];if(de!==null){De===void 0&&(X.push(Te),ge[Te]=De=X.length-1),j.writeVarint(De);var qe=typeof de;qe!=="string"&&qe!=="boolean"&&qe!=="number"&&(de=JSON.stringify(de));var Ae=qe+":"+de,it=xe[Ae];it===void 0&&(oe.push(de),xe[Ae]=it=oe.length-1),j.writeVarint(it)}}}function kr(le,j){return(j<<3)+(7&le)}function _r(le){return le<<1^le>>31}function ti(le,j){for(var V=le.loadGeometry(),X=le.type,oe=0,ge=0,xe=V.length,Te=0;Te<xe;Te++){var de=V[Te],De=1;X===1&&(De=de.length),j.writeVarint(kr(1,De));for(var qe=X===3?de.length-1:de.length,Ae=0;Ae<qe;Ae++){Ae===1&&X!==1&&j.writeVarint(kr(2,qe-1));var it=de[Ae].x-oe,Ct=de[Ae].y-ge;j.writeVarint(_r(it)),j.writeVarint(_r(Ct)),oe+=it,ge+=Ct}X===3&&j.writeVarint(kr(7,1))}}function Wr(le,j){var V=typeof le;V==="string"?j.writeStringField(1,le):V==="boolean"?j.writeBooleanField(7,le):V==="number"&&(le%1!=0?j.writeDoubleField(3,le):le<0?j.writeSVarintField(6,le):j.writeVarintField(5,le))}Pt.exports=xr,Pt.exports.fromVectorTileJs=xr,Pt.exports.fromGeojsonVt=function(le,j){j=j||{};var V={};for(var X in le)V[X]=new zr(le[X].features,j),V[X].name=X,V[X].version=j.version,V[X].extent=j.extent;return xr({layers:V})},Pt.exports.GeoJSONWrapper=zr;var wr=A.by(Pt.exports);const ft={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:le=>le},Mt=Math.fround||(xt=new Float32Array(1),le=>(xt[0]=+le,xt[0]));var xt;const ke=3,He=5,Gt=6;class Tt{constructor(j){this.options=Object.assign(Object.create(ft),j),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(j){const{log:V,minZoom:X,maxZoom:oe}=this.options;V&&console.time("total time");const ge=`prepare ${j.length} points`;V&&console.time(ge),this.points=j;const xe=[];for(let de=0;de<j.length;de++){const De=j[de];if(!De.geometry)continue;const[qe,Ae]=De.geometry.coordinates,it=Mt(tr(qe)),Ct=Mt(cr(Ae));xe.push(it,Ct,1/0,de,-1,1),this.options.reduce&&xe.push(0)}let Te=this.trees[oe+1]=this._createTree(xe);V&&console.timeEnd(ge);for(let de=oe;de>=X;de--){const De=+Date.now();Te=this.trees[de]=this._createTree(this._cluster(Te,de)),V&&console.log("z%d: %d clusters in %dms",de,Te.numItems,+Date.now()-De)}return V&&console.timeEnd("total time"),this}getClusters(j,V){let X=((j[0]+180)%360+360)%360-180;const oe=Math.max(-90,Math.min(90,j[1]));let ge=j[2]===180?180:((j[2]+180)%360+360)%360-180;const xe=Math.max(-90,Math.min(90,j[3]));if(j[2]-j[0]>=360)X=-180,ge=180;else if(X>ge){const Ae=this.getClusters([X,oe,180,xe],V),it=this.getClusters([-180,oe,ge,xe],V);return Ae.concat(it)}const Te=this.trees[this._limitZoom(V)],de=Te.range(tr(X),cr(xe),tr(ge),cr(oe)),De=Te.data,qe=[];for(const Ae of de){const it=this.stride*Ae;qe.push(De[it+He]>1?$t(De,it,this.clusterProps):this.points[De[it+ke]])}return qe}getChildren(j){const V=this._getOriginId(j),X=this._getOriginZoom(j),oe="No cluster with the specified id.",ge=this.trees[X];if(!ge)throw new Error(oe);const xe=ge.data;if(V*this.stride>=xe.length)throw new Error(oe);const Te=this.options.radius/(this.options.extent*Math.pow(2,X-1)),de=ge.within(xe[V*this.stride],xe[V*this.stride+1],Te),De=[];for(const qe of de){const Ae=qe*this.stride;xe[Ae+4]===j&&De.push(xe[Ae+He]>1?$t(xe,Ae,this.clusterProps):this.points[xe[Ae+ke]])}if(De.length===0)throw new Error(oe);return De}getLeaves(j,V,X){const oe=[];return this._appendLeaves(oe,j,V=V||10,X=X||0,0),oe}getTile(j,V,X){const oe=this.trees[this._limitZoom(j)],ge=Math.pow(2,j),{extent:xe,radius:Te}=this.options,de=Te/xe,De=(X-de)/ge,qe=(X+1+de)/ge,Ae={features:[]};return this._addTileFeatures(oe.range((V-de)/ge,De,(V+1+de)/ge,qe),oe.data,V,X,ge,Ae),V===0&&this._addTileFeatures(oe.range(1-de/ge,De,1,qe),oe.data,ge,X,ge,Ae),V===ge-1&&this._addTileFeatures(oe.range(0,De,de/ge,qe),oe.data,-1,X,ge,Ae),Ae.features.length?Ae:null}getClusterExpansionZoom(j){let V=this._getOriginZoom(j)-1;for(;V<=this.options.maxZoom;){const X=this.getChildren(j);if(V++,X.length!==1)break;j=X[0].properties.cluster_id}return V}_appendLeaves(j,V,X,oe,ge){const xe=this.getChildren(V);for(const Te of xe){const de=Te.properties;if(de&&de.cluster?ge+de.point_count<=oe?ge+=de.point_count:ge=this._appendLeaves(j,de.cluster_id,X,oe,ge):ge<oe?ge++:j.push(Te),j.length===X)break}return ge}_createTree(j){const V=new A.av(j.length/this.stride|0,this.options.nodeSize,Float32Array);for(let X=0;X<j.length;X+=this.stride)V.add(j[X],j[X+1]);return V.finish(),V.data=j,V}_addTileFeatures(j,V,X,oe,ge,xe){for(const Te of j){const de=Te*this.stride,De=V[de+He]>1;let qe,Ae,it;if(De)qe=rr(V,de,this.clusterProps),Ae=V[de],it=V[de+1];else{const br=this.points[V[de+ke]];qe=br.properties;const[er,Tr]=br.geometry.coordinates;Ae=tr(er),it=cr(Tr)}const Ct={type:1,geometry:[[Math.round(this.options.extent*(Ae*ge-X)),Math.round(this.options.extent*(it*ge-oe))]],tags:qe};let Lt;Lt=De||this.options.generateId?V[de+ke]:this.points[V[de+ke]].id,Lt!==void 0&&(Ct.id=Lt),xe.features.push(Ct)}}_limitZoom(j){return Math.max(this.options.minZoom,Math.min(Math.floor(+j),this.options.maxZoom+1))}_cluster(j,V){const{radius:X,extent:oe,reduce:ge,minPoints:xe}=this.options,Te=X/(oe*Math.pow(2,V)),de=j.data,De=[],qe=this.stride;for(let Ae=0;Ae<de.length;Ae+=qe){if(de[Ae+2]<=V)continue;de[Ae+2]=V;const it=de[Ae],Ct=de[Ae+1],Lt=j.within(de[Ae],de[Ae+1],Te),br=de[Ae+He];let er=br;for(const Tr of Lt){const ir=Tr*qe;de[ir+2]>V&&(er+=de[ir+He])}if(er>br&&er>=xe){let Tr,ir=it*br,gi=Ct*br,Xr=-1;const hr=((Ae/qe|0)<<5)+(V+1)+this.points.length;for(const Or of Lt){const Kr=Or*qe;if(de[Kr+2]<=V)continue;de[Kr+2]=V;const yi=de[Kr+He];ir+=de[Kr]*yi,gi+=de[Kr+1]*yi,de[Kr+4]=hr,ge&&(Tr||(Tr=this._map(de,Ae,!0),Xr=this.clusterProps.length,this.clusterProps.push(Tr)),ge(Tr,this._map(de,Kr)))}de[Ae+4]=hr,De.push(ir/er,gi/er,1/0,hr,-1,er),ge&&De.push(Xr)}else{for(let Tr=0;Tr<qe;Tr++)De.push(de[Ae+Tr]);if(er>1)for(const Tr of Lt){const ir=Tr*qe;if(!(de[ir+2]<=V)){de[ir+2]=V;for(let gi=0;gi<qe;gi++)De.push(de[ir+gi])}}}}return De}_getOriginId(j){return j-this.points.length>>5}_getOriginZoom(j){return(j-this.points.length)%32}_map(j,V,X){if(j[V+He]>1){const xe=this.clusterProps[j[V+Gt]];return X?Object.assign({},xe):xe}const oe=this.points[j[V+ke]].properties,ge=this.options.map(oe);return X&&ge===oe?Object.assign({},ge):ge}}function $t(le,j,V){return{type:"Feature",id:le[j+ke],properties:rr(le,j,V),geometry:{type:"Point",coordinates:[(X=le[j],360*(X-.5)),Ar(le[j+1])]}};var X}function rr(le,j,V){const X=le[j+He],oe=X>=1e4?`${Math.round(X/1e3)}k`:X>=1e3?Math.round(X/100)/10+"k":X,ge=le[j+Gt],xe=ge===-1?{}:Object.assign({},V[ge]);return Object.assign(xe,{cluster:!0,cluster_id:le[j+ke],point_count:X,point_count_abbreviated:oe})}function tr(le){return le/360+.5}function cr(le){const j=Math.sin(le*Math.PI/180),V=.5-.25*Math.log((1+j)/(1-j))/Math.PI;return V<0?0:V>1?1:V}function Ar(le){const j=(180-360*le)*Math.PI/180;return 360*Math.atan(Math.exp(j))/Math.PI-90}function bi(le,j,V,X){let oe=X;const ge=j+(V-j>>1);let xe,Te=V-j;const de=le[j],De=le[j+1],qe=le[V],Ae=le[V+1];for(let it=j+3;it<V;it+=3){const Ct=Pn(le[it],le[it+1],de,De,qe,Ae);if(Ct>oe)xe=it,oe=Ct;else if(Ct===oe){const Lt=Math.abs(it-ge);Lt<Te&&(xe=it,Te=Lt)}}oe>X&&(xe-j>3&&bi(le,j,xe,X),le[xe+2]=oe,V-xe>3&&bi(le,xe,V,X))}function Pn(le,j,V,X,oe,ge){let xe=oe-V,Te=ge-X;if(xe!==0||Te!==0){const de=((le-V)*xe+(j-X)*Te)/(xe*xe+Te*Te);de>1?(V=oe,X=ge):de>0&&(V+=xe*de,X+=Te*de)}return xe=le-V,Te=j-X,xe*xe+Te*Te}function di(le,j,V,X){const oe={id:le??null,type:j,geometry:V,tags:X,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(j==="Point"||j==="MultiPoint"||j==="LineString")en(oe,V);else if(j==="Polygon")en(oe,V[0]);else if(j==="MultiLineString")for(const ge of V)en(oe,ge);else if(j==="MultiPolygon")for(const ge of V)en(oe,ge[0]);return oe}function en(le,j){for(let V=0;V<j.length;V+=3)le.minX=Math.min(le.minX,j[V]),le.minY=Math.min(le.minY,j[V+1]),le.maxX=Math.max(le.maxX,j[V]),le.maxY=Math.max(le.maxY,j[V+1])}function wo(le,j,V,X){if(!j.geometry)return;const oe=j.geometry.coordinates;if(oe&&oe.length===0)return;const ge=j.geometry.type,xe=Math.pow(V.tolerance/((1<<V.maxZoom)*V.extent),2);let Te=[],de=j.id;if(V.promoteId?de=j.properties[V.promoteId]:V.generateId&&(de=X||0),ge==="Point")Ia(oe,Te);else if(ge==="MultiPoint")for(const De of oe)Ia(De,Te);else if(ge==="LineString")Fe(oe,Te,xe,!1);else if(ge==="MultiLineString"){if(V.lineMetrics){for(const De of oe)Te=[],Fe(De,Te,xe,!1),le.push(di(de,"LineString",Te,j.properties));return}Si(oe,Te,xe,!1)}else if(ge==="Polygon")Si(oe,Te,xe,!0);else{if(ge!=="MultiPolygon"){if(ge==="GeometryCollection"){for(const De of j.geometry.geometries)wo(le,{id:de,geometry:De,properties:j.properties},V,X);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const De of oe){const qe=[];Si(De,qe,xe,!0),Te.push(qe)}}le.push(di(de,ge,Te,j.properties))}function Ia(le,j){j.push(ua(le[0]),Er(le[1]),0)}function Fe(le,j,V,X){let oe,ge,xe=0;for(let de=0;de<le.length;de++){const De=ua(le[de][0]),qe=Er(le[de][1]);j.push(De,qe,0),de>0&&(xe+=X?(oe*qe-De*ge)/2:Math.sqrt(Math.pow(De-oe,2)+Math.pow(qe-ge,2))),oe=De,ge=qe}const Te=j.length-3;j[2]=1,bi(j,0,Te,V),j[Te+2]=1,j.size=Math.abs(xe),j.start=0,j.end=j.size}function Si(le,j,V,X){for(let oe=0;oe<le.length;oe++){const ge=[];Fe(le[oe],ge,V,X),j.push(ge)}}function ua(le){return le/360+.5}function Er(le){const j=Math.sin(le*Math.PI/180),V=.5-.25*Math.log((1+j)/(1-j))/Math.PI;return V<0?0:V>1?1:V}function qr(le,j,V,X,oe,ge,xe,Te){if(X/=j,ge>=(V/=j)&&xe<X)return le;if(xe<V||ge>=X)return null;const de=[];for(const De of le){const qe=De.geometry;let Ae=De.type;const it=oe===0?De.minX:De.minY,Ct=oe===0?De.maxX:De.maxY;if(it>=V&&Ct<X){de.push(De);continue}if(Ct<V||it>=X)continue;let Lt=[];if(Ae==="Point"||Ae==="MultiPoint")bo(qe,Lt,V,X,oe);else if(Ae==="LineString")So(qe,Lt,V,X,oe,!1,Te.lineMetrics);else if(Ae==="MultiLineString")Pa(qe,Lt,V,X,oe,!1);else if(Ae==="Polygon")Pa(qe,Lt,V,X,oe,!0);else if(Ae==="MultiPolygon")for(const br of qe){const er=[];Pa(br,er,V,X,oe,!0),er.length&&Lt.push(er)}if(Lt.length){if(Te.lineMetrics&&Ae==="LineString"){for(const br of Lt)de.push(di(De.id,Ae,br,De.tags));continue}Ae!=="LineString"&&Ae!=="MultiLineString"||(Lt.length===1?(Ae="LineString",Lt=Lt[0]):Ae="MultiLineString"),Ae!=="Point"&&Ae!=="MultiPoint"||(Ae=Lt.length===3?"Point":"MultiPoint"),de.push(di(De.id,Ae,Lt,De.tags))}}return de.length?de:null}function bo(le,j,V,X,oe){for(let ge=0;ge<le.length;ge+=3){const xe=le[ge+oe];xe>=V&&xe<=X&&Mn(j,le[ge],le[ge+1],le[ge+2])}}function So(le,j,V,X,oe,ge,xe){let Te=ko(le);const de=oe===0?cs:Ma;let De,qe,Ae=le.start;for(let er=0;er<le.length-3;er+=3){const Tr=le[er],ir=le[er+1],gi=le[er+2],Xr=le[er+3],hr=le[er+4],Or=oe===0?Tr:ir,Kr=oe===0?Xr:hr;let yi=!1;xe&&(De=Math.sqrt(Math.pow(Tr-Xr,2)+Math.pow(ir-hr,2))),Or<V?Kr>V&&(qe=de(Te,Tr,ir,Xr,hr,V),xe&&(Te.start=Ae+De*qe)):Or>X?Kr<X&&(qe=de(Te,Tr,ir,Xr,hr,X),xe&&(Te.start=Ae+De*qe)):Mn(Te,Tr,ir,gi),Kr<V&&Or>=V&&(qe=de(Te,Tr,ir,Xr,hr,V),yi=!0),Kr>X&&Or<=X&&(qe=de(Te,Tr,ir,Xr,hr,X),yi=!0),!ge&&yi&&(xe&&(Te.end=Ae+De*qe),j.push(Te),Te=ko(le)),xe&&(Ae+=De)}let it=le.length-3;const Ct=le[it],Lt=le[it+1],br=oe===0?Ct:Lt;br>=V&&br<=X&&Mn(Te,Ct,Lt,le[it+2]),it=Te.length-3,ge&&it>=3&&(Te[it]!==Te[0]||Te[it+1]!==Te[1])&&Mn(Te,Te[0],Te[1],Te[2]),Te.length&&j.push(Te)}function ko(le){const j=[];return j.size=le.size,j.start=le.start,j.end=le.end,j}function Pa(le,j,V,X,oe,ge){for(const xe of le)So(xe,j,V,X,oe,ge,!1)}function Mn(le,j,V,X){le.push(j,V,X)}function cs(le,j,V,X,oe,ge){const xe=(ge-j)/(X-j);return Mn(le,ge,V+(oe-V)*xe,1),xe}function Ma(le,j,V,X,oe,ge){const xe=(ge-V)/(oe-V);return Mn(le,j+(X-j)*xe,ge,1),xe}function rt(le,j){const V=[];for(let X=0;X<le.length;X++){const oe=le[X],ge=oe.type;let xe;if(ge==="Point"||ge==="MultiPoint"||ge==="LineString")xe=ao(oe.geometry,j);else if(ge==="MultiLineString"||ge==="Polygon"){xe=[];for(const Te of oe.geometry)xe.push(ao(Te,j))}else if(ge==="MultiPolygon"){xe=[];for(const Te of oe.geometry){const de=[];for(const De of Te)de.push(ao(De,j));xe.push(de)}}V.push(di(oe.id,ge,xe,oe.tags))}return V}function ao(le,j){const V=[];V.size=le.size,le.start!==void 0&&(V.start=le.start,V.end=le.end);for(let X=0;X<le.length;X+=3)V.push(le[X]+j,le[X+1],le[X+2]);return V}function pi(le,j){if(le.transformed)return le;const V=1<<le.z,X=le.x,oe=le.y;for(const ge of le.features){const xe=ge.geometry,Te=ge.type;if(ge.geometry=[],Te===1)for(let de=0;de<xe.length;de+=2)ge.geometry.push(fr(xe[de],xe[de+1],j,V,X,oe));else for(let de=0;de<xe.length;de++){const De=[];for(let qe=0;qe<xe[de].length;qe+=2)De.push(fr(xe[de][qe],xe[de][qe+1],j,V,X,oe));ge.geometry.push(De)}}return le.transformed=!0,le}function fr(le,j,V,X,oe,ge){return[Math.round(V*(le*X-oe)),Math.round(V*(j*X-ge))]}function ri(le,j,V,X,oe){const ge=j===oe.maxZoom?0:oe.tolerance/((1<<j)*oe.extent),xe={features:[],numPoints:0,numSimplified:0,numFeatures:le.length,source:null,x:V,y:X,z:j,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Te of le)at(xe,Te,ge,oe);return xe}function at(le,j,V,X){const oe=j.geometry,ge=j.type,xe=[];if(le.minX=Math.min(le.minX,j.minX),le.minY=Math.min(le.minY,j.minY),le.maxX=Math.max(le.maxX,j.maxX),le.maxY=Math.max(le.maxY,j.maxY),ge==="Point"||ge==="MultiPoint")for(let Te=0;Te<oe.length;Te+=3)xe.push(oe[Te],oe[Te+1]),le.numPoints++,le.numSimplified++;else if(ge==="LineString")sr(xe,oe,le,V,!1,!1);else if(ge==="MultiLineString"||ge==="Polygon")for(let Te=0;Te<oe.length;Te++)sr(xe,oe[Te],le,V,ge==="Polygon",Te===0);else if(ge==="MultiPolygon")for(let Te=0;Te<oe.length;Te++){const de=oe[Te];for(let De=0;De<de.length;De++)sr(xe,de[De],le,V,!0,De===0)}if(xe.length){let Te=j.tags||null;if(ge==="LineString"&&X.lineMetrics){Te={};for(const De in j.tags)Te[De]=j.tags[De];Te.mapbox_clip_start=oe.start/oe.size,Te.mapbox_clip_end=oe.end/oe.size}const de={geometry:xe,type:ge==="Polygon"||ge==="MultiPolygon"?3:ge==="LineString"||ge==="MultiLineString"?2:1,tags:Te};j.id!==null&&(de.id=j.id),le.features.push(de)}}function sr(le,j,V,X,oe,ge){const xe=X*X;if(X>0&&j.size<(oe?xe:X))return void(V.numPoints+=j.length/3);const Te=[];for(let de=0;de<j.length;de+=3)(X===0||j[de+2]>xe)&&(V.numSimplified++,Te.push(j[de],j[de+1])),V.numPoints++;oe&&(function(de,De){let qe=0;for(let Ae=0,it=de.length,Ct=it-2;Ae<it;Ct=Ae,Ae+=2)qe+=(de[Ae]-de[Ct])*(de[Ae+1]+de[Ct+1]);if(qe>0===De)for(let Ae=0,it=de.length;Ae<it/2;Ae+=2){const Ct=de[Ae],Lt=de[Ae+1];de[Ae]=de[it-2-Ae],de[Ae+1]=de[it-1-Ae],de[it-2-Ae]=Ct,de[it-1-Ae]=Lt}})(Te,ge),le.push(Te)}const Zt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Gi{constructor(j,V){const X=(V=this.options=(function(ge,xe){for(const Te in xe)ge[Te]=xe[Te];return ge})(Object.create(Zt),V)).debug;if(X&&console.time("preprocess data"),V.maxZoom<0||V.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(V.promoteId&&V.generateId)throw new Error("promoteId and generateId cannot be used together.");let oe=(function(ge,xe){const Te=[];if(ge.type==="FeatureCollection")for(let de=0;de<ge.features.length;de++)wo(Te,ge.features[de],xe,de);else wo(Te,ge.type==="Feature"?ge:{geometry:ge},xe);return Te})(j,V);this.tiles={},this.tileCoords=[],X&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",V.indexMaxZoom,V.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),oe=(function(ge,xe){const Te=xe.buffer/xe.extent;let de=ge;const De=qr(ge,1,-1-Te,Te,0,-1,2,xe),qe=qr(ge,1,1-Te,2+Te,0,-1,2,xe);return(De||qe)&&(de=qr(ge,1,-Te,1+Te,0,-1,2,xe)||[],De&&(de=rt(De,1).concat(de)),qe&&(de=de.concat(rt(qe,-1)))),de})(oe,V),oe.length&&this.splitTile(oe,0,0,0),X&&(oe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(j,V,X,oe,ge,xe,Te){const de=[j,V,X,oe],De=this.options,qe=De.debug;for(;de.length;){oe=de.pop(),X=de.pop(),V=de.pop(),j=de.pop();const Ae=1<<V,it=Ni(V,X,oe);let Ct=this.tiles[it];if(!Ct&&(qe>1&&console.time("creation"),Ct=this.tiles[it]=ri(j,V,X,oe,De),this.tileCoords.push({z:V,x:X,y:oe}),qe)){qe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",V,X,oe,Ct.numFeatures,Ct.numPoints,Ct.numSimplified),console.timeEnd("creation"));const yi=`z${V}`;this.stats[yi]=(this.stats[yi]||0)+1,this.total++}if(Ct.source=j,ge==null){if(V===De.indexMaxZoom||Ct.numPoints<=De.indexMaxPoints)continue}else{if(V===De.maxZoom||V===ge)continue;if(ge!=null){const yi=ge-V;if(X!==xe>>yi||oe!==Te>>yi)continue}}if(Ct.source=null,j.length===0)continue;qe>1&&console.time("clipping");const Lt=.5*De.buffer/De.extent,br=.5-Lt,er=.5+Lt,Tr=1+Lt;let ir=null,gi=null,Xr=null,hr=null,Or=qr(j,Ae,X-Lt,X+er,0,Ct.minX,Ct.maxX,De),Kr=qr(j,Ae,X+br,X+Tr,0,Ct.minX,Ct.maxX,De);j=null,Or&&(ir=qr(Or,Ae,oe-Lt,oe+er,1,Ct.minY,Ct.maxY,De),gi=qr(Or,Ae,oe+br,oe+Tr,1,Ct.minY,Ct.maxY,De),Or=null),Kr&&(Xr=qr(Kr,Ae,oe-Lt,oe+er,1,Ct.minY,Ct.maxY,De),hr=qr(Kr,Ae,oe+br,oe+Tr,1,Ct.minY,Ct.maxY,De),Kr=null),qe>1&&console.timeEnd("clipping"),de.push(ir||[],V+1,2*X,2*oe),de.push(gi||[],V+1,2*X,2*oe+1),de.push(Xr||[],V+1,2*X+1,2*oe),de.push(hr||[],V+1,2*X+1,2*oe+1)}}getTile(j,V,X){j=+j,V=+V,X=+X;const oe=this.options,{extent:ge,debug:xe}=oe;if(j<0||j>24)return null;const Te=1<<j,de=Ni(j,V=V+Te&Te-1,X);if(this.tiles[de])return pi(this.tiles[de],ge);xe>1&&console.log("drilling down to z%d-%d-%d",j,V,X);let De,qe=j,Ae=V,it=X;for(;!De&&qe>0;)qe--,Ae>>=1,it>>=1,De=this.tiles[Ni(qe,Ae,it)];return De&&De.source?(xe>1&&(console.log("found parent tile z%d-%d-%d",qe,Ae,it),console.time("drilling down")),this.splitTile(De.source,qe,Ae,it,j,V,X),xe>1&&console.timeEnd("drilling down"),this.tiles[de]?pi(this.tiles[de],ge):null):null}}function Ni(le,j,V){return 32*((1<<le)*V+j)+le}function Ht(le,j){return j?le.properties[j]:le.id}function An(le,j){if(le==null)return!0;if(le.type==="Feature")return Ht(le,j)!=null;if(le.type==="FeatureCollection"){const V=new Set;for(const X of le.features){const oe=Ht(X,j);if(oe==null||V.has(oe))return!1;V.add(oe)}return!0}return!1}function so(le,j){const V=new Map;if(le!=null)if(le.type==="Feature")V.set(Ht(le,j),le);else for(const X of le.features)V.set(Ht(X,j),X);return V}class xn extends re{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(j,V){return A._(this,void 0,void 0,(function*(){const X=j.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const oe=this._geoJSONIndex.getTile(X.z,X.x,X.y);if(!oe)return null;const ge=new class{constructor(Te){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=A.X,this.length=Te.length,this._features=Te}feature(Te){return new class{constructor(de){this._feature=de,this.extent=A.X,this.type=de.type,this.properties=de.tags,"id"in de&&!isNaN(de.id)&&(this.id=parseInt(de.id,10))}loadGeometry(){if(this._feature.type===1){const de=[];for(const De of this._feature.geometry)de.push([new A.P(De[0],De[1])]);return de}{const de=[];for(const De of this._feature.geometry){const qe=[];for(const Ae of De)qe.push(new A.P(Ae[0],Ae[1]));de.push(qe)}return de}}toGeoJSON(de,De,qe){return Xe.call(this,de,De,qe)}}(this._features[Te])}}(oe.features);let xe=wr(ge);return xe.byteOffset===0&&xe.byteLength===xe.buffer.byteLength||(xe=new Uint8Array(xe)),{vectorTile:ge,rawData:xe.buffer}}))}loadData(j){return A._(this,void 0,void 0,(function*(){var V;(V=this._pendingRequest)===null||V===void 0||V.abort();const X=!!(j&&j.request&&j.request.collectResourceTiming)&&new A.bv(j.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(j,this._pendingRequest),this._geoJSONIndex=j.cluster?new Tt((function({superclusterOptions:xe,clusterProperties:Te}){if(!Te||!xe)return xe;const de={},De={},qe={accumulated:null,zoom:0},Ae={properties:null},it=Object.keys(Te);for(const Ct of it){const[Lt,br]=Te[Ct],er=A.bC(br),Tr=A.bC(typeof Lt=="string"?[Lt,["accumulated"],["get",Ct]]:Lt);de[Ct]=er.value,De[Ct]=Tr.value}return xe.map=Ct=>{Ae.properties=Ct;const Lt={};for(const br of it)Lt[br]=de[br].evaluate(qe,Ae);return Lt},xe.reduce=(Ct,Lt)=>{Ae.properties=Lt;for(const br of it)qe.accumulated=Ct[br],Ct[br]=De[br].evaluate(qe,Ae)},xe})(j)).load((yield this._pendingData).features):(oe=yield this._pendingData,new Gi(oe,j.geojsonVtOptions)),this.loaded={};const ge={};if(X){const xe=X.finish();xe&&(ge.resourceTiming={},ge.resourceTiming[j.source]=JSON.parse(JSON.stringify(xe)))}return ge}catch(ge){if(delete this._pendingRequest,A.bB(ge))return{abandoned:!0};throw ge}var oe}))}getData(){return A._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(j){const V=this.loaded;return V&&V[j.uid]?super.reloadTile(j):this.loadTile(j)}loadAndProcessGeoJSON(j,V){return A._(this,void 0,void 0,(function*(){let X=yield this.loadGeoJSON(j,V);if(delete this._pendingRequest,typeof X!="object")throw new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`);if(je(X,!0),j.filter){const oe=A.bC(j.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(oe.result==="error")throw new Error(oe.value.map((xe=>`${xe.key}: ${xe.message}`)).join(", "));X={type:"FeatureCollection",features:X.features.filter((xe=>oe.value.evaluate({zoom:0},xe)))}}return X}))}loadGeoJSON(j,V){return A._(this,void 0,void 0,(function*(){const{promoteId:X}=j;if(j.request){const oe=yield A.h(j.request,V);return this._dataUpdateable=An(oe.data,X)?so(oe.data,X):void 0,oe.data}if(typeof j.data=="string")try{const oe=JSON.parse(j.data);return this._dataUpdateable=An(oe,X)?so(oe,X):void 0,oe}catch{throw new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`)}if(!j.dataDiff)throw new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${j.source}`);return(function(oe,ge,xe){var Te,de,De,qe;if(ge.removeAll&&oe.clear(),ge.remove)for(const Ae of ge.remove)oe.delete(Ae);if(ge.add)for(const Ae of ge.add){const it=Ht(Ae,xe);it!=null&&oe.set(it,Ae)}if(ge.update)for(const Ae of ge.update){let it=oe.get(Ae.id);if(it==null)continue;const Ct=!Ae.removeAllProperties&&(((Te=Ae.removeProperties)===null||Te===void 0?void 0:Te.length)>0||((de=Ae.addOrUpdateProperties)===null||de===void 0?void 0:de.length)>0);if((Ae.newGeometry||Ae.removeAllProperties||Ct)&&(it=Object.assign({},it),oe.set(Ae.id,it),Ct&&(it.properties=Object.assign({},it.properties))),Ae.newGeometry&&(it.geometry=Ae.newGeometry),Ae.removeAllProperties)it.properties={};else if(((De=Ae.removeProperties)===null||De===void 0?void 0:De.length)>0)for(const Lt of Ae.removeProperties)Object.prototype.hasOwnProperty.call(it.properties,Lt)&&delete it.properties[Lt];if(((qe=Ae.addOrUpdateProperties)===null||qe===void 0?void 0:qe.length)>0)for(const{key:Lt,value:br}of Ae.addOrUpdateProperties)it.properties[Lt]=br}})(this._dataUpdateable,j.dataDiff,X),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(j){return A._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(j){return this._geoJSONIndex.getClusterExpansionZoom(j.clusterId)}getClusterChildren(j){return this._geoJSONIndex.getChildren(j.clusterId)}getClusterLeaves(j){return this._geoJSONIndex.getLeaves(j.clusterId,j.limit,j.offset)}}class ln{constructor(j){this.self=j,this.actor=new A.F(j),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(V,X)=>{if(this.externalWorkerSourceTypes[V])throw new Error(`Worker source with name "${V}" already registered.`);this.externalWorkerSourceTypes[V]=X},this.self.addProtocol=A.bi,this.self.removeProtocol=A.bj,this.self.registerRTLTextPlugin=V=>{if(A.bD.isParsed())throw new Error("RTL text plugin already registered.");A.bD.setMethods(V)},this.actor.registerMessageHandler("LDT",((V,X)=>this._getDEMWorkerSource(V,X.source).loadTile(X))),this.actor.registerMessageHandler("RDT",((V,X)=>A._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(V,X.source).removeTile(X)})))),this.actor.registerMessageHandler("GCEZ",((V,X)=>A._(this,void 0,void 0,(function*(){return this._getWorkerSource(V,X.type,X.source).getClusterExpansionZoom(X)})))),this.actor.registerMessageHandler("GCC",((V,X)=>A._(this,void 0,void 0,(function*(){return this._getWorkerSource(V,X.type,X.source).getClusterChildren(X)})))),this.actor.registerMessageHandler("GCL",((V,X)=>A._(this,void 0,void 0,(function*(){return this._getWorkerSource(V,X.type,X.source).getClusterLeaves(X)})))),this.actor.registerMessageHandler("LD",((V,X)=>this._getWorkerSource(V,X.type,X.source).loadData(X))),this.actor.registerMessageHandler("GD",((V,X)=>this._getWorkerSource(V,X.type,X.source).getData())),this.actor.registerMessageHandler("LT",((V,X)=>this._getWorkerSource(V,X.type,X.source).loadTile(X))),this.actor.registerMessageHandler("RT",((V,X)=>this._getWorkerSource(V,X.type,X.source).reloadTile(X))),this.actor.registerMessageHandler("AT",((V,X)=>this._getWorkerSource(V,X.type,X.source).abortTile(X))),this.actor.registerMessageHandler("RMT",((V,X)=>this._getWorkerSource(V,X.type,X.source).removeTile(X))),this.actor.registerMessageHandler("RS",((V,X)=>A._(this,void 0,void 0,(function*(){if(!this.workerSources[V]||!this.workerSources[V][X.type]||!this.workerSources[V][X.type][X.source])return;const oe=this.workerSources[V][X.type][X.source];delete this.workerSources[V][X.type][X.source],oe.removeSource!==void 0&&oe.removeSource(X)})))),this.actor.registerMessageHandler("RM",(V=>A._(this,void 0,void 0,(function*(){delete this.layerIndexes[V],delete this.availableImages[V],delete this.workerSources[V],delete this.demWorkerSources[V]})))),this.actor.registerMessageHandler("SR",((V,X)=>A._(this,void 0,void 0,(function*(){this.referrer=X})))),this.actor.registerMessageHandler("SRPS",((V,X)=>this._syncRTLPluginState(V,X))),this.actor.registerMessageHandler("IS",((V,X)=>A._(this,void 0,void 0,(function*(){this.self.importScripts(X)})))),this.actor.registerMessageHandler("SI",((V,X)=>this._setImages(V,X))),this.actor.registerMessageHandler("UL",((V,X)=>A._(this,void 0,void 0,(function*(){this._getLayerIndex(V).update(X.layers,X.removedIds)})))),this.actor.registerMessageHandler("SL",((V,X)=>A._(this,void 0,void 0,(function*(){this._getLayerIndex(V).replace(X)}))))}_setImages(j,V){return A._(this,void 0,void 0,(function*(){this.availableImages[j]=V;for(const X in this.workerSources[j]){const oe=this.workerSources[j][X];for(const ge in oe)oe[ge].availableImages=V}}))}_syncRTLPluginState(j,V){return A._(this,void 0,void 0,(function*(){if(A.bD.isParsed())return A.bD.getState();if(V.pluginStatus!=="loading")return A.bD.setState(V),V;const X=V.pluginURL;if(this.self.importScripts(X),A.bD.isParsed()){const oe={pluginStatus:"loaded",pluginURL:X};return A.bD.setState(oe),oe}throw A.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${X}`)}))}_getAvailableImages(j){let V=this.availableImages[j];return V||(V=[]),V}_getLayerIndex(j){let V=this.layerIndexes[j];return V||(V=this.layerIndexes[j]=new d),V}_getWorkerSource(j,V,X){if(this.workerSources[j]||(this.workerSources[j]={}),this.workerSources[j][V]||(this.workerSources[j][V]={}),!this.workerSources[j][V][X]){const oe={sendAsync:(ge,xe)=>(ge.targetMapId=j,this.actor.sendAsync(ge,xe))};switch(V){case"vector":this.workerSources[j][V][X]=new re(oe,this._getLayerIndex(j),this._getAvailableImages(j));break;case"geojson":this.workerSources[j][V][X]=new xn(oe,this._getLayerIndex(j),this._getAvailableImages(j));break;default:this.workerSources[j][V][X]=new this.externalWorkerSourceTypes[V](oe,this._getLayerIndex(j),this._getAvailableImages(j))}}return this.workerSources[j][V][X]}_getDEMWorkerSource(j,V){return this.demWorkerSources[j]||(this.demWorkerSources[j]={}),this.demWorkerSources[j][V]||(this.demWorkerSources[j][V]=new ne),this.demWorkerSources[j][V]}}return A.i(self)&&(self.worker=new ln(self)),ln})),W("index",["exports","./shared"],(function(A,d){var Se="4.7.1";let Pe,Le;const re={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:f=>new Promise(((e,o)=>{const l=requestAnimationFrame(e);f.signal.addEventListener("abort",(()=>{cancelAnimationFrame(l),o(d.c())}))})),getImageData(f,e=0){return this.getImageCanvasContext(f).getImageData(-e,-e,f.width+2*e,f.height+2*e)},getImageCanvasContext(f){const e=window.document.createElement("canvas"),o=e.getContext("2d",{willReadFrequently:!0});if(!o)throw new Error("failed to create canvas 2d context");return e.width=f.width,e.height=f.height,o.drawImage(f,0,0,f.width,f.height),o},resolveURL:f=>(Pe||(Pe=document.createElement("a")),Pe.href=f,Pe.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Le==null&&(Le=matchMedia("(prefers-reduced-motion: reduce)")),Le.matches)}};class ne{static testProp(e){if(!ne.docStyle)return e[0];for(let o=0;o<e.length;o++)if(e[o]in ne.docStyle)return e[o];return e[0]}static create(e,o,l){const u=window.document.createElement(e);return o!==void 0&&(u.className=o),l&&l.appendChild(u),u}static createNS(e,o){return window.document.createElementNS(e,o)}static disableDrag(){ne.docStyle&&ne.selectProp&&(ne.userSelect=ne.docStyle[ne.selectProp],ne.docStyle[ne.selectProp]="none")}static enableDrag(){ne.docStyle&&ne.selectProp&&(ne.docStyle[ne.selectProp]=ne.userSelect)}static setTransform(e,o){e.style[ne.transformProp]=o}static addEventListener(e,o,l,u={}){e.addEventListener(o,l,"passive"in u?u:u.capture)}static removeEventListener(e,o,l,u={}){e.removeEventListener(o,l,"passive"in u?u:u.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",ne.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",ne.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",ne.suppressClickInternal,!0)}),0)}static getScale(e){const o=e.getBoundingClientRect();return{x:o.width/e.offsetWidth||1,y:o.height/e.offsetHeight||1,boundingClientRect:o}}static getPoint(e,o,l){const u=o.boundingClientRect;return new d.P((l.clientX-u.left)/o.x-e.clientLeft,(l.clientY-u.top)/o.y-e.clientTop)}static mousePos(e,o){const l=ne.getScale(e);return ne.getPoint(e,l,o)}static touchPos(e,o){const l=[],u=ne.getScale(e);for(let p=0;p<o.length;p++)l.push(ne.getPoint(e,u,o[p]));return l}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}}ne.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,ne.selectProp=ne.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),ne.transformProp=ne.testProp(["transform","WebkitTransform"]);const Ge={supported:!1,testSupport:function(f){!Xe&&je&&(Pt?mt(f):et=f)}};let et,je,Xe=!1,Pt=!1;function mt(f){const e=f.createTexture();f.bindTexture(f.TEXTURE_2D,e);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,je),f.isContextLost())return;Ge.supported=!0}catch{}f.deleteTexture(e),Xe=!0}var St;typeof document<"u"&&(je=document.createElement("img"),je.onload=()=>{et&&mt(et),et=null,Pt=!0},je.onerror=()=>{Xe=!0,et=null},je.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(f){let e,o,l,u;f.resetRequestQueue=()=>{e=[],o=0,l=0,u={}},f.addThrottleControl=S=>{const C=l++;return u[C]=S,C},f.removeThrottleControl=S=>{delete u[S],v()},f.getImage=(S,C,F=!0)=>new Promise(((B,$)=>{Ge.supported&&(S.headers||(S.headers={}),S.headers.accept="image/webp,*/*"),d.e(S,{type:"image"}),e.push({abortController:C,requestParameters:S,supportImageRefresh:F,state:"queued",onError:K=>{$(K)},onSuccess:K=>{B(K)}}),v()}));const p=S=>d._(this,void 0,void 0,(function*(){S.state="running";const{requestParameters:C,supportImageRefresh:F,onError:B,onSuccess:$,abortController:K}=S,Q=F===!1&&!d.i(self)&&!d.g(C.url)&&(!C.headers||Object.keys(C.headers).reduce(((ue,me)=>ue&&me==="accept"),!0));o++;const te=Q?w(C,K):d.m(C,K);try{const ue=yield te;delete S.abortController,S.state="completed",ue.data instanceof HTMLImageElement||d.b(ue.data)?$(ue):ue.data&&$({data:yield(ae=ue.data,typeof createImageBitmap=="function"?d.d(ae):d.f(ae)),cacheControl:ue.cacheControl,expires:ue.expires})}catch(ue){delete S.abortController,B(ue)}finally{o--,v()}var ae})),v=()=>{const S=(()=>{for(const C of Object.keys(u))if(u[C]())return!0;return!1})()?d.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:d.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let C=o;C<S&&e.length>0;C++){const F=e.shift();F.abortController.signal.aborted?C--:p(F)}},w=(S,C)=>new Promise(((F,B)=>{const $=new Image,K=S.url,Q=S.credentials;Q&&Q==="include"?$.crossOrigin="use-credentials":(Q&&Q==="same-origin"||!d.s(K))&&($.crossOrigin="anonymous"),C.signal.addEventListener("abort",(()=>{$.src="",B(d.c())})),$.fetchPriority="high",$.onload=()=>{$.onerror=$.onload=null,F({data:$})},$.onerror=()=>{$.onerror=$.onload=null,C.signal.aborted||B(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},$.src=K}))})(St||(St={})),St.resetRequestQueue();class ar{constructor(e){this._transformRequestFn=e}transformRequest(e,o){return this._transformRequestFn&&this._transformRequestFn(e,o)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function ur(f){var e=new d.A(3);return e[0]=f[0],e[1]=f[1],e[2]=f[2],e}var gr,Vt=function(f,e,o){return f[0]=e[0]-o[0],f[1]=e[1]-o[1],f[2]=e[2]-o[2],f};gr=new d.A(3),d.A!=Float32Array&&(gr[0]=0,gr[1]=0,gr[2]=0);var zr=function(f){var e=f[0],o=f[1];return e*e+o*o};function xr(f){const e=[];if(typeof f=="string")e.push({id:"default",url:f});else if(f&&f.length>0){const o=[];for(const{id:l,url:u}of f){const p=`${l}${u}`;o.indexOf(p)===-1&&(o.push(p),e.push({id:l,url:u}))}}return e}function Br(f,e,o){const l=f.split("?");return l[0]+=`${e}${o}`,l.join("?")}(function(){var f=new d.A(2);d.A!=Float32Array&&(f[0]=0,f[1]=0)})();class Et{constructor(e,o,l,u){this.context=e,this.format=l,this.texture=e.gl.createTexture(),this.update(o,u)}update(e,o,l){const{width:u,height:p}=e,v=!(this.size&&this.size[0]===u&&this.size[1]===p||l),{context:w}=this,{gl:S}=w;if(this.useMipmap=!!(o&&o.useMipmap),S.bindTexture(S.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===S.RGBA&&(!o||o.premultiply!==!1)),v)this.size=[u,p],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||d.b(e)?S.texImage2D(S.TEXTURE_2D,0,this.format,this.format,S.UNSIGNED_BYTE,e):S.texImage2D(S.TEXTURE_2D,0,this.format,u,p,0,this.format,S.UNSIGNED_BYTE,e.data);else{const{x:C,y:F}=l||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||d.b(e)?S.texSubImage2D(S.TEXTURE_2D,0,C,F,S.RGBA,S.UNSIGNED_BYTE,e):S.texSubImage2D(S.TEXTURE_2D,0,C,F,u,p,S.RGBA,S.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&S.generateMipmap(S.TEXTURE_2D)}bind(e,o,l){const{context:u}=this,{gl:p}=u;p.bindTexture(p.TEXTURE_2D,this.texture),l!==p.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(l=p.LINEAR),e!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,e),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,l||e),this.filter=e),o!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,o),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function Hr(f){const{userImage:e}=f;return!!(e&&e.render&&e.render())&&(f.data.replace(new Uint8Array(e.data.buffer)),!0)}class kr extends d.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new d.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:o,promiseResolve:l}of this.requestors)l(this._getImagesForIds(o));this.requestors=[]}}getImage(e){const o=this.images[e];if(o&&!o.data&&o.spriteData){const l=o.spriteData;o.data=new d.R({width:l.width,height:l.height},l.context.getImageData(l.x,l.y,l.width,l.height).data),o.spriteData=null}return o}addImage(e,o){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,o)&&(this.images[e]=o)}_validate(e,o){let l=!0;const u=o.data||o.spriteData;return this._validateStretch(o.stretchX,u&&u.width)||(this.fire(new d.j(new Error(`Image "${e}" has invalid "stretchX" value`))),l=!1),this._validateStretch(o.stretchY,u&&u.height)||(this.fire(new d.j(new Error(`Image "${e}" has invalid "stretchY" value`))),l=!1),this._validateContent(o.content,o)||(this.fire(new d.j(new Error(`Image "${e}" has invalid "content" value`))),l=!1),l}_validateStretch(e,o){if(!e)return!0;let l=0;for(const u of e){if(u[0]<l||u[1]<u[0]||o<u[1])return!1;l=u[1]}return!0}_validateContent(e,o){if(!e)return!0;if(e.length!==4)return!1;const l=o.spriteData,u=l&&l.width||o.data.width,p=l&&l.height||o.data.height;return!(e[0]<0||u<e[0]||e[1]<0||p<e[1]||e[2]<0||u<e[2]||e[3]<0||p<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,o,l=!0){const u=this.getImage(e);if(l&&(u.data.width!==o.data.width||u.data.height!==o.data.height))throw new Error(`size mismatch between old image (${u.data.width}x${u.data.height}) and new image (${o.data.width}x${o.data.height}).`);o.version=u.version+1,this.images[e]=o,this.updatedImages[e]=!0}removeImage(e){const o=this.images[e];delete this.images[e],delete this.patterns[e],o.userImage&&o.userImage.onRemove&&o.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise(((o,l)=>{let u=!0;if(!this.isLoaded())for(const p of e)this.images[p]||(u=!1);this.isLoaded()||u?o(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:o})}))}_getImagesForIds(e){const o={};for(const l of e){let u=this.getImage(l);u||(this.fire(new d.k("styleimagemissing",{id:l})),u=this.getImage(l)),u?o[l]={data:u.data.clone(),pixelRatio:u.pixelRatio,sdf:u.sdf,version:u.version,stretchX:u.stretchX,stretchY:u.stretchY,content:u.content,textFitWidth:u.textFitWidth,textFitHeight:u.textFitHeight,hasRenderCallback:!!(u.userImage&&u.userImage.render)}:d.w(`Image "${l}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return o}getPixelSize(){const{width:e,height:o}=this.atlasImage;return{width:e,height:o}}getPattern(e){const o=this.patterns[e],l=this.getImage(e);if(!l)return null;if(o&&o.position.version===l.version)return o.position;if(o)o.position.version=l.version;else{const u={w:l.data.width+2,h:l.data.height+2,x:0,y:0},p=new d.I(u,l);this.patterns[e]={bin:u,position:p}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const o=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Et(e,this.atlasImage,o.RGBA),this.atlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const p in this.patterns)e.push(this.patterns[p].bin);const{w:o,h:l}=d.p(e),u=this.atlasImage;u.resize({width:o||1,height:l||1});for(const p in this.patterns){const{bin:v}=this.patterns[p],w=v.x+1,S=v.y+1,C=this.getImage(p).data,F=C.width,B=C.height;d.R.copy(C,u,{x:0,y:0},{x:w,y:S},{width:F,height:B}),d.R.copy(C,u,{x:0,y:B-1},{x:w,y:S-1},{width:F,height:1}),d.R.copy(C,u,{x:0,y:0},{x:w,y:S+B},{width:F,height:1}),d.R.copy(C,u,{x:F-1,y:0},{x:w-1,y:S},{width:1,height:B}),d.R.copy(C,u,{x:0,y:0},{x:w+F,y:S},{width:1,height:B})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const o of e){if(this.callbackDispatchedThisFrame[o])continue;this.callbackDispatchedThisFrame[o]=!0;const l=this.getImage(o);l||d.w(`Image with ID: "${o}" was not found`),Hr(l)&&this.updateImage(o,l)}}}const _r=1e20;function ti(f,e,o,l,u,p,v,w,S){for(let C=e;C<e+l;C++)Wr(f,o*p+C,p,u,v,w,S);for(let C=o;C<o+u;C++)Wr(f,C*p+e,1,l,v,w,S)}function Wr(f,e,o,l,u,p,v){p[0]=0,v[0]=-_r,v[1]=_r,u[0]=f[e];for(let w=1,S=0,C=0;w<l;w++){u[w]=f[e+w*o];const F=w*w;do{const B=p[S];C=(u[w]-u[B]+F-B*B)/(w-B)/2}while(C<=v[S]&&--S>-1);S++,p[S]=w,v[S]=C,v[S+1]=_r}for(let w=0,S=0;w<l;w++){for(;v[S+1]<w;)S++;const C=p[S],F=w-C;f[e+w*o]=u[C]+F*F}}class wr{constructor(e,o){this.requestManager=e,this.localIdeographFontFamily=o,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return d._(this,void 0,void 0,(function*(){const o=[];for(const p in e)for(const v of e[p])o.push(this._getAndCacheGlyphsPromise(p,v));const l=yield Promise.all(o),u={};for(const{stack:p,id:v,glyph:w}of l)u[p]||(u[p]={}),u[p][v]=w&&{id:w.id,bitmap:w.bitmap.clone(),metrics:w.metrics};return u}))}_getAndCacheGlyphsPromise(e,o){return d._(this,void 0,void 0,(function*(){let l=this.entries[e];l||(l=this.entries[e]={glyphs:{},requests:{},ranges:{}});let u=l.glyphs[o];if(u!==void 0)return{stack:e,id:o,glyph:u};if(u=this._tinySDF(l,e,o),u)return l.glyphs[o]=u,{stack:e,id:o,glyph:u};const p=Math.floor(o/256);if(256*p>65535)throw new Error("glyphs > 65535 not supported");if(l.ranges[p])return{stack:e,id:o,glyph:u};if(!this.url)throw new Error("glyphsUrl is not set");if(!l.requests[p]){const w=wr.loadGlyphRange(e,p,this.url,this.requestManager);l.requests[p]=w}const v=yield l.requests[p];for(const w in v)this._doesCharSupportLocalGlyph(+w)||(l.glyphs[+w]=v[+w]);return l.ranges[p]=!0,{stack:e,id:o,glyph:v[o]||null}}))}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))}_tinySDF(e,o,l){const u=this.localIdeographFontFamily;if(!u||!this._doesCharSupportLocalGlyph(l))return;let p=e.tinySDF;if(!p){let w="400";/bold/i.test(o)?w="900":/medium/i.test(o)?w="500":/light/i.test(o)&&(w="200"),p=e.tinySDF=new wr.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:u,fontWeight:w})}const v=p.draw(String.fromCharCode(l));return{id:l,bitmap:new d.o({width:v.width||60,height:v.height||60},v.data),metrics:{width:v.glyphWidth/2||24,height:v.glyphHeight/2||24,left:v.glyphLeft/2+.5||0,top:v.glyphTop/2-27.5||-8,advance:v.glyphAdvance/2||24,isDoubleResolution:!0}}}}wr.loadGlyphRange=function(f,e,o,l){return d._(this,void 0,void 0,(function*(){const u=256*e,p=u+255,v=l.transformRequest(o.replace("{fontstack}",f).replace("{range}",`${u}-${p}`),"Glyphs"),w=yield d.l(v,new AbortController);if(!w||!w.data)throw new Error(`Could not load glyph range. range: ${e}, ${u}-${p}`);const S={};for(const C of d.n(w.data))S[C.id]=C;return S}))},wr.TinySDF=class{constructor({fontSize:f=24,buffer:e=3,radius:o=8,cutoff:l=.25,fontFamily:u="sans-serif",fontWeight:p="normal",fontStyle:v="normal"}={}){this.buffer=e,this.cutoff=l,this.radius=o;const w=this.size=f+4*e,S=this._createCanvas(w),C=this.ctx=S.getContext("2d",{willReadFrequently:!0});C.font=`${v} ${p} ${f}px ${u}`,C.textBaseline="alphabetic",C.textAlign="left",C.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(f){const e=document.createElement("canvas");return e.width=e.height=f,e}draw(f){const{width:e,actualBoundingBoxAscent:o,actualBoundingBoxDescent:l,actualBoundingBoxLeft:u,actualBoundingBoxRight:p}=this.ctx.measureText(f),v=Math.ceil(o),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(p-u))),S=Math.min(this.size-this.buffer,v+Math.ceil(l)),C=w+2*this.buffer,F=S+2*this.buffer,B=Math.max(C*F,0),$=new Uint8ClampedArray(B),K={data:$,width:C,height:F,glyphWidth:w,glyphHeight:S,glyphTop:v,glyphLeft:0,glyphAdvance:e};if(w===0||S===0)return K;const{ctx:Q,buffer:te,gridInner:ae,gridOuter:ue}=this;Q.clearRect(te,te,w,S),Q.fillText(f,te,te+v);const me=Q.getImageData(te,te,w,S);ue.fill(_r,0,B),ae.fill(0,0,B);for(let ie=0;ie<S;ie++)for(let ve=0;ve<w;ve++){const be=me.data[4*(ie*w+ve)+3]/255;if(be===0)continue;const Ie=(ie+te)*C+ve+te;if(be===1)ue[Ie]=0,ae[Ie]=_r;else{const Ue=.5-be;ue[Ie]=Ue>0?Ue*Ue:0,ae[Ie]=Ue<0?Ue*Ue:0}}ti(ue,0,0,C,F,C,this.f,this.v,this.z),ti(ae,te,te,w,S,C,this.f,this.v,this.z);for(let ie=0;ie<B;ie++){const ve=Math.sqrt(ue[ie])-Math.sqrt(ae[ie]);$[ie]=Math.round(255-255*(ve/this.radius+this.cutoff))}return K}};class ft{constructor(){this.specification=d.v.light.position}possiblyEvaluate(e,o){return d.x(e.expression.evaluate(o))}interpolate(e,o,l){return{x:d.y.number(e.x,o.x,l),y:d.y.number(e.y,o.y,l),z:d.y.number(e.z,o.z,l)}}}let Mt;class xt extends d.E{constructor(e){super(),Mt=Mt||new d.q({anchor:new d.D(d.v.light.anchor),position:new ft,color:new d.D(d.v.light.color),intensity:new d.D(d.v.light.intensity)}),this._transitionable=new d.T(Mt),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,o={}){if(!this._validate(d.r,e,o))for(const l in e){const u=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),u):this._transitionable.setValue(l,u)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,o,l){return(!l||l.validate!==!1)&&d.t(this,e.call(d.u,{value:o,style:{glyphs:!0,sprite:!0},styleSpec:d.v}))}}const ke=new d.q({"sky-color":new d.D(d.v.sky["sky-color"]),"horizon-color":new d.D(d.v.sky["horizon-color"]),"fog-color":new d.D(d.v.sky["fog-color"]),"fog-ground-blend":new d.D(d.v.sky["fog-ground-blend"]),"horizon-fog-blend":new d.D(d.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new d.D(d.v.sky["sky-horizon-blend"]),"atmosphere-blend":new d.D(d.v.sky["atmosphere-blend"])});class He extends d.E{constructor(e){super(),this._transitionable=new d.T(ke),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new d.z(0))}setSky(e,o={}){if(!this._validate(d.B,e,o)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const l in e){const u=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),u):this._transitionable.setValue(l,u)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,o,l={}){return l?.validate!==!1&&d.t(this,e.call(d.u,d.e({value:o,style:{glyphs:!0,sprite:!0},styleSpec:d.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class Gt{constructor(e,o){this.width=e,this.height=o,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,o){const l=e.join(",")+String(o);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(e,o)),this.dashEntry[l]}getDashRanges(e,o,l){const u=[];let p=e.length%2==1?-e[e.length-1]*l:0,v=e[0]*l,w=!0;u.push({left:p,right:v,isDash:w,zeroLength:e[0]===0});let S=e[0];for(let C=1;C<e.length;C++){w=!w;const F=e[C];p=S*l,S+=F,v=S*l,u.push({left:p,right:v,isDash:w,zeroLength:F===0})}return u}addRoundDash(e,o,l){const u=o/2;for(let p=-l;p<=l;p++){const v=this.width*(this.nextRow+l+p);let w=0,S=e[w];for(let C=0;C<this.width;C++){C/S.right>1&&(S=e[++w]);const F=Math.abs(C-S.left),B=Math.abs(C-S.right),$=Math.min(F,B);let K;const Q=p/l*(u+1);if(S.isDash){const te=u-Math.abs(Q);K=Math.sqrt($*$+te*te)}else K=u-Math.sqrt($*$+Q*Q);this.data[v+C]=Math.max(0,Math.min(255,K+128))}}}addRegularDash(e){for(let w=e.length-1;w>=0;--w){const S=e[w],C=e[w+1];S.zeroLength?e.splice(w,1):C&&C.isDash===S.isDash&&(C.left=S.left,e.splice(w,1))}const o=e[0],l=e[e.length-1];o.isDash===l.isDash&&(o.left=l.left-this.width,l.right=o.right+this.width);const u=this.width*this.nextRow;let p=0,v=e[p];for(let w=0;w<this.width;w++){w/v.right>1&&(v=e[++p]);const S=Math.abs(w-v.left),C=Math.abs(w-v.right),F=Math.min(S,C);this.data[u+w]=Math.max(0,Math.min(255,(v.isDash?F:-F)+128))}}addDash(e,o){const l=o?7:0,u=2*l+1;if(this.nextRow+u>this.height)return d.w("LineAtlas out of space"),null;let p=0;for(let w=0;w<e.length;w++)p+=e[w];if(p!==0){const w=this.width/p,S=this.getDashRanges(e,this.width,w);o?this.addRoundDash(S,w,l):this.addRegularDash(S)}const v={y:(this.nextRow+l+.5)/this.height,height:2*l/this.height,width:p};return this.nextRow+=u,this.dirty=!0,v}bind(e){const o=e.gl;this.texture?(o.bindTexture(o.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,o.texSubImage2D(o.TEXTURE_2D,0,0,0,this.width,this.height,o.ALPHA,o.UNSIGNED_BYTE,this.data))):(this.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.ALPHA,this.width,this.height,0,o.ALPHA,o.UNSIGNED_BYTE,this.data))}}const Tt="maplibre_preloaded_worker_pool";class $t{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<$t.workerCount;)this.workers.push(new Worker(d.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach((o=>{o.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Tt]}numActive(){return Object.keys(this.active).length}}const rr=Math.floor(re.hardwareConcurrency/2);let tr,cr;function Ar(){return tr||(tr=new $t),tr}$t.workerCount=d.C(globalThis)?Math.max(Math.min(rr,3),1):1;class bi{constructor(e,o){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=o;const l=this.workerPool.acquire(o);for(let u=0;u<l.length;u++){const p=new d.F(l[u],o);p.name=`Worker ${u}`,this.actors.push(p)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,o){const l=[];for(const u of this.actors)l.push(u.sendAsync({type:e,data:o}));return Promise.all(l)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach((o=>{o.remove()})),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,o){for(const l of this.actors)l.registerMessageHandler(e,o)}}function Pn(){return cr||(cr=new bi(Ar(),d.G),cr.registerMessageHandler("GR",((f,e,o)=>d.m(e,o)))),cr}function di(f,e){const o=d.H();return d.J(o,o,[1,1,0]),d.K(o,o,[.5*f.width,.5*f.height,1]),d.L(o,o,f.calculatePosMatrix(e.toUnwrapped()))}function en(f,e,o,l,u,p){const v=(function(B,$,K){if(B)for(const Q of B){const te=$[Q];if(te&&te.source===K&&te.type==="fill-extrusion")return!0}else for(const Q in $){const te=$[Q];if(te.source===K&&te.type==="fill-extrusion")return!0}return!1})(u&&u.layers,e,f.id),w=p.maxPitchScaleFactor(),S=f.tilesIn(l,w,v);S.sort(wo);const C=[];for(const B of S)C.push({wrappedTileID:B.tileID.wrapped().key,queryResults:B.tile.queryRenderedFeatures(e,o,f._state,B.queryGeometry,B.cameraQueryGeometry,B.scale,u,p,w,di(f.transform,B.tileID))});const F=(function(B){const $={},K={};for(const Q of B){const te=Q.queryResults,ae=Q.wrappedTileID,ue=K[ae]=K[ae]||{};for(const me in te){const ie=te[me],ve=ue[me]=ue[me]||{},be=$[me]=$[me]||[];for(const Ie of ie)ve[Ie.featureIndex]||(ve[Ie.featureIndex]=!0,be.push(Ie))}}return $})(C);for(const B in F)F[B].forEach(($=>{const K=$.feature,Q=f.getFeatureState(K.layer["source-layer"],K.id);K.source=K.layer.source,K.layer["source-layer"]&&(K.sourceLayer=K.layer["source-layer"]),K.state=Q}));return F}function wo(f,e){const o=f.tileID,l=e.tileID;return o.overscaledZ-l.overscaledZ||o.canonical.y-l.canonical.y||o.wrap-l.wrap||o.canonical.x-l.canonical.x}function Ia(f,e,o){return d._(this,void 0,void 0,(function*(){let l=f;if(f.url?l=(yield d.h(e.transformRequest(f.url,"Source"),o)).data:yield re.frameAsync(o),!l)return null;const u=d.M(d.e(l,f),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in l&&l.vector_layers&&(u.vectorLayerIds=l.vector_layers.map((p=>p.id))),u}))}class Fe{constructor(e,o){e&&(o?this.setSouthWest(e).setNorthEast(o):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof d.N?new d.N(e.lng,e.lat):d.N.convert(e),this}setSouthWest(e){return this._sw=e instanceof d.N?new d.N(e.lng,e.lat):d.N.convert(e),this}extend(e){const o=this._sw,l=this._ne;let u,p;if(e instanceof d.N)u=e,p=e;else{if(!(e instanceof Fe))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Fe.convert(e)):this.extend(d.N.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(d.N.convert(e)):this;if(u=e._sw,p=e._ne,!u||!p)return this}return o||l?(o.lng=Math.min(u.lng,o.lng),o.lat=Math.min(u.lat,o.lat),l.lng=Math.max(p.lng,l.lng),l.lat=Math.max(p.lat,l.lat)):(this._sw=new d.N(u.lng,u.lat),this._ne=new d.N(p.lng,p.lat)),this}getCenter(){return new d.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new d.N(this.getWest(),this.getNorth())}getSouthEast(){return new d.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:o,lat:l}=d.N.convert(e);let u=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&u}static convert(e){return e instanceof Fe?e:e&&new Fe(e)}static fromLngLat(e,o=0){const l=360*o/40075017,u=l/Math.cos(Math.PI/180*e.lat);return new Fe(new d.N(e.lng-u,e.lat-l),new d.N(e.lng+u,e.lat+l))}adjustAntiMeridian(){const e=new d.N(this._sw.lng,this._sw.lat),o=new d.N(this._ne.lng,this._ne.lat);return new Fe(e,e.lng>o.lng?new d.N(o.lng+360,o.lat):o)}}class Si{constructor(e,o,l){this.bounds=Fe.convert(this.validateBounds(e)),this.minzoom=o||0,this.maxzoom=l||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const o=Math.pow(2,e.z),l=Math.floor(d.O(this.bounds.getWest())*o),u=Math.floor(d.Q(this.bounds.getNorth())*o),p=Math.ceil(d.O(this.bounds.getEast())*o),v=Math.ceil(d.Q(this.bounds.getSouth())*o);return e.x>=l&&e.x<p&&e.y>=u&&e.y<v}}class ua extends d.E{constructor(e,o,l,u){if(super(),this.id=e,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,d.e(this,d.M(o,["url","scheme","tileSize","promoteId"])),this._options=d.e({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(u)}load(){return d._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new d.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield Ia(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(d.e(this,e),e.bounds&&(this.tileBounds=new Si(e.bounds,this.minzoom,this.maxzoom)),this.fire(new d.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new d.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new d.j(e))}}))}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return d.e({},this._options)}loadTile(e){return d._(this,void 0,void 0,(function*(){const o=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l={request:this.map._requestManager.transformRequest(o,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};l.request.collectResourceTiming=this._collectResourceTiming;let u="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise(((p,v)=>{e.reloadPromise={resolve:p,reject:v}}))}else e.actor=this.dispatcher.getActor(),u="LT";e.abortController=new AbortController;try{const p=yield e.actor.sendAsync({type:u,data:l},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,p)}catch(p){if(delete e.abortController,e.aborted)return;if(p&&p.status!==404)throw p;this._afterTileLoadWorkerResponse(e,null)}}))}_afterTileLoadWorkerResponse(e,o){if(o&&o.resourceTiming&&(e.resourceTiming=o.resourceTiming),o&&this.map._refreshExpiredTiles&&e.setExpiryData(o),e.loadVectorData(o,this.map.painter),e.reloadPromise){const l=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(l.resolve).catch(l.reject)}}abortTile(e){return d._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}unloadTile(e){return d._(this,void 0,void 0,(function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class Er extends d.E{constructor(e,o,l,u){super(),this.id=e,this.dispatcher=l,this.setEventedParent(u),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=d.e({type:"raster"},o),d.e(this,d.M(o,["url","scheme","tileSize"]))}load(){return d._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new d.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield Ia(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,e&&(d.e(this,e),e.bounds&&(this.tileBounds=new Si(e.bounds,this.minzoom,this.maxzoom)),this.fire(new d.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new d.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new d.j(e))}}))}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load()}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}serialize(){return d.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return d._(this,void 0,void 0,(function*(){const o=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const l=yield St.getImage(this.map._requestManager.transformRequest(o,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(l&&l.data){this.map._refreshExpiredTiles&&l.cacheControl&&l.expires&&e.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const u=this.map.painter.context,p=u.gl,v=l.data;e.texture=this.map.painter.getTileTexture(v.width),e.texture?e.texture.update(v,{useMipmap:!0}):(e.texture=new Et(u,v,p.RGBA,{useMipmap:!0}),e.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE,p.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(l){if(delete e.abortController,e.aborted)e.state="unloaded";else if(l)throw e.state="errored",l}}))}abortTile(e){return d._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)}))}unloadTile(e){return d._(this,void 0,void 0,(function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)}))}hasTransition(){return!1}}class qr extends Er{constructor(e,o,l,u){super(e,o,l,u),this.type="raster-dem",this.maxzoom=22,this._options=d.e({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox",this.redFactor=o.redFactor,this.greenFactor=o.greenFactor,this.blueFactor=o.blueFactor,this.baseShift=o.baseShift}loadTile(e){return d._(this,void 0,void 0,(function*(){const o=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l=this.map._requestManager.transformRequest(o,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const u=yield St.getImage(l,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(u&&u.data){const p=u.data;this.map._refreshExpiredTiles&&u.cacheControl&&u.expires&&e.setExpiryData({cacheControl:u.cacheControl,expires:u.expires});const v=d.b(p)&&d.U()?p:yield this.readImageNow(p),w={type:this.type,uid:e.uid,source:this.id,rawImageData:v,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const S=yield e.actor.sendAsync({type:"LDT",data:w});e.dem=S,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(u){if(delete e.abortController,e.aborted)e.state="unloaded";else if(u)throw e.state="errored",u}}))}readImageNow(e){return d._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&d.V()){const o=e.width+2,l=e.height+2;try{return new d.R({width:o,height:l},yield d.W(e,-1,-1,o,l))}catch{}}return re.getImageData(e,1)}))}_getNeighboringTiles(e){const o=e.canonical,l=Math.pow(2,o.z),u=(o.x-1+l)%l,p=o.x===0?e.wrap-1:e.wrap,v=(o.x+1+l)%l,w=o.x+1===l?e.wrap+1:e.wrap,S={};return S[new d.S(e.overscaledZ,p,o.z,u,o.y).key]={backfilled:!1},S[new d.S(e.overscaledZ,w,o.z,v,o.y).key]={backfilled:!1},o.y>0&&(S[new d.S(e.overscaledZ,p,o.z,u,o.y-1).key]={backfilled:!1},S[new d.S(e.overscaledZ,e.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},S[new d.S(e.overscaledZ,w,o.z,v,o.y-1).key]={backfilled:!1}),o.y+1<l&&(S[new d.S(e.overscaledZ,p,o.z,u,o.y+1).key]={backfilled:!1},S[new d.S(e.overscaledZ,e.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},S[new d.S(e.overscaledZ,w,o.z,v,o.y+1).key]={backfilled:!1}),S}unloadTile(e){return d._(this,void 0,void 0,(function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))}))}}class bo extends d.E{constructor(e,o,l,u){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=l.getActor(),this.setEventedParent(u),this._data=o.data,this._options=d.e({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const p=d.X/this.tileSize;o.clusterMaxZoom!==void 0&&this.maxzoom<=o.clusterMaxZoom&&d.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${o.clusterMaxZoom}".`),this.workerOptions=d.e({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*p,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*p,extent:d.X,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:d.X,radius:(o.clusterRadius||50)*p,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return d._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return d._(this,void 0,void 0,(function*(){const e=d.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})}))}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=e.clusterRadius),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,o,l){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:o,offset:l}})}_updateWorkerData(e){return d._(this,void 0,void 0,(function*(){const o=d.e({type:this.type},this.workerOptions);e?o.dataDiff=e:typeof this._data=="string"?(o.request=this.map._requestManager.transformRequest(re.resolveURL(this._data),"Source"),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new d.k("dataloading",{dataType:"source"}));try{const l=yield this.actor.sendAsync({type:"LD",data:o});if(this._pendingLoads--,this._removed||l.abandoned)return void this.fire(new d.k("dataabort",{dataType:"source"}));let u=null;l.resourceTiming&&l.resourceTiming[this.id]&&(u=l.resourceTiming[this.id].slice(0));const p={dataType:"source"};this._collectResourceTiming&&u&&u.length>0&&d.e(p,{resourceTiming:u}),this.fire(new d.k("data",Object.assign(Object.assign({},p),{sourceDataType:"metadata"}))),this.fire(new d.k("data",Object.assign(Object.assign({},p),{sourceDataType:"content"})))}catch(l){if(this._pendingLoads--,this._removed)return void this.fire(new d.k("dataabort",{dataType:"source"}));this.fire(new d.j(l))}}))}loaded(){return this._pendingLoads===0}loadTile(e){return d._(this,void 0,void 0,(function*(){const o=e.actor?"RT":"LT";e.actor=this.actor;const l={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};e.abortController=new AbortController;const u=yield this.actor.sendAsync({type:o,data:l},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(u,this.map.painter,o==="RT")}))}abortTile(e){return d._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0}))}unloadTile(e){return d._(this,void 0,void 0,(function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return d.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var So=d.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class ko extends d.E{constructor(e,o,l,u){super(),this.id=e,this.dispatcher=l,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(u),this.options=o}load(e){return d._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new d.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const o=yield St.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,o&&o.data&&(this.image=o.data,e&&(this.coordinates=e),this._finishLoading())}catch(o){this._request=null,this._loaded=!0,this.fire(new d.j(o))}}))}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new d.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const o=e.map(d.Z.fromLngLat);this.tileID=(function(u){let p=1/0,v=1/0,w=-1/0,S=-1/0;for(const $ of u)p=Math.min(p,$.x),v=Math.min(v,$.y),w=Math.max(w,$.x),S=Math.max(S,$.y);const C=Math.max(w-p,S-v),F=Math.max(0,Math.floor(-Math.log(C)/Math.LN2)),B=Math.pow(2,F);return new d.a1(F,Math.floor((p+w)/2*B),Math.floor((v+S)/2*B))})(o),this.minzoom=this.maxzoom=this.tileID.z;const l=o.map((u=>this.tileID.getTilePoint(u)._round()));return this._boundsArray=new d.$,this._boundsArray.emplaceBack(l[0].x,l[0].y,0,0),this._boundsArray.emplaceBack(l[1].x,l[1].y,d.X,0),this._boundsArray.emplaceBack(l[3].x,l[3].y,0,d.X),this._boundsArray.emplaceBack(l[2].x,l[2].y,d.X,d.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new d.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,o=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,So.members)),this.boundsSegments||(this.boundsSegments=d.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Et(e,this.image,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let l=!1;for(const u in this.tiles){const p=this.tiles[u];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture,l=!0)}l&&this.fire(new d.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return d._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Pa extends ko{constructor(e,o,l,u){super(e,o,l,u),this.roundZoom=!0,this.type="video",this.options=o}load(){return d._(this,void 0,void 0,(function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const o of e.urls)this.urls.push(this.map._requestManager.transformRequest(o,"Source").url);try{const o=yield d.a3(this.urls);if(this._loaded=!0,!o)return;this.video=o,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(o){this.fire(new d.j(o))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const o=this.video.seekable;e<o.start(0)||e>o.end(0)?this.fire(new d.j(new d.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,o=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,So.members)),this.boundsSegments||(this.boundsSegments=d.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new Et(e,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let l=!1;for(const u in this.tiles){const p=this.tiles[u];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture,l=!0)}l&&this.fire(new d.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Mn extends ko{constructor(e,o,l,u){super(e,o,l,u),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some((p=>!Array.isArray(p)||p.length!==2||p.some((v=>typeof v!="number"))))||this.fire(new d.j(new d.a2(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new d.j(new d.a2(`sources.${e}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new d.j(new d.a2(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new d.j(new d.a2(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new d.j(new d.a2(`sources.${e}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){return d._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new d.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context,l=o.gl;this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,So.members)),this.boundsSegments||(this.boundsSegments=d.a0.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Et(o,this.canvas,l.RGBA,{premultiply:!0});let u=!1;for(const p in this.tiles){const v=this.tiles[p];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,u=!0)}u&&this.fire(new d.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const cs={},Ma=f=>{switch(f){case"geojson":return bo;case"image":return ko;case"raster":return Er;case"raster-dem":return qr;case"vector":return ua;case"video":return Pa;case"canvas":return Mn}return cs[f]},rt="RTLPluginLoaded";class ao extends d.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Pn()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch((o=>{throw this.status="error",o}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return d._(this,arguments,void 0,(function*(o,l=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=re.resolveURL(o),!this.url)throw new Error(`requested url ${o} is invalid`);if(this.status==="unavailable"){if(!l)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return d._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new d.k(rt))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let pi=null;function fr(){return pi||(pi=new ao),pi}class ri{constructor(e,o){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=d.a4(),this.uses=0,this.tileSize=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const o=e+this.timeAdded;o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,o,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=(function(u,p){const v={};if(!p)return v;for(const w of u){const S=w.layerIds.map((C=>p.getLayer(C))).filter(Boolean);if(S.length!==0){w.layers=S,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map((C=>S.filter((F=>F.id===C))[0])));for(const C of S)v[C.id]=w}}return v})(e.buckets,o.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const p=this.buckets[u];if(p instanceof d.a6){if(this.hasSymbolBuckets=!0,!l)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const p=this.buckets[u];if(p instanceof d.a6&&p.hasRTLText){this.hasRTLText=!0,fr().lazyLoad();break}}this.queryPadding=0;for(const u in this.buckets){const p=this.buckets[u];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(u).queryRadius(p))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new d.a5}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const l in this.buckets){const u=this.buckets[l];u.uploadPending()&&u.upload(e)}const o=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Et(e,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Et(e,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,o,l,u,p,v,w,S,C,F){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:u,cameraQueryGeometry:p,scale:v,tileSize:this.tileSize,pixelPosMatrix:F,transform:S,params:w,queryPadding:this.queryPadding*C},e,o,l):{}}querySourceFeatures(e,o){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const u=l.loadVTLayers(),p=o&&o.sourceLayer?o.sourceLayer:"",v=u._geojsonTileLayer||u[p];if(!v)return;const w=d.a7(o&&o.filter),{z:S,x:C,y:F}=this.tileID.canonical,B={z:S,x:C,y:F};for(let $=0;$<v.length;$++){const K=v.feature($);if(w.needGeometry){const ae=d.a8(K,!0);if(!w.filter(new d.z(this.tileID.overscaledZ),ae,this.tileID.canonical))continue}else if(!w.filter(new d.z(this.tileID.overscaledZ),K))continue;const Q=l.getId(K,p),te=new d.a9(K,S,C,F,Q);te.tile=B,e.push(te)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const o=this.expirationTime;if(e.cacheControl){const l=d.aa(e.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const l=Date.now();let u=!1;if(this.expirationTime>l)u=!1;else if(o)if(this.expirationTime<o)u=!0;else{const p=this.expirationTime-o;p?this.expirationTime=l+Math.max(p,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const l=this.latestFeatureIndex.loadVTLayers();for(const u in this.buckets){if(!o.style.hasLayer(u))continue;const p=this.buckets[u],v=p.layers[0].sourceLayer||"_geojsonTileLayer",w=l[v],S=e[v];if(!w||!S||Object.keys(S).length===0)continue;p.update(S,w,this.imageAtlas&&this.imageAtlas.patternPositions||{});const C=o&&o.style&&o.style.getLayer(u);C&&(this.queryPadding=Math.max(this.queryPadding,C.queryRadius(p)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<re.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=re.now()+e}setDependencies(e,o){const l={};for(const u of o)l[u]=!0;this.dependencies[e]=l}hasDependency(e,o){for(const l of e){const u=this.dependencies[l];if(u){for(const p of o)if(u[p])return!0}}return!1}}class at{constructor(e,o){this.max=e,this.onRemove=o,this.reset()}reset(){for(const e in this.data)for(const o of this.data[e])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(e,o,l){const u=e.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);const p={value:o,timeout:void 0};if(l!==void 0&&(p.timeout=setTimeout((()=>{this.remove(e,p)}),l)),this.data[u].push(p),this.order.push(u),this.order.length>this.max){const v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const o=this.data[e].shift();return o.timeout&&clearTimeout(o.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),o.value}getByKey(e){const o=this.data[e];return o?o[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,o){if(!this.has(e))return this;const l=e.wrapped().key,u=o===void 0?0:this.data[l].indexOf(o),p=this.data[l][u];return this.data[l].splice(u,1),p.timeout&&clearTimeout(p.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(p.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(e){const o=[];for(const l in this.data)for(const u of this.data[l])e(u.value)||o.push(u);for(const l of o)this.remove(l.value.tileID,l)}}class sr{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,o,l){const u=String(o);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},d.e(this.stateChanges[e][u],l),this.deletedStates[e]===null){this.deletedStates[e]={};for(const p in this.state[e])p!==u&&(this.deletedStates[e][p]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][u]===null){this.deletedStates[e][u]={};for(const p in this.state[e][u])l[p]||(this.deletedStates[e][u][p]=null)}else for(const p in l)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][p]===null&&delete this.deletedStates[e][u][p]}removeFeatureState(e,o,l){if(this.deletedStates[e]===null)return;const u=String(o);if(this.deletedStates[e]=this.deletedStates[e]||{},l&&o!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][l]=null);else if(o!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(l in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][l]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}getState(e,o){const l=String(o),u=d.e({},(this.state[e]||{})[l],(this.stateChanges[e]||{})[l]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const p=this.deletedStates[e][o];if(p===null)return{};for(const v in p)delete u[v]}return u}initializeTileState(e,o){e.setFeatureState(this.state,o)}coalesceChanges(e,o){const l={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const p={};for(const v in this.stateChanges[u])this.state[u][v]||(this.state[u][v]={}),d.e(this.state[u][v],this.stateChanges[u][v]),p[v]=this.state[u][v];l[u]=p}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const p={};if(this.deletedStates[u]===null)for(const v in this.state[u])p[v]={},this.state[u][v]={};else for(const v in this.deletedStates[u]){if(this.deletedStates[u][v]===null)this.state[u][v]={};else for(const w of Object.keys(this.deletedStates[u][v]))delete this.state[u][v][w];p[v]=this.state[u][v]}l[u]=l[u]||{},d.e(l[u],p)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const u in e)e[u].setFeatureState(l,o)}}class Zt extends d.E{constructor(e,o,l){super(),this.id=e,this.dispatcher=l,this.on("data",(u=>this._dataHandler(u))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((u,p,v,w)=>{const S=new(Ma(p.type))(u,p,v,w);if(S.id!==u)throw new Error(`Expected Source id to be ${u} instead of ${S.id}`);return S})(e,o,l,this),this._tiles={},this._cache=new at(0,(u=>this._unloadTile(u))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new sr,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const o=this._tiles[e];if(o.state!=="loaded"&&o.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,o,l){return d._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,o,l)}catch(u){e.state="errored",u.status!==404?this._source.fire(new d.j(u,{tile:e})):this.update(this.transform,this.terrain)}}))}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new d.k("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const o in this._tiles){const l=this._tiles[o];l.upload(e),l.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((e=>e.tileID)).sort(Gi).map((e=>e.key))}getRenderableIds(e){const o=[];for(const l in this._tiles)this._isIdRenderable(l,e)&&o.push(this._tiles[l]);return e?o.sort(((l,u)=>{const p=l.tileID,v=u.tileID,w=new d.P(p.canonical.x,p.canonical.y)._rotate(this.transform.angle),S=new d.P(v.canonical.x,v.canonical.y)._rotate(this.transform.angle);return p.overscaledZ-v.overscaledZ||S.y-w.y||S.x-w.x})).map((l=>l.tileID.key)):o.map((l=>l.tileID)).sort(Gi).map((l=>l.key))}hasRenderableParent(e){const o=this.findLoadedParent(e,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(e,o){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(o||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(e,"reloading")}}_reloadTile(e,o){return d._(this,void 0,void 0,(function*(){const l=this._tiles[e];l&&(l.state!=="loading"&&(l.state=o),yield this._loadTile(l,e,o))}))}_tileLoaded(e,o,l){e.timeAdded=re.now(),l==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(o,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new d.k("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const o=this.getRenderableIds();for(let u=0;u<o.length;u++){const p=o[u];if(e.neighboringTiles&&e.neighboringTiles[p]){const v=this.getTileByID(p);l(e,v),l(v,e)}}function l(u,p){u.needsHillshadePrepare=!0,u.needsTerrainPrepare=!0;let v=p.tileID.canonical.x-u.tileID.canonical.x;const w=p.tileID.canonical.y-u.tileID.canonical.y,S=Math.pow(2,u.tileID.canonical.z),C=p.tileID.key;v===0&&w===0||Math.abs(w)>1||(Math.abs(v)>1&&(Math.abs(v+S)===1?v+=S:Math.abs(v-S)===1&&(v-=S)),p.dem&&u.dem&&(u.dem.backfillBorder(p.dem,v,w),u.neighboringTiles&&u.neighboringTiles[C]&&(u.neighboringTiles[C].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,o,l,u){for(const p in this._tiles){let v=this._tiles[p];if(u[p]||!v.hasData()||v.tileID.overscaledZ<=o||v.tileID.overscaledZ>l)continue;let w=v.tileID;for(;v&&v.tileID.overscaledZ>o+1;){const C=v.tileID.scaledTo(v.tileID.overscaledZ-1);v=this._tiles[C.key],v&&v.hasData()&&(w=C)}let S=w;for(;S.overscaledZ>o;)if(S=S.scaledTo(S.overscaledZ-1),e[S.key]){u[w.key]=w;break}}}findLoadedParent(e,o){if(e.key in this._loadedParentTiles){const l=this._loadedParentTiles[e.key];return l&&l.tileID.overscaledZ>=o?l:null}for(let l=e.overscaledZ-1;l>=o;l--){const u=e.scaledTo(l),p=this._getLoadedTile(u);if(p)return p}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const o=this._tiles[e.key];return o&&o.hasData()?o:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const o=Math.ceil(e.width/this._source.tileSize)+1,l=Math.ceil(e.height/this._source.tileSize)+1,u=Math.floor(o*l*(this._maxTileCacheZoomLevels===null?d.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),p=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,u):u;this._cache.setMaxSize(p)}handleWrapJump(e){const o=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,o){const l={};for(const u in this._tiles){const p=this._tiles[u];p.tileID=p.tileID.unwrapTo(p.tileID.wrap+o),l[p.tileID.key]=p}this._tiles=l;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(u,this._tiles[u])}}_updateCoveredAndRetainedTiles(e,o,l,u,p,v){const w={},S={},C=Object.keys(e),F=re.now();for(const B of C){const $=e[B],K=this._tiles[B];if(!K||K.fadeEndTime!==0&&K.fadeEndTime<=F)continue;const Q=this.findLoadedParent($,o),te=this.findLoadedSibling($),ae=Q||te||null;ae&&(this._addTile(ae.tileID),w[ae.tileID.key]=ae.tileID),S[B]=$}this._retainLoadedChildren(S,u,l,e);for(const B in w)e[B]||(this._coveredTiles[B]=!0,e[B]=w[B]);if(v){const B={},$={};for(const K of p)this._tiles[K.key].hasData()?B[K.key]=K:$[K.key]=K;for(const K in $){const Q=$[K].children(this._source.maxzoom);this._tiles[Q[0].key]&&this._tiles[Q[1].key]&&this._tiles[Q[2].key]&&this._tiles[Q[3].key]&&(B[Q[0].key]=e[Q[0].key]=Q[0],B[Q[1].key]=e[Q[1].key]=Q[1],B[Q[2].key]=e[Q[2].key]=Q[2],B[Q[3].key]=e[Q[3].key]=Q[3],delete $[K])}for(const K in $){const Q=$[K],te=this.findLoadedParent(Q,this._source.minzoom),ae=this.findLoadedSibling(Q),ue=te||ae||null;if(ue){B[ue.tileID.key]=e[ue.tileID.key]=ue.tileID;for(const me in B)B[me].isChildOf(ue.tileID)&&delete B[me]}}for(const K in this._tiles)B[K]||(this._coveredTiles[K]=!0)}}update(e,o){if(!this._sourceLoaded||this._paused)return;let l;this.transform=e,this.terrain=o,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?l=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((F=>new d.S(F.canonical.z,F.wrap,F.canonical.z,F.canonical.x,F.canonical.y))):(l=e.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:o}),this._source.hasTile&&(l=l.filter((F=>this._source.hasTile(F))))):l=[];const u=e.coveringZoomLevel(this._source),p=Math.max(u-Zt.maxOverzooming,this._source.minzoom),v=Math.max(u+Zt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const F={};for(const B of l)if(B.canonical.z>this._source.minzoom){const $=B.scaledTo(B.canonical.z-1);F[$.key]=$;const K=B.scaledTo(Math.max(this._source.minzoom,Math.min(B.canonical.z,5)));F[K.key]=K}l=l.concat(Object.values(F))}const w=l.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,w&&this.fire(new d.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const S=this._updateRetainedTiles(l,u);Ni(this._source.type)&&this._updateCoveredAndRetainedTiles(S,p,v,u,l,o);for(const F in S)this._tiles[F].clearFadeHold();const C=d.ab(this._tiles,S);for(const F of C){const B=this._tiles[F];B.hasSymbolBuckets&&!B.holdingForFade()?B.setHoldDuration(this.map._fadeDuration):B.hasSymbolBuckets&&!B.symbolFadeFinished()||this._removeTile(F)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,o){var l;const u={},p={},v=Math.max(o-Zt.maxOverzooming,this._source.minzoom),w=Math.max(o+Zt.maxUnderzooming,this._source.minzoom),S={};for(const C of e){const F=this._addTile(C);u[C.key]=C,F.hasData()||o<this._source.maxzoom&&(S[C.key]=C)}this._retainLoadedChildren(S,o,w,u);for(const C of e){let F=this._tiles[C.key];if(F.hasData())continue;if(o+1>this._source.maxzoom){const $=C.children(this._source.maxzoom)[0],K=this.getTile($);if(K&&K.hasData()){u[$.key]=$;continue}}else{const $=C.children(this._source.maxzoom);if(u[$[0].key]&&u[$[1].key]&&u[$[2].key]&&u[$[3].key])continue}let B=F.wasRequested();for(let $=C.overscaledZ-1;$>=v;--$){const K=C.scaledTo($);if(p[K.key])break;if(p[K.key]=!0,F=this.getTile(K),!F&&B&&(F=this._addTile(K)),F){const Q=F.hasData();if((Q||!(!((l=this.map)===null||l===void 0)&&l.cancelPendingTileRequestsWhileZooming)||B)&&(u[K.key]=K),B=F.wasRequested(),Q)break}}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const o=[];let l,u=this._tiles[e].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){l=this._loadedParentTiles[u.key];break}o.push(u.key);const p=u.scaledTo(u.overscaledZ-1);if(l=this._getLoadedTile(p),l)break;u=p}for(const p of o)this._loadedParentTiles[p]=l}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const o=this._tiles[e].tileID,l=this._getLoadedTile(o);this._loadedSiblingTiles[o.key]=l}}_addTile(e){let o=this._tiles[e.key];if(o)return o;o=this._cache.getAndRemove(e),o&&(this._setTileReloadTimer(e.key,o),o.tileID=e,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,o)));const l=o;return o||(o=new ri(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(o,e.key,o.state)),o.uses++,this._tiles[e.key]=o,l||this._source.fire(new d.k("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o}_setTileReloadTimer(e,o){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const l=o.getExpiryTimeout();l&&(this._timers[e]=setTimeout((()=>{this._reloadTile(e,"expired"),delete this._timers[e]}),l))}_removeTile(e){const o=this._tiles[e];o&&(o.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}_dataHandler(e){const o=e.sourceDataType;e.dataType==="source"&&o==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&o==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,o,l){const u=[],p=this.transform;if(!p)return u;const v=l?p.getCameraQueryGeometry(e):e,w=e.map((Q=>p.pointCoordinate(Q,this.terrain))),S=v.map((Q=>p.pointCoordinate(Q,this.terrain))),C=this.getIds();let F=1/0,B=1/0,$=-1/0,K=-1/0;for(const Q of S)F=Math.min(F,Q.x),B=Math.min(B,Q.y),$=Math.max($,Q.x),K=Math.max(K,Q.y);for(let Q=0;Q<C.length;Q++){const te=this._tiles[C[Q]];if(te.holdingForFade())continue;const ae=te.tileID,ue=Math.pow(2,p.zoom-te.tileID.overscaledZ),me=o*te.queryPadding*d.X/te.tileSize/ue,ie=[ae.getTilePoint(new d.Z(F,B)),ae.getTilePoint(new d.Z($,K))];if(ie[0].x-me<d.X&&ie[0].y-me<d.X&&ie[1].x+me>=0&&ie[1].y+me>=0){const ve=w.map((Ie=>ae.getTilePoint(Ie))),be=S.map((Ie=>ae.getTilePoint(Ie)));u.push({tile:te,tileID:ae,queryGeometry:ve,cameraQueryGeometry:be,scale:ue})}}return u}getVisibleCoordinates(e){const o=this.getRenderableIds(e).map((l=>this._tiles[l].tileID));for(const l of o)l.posMatrix=this.transform.calculatePosMatrix(l.toUnwrapped());return o}hasTransition(){if(this._source.hasTransition())return!0;if(Ni(this._source.type)){const e=re.now();for(const o in this._tiles)if(this._tiles[o].fadeEndTime>=e)return!0}return!1}setFeatureState(e,o,l){this._state.updateState(e=e||"_geojsonTileLayer",o,l)}removeFeatureState(e,o,l){this._state.removeFeatureState(e=e||"_geojsonTileLayer",o,l)}getFeatureState(e,o){return this._state.getState(e=e||"_geojsonTileLayer",o)}setDependencies(e,o,l){const u=this._tiles[e];u&&u.setDependencies(o,l)}reloadTilesForDependencies(e,o){for(const l in this._tiles)this._tiles[l].hasDependency(e,o)&&this._reloadTile(l,"reloading");this._cache.filter((l=>!l.hasDependency(e,o)))}}function Gi(f,e){const o=Math.abs(2*f.wrap)-+(f.wrap<0),l=Math.abs(2*e.wrap)-+(e.wrap<0);return f.overscaledZ-e.overscaledZ||l-o||e.canonical.y-f.canonical.y||e.canonical.x-f.canonical.x}function Ni(f){return f==="raster"||f==="image"||f==="video"}Zt.maxOverzooming=10,Zt.maxUnderzooming=3;class Ht{constructor(e,o){this.reset(e,o)}reset(e,o){this.points=e||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=d.ac(e,0,1);let o=1,l=this._distances[o];const u=e*this.paddedLength+this.padding;for(;l<u&&o<this._distances.length;)l=this._distances[++o];const p=o-1,v=this._distances[p],w=l-v,S=w>0?(u-v)/w:0;return this.points[p].mult(1-S).add(this.points[o].mult(S))}}function An(f,e){let o=!0;return f==="always"||f!=="never"&&e!=="never"||(o=!1),o}class so{constructor(e,o,l){const u=this.boxCells=[],p=this.circleCells=[];this.xCellCount=Math.ceil(e/l),this.yCellCount=Math.ceil(o/l);for(let v=0;v<this.xCellCount*this.yCellCount;v++)u.push([]),p.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=o,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,o,l,u,p){this._forEachCell(o,l,u,p,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(o),this.bboxes.push(l),this.bboxes.push(u),this.bboxes.push(p)}insertCircle(e,o,l,u){this._forEachCell(o-u,l-u,o+u,l+u,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(o),this.circles.push(l),this.circles.push(u)}_insertBoxCell(e,o,l,u,p,v){this.boxCells[p].push(v)}_insertCircleCell(e,o,l,u,p,v){this.circleCells[p].push(v)}_query(e,o,l,u,p,v,w){if(l<0||e>this.width||u<0||o>this.height)return[];const S=[];if(e<=0&&o<=0&&this.width<=l&&this.height<=u){if(p)return[{key:null,x1:e,y1:o,x2:l,y2:u}];for(let C=0;C<this.boxKeys.length;C++)S.push({key:this.boxKeys[C],x1:this.bboxes[4*C],y1:this.bboxes[4*C+1],x2:this.bboxes[4*C+2],y2:this.bboxes[4*C+3]});for(let C=0;C<this.circleKeys.length;C++){const F=this.circles[3*C],B=this.circles[3*C+1],$=this.circles[3*C+2];S.push({key:this.circleKeys[C],x1:F-$,y1:B-$,x2:F+$,y2:B+$})}}else this._forEachCell(e,o,l,u,this._queryCell,S,{hitTest:p,overlapMode:v,seenUids:{box:{},circle:{}}},w);return S}query(e,o,l,u){return this._query(e,o,l,u,!1,null)}hitTest(e,o,l,u,p,v){return this._query(e,o,l,u,!0,p,v).length>0}hitTestCircle(e,o,l,u,p){const v=e-l,w=e+l,S=o-l,C=o+l;if(w<0||v>this.width||C<0||S>this.height)return!1;const F=[];return this._forEachCell(v,S,w,C,this._queryCellCircle,F,{hitTest:!0,overlapMode:u,circle:{x:e,y:o,radius:l},seenUids:{box:{},circle:{}}},p),F.length>0}_queryCell(e,o,l,u,p,v,w,S){const{seenUids:C,hitTest:F,overlapMode:B}=w,$=this.boxCells[p];if($!==null){const Q=this.bboxes;for(const te of $)if(!C.box[te]){C.box[te]=!0;const ae=4*te,ue=this.boxKeys[te];if(e<=Q[ae+2]&&o<=Q[ae+3]&&l>=Q[ae+0]&&u>=Q[ae+1]&&(!S||S(ue))&&(!F||!An(B,ue.overlapMode))&&(v.push({key:ue,x1:Q[ae],y1:Q[ae+1],x2:Q[ae+2],y2:Q[ae+3]}),F))return!0}}const K=this.circleCells[p];if(K!==null){const Q=this.circles;for(const te of K)if(!C.circle[te]){C.circle[te]=!0;const ae=3*te,ue=this.circleKeys[te];if(this._circleAndRectCollide(Q[ae],Q[ae+1],Q[ae+2],e,o,l,u)&&(!S||S(ue))&&(!F||!An(B,ue.overlapMode))){const me=Q[ae],ie=Q[ae+1],ve=Q[ae+2];if(v.push({key:ue,x1:me-ve,y1:ie-ve,x2:me+ve,y2:ie+ve}),F)return!0}}}return!1}_queryCellCircle(e,o,l,u,p,v,w,S){const{circle:C,seenUids:F,overlapMode:B}=w,$=this.boxCells[p];if($!==null){const Q=this.bboxes;for(const te of $)if(!F.box[te]){F.box[te]=!0;const ae=4*te,ue=this.boxKeys[te];if(this._circleAndRectCollide(C.x,C.y,C.radius,Q[ae+0],Q[ae+1],Q[ae+2],Q[ae+3])&&(!S||S(ue))&&!An(B,ue.overlapMode))return v.push(!0),!0}}const K=this.circleCells[p];if(K!==null){const Q=this.circles;for(const te of K)if(!F.circle[te]){F.circle[te]=!0;const ae=3*te,ue=this.circleKeys[te];if(this._circlesCollide(Q[ae],Q[ae+1],Q[ae+2],C.x,C.y,C.radius)&&(!S||S(ue))&&!An(B,ue.overlapMode))return v.push(!0),!0}}}_forEachCell(e,o,l,u,p,v,w,S){const C=this._convertToXCellCoord(e),F=this._convertToYCellCoord(o),B=this._convertToXCellCoord(l),$=this._convertToYCellCoord(u);for(let K=C;K<=B;K++)for(let Q=F;Q<=$;Q++)if(p.call(this,e,o,l,u,this.xCellCount*Q+K,v,w,S))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,o,l,u,p,v){const w=u-e,S=p-o,C=l+v;return C*C>w*w+S*S}_circleAndRectCollide(e,o,l,u,p,v,w){const S=(v-u)/2,C=Math.abs(e-(u+S));if(C>S+l)return!1;const F=(w-p)/2,B=Math.abs(o-(p+F));if(B>F+l)return!1;if(C<=S||B<=F)return!0;const $=C-S,K=B-F;return $*$+K*K<=l*l}}function xn(f,e,o,l,u){const p=d.H();return e?(d.K(p,p,[1/u,1/u,1]),o||d.ad(p,p,l.angle)):d.L(p,l.labelPlaneMatrix,f),p}function ln(f,e,o,l,u){if(e){const p=d.ae(f);return d.K(p,p,[u,u,1]),o||d.ad(p,p,-l.angle),p}return l.glCoordMatrix}function le(f,e,o,l){let u;l?(u=[f,e,l(f,e),1],d.af(u,u,o)):(u=[f,e,0,1],br(u,u,o));const p=u[3];return{point:new d.P(u[0]/p,u[1]/p),signedDistanceFromCamera:p,isOccluded:!1}}function j(f,e){return .5+f/e*.5}function V(f,e){return f.x>=-e[0]&&f.x<=e[0]&&f.y>=-e[1]&&f.y<=e[1]}function X(f,e,o,l,u,p,v,w,S,C,F,B,$,K,Q){const te=l?f.textSizeData:f.iconSizeData,ae=d.ag(te,o.transform.zoom),ue=[256/o.width*2+1,256/o.height*2+1],me=l?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;me.clear();const ie=f.lineVertexArray,ve=l?f.text.placedSymbolArray:f.icon.placedSymbolArray,be=o.transform.width/o.transform.height;let Ie=!1;for(let Ue=0;Ue<ve.length;Ue++){const tt=ve.get(Ue);if(tt.hidden||tt.writingMode===d.ah.vertical&&!Ie){Lt(tt.numGlyphs,me);continue}Ie=!1;const lt=le(tt.anchorX,tt.anchorY,e,Q);if(!V(lt.point,ue)){Lt(tt.numGlyphs,me);continue}const gt=j(o.transform.cameraToCenterDistance,lt.signedDistanceFromCamera),ut=d.ai(te,ae,tt),ot=v?ut/gt:ut*gt,zt={getElevation:Q,labelPlaneMatrix:u,lineVertexArray:ie,pitchWithMap:v,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:C,tileAnchorPoint:new d.P(tt.anchorX,tt.anchorY),unwrappedTileID:F,width:B,height:$,translation:K},Jt=xe(zt,tt,ot,!1,w,e,p,f.glyphOffsetArray,me,be,S);Ie=Jt.useVertical,(Jt.notEnoughRoom||Ie||Jt.needsFlipping&&xe(zt,tt,ot,!0,w,e,p,f.glyphOffsetArray,me,be,S).notEnoughRoom)&&Lt(tt.numGlyphs,me)}l?f.text.dynamicLayoutVertexBuffer.updateData(me):f.icon.dynamicLayoutVertexBuffer.updateData(me)}function oe(f,e,o,l,u,p,v,w){const S=p.glyphStartIndex+p.numGlyphs,C=p.lineStartIndex,F=p.lineStartIndex+p.lineLength,B=e.getoffsetX(p.glyphStartIndex),$=e.getoffsetX(S-1),K=it(f*B,o,l,u,p.segment,C,F,w,v);if(!K)return null;const Q=it(f*$,o,l,u,p.segment,C,F,w,v);return Q?w.projectionCache.anyProjectionOccluded?null:{first:K,last:Q}:null}function ge(f,e,o,l){return f===d.ah.horizontal&&Math.abs(o.y-e.y)>Math.abs(o.x-e.x)*l?{useVertical:!0}:(f===d.ah.vertical?e.y<o.y:e.x>o.x)?{needsFlipping:!0}:null}function xe(f,e,o,l,u,p,v,w,S,C,F){const B=o/24,$=e.lineOffsetX*B,K=e.lineOffsetY*B;let Q;if(e.numGlyphs>1){const te=e.glyphStartIndex+e.numGlyphs,ae=e.lineStartIndex,ue=e.lineStartIndex+e.lineLength,me=oe(B,w,$,K,l,e,F,f);if(!me)return{notEnoughRoom:!0};const ie=le(me.first.point.x,me.first.point.y,v,f.getElevation).point,ve=le(me.last.point.x,me.last.point.y,v,f.getElevation).point;if(u&&!l){const be=ge(e.writingMode,ie,ve,C);if(be)return be}Q=[me.first];for(let be=e.glyphStartIndex+1;be<te-1;be++)Q.push(it(B*w.getoffsetX(be),$,K,l,e.segment,ae,ue,f,F));Q.push(me.last)}else{if(u&&!l){const ae=le(f.tileAnchorPoint.x,f.tileAnchorPoint.y,p,f.getElevation).point,ue=e.lineStartIndex+e.segment+1,me=new d.P(f.lineVertexArray.getx(ue),f.lineVertexArray.gety(ue)),ie=le(me.x,me.y,p,f.getElevation),ve=ie.signedDistanceFromCamera>0?ie.point:(function(Ie,Ue,tt,lt,gt,ut){return Te(Ie,Ue,tt,1,gt,ut)})(f.tileAnchorPoint,me,ae,0,p,f),be=ge(e.writingMode,ae,ve,C);if(be)return be}const te=it(B*w.getoffsetX(e.glyphStartIndex),$,K,l,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,f,F);if(!te||f.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Q=[te]}for(const te of Q)d.aj(S,te.point,te.angle);return{}}function Te(f,e,o,l,u,p){const v=f.add(f.sub(e)._unit()),w=u!==void 0?le(v.x,v.y,u,p.getElevation).point:De(v.x,v.y,p).point,S=o.sub(w);return o.add(S._mult(l/S.mag()))}function de(f,e,o){const l=e.projectionCache;if(l.projections[f])return l.projections[f];const u=new d.P(e.lineVertexArray.getx(f),e.lineVertexArray.gety(f)),p=De(u.x,u.y,e);if(p.signedDistanceFromCamera>0)return l.projections[f]=p.point,l.anyProjectionOccluded=l.anyProjectionOccluded||p.isOccluded,p.point;const v=f-o.direction;return(function(w,S,C,F,B){return Te(w,S,C,F,void 0,B)})(o.distanceFromAnchor===0?e.tileAnchorPoint:new d.P(e.lineVertexArray.getx(v),e.lineVertexArray.gety(v)),u,o.previousVertex,o.absOffsetX-o.distanceFromAnchor+1,e)}function De(f,e,o){const l=f+o.translation[0],u=e+o.translation[1];let p;return!o.pitchWithMap&&o.projection.useSpecialProjectionForSymbols?(p=o.projection.projectTileCoordinates(l,u,o.unwrappedTileID,o.getElevation),p.point.x=(.5*p.point.x+.5)*o.width,p.point.y=(.5*-p.point.y+.5)*o.height):(p=le(l,u,o.labelPlaneMatrix,o.getElevation),p.isOccluded=!1),p}function qe(f,e,o){return f._unit()._perp()._mult(e*o)}function Ae(f,e,o,l,u,p,v,w,S){if(w.projectionCache.offsets[f])return w.projectionCache.offsets[f];const C=o.add(e);if(f+S.direction<l||f+S.direction>=u)return w.projectionCache.offsets[f]=C,C;const F=de(f+S.direction,w,S),B=qe(F.sub(o),v,S.direction),$=o.add(B),K=F.add(B);return w.projectionCache.offsets[f]=d.ak(p,C,$,K)||C,w.projectionCache.offsets[f]}function it(f,e,o,l,u,p,v,w,S){const C=l?f-e:f+e;let F=C>0?1:-1,B=0;l&&(F*=-1,B=Math.PI),F<0&&(B+=Math.PI);let $,K=F>0?p+u:p+u+1;w.projectionCache.cachedAnchorPoint?$=w.projectionCache.cachedAnchorPoint:($=De(w.tileAnchorPoint.x,w.tileAnchorPoint.y,w).point,w.projectionCache.cachedAnchorPoint=$);let Q,te,ae=$,ue=$,me=0,ie=0;const ve=Math.abs(C),be=[];let Ie;for(;me+ie<=ve;){if(K+=F,K<p||K>=v)return null;me+=ie,ue=ae,te=Q;const lt={absOffsetX:ve,direction:F,distanceFromAnchor:me,previousVertex:ue};if(ae=de(K,w,lt),o===0)be.push(ue),Ie=ae.sub(ue);else{let gt;const ut=ae.sub(ue);gt=ut.mag()===0?qe(de(K+F,w,lt).sub(ae),o,F):qe(ut,o,F),te||(te=ue.add(gt)),Q=Ae(K,gt,ae,p,v,te,o,w,lt),be.push(te),Ie=Q.sub(te)}ie=Ie.mag()}const Ue=Ie._mult((ve-me)/ie)._add(te||ue),tt=B+Math.atan2(ae.y-ue.y,ae.x-ue.x);return be.push(Ue),{point:Ue,angle:S?tt:0,path:be}}const Ct=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Lt(f,e){for(let o=0;o<f;o++){const l=e.length;e.resize(l+4),e.float32.set(Ct,3*l)}}function br(f,e,o){const l=e[0],u=e[1];return f[0]=o[0]*l+o[4]*u+o[12],f[1]=o[1]*l+o[5]*u+o[13],f[3]=o[3]*l+o[7]*u+o[15],f}const er=100;class Tr{constructor(e,o,l=new so(e.width+200,e.height+200,25),u=new so(e.width+200,e.height+200,25)){this.transform=e,this.mapProjection=o,this.grid=l,this.ignoredGrid=u,this.pitchFactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+er,this.screenBottomBoundary=e.height+er,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,o,l,u,p,v,w,S,C,F,B){const $=e.anchorPointX+S[0],K=e.anchorPointY+S[1],Q=this.projectAndGetPerspectiveRatio(u,$,K,p,F),te=l*Q.perspectiveRatio;let ae;if(v||w)ae=this._projectCollisionBox(e,te,u,p,v,w,S,Q,F,B);else{const be=Q.point.x+(B?B.x*te:0),Ie=Q.point.y+(B?B.y*te:0);ae={allPointsOccluded:!1,box:[be+e.x1*te,Ie+e.y1*te,be+e.x2*te,Ie+e.y2*te]}}const[ue,me,ie,ve]=ae.box;return this.mapProjection.useSpecialProjectionForSymbols&&(v?ae.allPointsOccluded:this.mapProjection.isOccluded($,K,p))||Q.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(ue,me,ie,ve)||o!=="always"&&this.grid.hitTest(ue,me,ie,ve,o,C)?{box:[ue,me,ie,ve],placeable:!1,offscreen:!1}:{box:[ue,me,ie,ve],placeable:!0,offscreen:this.isOffscreen(ue,me,ie,ve)}}placeCollisionCircles(e,o,l,u,p,v,w,S,C,F,B,$,K,Q,te,ae){const ue=[],me=new d.P(o.anchorX,o.anchorY),ie=this.getPerspectiveRatio(v,me.x,me.y,w,ae),ve=(B?p/ie:p*ie)/d.ap,be={getElevation:ae,labelPlaneMatrix:S,lineVertexArray:l,pitchWithMap:B,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:me,unwrappedTileID:w,width:this.transform.width,height:this.transform.height,translation:te},Ie=oe(ve,u,o.lineOffsetX*ve,o.lineOffsetY*ve,!1,o,!1,be);let Ue=!1,tt=!1,lt=!0;if(Ie){const gt=.5*K*ie+Q,ut=new d.P(-100,-100),ot=new d.P(this.screenRightBoundary,this.screenBottomBoundary),zt=new Ht,Jt=Ie.first,ct=Ie.last;let dt=[];for(let or=Jt.path.length-1;or>=1;or--)dt.push(Jt.path[or]);for(let or=1;or<ct.path.length;or++)dt.push(ct.path[or]);const Wt=2.5*gt;if(C){const or=this.projectPathToScreenSpace(dt,be,C);dt=or.some((dr=>dr.signedDistanceFromCamera<=0))?[]:or.map((dr=>dr.point))}let Gr=[];if(dt.length>0){const or=dt[0].clone(),dr=dt[0].clone();for(let Yr=1;Yr<dt.length;Yr++)or.x=Math.min(or.x,dt[Yr].x),or.y=Math.min(or.y,dt[Yr].y),dr.x=Math.max(dr.x,dt[Yr].x),dr.y=Math.max(dr.y,dt[Yr].y);Gr=or.x>=ut.x&&dr.x<=ot.x&&or.y>=ut.y&&dr.y<=ot.y?[dt]:dr.x<ut.x||or.x>ot.x||dr.y<ut.y||or.y>ot.y?[]:d.al([dt],ut.x,ut.y,ot.x,ot.y)}for(const or of Gr){zt.reset(or,.25*gt);let dr=0;dr=zt.length<=.5*gt?1:Math.ceil(zt.paddedLength/Wt)+1;for(let Yr=0;Yr<dr;Yr++){const on=Yr/Math.max(dr-1,1),ho=zt.lerp(on),Qr=ho.x+er,Xi=ho.y+er;ue.push(Qr,Xi,gt,0);const ci=Qr-gt,Ci=Xi-gt,gn=Qr+gt,Yo=Xi+gt;if(lt=lt&&this.isOffscreen(ci,Ci,gn,Yo),tt=tt||this.isInsideGrid(ci,Ci,gn,Yo),e!=="always"&&this.grid.hitTestCircle(Qr,Xi,gt,e,$)&&(Ue=!0,!F))return{circles:[],offscreen:!1,collisionDetected:Ue}}}}return{circles:!F&&Ue||!tt||ie<this.perspectiveRatioCutoff?[]:ue,offscreen:lt,collisionDetected:Ue}}projectPathToScreenSpace(e,o,l){return e.map((u=>le(u.x,u.y,l,o.getElevation)))}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const o=[];let l=1/0,u=1/0,p=-1/0,v=-1/0;for(const F of e){const B=new d.P(F.x+er,F.y+er);l=Math.min(l,B.x),u=Math.min(u,B.y),p=Math.max(p,B.x),v=Math.max(v,B.y),o.push(B)}const w=this.grid.query(l,u,p,v).concat(this.ignoredGrid.query(l,u,p,v)),S={},C={};for(const F of w){const B=F.key;if(S[B.bucketInstanceId]===void 0&&(S[B.bucketInstanceId]={}),S[B.bucketInstanceId][B.featureIndex])continue;const $=[new d.P(F.x1,F.y1),new d.P(F.x2,F.y1),new d.P(F.x2,F.y2),new d.P(F.x1,F.y2)];d.am(o,$)&&(S[B.bucketInstanceId][B.featureIndex]=!0,C[B.bucketInstanceId]===void 0&&(C[B.bucketInstanceId]=[]),C[B.bucketInstanceId].push(B.featureIndex))}return C}insertCollisionBox(e,o,l,u,p,v){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:u,featureIndex:p,collisionGroupID:v,overlapMode:o},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,o,l,u,p,v){const w=l?this.ignoredGrid:this.grid,S={bucketInstanceId:u,featureIndex:p,collisionGroupID:v,overlapMode:o};for(let C=0;C<e.length;C+=4)w.insertCircle(S,e[C],e[C+1],e[C+2])}projectAndGetPerspectiveRatio(e,o,l,u,p){let v;p?(v=[o,l,p(o,l),1],d.af(v,v,e)):(v=[o,l,0,1],br(v,v,e));const w=v[3];return{point:new d.P((v[0]/w+1)/2*this.transform.width+er,(-v[1]/w+1)/2*this.transform.height+er),perspectiveRatio:.5+this.transform.cameraToCenterDistance/w*.5,isOccluded:!1,signedDistanceFromCamera:w}}getPerspectiveRatio(e,o,l,u,p){const v=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(o,l,u,p):le(o,l,e,p);return .5+this.transform.cameraToCenterDistance/v.signedDistanceFromCamera*.5}isOffscreen(e,o,l,u){return l<er||e>=this.screenRightBoundary||u<er||o>this.screenBottomBoundary}isInsideGrid(e,o,l,u){return l>=0&&e<this.gridRightBoundary&&u>=0&&o<this.gridBottomBoundary}getViewportMatrix(){const e=d.an([]);return d.J(e,e,[-100,-100,0]),e}_projectCollisionBox(e,o,l,u,p,v,w,S,C,F){let B=new d.P(1,0),$=new d.P(0,1);const K=new d.P(e.anchorPointX+w[0],e.anchorPointY+w[1]);if(v&&!p){const lt=this.projectAndGetPerspectiveRatio(l,K.x+1,K.y,u,C).point.sub(S.point).unit(),gt=Math.atan(lt.y/lt.x)+(lt.x<0?Math.PI:0),ut=Math.sin(gt),ot=Math.cos(gt);B=new d.P(ot,ut),$=new d.P(-ut,ot)}else if(!v&&p){const lt=-this.transform.angle,gt=Math.sin(lt),ut=Math.cos(lt);B=new d.P(ut,gt),$=new d.P(-gt,ut)}let Q=S.point,te=o;if(p){Q=K;const lt=this.transform.zoom-Math.floor(this.transform.zoom);te=Math.pow(2,-lt),te*=this.mapProjection.getPitchedTextCorrection(this.transform,K,u),F||(te*=d.ac(.5+S.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}F&&(Q=Q.add(B.mult(F.x*te)).add($.mult(F.y*te)));const ae=e.x1*te,ue=e.x2*te,me=(ae+ue)/2,ie=e.y1*te,ve=e.y2*te,be=(ie+ve)/2,Ie=[{offsetX:ae,offsetY:ie},{offsetX:me,offsetY:ie},{offsetX:ue,offsetY:ie},{offsetX:ue,offsetY:be},{offsetX:ue,offsetY:ve},{offsetX:me,offsetY:ve},{offsetX:ae,offsetY:ve},{offsetX:ae,offsetY:be}];let Ue=[];for(const{offsetX:lt,offsetY:gt}of Ie)Ue.push(new d.P(Q.x+B.x*lt+$.x*gt,Q.y+B.y*lt+$.y*gt));let tt=!1;if(p){const lt=Ue.map((gt=>this.projectAndGetPerspectiveRatio(l,gt.x,gt.y,u,C)));tt=lt.some((gt=>!gt.isOccluded)),Ue=lt.map((gt=>gt.point))}else tt=!0;return{box:d.ao(Ue),allPointsOccluded:!tt}}}function ir(f,e,o){return e*(d.X/(f.tileSize*Math.pow(2,o-f.tileID.overscaledZ)))}class gi{constructor(e,o,l,u){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?o:-o))):u&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class Xr{constructor(e,o,l,u,p){this.text=new gi(e?e.text:null,o,l,p),this.icon=new gi(e?e.icon:null,o,u,p)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class hr{constructor(e,o,l){this.text=e,this.icon=o,this.skipFade=l}}class Or{constructor(){this.invProjMatrix=d.H(),this.viewportMatrix=d.H(),this.circles=[]}}class Kr{constructor(e,o,l,u,p){this.bucketInstanceId=e,this.featureIndex=o,this.sourceLayerIndex=l,this.bucketIndex=u,this.tileID=p}}class yi{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const o=++this.maxGroupID;this.collisionGroups[e]={ID:o,predicate:l=>l.collisionGroupID===o}}return this.collisionGroups[e]}}function Pi(f,e,o,l,u){const{horizontalAlign:p,verticalAlign:v}=d.au(f);return new d.P(-(p-.5)*e+l[0]*u,-(v-.5)*o+l[1]*u)}class ji{constructor(e,o,l,u,p,v){this.transform=e.clone(),this.terrain=l,this.collisionIndex=new Tr(this.transform,o),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new yi(p),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=v,v&&(v.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const o=this.terrain;return o?(l,u)=>o.getElevation(e,l,u):null}getBucketParts(e,o,l,u){const p=l.getBucket(o),v=l.latestFeatureIndex;if(!p||!v||o.id!==p.layerIds[0])return;const w=l.collisionBoxArray,S=p.layers[0].layout,C=p.layers[0].paint,F=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),B=l.tileSize/d.X,$=l.tileID.toUnwrapped(),K=this.transform.calculatePosMatrix($),Q=S.get("text-pitch-alignment")==="map",te=S.get("text-rotation-alignment")==="map",ae=ir(l,1,this.transform.zoom),ue=this.collisionIndex.mapProjection.translatePosition(this.transform,l,C.get("text-translate"),C.get("text-translate-anchor")),me=this.collisionIndex.mapProjection.translatePosition(this.transform,l,C.get("icon-translate"),C.get("icon-translate-anchor")),ie=xn(K,Q,te,this.transform,ae);let ve=null;if(Q){const Ie=ln(K,Q,te,this.transform,ae);ve=d.L([],this.transform.labelPlaneMatrix,Ie)}this.retainedQueryData[p.bucketInstanceId]=new Kr(p.bucketInstanceId,v,p.sourceLayerIndex,p.index,l.tileID);const be={bucket:p,layout:S,translationText:ue,translationIcon:me,posMatrix:K,unwrappedTileID:$,textLabelPlaneMatrix:ie,labelToScreenMatrix:ve,scale:F,textPixelRatio:B,holdingForFade:l.holdingForFade(),collisionBoxArray:w,partiallyEvaluatedTextSize:d.ag(p.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(p.sourceID)};if(u)for(const Ie of p.sortKeyRanges){const{sortKey:Ue,symbolInstanceStart:tt,symbolInstanceEnd:lt}=Ie;e.push({sortKey:Ue,symbolInstanceStart:tt,symbolInstanceEnd:lt,parameters:be})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:p.symbolInstances.length,parameters:be})}attemptAnchorPlacement(e,o,l,u,p,v,w,S,C,F,B,$,K,Q,te,ae,ue,me,ie){const ve=d.aq[e.textAnchor],be=[e.textOffset0,e.textOffset1],Ie=Pi(ve,l,u,be,p),Ue=this.collisionIndex.placeCollisionBox(o,$,S,C,F,w,v,ae,B.predicate,ie,Ie);if((!me||this.collisionIndex.placeCollisionBox(me,$,S,C,F,w,v,ue,B.predicate,ie,Ie).placeable)&&Ue.placeable){let tt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[K.crossTileID]&&this.prevPlacement.placements[K.crossTileID]&&this.prevPlacement.placements[K.crossTileID].text&&(tt=this.prevPlacement.variableOffsets[K.crossTileID].anchor),K.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[K.crossTileID]={textOffset:be,width:l,height:u,anchor:ve,textBoxScale:p,prevAnchor:tt},this.markUsedJustification(Q,ve,K,te),Q.allowVerticalPlacement&&(this.markUsedOrientation(Q,te,K),this.placedOrientations[K.crossTileID]=te),{shift:Ie,placedGlyphBoxes:Ue}}}placeLayerBucketPart(e,o,l){const{bucket:u,layout:p,translationText:v,translationIcon:w,posMatrix:S,unwrappedTileID:C,textLabelPlaneMatrix:F,labelToScreenMatrix:B,textPixelRatio:$,holdingForFade:K,collisionBoxArray:Q,partiallyEvaluatedTextSize:te,collisionGroup:ae}=e.parameters,ue=p.get("text-optional"),me=p.get("icon-optional"),ie=d.ar(p,"text-overlap","text-allow-overlap"),ve=ie==="always",be=d.ar(p,"icon-overlap","icon-allow-overlap"),Ie=be==="always",Ue=p.get("text-rotation-alignment")==="map",tt=p.get("text-pitch-alignment")==="map",lt=p.get("icon-text-fit")!=="none",gt=p.get("symbol-z-order")==="viewport-y",ut=ve&&(Ie||!u.hasIconData()||me),ot=Ie&&(ve||!u.hasTextData()||ue);!u.collisionArrays&&Q&&u.deserializeCollisionBoxes(Q);const zt=this._getTerrainElevationFunc(this.retainedQueryData[u.bucketInstanceId].tileID),Jt=(ct,dt,Wt)=>{var Gr,or;if(o[ct.crossTileID])return;if(K)return void(this.placements[ct.crossTileID]=new hr(!1,!1,!1));let dr=!1,Yr=!1,on=!0,ho=null,Qr={box:null,placeable:!1,offscreen:null},Xi={placeable:!1},ci=null,Ci=null,gn=null,Yo=0,Kn=0,Qo=0;dt.textFeatureIndex?Yo=dt.textFeatureIndex:ct.useRuntimeCollisionCircles&&(Yo=ct.featureIndex),dt.verticalTextFeatureIndex&&(Kn=dt.verticalTextFeatureIndex);const bs=dt.textBox;if(bs){const Bn=Ri=>{let fi=d.ah.horizontal;if(u.allowVerticalPlacement&&!Ri&&this.prevPlacement){const yn=this.prevPlacement.placedOrientations[ct.crossTileID];yn&&(this.placedOrientations[ct.crossTileID]=yn,fi=yn,this.markUsedOrientation(u,fi,ct))}return fi},fo=(Ri,fi)=>{if(u.allowVerticalPlacement&&ct.numVerticalGlyphVertices>0&&dt.verticalTextBox){for(const yn of u.writingModes)if(yn===d.ah.vertical?(Qr=fi(),Xi=Qr):Qr=Ri(),Qr&&Qr.placeable)break}else Qr=Ri()},ea=ct.textAnchorOffsetStartIndex,Do=ct.textAnchorOffsetEndIndex;if(Do===ea){const Ri=(fi,yn)=>{const mr=this.collisionIndex.placeCollisionBox(fi,ie,$,S,C,tt,Ue,v,ae.predicate,zt);return mr&&mr.placeable&&(this.markUsedOrientation(u,yn,ct),this.placedOrientations[ct.crossTileID]=yn),mr};fo((()=>Ri(bs,d.ah.horizontal)),(()=>{const fi=dt.verticalTextBox;return u.allowVerticalPlacement&&ct.numVerticalGlyphVertices>0&&fi?Ri(fi,d.ah.vertical):{box:null,offscreen:null}})),Bn(Qr&&Qr.placeable)}else{let Ri=d.aq[(or=(Gr=this.prevPlacement)===null||Gr===void 0?void 0:Gr.variableOffsets[ct.crossTileID])===null||or===void 0?void 0:or.anchor];const fi=(mr,mo,Ss)=>{const ta=mr.x2-mr.x1,nc=mr.y2-mr.y1,oc=ct.textBoxScale,_i=lt&&be==="never"?mo:null;let ra=null,Cu=ie==="never"?1:2,xl="never";Ri&&Cu++;for(let ks=0;ks<Cu;ks++){for(let wl=ea;wl<Do;wl++){const ka=u.textAnchorOffsets.get(wl);if(Ri&&ka.textAnchor!==Ri)continue;const ei=this.attemptAnchorPlacement(ka,mr,ta,nc,oc,Ue,tt,$,S,C,ae,xl,ct,u,Ss,v,w,_i,zt);if(ei&&(ra=ei.placedGlyphBoxes,ra&&ra.placeable))return dr=!0,ho=ei.shift,ra}Ri?Ri=null:xl=ie}return l&&!ra&&(ra={box:this.collisionIndex.placeCollisionBox(bs,"always",$,S,C,tt,Ue,v,ae.predicate,zt,new d.P(0,0)).box,offscreen:!1,placeable:!1}),ra};fo((()=>fi(bs,dt.iconBox,d.ah.horizontal)),(()=>{const mr=dt.verticalTextBox;return u.allowVerticalPlacement&&(!Qr||!Qr.placeable)&&ct.numVerticalGlyphVertices>0&&mr?fi(mr,dt.verticalIconBox,d.ah.vertical):{box:null,occluded:!0,offscreen:null}})),Qr&&(dr=Qr.placeable,on=Qr.offscreen);const yn=Bn(Qr&&Qr.placeable);if(!dr&&this.prevPlacement){const mr=this.prevPlacement.variableOffsets[ct.crossTileID];mr&&(this.variableOffsets[ct.crossTileID]=mr,this.markUsedJustification(u,mr.anchor,ct,yn))}}}if(ci=Qr,dr=ci&&ci.placeable,on=ci&&ci.offscreen,ct.useRuntimeCollisionCircles){const Bn=u.text.placedSymbolArray.get(ct.centerJustifiedTextSymbolIndex),fo=d.ai(u.textSizeData,te,Bn),ea=p.get("text-padding");Ci=this.collisionIndex.placeCollisionCircles(ie,Bn,u.lineVertexArray,u.glyphOffsetArray,fo,S,C,F,B,l,tt,ae.predicate,ct.collisionCircleDiameter,ea,v,zt),Ci.circles.length&&Ci.collisionDetected&&!l&&d.w("Collisions detected, but collision boxes are not shown"),dr=ve||Ci.circles.length>0&&!Ci.collisionDetected,on=on&&Ci.offscreen}if(dt.iconFeatureIndex&&(Qo=dt.iconFeatureIndex),dt.iconBox){const Bn=fo=>this.collisionIndex.placeCollisionBox(fo,be,$,S,C,tt,Ue,w,ae.predicate,zt,lt&&ho?ho:void 0);Xi&&Xi.placeable&&dt.verticalIconBox?(gn=Bn(dt.verticalIconBox),Yr=gn.placeable):(gn=Bn(dt.iconBox),Yr=gn.placeable),on=on&&gn.offscreen}const po=ue||ct.numHorizontalGlyphVertices===0&&ct.numVerticalGlyphVertices===0,Ao=me||ct.numIconVertices===0;po||Ao?Ao?po||(Yr=Yr&&dr):dr=Yr&&dr:Yr=dr=Yr&&dr;const Sa=Yr&&gn.placeable;if(dr&&ci.placeable&&this.collisionIndex.insertCollisionBox(ci.box,ie,p.get("text-ignore-placement"),u.bucketInstanceId,Xi&&Xi.placeable&&Kn?Kn:Yo,ae.ID),Sa&&this.collisionIndex.insertCollisionBox(gn.box,be,p.get("icon-ignore-placement"),u.bucketInstanceId,Qo,ae.ID),Ci&&dr&&this.collisionIndex.insertCollisionCircles(Ci.circles,ie,p.get("text-ignore-placement"),u.bucketInstanceId,Yo,ae.ID),l&&this.storeCollisionData(u.bucketInstanceId,Wt,dt,ci,gn,Ci),ct.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(u.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[ct.crossTileID]=new hr(dr||ut,Yr||ot,on||u.justReloaded),o[ct.crossTileID]=!0};if(gt){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const ct=u.getSortedSymbolIndexes(this.transform.angle);for(let dt=ct.length-1;dt>=0;--dt){const Wt=ct[dt];Jt(u.symbolInstances.get(Wt),u.collisionArrays[Wt],Wt)}}else for(let ct=e.symbolInstanceStart;ct<e.symbolInstanceEnd;ct++)Jt(u.symbolInstances.get(ct),u.collisionArrays[ct],ct);if(l&&u.bucketInstanceId in this.collisionCircleArrays){const ct=this.collisionCircleArrays[u.bucketInstanceId];d.as(ct.invProjMatrix,S),ct.viewportMatrix=this.collisionIndex.getViewportMatrix()}u.justReloaded=!1}storeCollisionData(e,o,l,u,p,v){if(l.textBox||l.iconBox){let w,S;this.collisionBoxArrays.has(e)?w=this.collisionBoxArrays.get(e):(w=new Map,this.collisionBoxArrays.set(e,w)),w.has(o)?S=w.get(o):(S={text:null,icon:null},w.set(o,S)),l.textBox&&(S.text=u.box),l.iconBox&&(S.icon=p.box)}if(v){let w=this.collisionCircleArrays[e];w===void 0&&(w=this.collisionCircleArrays[e]=new Or);for(let S=0;S<v.circles.length;S+=4)w.circles.push(v.circles[S+0]),w.circles.push(v.circles[S+1]),w.circles.push(v.circles[S+2]),w.circles.push(v.collisionDetected?1:0)}}markUsedJustification(e,o,l,u){let p;p=u===d.ah.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[d.at(o)];const v=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];for(const w of v)w>=0&&(e.text.placedSymbolArray.get(w).crossTileID=p>=0&&w!==p?0:l.crossTileID)}markUsedOrientation(e,o,l){const u=o===d.ah.horizontal||o===d.ah.horizontalOnly?o:0,p=o===d.ah.vertical?o:0,v=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];for(const w of v)e.text.placedSymbolArray.get(w).placedOrientation=u;l.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=p)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const o=this.prevPlacement;let l=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;const u=o?o.symbolFadeChange(e):1,p=o?o.opacities:{},v=o?o.variableOffsets:{},w=o?o.placedOrientations:{};for(const S in this.placements){const C=this.placements[S],F=p[S];F?(this.opacities[S]=new Xr(F,u,C.text,C.icon),l=l||C.text!==F.text.placed||C.icon!==F.icon.placed):(this.opacities[S]=new Xr(null,u,C.text,C.icon,C.skipFade),l=l||C.text||C.icon)}for(const S in p){const C=p[S];if(!this.opacities[S]){const F=new Xr(C,u,!1,!1);F.isHidden()||(this.opacities[S]=F,l=l||C.text.placed||C.icon.placed)}}for(const S in v)this.variableOffsets[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.variableOffsets[S]=v[S]);for(const S in w)this.placedOrientations[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.placedOrientations[S]=w[S]);if(o&&o.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");l?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:e)}updateLayerOpacities(e,o){const l={};for(const u of o){const p=u.getBucket(e);p&&u.latestFeatureIndex&&e.id===p.layerIds[0]&&this.updateBucketOpacities(p,u.tileID,l,u.collisionBoxArray)}}updateBucketOpacities(e,o,l,u){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const p=e.layers[0],v=p.layout,w=new Xr(null,0,!1,!1,!0),S=v.get("text-allow-overlap"),C=v.get("icon-allow-overlap"),F=p._unevaluatedLayout.hasValue("text-variable-anchor")||p._unevaluatedLayout.hasValue("text-variable-anchor-offset"),B=v.get("text-rotation-alignment")==="map",$=v.get("text-pitch-alignment")==="map",K=v.get("icon-text-fit")!=="none",Q=new Xr(null,0,S&&(C||!e.hasIconData()||v.get("icon-optional")),C&&(S||!e.hasTextData()||v.get("text-optional")),!0);!e.collisionArrays&&u&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(u);const te=(ue,me,ie)=>{for(let ve=0;ve<me/4;ve++)ue.opacityVertexArray.emplaceBack(ie);ue.hasVisibleVertices=ue.hasVisibleVertices||ie!==rn},ae=this.collisionBoxArrays.get(e.bucketInstanceId);for(let ue=0;ue<e.symbolInstances.length;ue++){const me=e.symbolInstances.get(ue),{numHorizontalGlyphVertices:ie,numVerticalGlyphVertices:ve,crossTileID:be}=me;let Ie=this.opacities[be];l[be]?Ie=w:Ie||(Ie=Q,this.opacities[be]=Ie),l[be]=!0;const Ue=me.numIconVertices>0,tt=this.placedOrientations[me.crossTileID],lt=tt===d.ah.vertical,gt=tt===d.ah.horizontal||tt===d.ah.horizontalOnly;if(ie>0||ve>0){const ot=Hi(Ie.text);te(e.text,ie,lt?rn:ot),te(e.text,ve,gt?rn:ot);const zt=Ie.text.isHidden();[me.rightJustifiedTextSymbolIndex,me.centerJustifiedTextSymbolIndex,me.leftJustifiedTextSymbolIndex].forEach((dt=>{dt>=0&&(e.text.placedSymbolArray.get(dt).hidden=zt||lt?1:0)})),me.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(me.verticalPlacedTextSymbolIndex).hidden=zt||gt?1:0);const Jt=this.variableOffsets[me.crossTileID];Jt&&this.markUsedJustification(e,Jt.anchor,me,tt);const ct=this.placedOrientations[me.crossTileID];ct&&(this.markUsedJustification(e,"left",me,ct),this.markUsedOrientation(e,ct,me))}if(Ue){const ot=Hi(Ie.icon),zt=!(K&&me.verticalPlacedIconSymbolIndex&&lt);me.placedIconSymbolIndex>=0&&(te(e.icon,me.numIconVertices,zt?ot:rn),e.icon.placedSymbolArray.get(me.placedIconSymbolIndex).hidden=Ie.icon.isHidden()),me.verticalPlacedIconSymbolIndex>=0&&(te(e.icon,me.numVerticalIconVertices,zt?rn:ot),e.icon.placedSymbolArray.get(me.verticalPlacedIconSymbolIndex).hidden=Ie.icon.isHidden())}const ut=ae&&ae.has(ue)?ae.get(ue):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const ot=e.collisionArrays[ue];if(ot){let zt=new d.P(0,0);if(ot.textBox||ot.verticalTextBox){let Jt=!0;if(F){const ct=this.variableOffsets[be];ct?(zt=Pi(ct.anchor,ct.width,ct.height,ct.textOffset,ct.textBoxScale),B&&zt._rotate($?this.transform.angle:-this.transform.angle)):Jt=!1}if(ot.textBox||ot.verticalTextBox){let ct;ot.textBox&&(ct=lt),ot.verticalTextBox&&(ct=gt),Aa(e.textCollisionBox.collisionVertexArray,Ie.text.placed,!Jt||ct,ut.text,zt.x,zt.y)}}if(ot.iconBox||ot.verticalIconBox){const Jt=!!(!gt&&ot.verticalIconBox);let ct;ot.iconBox&&(ct=Jt),ot.verticalIconBox&&(ct=!Jt),Aa(e.iconCollisionBox.collisionVertexArray,Ie.icon.placed,ct,ut.icon,K?zt.x:0,K?zt.y:0)}}}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);if(e.bucketInstanceId in this.collisionCircleArrays){const ue=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=ue.invProjMatrix,e.placementViewportMatrix=ue.viewportMatrix,e.collisionCircleArray=ue.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,o){const l=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*l>e}setStale(){this.stale=!0}}function Aa(f,e,o,l,u,p){l&&l.length!==0||(l=[0,0,0,0]);const v=l[0]-er,w=l[1]-er,S=l[2]-er,C=l[3]-er;f.emplaceBack(e?1:0,o?1:0,u||0,p||0,v,w),f.emplaceBack(e?1:0,o?1:0,u||0,p||0,S,w),f.emplaceBack(e?1:0,o?1:0,u||0,p||0,S,C),f.emplaceBack(e?1:0,o?1:0,u||0,p||0,v,C)}const Xt=Math.pow(2,25),Bl=Math.pow(2,24),hs=Math.pow(2,17),wn=Math.pow(2,16),tn=Math.pow(2,9),Zu=Math.pow(2,8),Dn=Math.pow(2,1);function Hi(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const e=f.placed?1:0,o=Math.floor(127*f.opacity);return o*Xt+e*Bl+o*hs+e*wn+o*tn+e*Zu+o*Dn+e}const rn=0;function $o(){return{isOccluded:(f,e,o)=>!1,getPitchedTextCorrection:(f,e,o)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(f,e,o,l){throw new Error("Not implemented.")},translatePosition:(f,e,o,l)=>(function(u,p,v,w,S=!1){if(!v[0]&&!v[1])return[0,0];const C=S?w==="map"?u.angle:0:w==="viewport"?-u.angle:0;if(C){const F=Math.sin(C),B=Math.cos(C);v=[v[0]*B-v[1]*F,v[0]*F+v[1]*B]}return[S?v[0]:ir(p,v[0],u.zoom),S?v[1]:ir(p,v[1],u.zoom)]})(f,e,o,l),getCircleRadiusCorrection:f=>1}}class Vr{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,o,l,u,p){const v=this._bucketParts;for(;this._currentTileIndex<e.length;)if(o.getBucketParts(v,u,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,p())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,v.sort(((w,S)=>w.sortKey-S.sortKey)));this._currentPartIndex<v.length;)if(o.placeLayerBucketPart(v[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,p())return!0;return!1}}class As{constructor(e,o,l,u,p,v,w,S){this.placement=new ji(e,$o(),o,v,w,S),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=u,this._showCollisionBoxes=p,this._done=!1}isDone(){return this._done}continuePlacement(e,o,l){const u=re.now(),p=()=>!this._forceFullPlacement&&re.now()-u>2;for(;this._currentPlacementIndex>=0;){const v=o[e[this._currentPlacementIndex]],w=this.placement.collisionIndex.transform.zoom;if(v.type==="symbol"&&(!v.minzoom||v.minzoom<=w)&&(!v.maxzoom||v.maxzoom>w)){if(this._inProgressLayer||(this._inProgressLayer=new Vr(v)),this._inProgressLayer.continuePlacement(l[v.source],this.placement,this._showCollisionBoxes,v,p))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const lo=512/d.X/2;class Nr{constructor(e,o,l){this.tileID=e,this.bucketInstanceId=l,this._symbolsByKey={};const u=new Map;for(let p=0;p<o.length;p++){const v=o.get(p),w=v.key,S=u.get(w);S?S.push(v):u.set(w,[v])}for(const[p,v]of u){const w={positions:v.map((S=>({x:Math.floor(S.anchorX*lo),y:Math.floor(S.anchorY*lo)}))),crossTileIDs:v.map((S=>S.crossTileID))};if(w.positions.length>128){const S=new d.av(w.positions.length,16,Uint16Array);for(const{x:C,y:F}of w.positions)S.add(C,F);S.finish(),delete w.positions,w.index=S}this._symbolsByKey[p]=w}}getScaledCoordinates(e,o){const{x:l,y:u,z:p}=this.tileID.canonical,{x:v,y:w,z:S}=o.canonical,C=lo/Math.pow(2,S-p),F=(w*d.X+e.anchorY)*C,B=u*d.X*lo;return{x:Math.floor((v*d.X+e.anchorX)*C-l*d.X*lo),y:Math.floor(F-B)}}findMatches(e,o,l){const u=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z);for(let p=0;p<e.length;p++){const v=e.get(p);if(v.crossTileID)continue;const w=this._symbolsByKey[v.key];if(!w)continue;const S=this.getScaledCoordinates(v,o);if(w.index){const C=w.index.range(S.x-u,S.y-u,S.x+u,S.y+u).sort();for(const F of C){const B=w.crossTileIDs[F];if(!l[B]){l[B]=!0,v.crossTileID=B;break}}}else if(w.positions)for(let C=0;C<w.positions.length;C++){const F=w.positions[C],B=w.crossTileIDs[C];if(Math.abs(F.x-S.x)<=u&&Math.abs(F.y-S.y)<=u&&!l[B]){l[B]=!0,v.crossTileID=B;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:e})=>e))}}class Zo{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class un{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const o=Math.round((e-this.lng)/360);if(o!==0)for(const l in this.indexes){const u=this.indexes[l],p={};for(const v in u){const w=u[v];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+o),p[w.tileID.key]=w}this.indexes[l]=p}this.lng=e}addBucket(e,o,l){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let p=0;p<o.symbolInstances.length;p++)o.symbolInstances.get(p).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const u=this.usedCrossTileIDs[e.overscaledZ];for(const p in this.indexes){const v=this.indexes[p];if(Number(p)>e.overscaledZ)for(const w in v){const S=v[w];S.tileID.isChildOf(e)&&S.findMatches(o.symbolInstances,e,u)}else{const w=v[e.scaledTo(Number(p)).key];w&&w.findMatches(o.symbolInstances,e,u)}}for(let p=0;p<o.symbolInstances.length;p++){const v=o.symbolInstances.get(p);v.crossTileID||(v.crossTileID=l.generate(),u[v.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Nr(e,o.symbolInstances,o.bucketInstanceId),!0}removeBucketCrossTileIDs(e,o){for(const l of o.getCrossTileIDsLists())for(const u of l)delete this.usedCrossTileIDs[e][u]}removeStaleBuckets(e){let o=!1;for(const l in this.indexes){const u=this.indexes[l];for(const p in u)e[u[p].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,u[p]),delete u[p],o=!0)}return o}}class Da{constructor(){this.layerIndexes={},this.crossTileIDs=new Zo,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,o,l){let u=this.layerIndexes[e.id];u===void 0&&(u=this.layerIndexes[e.id]=new un);let p=!1;const v={};u.handleWrapJump(l);for(const w of o){const S=w.getBucket(e);S&&e.id===S.layerIds[0]&&(S.bucketInstanceId||(S.bucketInstanceId=++this.maxBucketInstanceId),u.addBucket(w.tileID,S,this.crossTileIDs)&&(p=!0),v[S.bucketInstanceId]=!0)}return u.removeStaleBuckets(v)&&(p=!0),p}pruneUnusedLayers(e){const o={};e.forEach((l=>{o[l]=!0}));for(const l in this.layerIndexes)o[l]||delete this.layerIndexes[l]}}const cn=(f,e)=>d.t(f,e&&e.filter((o=>o.identifier!=="source.canvas"))),Ol=d.aw();class La extends d.E{constructor(e,o={}){super(),this._rtlPluginLoaded=()=>{for(const l in this.sourceCaches){const u=this.sourceCaches[l].getSource().type;u!=="vector"&&u!=="geojson"||this.sourceCaches[l].reload()}},this.map=e,this.dispatcher=new bi(Ar(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",((l,u)=>this.getGlyphs(l,u))),this.dispatcher.registerMessageHandler("GI",((l,u)=>this.getImages(l,u))),this.imageManager=new kr,this.imageManager.setEventedParent(this),this.glyphManager=new wr(e._requestManager,o.localIdeographFontFamily),this.lineAtlas=new Gt(256,512),this.crossTileSymbolIndex=new Da,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new d.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",d.ay()),fr().on(rt,this._rtlPluginLoaded),this.on("data",(l=>{if(l.dataType!=="source"||l.sourceDataType!=="metadata")return;const u=this.sourceCaches[l.sourceId];if(!u)return;const p=u.getSource();if(p&&p.vectorLayerIds)for(const v in this._layers){const w=this._layers[v];w.source===p.id&&this._validateLayer(w)}}))}loadURL(e,o={},l){this.fire(new d.k("dataloading",{dataType:"style"})),o.validate=typeof o.validate!="boolean"||o.validate;const u=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const p=this._loadStyleRequest;d.h(u,this._loadStyleRequest).then((v=>{this._loadStyleRequest=null,this._load(v.data,o,l)})).catch((v=>{this._loadStyleRequest=null,v&&!p.signal.aborted&&this.fire(new d.j(v))}))}loadJSON(e,o={},l){this.fire(new d.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,re.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,o.validate=o.validate!==!1,this._load(e,o,l)})).catch((()=>{}))}loadEmpty(){this.fire(new d.k("dataloading",{dataType:"style"})),this._load(Ol,{validate:!1})}_load(e,o,l){var u;const p=o.transformStyle?o.transformStyle(l,e):e;if(!o.validate||!cn(this,d.u(p))){this._loaded=!0,this.stylesheet=p;for(const v in p.sources)this.addSource(v,p.sources[v],{validate:!1});p.sprite?this._loadSprite(p.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(p.glyphs),this._createLayers(),this.light=new xt(this.stylesheet.light),this.sky=new He(this.stylesheet.sky),this.map.setTerrain((u=this.stylesheet.terrain)!==null&&u!==void 0?u:null),this.fire(new d.k("data",{dataType:"style"})),this.fire(new d.k("style.load"))}}_createLayers(){const e=d.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map((o=>o.id)),this._layers={},this._serializedLayers=null;for(const o of e){const l=d.aA(o);l.setEventedParent(this,{layer:{id:o.id}}),this._layers[o.id]=l}}_loadSprite(e,o=!1,l=void 0){let u;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,(function(p,v,w,S){return d._(this,void 0,void 0,(function*(){const C=xr(p),F=w>1?"@2x":"",B={},$={};for(const{id:K,url:Q}of C){const te=v.transformRequest(Br(Q,F,".json"),"SpriteJSON");B[K]=d.h(te,S);const ae=v.transformRequest(Br(Q,F,".png"),"SpriteImage");$[K]=St.getImage(ae,S)}return yield Promise.all([...Object.values(B),...Object.values($)]),(function(K,Q){return d._(this,void 0,void 0,(function*(){const te={};for(const ae in K){te[ae]={};const ue=re.getImageCanvasContext((yield Q[ae]).data),me=(yield K[ae]).data;for(const ie in me){const{width:ve,height:be,x:Ie,y:Ue,sdf:tt,pixelRatio:lt,stretchX:gt,stretchY:ut,content:ot,textFitWidth:zt,textFitHeight:Jt}=me[ie];te[ae][ie]={data:null,pixelRatio:lt,sdf:tt,stretchX:gt,stretchY:ut,content:ot,textFitWidth:zt,textFitHeight:Jt,spriteData:{width:ve,height:be,x:Ie,y:Ue,context:ue}}}}return te}))})(B,$)}))})(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((p=>{if(this._spriteRequest=null,p)for(const v in p){this._spritesImagesIds[v]=[];const w=this._spritesImagesIds[v]?this._spritesImagesIds[v].filter((S=>!(S in p))):[];for(const S of w)this.imageManager.removeImage(S),this._changedImages[S]=!0;for(const S in p[v]){const C=v==="default"?S:`${v}:${S}`;this._spritesImagesIds[v].push(C),C in this.imageManager.images?this.imageManager.updateImage(C,p[v][S],!1):this.imageManager.addImage(C,p[v][S]),o&&(this._changedImages[C]=!0)}}})).catch((p=>{this._spriteRequest=null,u=p,this.fire(new d.j(u))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),o&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"})),l&&l(u)}))}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"}))}_validateLayer(e){const o=this.sourceCaches[e.source];if(!o)return;const l=e.sourceLayer;if(!l)return;const u=o.getSource();(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(l)===-1)&&this.fire(new d.j(new Error(`Source layer "${l}" does not exist on source "${u.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,o=!1){const l=this._serializedAllLayers();if(!e||e.length===0)return Object.values(o?d.aB(l):l);const u=[];for(const p of e)if(l[p]){const v=o?d.aB(l[p]):l[p];u.push(v)}return u}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const o=Object.keys(this._layers);for(const l of o){const u=this._layers[l];u.type!=="custom"&&(e[l]=u.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(const e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const o=this._changed;if(o){const u=Object.keys(this._updatedLayers),p=Object.keys(this._removedLayers);(u.length||p.length)&&this._updateWorkerLayers(u,p);for(const v in this._updatedSources){const w=this._updatedSources[v];if(w==="reload")this._reloadSource(v);else{if(w!=="clear")throw new Error(`Invalid action ${w}`);this._clearSource(v)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const v in this._updatedPaintProps)this._layers[v].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const l={};for(const u in this.sourceCaches){const p=this.sourceCaches[u];l[u]=p.used,p.used=!1}for(const u of this._order){const p=this._layers[u];p.recalculate(e,this._availableImages),!p.isHidden(e.zoom)&&p.source&&(this.sourceCaches[p.source].used=!0)}for(const u in l){const p=this.sourceCaches[u];!!l[u]!=!!p.used&&p.fire(new d.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:u}))}this.light.recalculate(e),this.sky.recalculate(e),this.z=e.zoom,o&&this.fire(new d.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,o){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:o})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,o={}){var l;this._checkLoaded();const u=this.serialize();if(e=o.transformStyle?o.transformStyle(u,e):e,((l=o.validate)===null||l===void 0||l)&&cn(this,d.u(e)))return!1;(e=d.aB(e)).layers=d.az(e.layers);const p=d.aC(u,e),v=this._getOperationsToPerform(p);if(v.unimplemented.length>0)throw new Error(`Unimplemented: ${v.unimplemented.join(", ")}.`);if(v.operations.length===0)return!1;for(const w of v.operations)w();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const o=[],l=[];for(const u of e)switch(u.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":o.push((()=>this.addLayer.apply(this,u.args)));break;case"removeLayer":o.push((()=>this.removeLayer.apply(this,u.args)));break;case"setPaintProperty":o.push((()=>this.setPaintProperty.apply(this,u.args)));break;case"setLayoutProperty":o.push((()=>this.setLayoutProperty.apply(this,u.args)));break;case"setFilter":o.push((()=>this.setFilter.apply(this,u.args)));break;case"addSource":o.push((()=>this.addSource.apply(this,u.args)));break;case"removeSource":o.push((()=>this.removeSource.apply(this,u.args)));break;case"setLayerZoomRange":o.push((()=>this.setLayerZoomRange.apply(this,u.args)));break;case"setLight":o.push((()=>this.setLight.apply(this,u.args)));break;case"setGeoJSONSourceData":o.push((()=>this.setGeoJSONSourceData.apply(this,u.args)));break;case"setGlyphs":o.push((()=>this.setGlyphs.apply(this,u.args)));break;case"setSprite":o.push((()=>this.setSprite.apply(this,u.args)));break;case"setSky":o.push((()=>this.setSky.apply(this,u.args)));break;case"setTerrain":o.push((()=>this.map.setTerrain.apply(this,u.args)));break;case"setTransition":o.push((()=>{}));break;default:l.push(u.command)}return{operations:o,unimplemented:l}}addImage(e,o){if(this.getImage(e))return this.fire(new d.j(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,o),this._afterImageUpdated(e)}updateImage(e,o){this.imageManager.updateImage(e,o)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new d.j(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,o,l={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!o.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(o).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(o.type)>=0&&this._validate(d.u.source,`sources.${e}`,o,null,l))return;this.map&&this.map._collectResourceTiming&&(o.collectResourceTiming=!0);const u=this.sourceCaches[e]=new Zt(e,o,this.dispatcher);u.style=this,u.setEventedParent(this,(()=>({isSourceLoaded:u.loaded(),source:u.serialize(),sourceId:e}))),u.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const l in this._layers)if(this._layers[l].source===e)return this.fire(new d.j(new Error(`Source "${e}" cannot be removed while layer "${l}" is using it.`)));const o=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],o.fire(new d.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),o.setEventedParent(null),o.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,o){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const l=this.sourceCaches[e].getSource();if(l.type!=="geojson")throw new Error(`geojsonSource.type is ${l.type}, which is !== 'geojson`);l.setData(o),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,o,l={}){this._checkLoaded();const u=e.id;if(this.getLayer(u))return void this.fire(new d.j(new Error(`Layer "${u}" already exists on this map.`)));let p;if(e.type==="custom"){if(cn(this,d.aD(e)))return;p=d.aA(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(u,e.source),e=d.aB(e),e=d.e(e,{source:u})),this._validate(d.u.layer,`layers.${u}`,e,{arrayIndex:-1},l))return;p=d.aA(e),this._validateLayer(p),p.setEventedParent(this,{layer:{id:u}})}const v=o?this._order.indexOf(o):this._order.length;if(o&&v===-1)this.fire(new d.j(new Error(`Cannot add layer "${u}" before non-existing layer "${o}".`)));else{if(this._order.splice(v,0,u),this._layerOrderChanged=!0,this._layers[u]=p,this._removedLayers[u]&&p.source&&p.type!=="custom"){const w=this._removedLayers[u];delete this._removedLayers[u],w.type!==p.type?this._updatedSources[p.source]="clear":(this._updatedSources[p.source]="reload",this.sourceCaches[p.source].pause())}this._updateLayer(p),p.onAdd&&p.onAdd(this.map)}}moveLayer(e,o){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new d.j(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===o)return;const l=this._order.indexOf(e);this._order.splice(l,1);const u=o?this._order.indexOf(o):this._order.length;o&&u===-1?this.fire(new d.j(new Error(`Cannot move layer "${e}" before non-existing layer "${o}".`))):(this._order.splice(u,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const o=this._layers[e];if(!o)return void this.fire(new d.j(new Error(`Cannot remove non-existing layer "${e}".`)));o.setEventedParent(null);const l=this._order.indexOf(e);this._order.splice(l,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=o,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],o.onRemove&&o.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,o,l){this._checkLoaded();const u=this.getLayer(e);u?u.minzoom===o&&u.maxzoom===l||(o!=null&&(u.minzoom=o),l!=null&&(u.maxzoom=l),this._updateLayer(u)):this.fire(new d.j(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,o,l={}){this._checkLoaded();const u=this.getLayer(e);if(u){if(!d.aE(u.filter,o))return o==null?(u.filter=void 0,void this._updateLayer(u)):void(this._validate(d.u.filter,`layers.${u.id}.filter`,o,null,l)||(u.filter=d.aB(o),this._updateLayer(u)))}else this.fire(new d.j(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return d.aB(this.getLayer(e).filter)}setLayoutProperty(e,o,l,u={}){this._checkLoaded();const p=this.getLayer(e);p?d.aE(p.getLayoutProperty(o),l)||(p.setLayoutProperty(o,l,u),this._updateLayer(p)):this.fire(new d.j(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,o){const l=this.getLayer(e);if(l)return l.getLayoutProperty(o);this.fire(new d.j(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,o,l,u={}){this._checkLoaded();const p=this.getLayer(e);p?d.aE(p.getPaintProperty(o),l)||(p.setPaintProperty(o,l,u)&&this._updateLayer(p),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new d.j(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,o){return this.getLayer(e).getPaintProperty(o)}setFeatureState(e,o){this._checkLoaded();const l=e.source,u=e.sourceLayer,p=this.sourceCaches[l];if(p===void 0)return void this.fire(new d.j(new Error(`The source '${l}' does not exist in the map's style.`)));const v=p.getSource().type;v==="geojson"&&u?this.fire(new d.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):v!=="vector"||u?(e.id===void 0&&this.fire(new d.j(new Error("The feature id parameter must be provided."))),p.setFeatureState(u,e.id,o)):this.fire(new d.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,o){this._checkLoaded();const l=e.source,u=this.sourceCaches[l];if(u===void 0)return void this.fire(new d.j(new Error(`The source '${l}' does not exist in the map's style.`)));const p=u.getSource().type,v=p==="vector"?e.sourceLayer:void 0;p!=="vector"||v?o&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new d.j(new Error("A feature id is required to remove its specific state property."))):u.removeFeatureState(v,e.id,o):this.fire(new d.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const o=e.source,l=e.sourceLayer,u=this.sourceCaches[o];if(u!==void 0)return u.getSource().type!=="vector"||l?(e.id===void 0&&this.fire(new d.j(new Error("The feature id parameter must be provided."))),u.getFeatureState(l,e.id)):void this.fire(new d.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new d.j(new Error(`The source '${o}' does not exist in the map's style.`)))}getTransition(){return d.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=d.aF(this.sourceCaches,(p=>p.serialize())),o=this._serializeByIds(this._order,!0),l=this.map.getTerrain()||void 0,u=this.stylesheet;return d.aG({version:u.version,name:u.name,metadata:u.metadata,light:u.light,sky:u.sky,center:u.center,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch,sprite:u.sprite,glyphs:u.glyphs,transition:u.transition,sources:e,layers:o,terrain:l},(p=>p!==void 0))}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const o=v=>this._layers[v].type==="fill-extrusion",l={},u=[];for(let v=this._order.length-1;v>=0;v--){const w=this._order[v];if(o(w)){l[w]=v;for(const S of e){const C=S[w];if(C)for(const F of C)u.push(F)}}}u.sort(((v,w)=>w.intersectionZ-v.intersectionZ));const p=[];for(let v=this._order.length-1;v>=0;v--){const w=this._order[v];if(o(w))for(let S=u.length-1;S>=0;S--){const C=u[S].feature;if(l[C.layer.id]<v)break;p.push(C),u.pop()}else for(const S of e){const C=S[w];if(C)for(const F of C)p.push(F.feature)}}return p}queryRenderedFeatures(e,o,l){o&&o.filter&&this._validate(d.u.filter,"queryRenderedFeatures.filter",o.filter,null,o);const u={};if(o&&o.layers){if(!Array.isArray(o.layers))return this.fire(new d.j(new Error("parameters.layers must be an Array."))),[];for(const w of o.layers){const S=this._layers[w];if(!S)return this.fire(new d.j(new Error(`The layer '${w}' does not exist in the map's style and cannot be queried for features.`))),[];u[S.source]=!0}}const p=[];o.availableImages=this._availableImages;const v=this._serializedAllLayers();for(const w in this.sourceCaches)o.layers&&!u[w]||p.push(en(this.sourceCaches[w],this._layers,v,e,o,l));return this.placement&&p.push((function(w,S,C,F,B,$,K){const Q={},te=$.queryRenderedSymbols(F),ae=[];for(const ue of Object.keys(te).map(Number))ae.push(K[ue]);ae.sort(wo);for(const ue of ae){const me=ue.featureIndex.lookupSymbolFeatures(te[ue.bucketInstanceId],S,ue.bucketIndex,ue.sourceLayerIndex,B.filter,B.layers,B.availableImages,w);for(const ie in me){const ve=Q[ie]=Q[ie]||[],be=me[ie];be.sort(((Ie,Ue)=>{const tt=ue.featureSortOrder;if(tt){const lt=tt.indexOf(Ie.featureIndex);return tt.indexOf(Ue.featureIndex)-lt}return Ue.featureIndex-Ie.featureIndex}));for(const Ie of be)ve.push(Ie)}}for(const ue in Q)Q[ue].forEach((me=>{const ie=me.feature,ve=C[w[ue].source].getFeatureState(ie.layer["source-layer"],ie.id);ie.source=ie.layer.source,ie.layer["source-layer"]&&(ie.sourceLayer=ie.layer["source-layer"]),ie.state=ve}));return Q})(this._layers,v,this.sourceCaches,e,o,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(p)}querySourceFeatures(e,o){o&&o.filter&&this._validate(d.u.filter,"querySourceFeatures.filter",o.filter,null,o);const l=this.sourceCaches[e];return l?(function(u,p){const v=u.getRenderableIds().map((C=>u.getTileByID(C))),w=[],S={};for(let C=0;C<v.length;C++){const F=v[C],B=F.tileID.canonical.key;S[B]||(S[B]=!0,F.querySourceFeatures(w,p))}return w})(l,o):[]}getLight(){return this.light.getLight()}setLight(e,o={}){this._checkLoaded();const l=this.light.getLight();let u=!1;for(const v in e)if(!d.aE(e[v],l[v])){u=!0;break}if(!u)return;const p={now:re.now(),transition:d.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,o),this.light.updateTransitions(p)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,o={}){const l=this.getSky();let u=!1;if(!e&&!l)return;if(e&&!l)u=!0;else if(!e&&l)u=!0;else for(const v in e)if(!d.aE(e[v],l[v])){u=!0;break}if(!u)return;const p={now:re.now(),transition:d.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,o),this.sky.updateTransitions(p)}_validate(e,o,l,u,p={}){return(!p||p.validate!==!1)&&cn(this,e.call(d.u,d.e({key:o,style:this.serialize(),value:l,styleSpec:d.v},u)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),fr().off(rt,this._rtlPluginLoaded);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this.sourceCaches){const l=this.sourceCaches[o];l.setEventedParent(null),l.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const o in this.sourceCaches)this.sourceCaches[o].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,o,l,u,p=!1){let v=!1,w=!1;const S={};for(const C of this._order){const F=this._layers[C];if(F.type!=="symbol")continue;if(!S[F.source]){const $=this.sourceCaches[F.source];S[F.source]=$.getRenderableIds(!0).map((K=>$.getTileByID(K))).sort(((K,Q)=>Q.tileID.overscaledZ-K.tileID.overscaledZ||(K.tileID.isLessThan(Q.tileID)?-1:1)))}const B=this.crossTileSymbolIndex.addLayer(F,S[F.source],e.center.lng);v=v||B}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((p=p||this._layerOrderChanged||l===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(re.now(),e.zoom))&&(this.pauseablePlacement=new As(e,this.map.terrain,this._order,p,o,l,u,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,S),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(re.now()),w=!0),v&&this.pauseablePlacement.placement.setStale()),w||v)for(const C of this._order){const F=this._layers[C];F.type==="symbol"&&this.placement.updateLayerOpacities(F,S[F.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(re.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,o){return d._(this,void 0,void 0,(function*(){const l=yield this.imageManager.getImages(o.icons);this._updateTilesForChangedImages();const u=this.sourceCaches[o.source];return u&&u.setDependencies(o.tileID.key,o.type,o.icons),l}))}getGlyphs(e,o){return d._(this,void 0,void 0,(function*(){const l=yield this.glyphManager.getGlyphs(o.stacks),u=this.sourceCaches[o.source];return u&&u.setDependencies(o.tileID.key,o.type,[""]),l}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,o={}){this._checkLoaded(),e&&this._validate(d.u.glyphs,"glyphs",e,null,o)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,o,l={},u){this._checkLoaded();const p=[{id:e,url:o}],v=[...xr(this.stylesheet.sprite),...p];this._validate(d.u.sprite,"sprite",v,null,l)||(this.stylesheet.sprite=v,this._loadSprite(p,!0,u))}removeSprite(e){this._checkLoaded();const o=xr(this.stylesheet.sprite);if(o.find((l=>l.id===e))){if(this._spritesImagesIds[e])for(const l of this._spritesImagesIds[e])this.imageManager.removeImage(l),this._changedImages[l]=!0;o.splice(o.findIndex((l=>l.id===e)),1),this.stylesheet.sprite=o.length>0?o:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"}))}else this.fire(new d.j(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return xr(this.stylesheet.sprite)}setSprite(e,o={},l){this._checkLoaded(),e&&this._validate(d.u.sprite,"sprite",e,null,o)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,l):(this._unloadSprite(),l&&l(null)))}}var Ln=d.Y([{name:"a_pos",type:"Int16",components:2}]);const Un={prelude:Cr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Cr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Cr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Cr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Cr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Cr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:Cr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Cr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Cr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Cr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Cr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Cr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Cr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Cr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Cr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Cr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Cr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Cr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Cr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Cr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Cr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Cr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Cr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Cr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Cr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Cr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Cr("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Cr("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Cr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:Cr("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Cr(f,e){const o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=e.match(/attribute ([\w]+) ([\w]+)/g),u=f.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),p=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),v=p?p.concat(u):u,w={};return{fragmentSource:f=f.replace(o,((S,C,F,B,$)=>(w[$]=!0,C==="define"?`
#ifndef HAS_UNIFORM_u_${$}
varying ${F} ${B} ${$};
#else
uniform ${F} ${B} u_${$};
#endif
`:`
#ifdef HAS_UNIFORM_u_${$}
    ${F} ${B} ${$} = u_${$};
#endif
`))),vertexSource:e=e.replace(o,((S,C,F,B,$)=>{const K=B==="float"?"vec2":"vec4",Q=$.match(/color/)?"color":K;return w[$]?C==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
attribute ${F} ${K} a_${$};
varying ${F} ${B} ${$};
#else
uniform ${F} ${B} u_${$};
#endif
`:Q==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = a_${$};
#else
    ${F} ${B} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = unpack_mix_${Q}(a_${$}, u_${$}_t);
#else
    ${F} ${B} ${$} = u_${$};
#endif
`:C==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
attribute ${F} ${K} a_${$};
#else
uniform ${F} ${B} u_${$};
#endif
`:Q==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${F} ${B} ${$} = a_${$};
#else
    ${F} ${B} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${F} ${B} ${$} = unpack_mix_${Q}(a_${$}, u_${$}_t);
#else
    ${F} ${B} ${$} = u_${$};
#endif
`})),staticAttributes:l,staticUniforms:v}}class Ra{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,o,l,u,p,v,w,S,C){this.context=e;let F=this.boundPaintVertexBuffers.length!==u.length;for(let B=0;!F&&B<u.length;B++)this.boundPaintVertexBuffers[B]!==u[B]&&(F=!0);!this.vao||this.boundProgram!==o||this.boundLayoutVertexBuffer!==l||F||this.boundIndexBuffer!==p||this.boundVertexOffset!==v||this.boundDynamicVertexBuffer!==w||this.boundDynamicVertexBuffer2!==S||this.boundDynamicVertexBuffer3!==C?this.freshBind(o,l,u,p,v,w,S,C):(e.bindVertexArray.set(this.vao),w&&w.bind(),p&&p.dynamicDraw&&p.bind(),S&&S.bind(),C&&C.bind())}freshBind(e,o,l,u,p,v,w,S){const C=e.numAttributes,F=this.context,B=F.gl;this.vao&&this.destroy(),this.vao=F.createVertexArray(),F.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=u,this.boundVertexOffset=p,this.boundDynamicVertexBuffer=v,this.boundDynamicVertexBuffer2=w,this.boundDynamicVertexBuffer3=S,o.enableAttributes(B,e);for(const $ of l)$.enableAttributes(B,e);v&&v.enableAttributes(B,e),w&&w.enableAttributes(B,e),S&&S.enableAttributes(B,e),o.bind(),o.setVertexAttribPointers(B,e,p);for(const $ of l)$.bind(),$.setVertexAttribPointers(B,e,p);v&&(v.bind(),v.setVertexAttribPointers(B,e,p)),u&&u.bind(),w&&(w.bind(),w.setVertexAttribPointers(B,e,p)),S&&(S.bind(),S.setVertexAttribPointers(B,e,p)),F.currentNumAttributes=C}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const ca=(f,e,o,l,u)=>({u_matrix:f,u_texture:0,u_ele_delta:e,u_fog_matrix:o,u_fog_color:l?l.properties.get("fog-color"):d.aM.white,u_fog_ground_blend:l?l.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:l?l.calculateFogBlendOpacity(u):0,u_horizon_color:l?l.properties.get("horizon-color"):d.aM.white,u_horizon_fog_blend:l?l.properties.get("horizon-fog-blend"):1});function ha(f){const e=[];for(let o=0;o<f.length;o++){if(f[o]===null)continue;const l=f[o].split(" ");e.push(l.pop())}return e}class jr{constructor(e,o,l,u,p,v){const w=e.gl;this.program=w.createProgram();const S=ha(o.staticAttributes),C=l?l.getBinderAttributes():[],F=S.concat(C),B=Un.prelude.staticUniforms?ha(Un.prelude.staticUniforms):[],$=o.staticUniforms?ha(o.staticUniforms):[],K=l?l.getBinderUniforms():[],Q=B.concat($).concat(K),te=[];for(const Ie of Q)te.indexOf(Ie)<0&&te.push(Ie);const ae=l?l.defines():[];p&&ae.push("#define OVERDRAW_INSPECTOR;"),v&&ae.push("#define TERRAIN3D;");const ue=ae.concat(Un.prelude.fragmentSource,o.fragmentSource).join(`
`),me=ae.concat(Un.prelude.vertexSource,o.vertexSource).join(`
`),ie=w.createShader(w.FRAGMENT_SHADER);if(w.isContextLost())return void(this.failedToCreate=!0);if(w.shaderSource(ie,ue),w.compileShader(ie),!w.getShaderParameter(ie,w.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${w.getShaderInfoLog(ie)}`);w.attachShader(this.program,ie);const ve=w.createShader(w.VERTEX_SHADER);if(w.isContextLost())return void(this.failedToCreate=!0);if(w.shaderSource(ve,me),w.compileShader(ve),!w.getShaderParameter(ve,w.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${w.getShaderInfoLog(ve)}`);w.attachShader(this.program,ve),this.attributes={};const be={};this.numAttributes=F.length;for(let Ie=0;Ie<this.numAttributes;Ie++)F[Ie]&&(w.bindAttribLocation(this.program,Ie,F[Ie]),this.attributes[F[Ie]]=Ie);if(w.linkProgram(this.program),!w.getProgramParameter(this.program,w.LINK_STATUS))throw new Error(`Program failed to link: ${w.getProgramInfoLog(this.program)}`);w.deleteShader(ve),w.deleteShader(ie);for(let Ie=0;Ie<te.length;Ie++){const Ue=te[Ie];if(Ue&&!be[Ue]){const tt=w.getUniformLocation(this.program,Ue);tt&&(be[Ue]=tt)}}this.fixedUniforms=u(e,be),this.terrainUniforms=((Ie,Ue)=>({u_depth:new d.aH(Ie,Ue.u_depth),u_terrain:new d.aH(Ie,Ue.u_terrain),u_terrain_dim:new d.aI(Ie,Ue.u_terrain_dim),u_terrain_matrix:new d.aJ(Ie,Ue.u_terrain_matrix),u_terrain_unpack:new d.aK(Ie,Ue.u_terrain_unpack),u_terrain_exaggeration:new d.aI(Ie,Ue.u_terrain_exaggeration)}))(e,be),this.binderUniforms=l?l.getUniforms(e,be):[]}draw(e,o,l,u,p,v,w,S,C,F,B,$,K,Q,te,ae,ue,me){const ie=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(l),e.setStencilMode(u),e.setColorMode(p),e.setCullFace(v),S){e.activeTexture.set(ie.TEXTURE2),ie.bindTexture(ie.TEXTURE_2D,S.depthTexture),e.activeTexture.set(ie.TEXTURE3),ie.bindTexture(ie.TEXTURE_2D,S.texture);for(const be in this.terrainUniforms)this.terrainUniforms[be].set(S[be])}for(const be in this.fixedUniforms)this.fixedUniforms[be].set(w[be]);te&&te.setUniforms(e,this.binderUniforms,K,{zoom:Q});let ve=0;switch(o){case ie.LINES:ve=2;break;case ie.TRIANGLES:ve=3;break;case ie.LINE_STRIP:ve=1}for(const be of $.get()){const Ie=be.vaos||(be.vaos={});(Ie[C]||(Ie[C]=new Ra)).bind(e,this,F,te?te.getPaintVertexBuffers():[],B,be.vertexOffset,ae,ue,me),ie.drawElements(o,be.primitiveLength*ve,ie.UNSIGNED_SHORT,be.primitiveOffset*ve*2)}}}function Ds(f,e,o){const l=1/ir(o,1,e.transform.tileZoom),u=Math.pow(2,o.tileID.overscaledZ),p=o.tileSize*Math.pow(2,e.transform.tileZoom)/u,v=p*(o.tileID.canonical.x+o.tileID.wrap*u),w=p*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[l,f.fromScale,f.toScale],u_fade:f.t,u_pixel_coord_upper:[v>>16,w>>16],u_pixel_coord_lower:[65535&v,65535&w]}}const Fa=(f,e,o,l)=>{const u=e.style.light,p=u.properties.get("position"),v=[p.x,p.y,p.z],w=(function(){var C=new d.A(9);return d.A!=Float32Array&&(C[1]=0,C[2]=0,C[3]=0,C[5]=0,C[6]=0,C[7]=0),C[0]=1,C[4]=1,C[8]=1,C})();u.properties.get("anchor")==="viewport"&&(function(C,F){var B=Math.sin(F),$=Math.cos(F);C[0]=$,C[1]=B,C[2]=0,C[3]=-B,C[4]=$,C[5]=0,C[6]=0,C[7]=0,C[8]=1})(w,-e.transform.angle),(function(C,F,B){var $=F[0],K=F[1],Q=F[2];C[0]=$*B[0]+K*B[3]+Q*B[6],C[1]=$*B[1]+K*B[4]+Q*B[7],C[2]=$*B[2]+K*B[5]+Q*B[8]})(v,v,w);const S=u.properties.get("color");return{u_matrix:f,u_lightpos:v,u_lightintensity:u.properties.get("intensity"),u_lightcolor:[S.r,S.g,S.b],u_vertical_gradient:+o,u_opacity:l}},ds=(f,e,o,l,u,p,v)=>d.e(Fa(f,e,o,l),Ds(p,e,v),{u_height_factor:-Math.pow(2,u.overscaledZ)/v.tileSize/8}),Ba=f=>({u_matrix:f}),Nl=(f,e,o,l)=>d.e(Ba(f),Ds(o,e,l)),gu=(f,e)=>({u_matrix:f,u_world:e}),Qs=(f,e,o,l,u)=>d.e(Nl(f,e,o,l),{u_world:u}),el=(f,e,o,l)=>{const u=f.transform;let p,v;if(l.paint.get("circle-pitch-alignment")==="map"){const w=ir(o,1,u.zoom);p=!0,v=[w,w]}else p=!1,v=u.pixelsToGLUnits;return{u_camera_to_center_distance:u.cameraToCenterDistance,u_scale_with_map:+(l.paint.get("circle-pitch-scale")==="map"),u_matrix:f.translatePosMatrix(e.posMatrix,o,l.paint.get("circle-translate"),l.paint.get("circle-translate-anchor")),u_pitch_with_map:+p,u_device_pixel_ratio:f.pixelRatio,u_extrude_scale:v}},bn=(f,e,o)=>({u_matrix:f,u_inv_matrix:e,u_camera_to_center_distance:o.cameraToCenterDistance,u_viewport_size:[o.width,o.height]}),$n=(f,e,o=1)=>({u_matrix:f,u_color:e,u_overlay:0,u_overlay_scale:o}),ki=f=>({u_matrix:f}),Vi=(f,e,o,l)=>({u_matrix:f,u_extrude_scale:ir(e,1,o),u_intensity:l}),da=(f,e,o,l)=>{const u=d.H();d.aP(u,0,f.width,f.height,0,0,1);const p=f.context.gl;return{u_matrix:u,u_world:[p.drawingBufferWidth,p.drawingBufferHeight],u_image:o,u_color_ramp:l,u_opacity:e.paint.get("heatmap-opacity")}};function nn(f,e){const o=Math.pow(2,e.canonical.z),l=e.canonical.y;return[new d.Z(0,l/o).toLngLat().lat,new d.Z(0,(l+1)/o).toLngLat().lat]}const tl=(f,e,o,l)=>{const u=f.transform;return{u_matrix:ps(f,e,o,l),u_ratio:1/ir(e,1,u.zoom),u_device_pixel_ratio:f.pixelRatio,u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]]}},jl=(f,e,o,l,u)=>d.e(tl(f,e,o,u),{u_image:0,u_image_height:l}),To=(f,e,o,l,u)=>{const p=f.transform,v=Ls(e,p);return{u_matrix:ps(f,e,o,u),u_texsize:e.imageAtlasTexture.size,u_ratio:1/ir(e,1,p.zoom),u_device_pixel_ratio:f.pixelRatio,u_image:0,u_scale:[v,l.fromScale,l.toScale],u_fade:l.t,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},qu=(f,e,o,l,u,p)=>{const v=f.lineAtlas,w=Ls(e,f.transform),S=o.layout.get("line-cap")==="round",C=v.getDash(l.from,S),F=v.getDash(l.to,S),B=C.width*u.fromScale,$=F.width*u.toScale;return d.e(tl(f,e,o,p),{u_patternscale_a:[w/B,-C.height/2],u_patternscale_b:[w/$,-F.height/2],u_sdfgamma:v.width/(256*Math.min(B,$)*f.pixelRatio)/2,u_image:0,u_tex_y_a:C.y,u_tex_y_b:F.y,u_mix:u.t})};function Ls(f,e){return 1/ir(f,1,e.tileZoom)}function ps(f,e,o,l){return f.translatePosMatrix(l?l.posMatrix:e.tileID.posMatrix,e,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const yu=(f,e,o,l,u)=>{return{u_matrix:f,u_tl_parent:e,u_scale_parent:o,u_buffer_scale:1,u_fade_t:l.mix,u_opacity:l.opacity*u.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:u.paint.get("raster-brightness-min"),u_brightness_high:u.paint.get("raster-brightness-max"),u_saturation_factor:(v=u.paint.get("raster-saturation"),v>0?1-1/(1.001-v):-v),u_contrast_factor:(p=u.paint.get("raster-contrast"),p>0?1/(1-p):1+p),u_spin_weights:Gu(u.paint.get("raster-hue-rotate"))};var p,v};function Gu(f){f*=Math.PI/180;const e=Math.sin(f),o=Math.cos(f);return[(2*o+1)/3,(-Math.sqrt(3)*e-o+1)/3,(Math.sqrt(3)*e-o+1)/3]}const Sn=(f,e,o,l,u,p,v,w,S,C,F,B,$,K)=>{const Q=v.transform;return{u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:Q.cameraToCenterDistance,u_pitch:Q.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:Q.width/Q.height,u_fade_change:v.options.fadeDuration?v.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:S,u_coord_matrix:C,u_is_text:+B,u_pitch_with_map:+l,u_is_along_line:u,u_is_variable_anchor:p,u_texsize:$,u_texture:0,u_translation:F,u_pitched_scale:K}},qo=(f,e,o,l,u,p,v,w,S,C,F,B,$,K,Q)=>{const te=v.transform;return d.e(Sn(f,e,o,l,u,p,v,w,S,C,F,B,$,Q),{u_gamma_scale:l?Math.cos(te._pitch)*te.cameraToCenterDistance:1,u_device_pixel_ratio:v.pixelRatio,u_is_halo:1})},pa=(f,e,o,l,u,p,v,w,S,C,F,B,$,K)=>d.e(qo(f,e,o,l,u,p,v,w,S,C,F,!0,B,!0,K),{u_texsize_icon:$,u_texture_icon:1}),fa=(f,e,o)=>({u_matrix:f,u_opacity:e,u_color:o}),Vl=(f,e,o,l,u,p)=>d.e((function(v,w,S,C){const F=S.imageManager.getPattern(v.from.toString()),B=S.imageManager.getPattern(v.to.toString()),{width:$,height:K}=S.imageManager.getPixelSize(),Q=Math.pow(2,C.tileID.overscaledZ),te=C.tileSize*Math.pow(2,S.transform.tileZoom)/Q,ae=te*(C.tileID.canonical.x+C.tileID.wrap*Q),ue=te*C.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:F.tl,u_pattern_br_a:F.br,u_pattern_tl_b:B.tl,u_pattern_br_b:B.br,u_texsize:[$,K],u_mix:w.t,u_pattern_size_a:F.displaySize,u_pattern_size_b:B.displaySize,u_scale_a:w.fromScale,u_scale_b:w.toScale,u_tile_units_to_pixels:1/ir(C,1,S.transform.tileZoom),u_pixel_coord_upper:[ae>>16,ue>>16],u_pixel_coord_lower:[65535&ae,65535&ue]}})(l,p,o,u),{u_matrix:f,u_opacity:e}),rl={fillExtrusion:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_lightpos:new d.aN(f,e.u_lightpos),u_lightintensity:new d.aI(f,e.u_lightintensity),u_lightcolor:new d.aN(f,e.u_lightcolor),u_vertical_gradient:new d.aI(f,e.u_vertical_gradient),u_opacity:new d.aI(f,e.u_opacity)}),fillExtrusionPattern:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_lightpos:new d.aN(f,e.u_lightpos),u_lightintensity:new d.aI(f,e.u_lightintensity),u_lightcolor:new d.aN(f,e.u_lightcolor),u_vertical_gradient:new d.aI(f,e.u_vertical_gradient),u_height_factor:new d.aI(f,e.u_height_factor),u_image:new d.aH(f,e.u_image),u_texsize:new d.aO(f,e.u_texsize),u_pixel_coord_upper:new d.aO(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new d.aO(f,e.u_pixel_coord_lower),u_scale:new d.aN(f,e.u_scale),u_fade:new d.aI(f,e.u_fade),u_opacity:new d.aI(f,e.u_opacity)}),fill:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix)}),fillPattern:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_image:new d.aH(f,e.u_image),u_texsize:new d.aO(f,e.u_texsize),u_pixel_coord_upper:new d.aO(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new d.aO(f,e.u_pixel_coord_lower),u_scale:new d.aN(f,e.u_scale),u_fade:new d.aI(f,e.u_fade)}),fillOutline:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_world:new d.aO(f,e.u_world)}),fillOutlinePattern:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_world:new d.aO(f,e.u_world),u_image:new d.aH(f,e.u_image),u_texsize:new d.aO(f,e.u_texsize),u_pixel_coord_upper:new d.aO(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new d.aO(f,e.u_pixel_coord_lower),u_scale:new d.aN(f,e.u_scale),u_fade:new d.aI(f,e.u_fade)}),circle:(f,e)=>({u_camera_to_center_distance:new d.aI(f,e.u_camera_to_center_distance),u_scale_with_map:new d.aH(f,e.u_scale_with_map),u_pitch_with_map:new d.aH(f,e.u_pitch_with_map),u_extrude_scale:new d.aO(f,e.u_extrude_scale),u_device_pixel_ratio:new d.aI(f,e.u_device_pixel_ratio),u_matrix:new d.aJ(f,e.u_matrix)}),collisionBox:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_pixel_extrude_scale:new d.aO(f,e.u_pixel_extrude_scale)}),collisionCircle:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_inv_matrix:new d.aJ(f,e.u_inv_matrix),u_camera_to_center_distance:new d.aI(f,e.u_camera_to_center_distance),u_viewport_size:new d.aO(f,e.u_viewport_size)}),debug:(f,e)=>({u_color:new d.aL(f,e.u_color),u_matrix:new d.aJ(f,e.u_matrix),u_overlay:new d.aH(f,e.u_overlay),u_overlay_scale:new d.aI(f,e.u_overlay_scale)}),clippingMask:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix)}),heatmap:(f,e)=>({u_extrude_scale:new d.aI(f,e.u_extrude_scale),u_intensity:new d.aI(f,e.u_intensity),u_matrix:new d.aJ(f,e.u_matrix)}),heatmapTexture:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_world:new d.aO(f,e.u_world),u_image:new d.aH(f,e.u_image),u_color_ramp:new d.aH(f,e.u_color_ramp),u_opacity:new d.aI(f,e.u_opacity)}),hillshade:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_image:new d.aH(f,e.u_image),u_latrange:new d.aO(f,e.u_latrange),u_light:new d.aO(f,e.u_light),u_shadow:new d.aL(f,e.u_shadow),u_highlight:new d.aL(f,e.u_highlight),u_accent:new d.aL(f,e.u_accent)}),hillshadePrepare:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_image:new d.aH(f,e.u_image),u_dimension:new d.aO(f,e.u_dimension),u_zoom:new d.aI(f,e.u_zoom),u_unpack:new d.aK(f,e.u_unpack)}),line:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_ratio:new d.aI(f,e.u_ratio),u_device_pixel_ratio:new d.aI(f,e.u_device_pixel_ratio),u_units_to_pixels:new d.aO(f,e.u_units_to_pixels)}),lineGradient:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_ratio:new d.aI(f,e.u_ratio),u_device_pixel_ratio:new d.aI(f,e.u_device_pixel_ratio),u_units_to_pixels:new d.aO(f,e.u_units_to_pixels),u_image:new d.aH(f,e.u_image),u_image_height:new d.aI(f,e.u_image_height)}),linePattern:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_texsize:new d.aO(f,e.u_texsize),u_ratio:new d.aI(f,e.u_ratio),u_device_pixel_ratio:new d.aI(f,e.u_device_pixel_ratio),u_image:new d.aH(f,e.u_image),u_units_to_pixels:new d.aO(f,e.u_units_to_pixels),u_scale:new d.aN(f,e.u_scale),u_fade:new d.aI(f,e.u_fade)}),lineSDF:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_ratio:new d.aI(f,e.u_ratio),u_device_pixel_ratio:new d.aI(f,e.u_device_pixel_ratio),u_units_to_pixels:new d.aO(f,e.u_units_to_pixels),u_patternscale_a:new d.aO(f,e.u_patternscale_a),u_patternscale_b:new d.aO(f,e.u_patternscale_b),u_sdfgamma:new d.aI(f,e.u_sdfgamma),u_image:new d.aH(f,e.u_image),u_tex_y_a:new d.aI(f,e.u_tex_y_a),u_tex_y_b:new d.aI(f,e.u_tex_y_b),u_mix:new d.aI(f,e.u_mix)}),raster:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_tl_parent:new d.aO(f,e.u_tl_parent),u_scale_parent:new d.aI(f,e.u_scale_parent),u_buffer_scale:new d.aI(f,e.u_buffer_scale),u_fade_t:new d.aI(f,e.u_fade_t),u_opacity:new d.aI(f,e.u_opacity),u_image0:new d.aH(f,e.u_image0),u_image1:new d.aH(f,e.u_image1),u_brightness_low:new d.aI(f,e.u_brightness_low),u_brightness_high:new d.aI(f,e.u_brightness_high),u_saturation_factor:new d.aI(f,e.u_saturation_factor),u_contrast_factor:new d.aI(f,e.u_contrast_factor),u_spin_weights:new d.aN(f,e.u_spin_weights)}),symbolIcon:(f,e)=>({u_is_size_zoom_constant:new d.aH(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new d.aH(f,e.u_is_size_feature_constant),u_size_t:new d.aI(f,e.u_size_t),u_size:new d.aI(f,e.u_size),u_camera_to_center_distance:new d.aI(f,e.u_camera_to_center_distance),u_pitch:new d.aI(f,e.u_pitch),u_rotate_symbol:new d.aH(f,e.u_rotate_symbol),u_aspect_ratio:new d.aI(f,e.u_aspect_ratio),u_fade_change:new d.aI(f,e.u_fade_change),u_matrix:new d.aJ(f,e.u_matrix),u_label_plane_matrix:new d.aJ(f,e.u_label_plane_matrix),u_coord_matrix:new d.aJ(f,e.u_coord_matrix),u_is_text:new d.aH(f,e.u_is_text),u_pitch_with_map:new d.aH(f,e.u_pitch_with_map),u_is_along_line:new d.aH(f,e.u_is_along_line),u_is_variable_anchor:new d.aH(f,e.u_is_variable_anchor),u_texsize:new d.aO(f,e.u_texsize),u_texture:new d.aH(f,e.u_texture),u_translation:new d.aO(f,e.u_translation),u_pitched_scale:new d.aI(f,e.u_pitched_scale)}),symbolSDF:(f,e)=>({u_is_size_zoom_constant:new d.aH(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new d.aH(f,e.u_is_size_feature_constant),u_size_t:new d.aI(f,e.u_size_t),u_size:new d.aI(f,e.u_size),u_camera_to_center_distance:new d.aI(f,e.u_camera_to_center_distance),u_pitch:new d.aI(f,e.u_pitch),u_rotate_symbol:new d.aH(f,e.u_rotate_symbol),u_aspect_ratio:new d.aI(f,e.u_aspect_ratio),u_fade_change:new d.aI(f,e.u_fade_change),u_matrix:new d.aJ(f,e.u_matrix),u_label_plane_matrix:new d.aJ(f,e.u_label_plane_matrix),u_coord_matrix:new d.aJ(f,e.u_coord_matrix),u_is_text:new d.aH(f,e.u_is_text),u_pitch_with_map:new d.aH(f,e.u_pitch_with_map),u_is_along_line:new d.aH(f,e.u_is_along_line),u_is_variable_anchor:new d.aH(f,e.u_is_variable_anchor),u_texsize:new d.aO(f,e.u_texsize),u_texture:new d.aH(f,e.u_texture),u_gamma_scale:new d.aI(f,e.u_gamma_scale),u_device_pixel_ratio:new d.aI(f,e.u_device_pixel_ratio),u_is_halo:new d.aH(f,e.u_is_halo),u_translation:new d.aO(f,e.u_translation),u_pitched_scale:new d.aI(f,e.u_pitched_scale)}),symbolTextAndIcon:(f,e)=>({u_is_size_zoom_constant:new d.aH(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new d.aH(f,e.u_is_size_feature_constant),u_size_t:new d.aI(f,e.u_size_t),u_size:new d.aI(f,e.u_size),u_camera_to_center_distance:new d.aI(f,e.u_camera_to_center_distance),u_pitch:new d.aI(f,e.u_pitch),u_rotate_symbol:new d.aH(f,e.u_rotate_symbol),u_aspect_ratio:new d.aI(f,e.u_aspect_ratio),u_fade_change:new d.aI(f,e.u_fade_change),u_matrix:new d.aJ(f,e.u_matrix),u_label_plane_matrix:new d.aJ(f,e.u_label_plane_matrix),u_coord_matrix:new d.aJ(f,e.u_coord_matrix),u_is_text:new d.aH(f,e.u_is_text),u_pitch_with_map:new d.aH(f,e.u_pitch_with_map),u_is_along_line:new d.aH(f,e.u_is_along_line),u_is_variable_anchor:new d.aH(f,e.u_is_variable_anchor),u_texsize:new d.aO(f,e.u_texsize),u_texsize_icon:new d.aO(f,e.u_texsize_icon),u_texture:new d.aH(f,e.u_texture),u_texture_icon:new d.aH(f,e.u_texture_icon),u_gamma_scale:new d.aI(f,e.u_gamma_scale),u_device_pixel_ratio:new d.aI(f,e.u_device_pixel_ratio),u_is_halo:new d.aH(f,e.u_is_halo),u_translation:new d.aO(f,e.u_translation),u_pitched_scale:new d.aI(f,e.u_pitched_scale)}),background:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_opacity:new d.aI(f,e.u_opacity),u_color:new d.aL(f,e.u_color)}),backgroundPattern:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_opacity:new d.aI(f,e.u_opacity),u_image:new d.aH(f,e.u_image),u_pattern_tl_a:new d.aO(f,e.u_pattern_tl_a),u_pattern_br_a:new d.aO(f,e.u_pattern_br_a),u_pattern_tl_b:new d.aO(f,e.u_pattern_tl_b),u_pattern_br_b:new d.aO(f,e.u_pattern_br_b),u_texsize:new d.aO(f,e.u_texsize),u_mix:new d.aI(f,e.u_mix),u_pattern_size_a:new d.aO(f,e.u_pattern_size_a),u_pattern_size_b:new d.aO(f,e.u_pattern_size_b),u_scale_a:new d.aI(f,e.u_scale_a),u_scale_b:new d.aI(f,e.u_scale_b),u_pixel_coord_upper:new d.aO(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new d.aO(f,e.u_pixel_coord_lower),u_tile_units_to_pixels:new d.aI(f,e.u_tile_units_to_pixels)}),terrain:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_texture:new d.aH(f,e.u_texture),u_ele_delta:new d.aI(f,e.u_ele_delta),u_fog_matrix:new d.aJ(f,e.u_fog_matrix),u_fog_color:new d.aL(f,e.u_fog_color),u_fog_ground_blend:new d.aI(f,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new d.aI(f,e.u_fog_ground_blend_opacity),u_horizon_color:new d.aL(f,e.u_horizon_color),u_horizon_fog_blend:new d.aI(f,e.u_horizon_fog_blend)}),terrainDepth:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_ele_delta:new d.aI(f,e.u_ele_delta)}),terrainCoords:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_texture:new d.aH(f,e.u_texture),u_terrain_coords_id:new d.aI(f,e.u_terrain_coords_id),u_ele_delta:new d.aI(f,e.u_ele_delta)}),sky:(f,e)=>({u_sky_color:new d.aL(f,e.u_sky_color),u_horizon_color:new d.aL(f,e.u_horizon_color),u_horizon:new d.aI(f,e.u_horizon),u_sky_horizon_blend:new d.aI(f,e.u_sky_horizon_blend)})};class Zn{constructor(e,o,l){this.context=e;const u=e.gl;this.buffer=u.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),u.bufferData(u.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const o=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const il={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Rs{constructor(e,o,l,u){this.length=o.length,this.attributes=l,this.itemSize=o.bytesPerElement,this.dynamicDraw=u,this.context=e;const p=e.gl;this.buffer=p.createBuffer(),e.bindVertexBuffer.set(this.buffer),p.bufferData(p.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,o){for(let l=0;l<this.attributes.length;l++){const u=o.attributes[this.attributes[l].name];u!==void 0&&e.enableVertexAttribArray(u)}}setVertexAttribPointers(e,o,l){for(let u=0;u<this.attributes.length;u++){const p=this.attributes[u],v=o.attributes[p.name];v!==void 0&&e.vertexAttribPointer(v,p.components,e[il[p.type]],!1,this.itemSize,p.offset+this.itemSize*(l||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ma=new WeakMap;function hn(f){var e;if(ma.has(f))return ma.get(f);{const o=(e=f.getParameter(f.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return ma.set(f,o),o}}class Ir{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Oa extends Ir{getDefault(){return d.aM.transparent}set(e){const o=this.current;(e.r!==o.r||e.g!==o.g||e.b!==o.b||e.a!==o.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class N extends Ir{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class z extends Ir{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class M extends Ir{getDefault(){return[!0,!0,!0,!0]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||e[2]!==o[2]||e[3]!==o[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class q extends Ir{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class Y extends Ir{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class pe extends Ir{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const o=this.current;(e.func!==o.func||e.ref!==o.ref||e.mask!==o.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class fe extends Ir{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||e[2]!==o[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Ce extends Ir{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST),this.current=e,this.dirty=!1}}class $e extends Ir{getDefault(){return[0,1]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Ne extends Ir{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST),this.current=e,this.dirty=!1}}class Ke extends Ir{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class We extends Ir{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.BLEND):o.disable(o.BLEND),this.current=e,this.dirty=!1}}class st extends Ir{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class Dr extends Ir{getDefault(){return d.aM.transparent}set(e){const o=this.current;(e.r!==o.r||e.g!==o.g||e.b!==o.b||e.a!==o.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class si extends Ir{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class yr extends Ir{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE),this.current=e,this.dirty=!1}}class Mi extends Ir{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class li extends Ir{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class dn extends Ir{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class Wi extends Ir{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class zo extends Ir{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||e[2]!==o[2]||e[3]!==o[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Ai extends Ir{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindFramebuffer(o.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class Rn extends Ir{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindRenderbuffer(o.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class ii extends Ir{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindTexture(o.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class Na extends Ir{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindBuffer(o.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Ui extends Ir{getDefault(){return null}set(e){const o=this.gl;o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Di extends Ir{getDefault(){return null}set(e){var o;if(e===this.current&&!this.dirty)return;const l=this.gl;hn(l)?l.bindVertexArray(e):(o=l.getExtension("OES_vertex_array_object"))===null||o===void 0||o.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class Li extends Ir{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class uo extends Ir{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class kn extends Ir{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class qn extends Ir{constructor(e,o){super(e),this.context=e,this.parent=o}getDefault(){return null}}class ga extends qn{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class $i extends qn{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Gn extends qn{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Eo{constructor(e,o,l,u,p){this.context=e,this.width=o,this.height=l;const v=e.gl,w=this.framebuffer=v.createFramebuffer();if(this.colorAttachment=new ga(e,w),u)this.depthAttachment=p?new Gn(e,w):new $i(e,w);else if(p)throw new Error("Stencil cannot be set without depth");if(v.checkFramebufferStatus(v.FRAMEBUFFER)!==v.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const e=this.context.gl,o=this.colorAttachment.get();if(o&&e.deleteTexture(o),this.depthAttachment){const l=this.depthAttachment.get();l&&e.deleteRenderbuffer(l)}e.deleteFramebuffer(this.framebuffer)}}class nr{constructor(e,o,l){this.blendFunction=e,this.blendColor=o,this.mask=l}}nr.Replace=[1,0],nr.disabled=new nr(nr.Replace,d.aM.transparent,[!1,!1,!1,!1]),nr.unblended=new nr(nr.Replace,d.aM.transparent,[!0,!0,!0,!0]),nr.alphaBlended=new nr([1,771],d.aM.transparent,[!0,!0,!0,!0]);class fs{constructor(e){var o,l;if(this.gl=e,this.clearColor=new Oa(this),this.clearDepth=new N(this),this.clearStencil=new z(this),this.colorMask=new M(this),this.depthMask=new q(this),this.stencilMask=new Y(this),this.stencilFunc=new pe(this),this.stencilOp=new fe(this),this.stencilTest=new Ce(this),this.depthRange=new $e(this),this.depthTest=new Ne(this),this.depthFunc=new Ke(this),this.blend=new We(this),this.blendFunc=new st(this),this.blendColor=new Dr(this),this.blendEquation=new si(this),this.cullFace=new yr(this),this.cullFaceSide=new Mi(this),this.frontFace=new li(this),this.program=new dn(this),this.activeTexture=new Wi(this),this.viewport=new zo(this),this.bindFramebuffer=new Ai(this),this.bindRenderbuffer=new Rn(this),this.bindTexture=new ii(this),this.bindVertexBuffer=new Na(this),this.bindElementBuffer=new Ui(this),this.bindVertexArray=new Di(this),this.pixelStoreUnpack=new Li(this),this.pixelStoreUnpackPremultiplyAlpha=new uo(this),this.pixelStoreUnpackFlipY=new kn(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),hn(e)){this.HALF_FLOAT=e.HALF_FLOAT;const u=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(o=e.RGBA16F)!==null&&o!==void 0?o:u?.RGBA16F_EXT,this.RGB16F=(l=e.RGB16F)!==null&&l!==void 0?l:u?.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const u=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=u?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,o){return new Zn(this,e,o)}createVertexBuffer(e,o,l){return new Rs(this,e,o,l)}createRenderbuffer(e,o,l){const u=this.gl,p=u.createRenderbuffer();return this.bindRenderbuffer.set(p),u.renderbufferStorage(u.RENDERBUFFER,e,o,l),this.bindRenderbuffer.set(null),p}createFramebuffer(e,o,l,u){return new Eo(this,e,o,l,u)}clear({color:e,depth:o,stencil:l}){const u=this.gl;let p=0;e&&(p|=u.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(p|=u.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),l!==void 0&&(p|=u.STENCIL_BUFFER_BIT,this.clearStencil.set(l),this.stencilMask.set(255)),u.clear(p)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){d.aE(e.blendFunction,nr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return hn(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var o;return hn(this.gl)?this.gl.deleteVertexArray(e):(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}class Kt{constructor(e,o,l){this.func=e,this.mask=o,this.range=l}}Kt.ReadOnly=!1,Kt.ReadWrite=!0,Kt.disabled=new Kt(519,Kt.ReadOnly,[0,1]);const ms=7680;class Lr{constructor(e,o,l,u,p,v){this.test=e,this.ref=o,this.mask=l,this.fail=u,this.depthFail=p,this.pass=v}}Lr.disabled=new Lr({func:519,mask:0},0,0,ms,ms,ms);class Rr{constructor(e,o,l){this.enable=e,this.mode=o,this.frontFace=l}}let pn;function ja(f,e,o,l,u){const p=f.context,v=p.gl,w=f.useProgram("collisionBox"),S=[];let C=0,F=0;for(let ue=0;ue<l.length;ue++){const me=l[ue],ie=e.getTile(me).getBucket(o);if(!ie)continue;const ve=u?ie.textCollisionBox:ie.iconCollisionBox,be=ie.collisionCircleArray;if(be.length>0){const Ie=d.H();d.aQ(Ie,ie.placementInvProjMatrix,f.transform.glCoordMatrix),d.aQ(Ie,Ie,ie.placementViewportMatrix),S.push({circleArray:be,circleOffset:F,transform:me.posMatrix,invTransform:Ie,coord:me}),C+=be.length/4,F=C}ve&&w.draw(p,v.LINES,Kt.disabled,Lr.disabled,f.colorModeForRenderPass(),Rr.disabled,{u_matrix:me.posMatrix,u_pixel_extrude_scale:[1/(B=f.transform).width,1/B.height]},f.style.map.terrain&&f.style.map.terrain.getTerrainData(me),o.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,null,f.transform.zoom,null,null,ve.collisionVertexBuffer)}var B;if(!u||!S.length)return;const $=f.useProgram("collisionCircle"),K=new d.aR;K.resize(4*C),K._trim();let Q=0;for(const ue of S)for(let me=0;me<ue.circleArray.length/4;me++){const ie=4*me,ve=ue.circleArray[ie+0],be=ue.circleArray[ie+1],Ie=ue.circleArray[ie+2],Ue=ue.circleArray[ie+3];K.emplace(Q++,ve,be,Ie,Ue,0),K.emplace(Q++,ve,be,Ie,Ue,1),K.emplace(Q++,ve,be,Ie,Ue,2),K.emplace(Q++,ve,be,Ie,Ue,3)}(!pn||pn.length<2*C)&&(pn=(function(ue){const me=2*ue,ie=new d.aT;ie.resize(me),ie._trim();for(let ve=0;ve<me;ve++){const be=6*ve;ie.uint16[be+0]=4*ve+0,ie.uint16[be+1]=4*ve+1,ie.uint16[be+2]=4*ve+2,ie.uint16[be+3]=4*ve+2,ie.uint16[be+4]=4*ve+3,ie.uint16[be+5]=4*ve+0}return ie})(C));const te=p.createIndexBuffer(pn,!0),ae=p.createVertexBuffer(K,d.aS.members,!0);for(const ue of S){const me=bn(ue.transform,ue.invTransform,f.transform);$.draw(p,v.TRIANGLES,Kt.disabled,Lr.disabled,f.colorModeForRenderPass(),Rr.disabled,me,f.style.map.terrain&&f.style.map.terrain.getTerrainData(ue.coord),o.id,ae,te,d.a0.simpleSegment(0,2*ue.circleOffset,ue.circleArray.length,ue.circleArray.length/2),null,f.transform.zoom,null,null,null)}ae.destroy(),te.destroy()}Rr.disabled=new Rr(!1,1029,2305),Rr.backCCW=new Rr(!0,1029,2305);const ya=d.an(new Float32Array(16));function Fs(f,e,o,l,u,p){const{horizontalAlign:v,verticalAlign:w}=d.au(f);return new d.P((-(v-.5)*e/u+l[0])*p,(-(w-.5)*o/u+l[1])*p)}function Go(f,e,o,l,u,p){const v=e.tileAnchorPoint.add(new d.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let w=l.mult(p);o||(w=w.rotate(-u));const S=v.add(w);return le(S.x,S.y,e.labelPlaneMatrix,e.getElevation).point}if(o){const w=De(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(f),S=Math.atan(w.y/w.x)+(w.x<0?Math.PI:0);return f.add(l.rotate(S))}return f.add(l)}function Va(f,e,o,l,u,p,v,w,S,C,F,B,$,K){const Q=f.text.placedSymbolArray,te=f.text.dynamicLayoutVertexArray,ae=f.icon.dynamicLayoutVertexArray,ue={};te.clear();for(let me=0;me<Q.length;me++){const ie=Q.get(me),ve=ie.hidden||!ie.crossTileID||f.allowVerticalPlacement&&!ie.placedOrientation?null:l[ie.crossTileID];if(ve){const be=new d.P(ie.anchorX,ie.anchorY),Ie={getElevation:K,width:u.width,height:u.height,labelPlaneMatrix:p,pitchWithMap:o,projection:F,tileAnchorPoint:be,translation:B,unwrappedTileID:$},Ue=o?le(be.x,be.y,v,K):De(be.x,be.y,Ie),tt=j(u.cameraToCenterDistance,Ue.signedDistanceFromCamera);let lt=d.ai(f.textSizeData,S,ie)*tt/d.ap;o&&(lt*=f.tilePixelRatio/w);const{width:gt,height:ut,anchor:ot,textOffset:zt,textBoxScale:Jt}=ve,ct=Fs(ot,gt,ut,zt,Jt,lt),dt=F.getPitchedTextCorrection(u,be.add(new d.P(B[0],B[1])),$),Wt=Go(Ue.point,Ie,e,ct,u.angle,dt),Gr=f.allowVerticalPlacement&&ie.placedOrientation===d.ah.vertical?Math.PI/2:0;for(let or=0;or<ie.numGlyphs;or++)d.aj(te,Wt,Gr);C&&ie.associatedIconIndex>=0&&(ue[ie.associatedIconIndex]={shiftedAnchor:Wt,angle:Gr})}else Lt(ie.numGlyphs,te)}if(C){ae.clear();const me=f.icon.placedSymbolArray;for(let ie=0;ie<me.length;ie++){const ve=me.get(ie);if(ve.hidden)Lt(ve.numGlyphs,ae);else{const be=ue[ie];if(be)for(let Ie=0;Ie<ve.numGlyphs;Ie++)d.aj(ae,be.shiftedAnchor,be.angle);else Lt(ve.numGlyphs,ae)}}f.icon.dynamicLayoutVertexBuffer.updateData(ae)}f.text.dynamicLayoutVertexBuffer.updateData(te)}function Tn(f,e,o){return o.iconsInText&&e?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function Ho(f,e,o,l,u,p,v,w,S,C,F,B){const $=f.context,K=$.gl,Q=f.transform,te=$o(),ae=w==="map",ue=S==="map",me=w!=="viewport"&&o.layout.get("symbol-placement")!=="point",ie=ae&&!ue&&!me,ve=!ue&&me,be=!o.layout.get("symbol-sort-key").isConstant();let Ie=!1;const Ue=f.depthModeForSublayer(0,Kt.ReadOnly),tt=o._unevaluatedLayout.hasValue("text-variable-anchor")||o._unevaluatedLayout.hasValue("text-variable-anchor-offset"),lt=[],gt=te.getCircleRadiusCorrection(Q);for(const ut of l){const ot=e.getTile(ut),zt=ot.getBucket(o);if(!zt)continue;const Jt=u?zt.text:zt.icon;if(!Jt||!Jt.segments.get().length||!Jt.hasVisibleVertices)continue;const ct=Jt.programConfigurations.get(o.id),dt=u||zt.sdfIcons,Wt=u?zt.textSizeData:zt.iconSizeData,Gr=ue||Q.pitch!==0,or=f.useProgram(Tn(dt,u,zt),ct),dr=d.ag(Wt,Q.zoom),Yr=f.style.map.terrain&&f.style.map.terrain.getTerrainData(ut);let on,ho,Qr,Xi,ci=[0,0],Ci=null;if(u)ho=ot.glyphAtlasTexture,Qr=K.LINEAR,on=ot.glyphAtlasTexture.size,zt.iconsInText&&(ci=ot.imageAtlasTexture.size,Ci=ot.imageAtlasTexture,Xi=Gr||f.options.rotating||f.options.zooming||Wt.kind==="composite"||Wt.kind==="camera"?K.LINEAR:K.NEAREST);else{const mr=o.layout.get("icon-size").constantOr(0)!==1||zt.iconsNeedLinear;ho=ot.imageAtlasTexture,Qr=dt||f.options.rotating||f.options.zooming||mr||Gr?K.LINEAR:K.NEAREST,on=ot.imageAtlasTexture.size}const gn=ir(ot,1,f.transform.zoom),Yo=ve?ut.posMatrix:ya,Kn=xn(Yo,ue,ae,f.transform,gn),Qo=ln(Yo,ue,ae,f.transform,gn),bs=ln(ut.posMatrix,ue,ae,f.transform,gn),po=te.translatePosition(f.transform,ot,p,v),Ao=tt&&zt.hasTextData(),Sa=o.layout.get("icon-text-fit")!=="none"&&Ao&&zt.hasIconData();if(me){const mr=f.style.map.terrain?(Ss,ta)=>f.style.map.terrain.getElevation(ut,Ss,ta):null,mo=o.layout.get("text-rotation-alignment")==="map";X(zt,ut.posMatrix,f,u,Kn,bs,ue,C,mo,te,ut.toUnwrapped(),Q.width,Q.height,po,mr)}const Bn=ut.posMatrix,fo=u&&tt||Sa,ea=me||fo?ya:Kn,Do=Qo,Ri=dt&&o.paint.get(u?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let fi;fi=dt?zt.iconsInText?pa(Wt.kind,dr,ie,ue,me,fo,f,Bn,ea,Do,po,on,ci,gt):qo(Wt.kind,dr,ie,ue,me,fo,f,Bn,ea,Do,po,u,on,!0,gt):Sn(Wt.kind,dr,ie,ue,me,fo,f,Bn,ea,Do,po,u,on,gt);const yn={program:or,buffers:Jt,uniformValues:fi,atlasTexture:ho,atlasTextureIcon:Ci,atlasInterpolation:Qr,atlasInterpolationIcon:Xi,isSDF:dt,hasHalo:Ri};if(be&&zt.canOverlap){Ie=!0;const mr=Jt.segments.get();for(const mo of mr)lt.push({segments:new d.a0([mo]),sortKey:mo.sortKey,state:yn,terrainData:Yr})}else lt.push({segments:Jt.segments,sortKey:0,state:yn,terrainData:Yr})}Ie&&lt.sort(((ut,ot)=>ut.sortKey-ot.sortKey));for(const ut of lt){const ot=ut.state;if($.activeTexture.set(K.TEXTURE0),ot.atlasTexture.bind(ot.atlasInterpolation,K.CLAMP_TO_EDGE),ot.atlasTextureIcon&&($.activeTexture.set(K.TEXTURE1),ot.atlasTextureIcon&&ot.atlasTextureIcon.bind(ot.atlasInterpolationIcon,K.CLAMP_TO_EDGE)),ot.isSDF){const zt=ot.uniformValues;ot.hasHalo&&(zt.u_is_halo=1,nl(ot.buffers,ut.segments,o,f,ot.program,Ue,F,B,zt,ut.terrainData)),zt.u_is_halo=0}nl(ot.buffers,ut.segments,o,f,ot.program,Ue,F,B,ot.uniformValues,ut.terrainData)}}function nl(f,e,o,l,u,p,v,w,S,C){const F=l.context;u.draw(F,F.gl.TRIANGLES,p,v,w,Rr.disabled,S,C,o.id,f.layoutVertexBuffer,f.indexBuffer,e,o.paint,l.transform.zoom,f.programConfigurations.get(o.id),f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer)}function Hu(f,e,o,l){const u=f.context,p=u.gl,v=Lr.disabled,w=new nr([p.ONE,p.ONE],d.aM.transparent,[!0,!0,!0,!0]),S=e.getBucket(o);if(!S)return;const C=l.key;let F=o.heatmapFbos.get(C);F||(F=ol(u,e.tileSize,e.tileSize),o.heatmapFbos.set(C,F)),u.bindFramebuffer.set(F.framebuffer),u.viewport.set([0,0,e.tileSize,e.tileSize]),u.clear({color:d.aM.transparent});const B=S.programConfigurations.get(o.id),$=f.useProgram("heatmap",B),K=f.style.map.terrain.getTerrainData(l);$.draw(u,p.TRIANGLES,Kt.disabled,v,w,Rr.disabled,Vi(l.posMatrix,e,f.transform.zoom,o.paint.get("heatmap-intensity")),K,o.id,S.layoutVertexBuffer,S.indexBuffer,S.segments,o.paint,f.transform.zoom,B)}function Bs(f,e,o){const l=f.context,u=l.gl;l.setColorMode(f.colorModeForRenderPass());const p=al(l,e),v=o.key,w=e.heatmapFbos.get(v);w&&(l.activeTexture.set(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,w.colorAttachment.get()),l.activeTexture.set(u.TEXTURE1),p.bind(u.LINEAR,u.CLAMP_TO_EDGE),f.useProgram("heatmapTexture").draw(l,u.TRIANGLES,Kt.disabled,Lr.disabled,f.colorModeForRenderPass(),Rr.disabled,da(f,e,0,1),null,e.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments,e.paint,f.transform.zoom),w.destroy(),e.heatmapFbos.delete(v))}function ol(f,e,o){var l,u;const p=f.gl,v=p.createTexture();p.bindTexture(p.TEXTURE_2D,v),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR);const w=(l=f.HALF_FLOAT)!==null&&l!==void 0?l:p.UNSIGNED_BYTE,S=(u=f.RGBA16F)!==null&&u!==void 0?u:p.RGBA;p.texImage2D(p.TEXTURE_2D,0,S,e,o,0,p.RGBA,w,null);const C=f.createFramebuffer(e,o,!1,!1);return C.colorAttachment.set(v),C}function al(f,e){return e.colorRampTexture||(e.colorRampTexture=new Et(f,e.colorRamp,f.gl.RGBA)),e.colorRampTexture}function _a(f,e,o,l,u){if(!o||!l||!l.imageAtlas)return;const p=l.imageAtlas.patternPositions;let v=p[o.to.toString()],w=p[o.from.toString()];if(!v&&w&&(v=w),!w&&v&&(w=v),!v||!w){const S=u.getPaintProperty(e);v=p[S],w=p[S]}v&&w&&f.setConstantPatternPositions(v,w)}function Ua(f,e,o,l,u,p,v){const w=f.context.gl,S="fill-pattern",C=o.paint.get(S),F=C&&C.constantOr(1),B=o.getCrossfadeParameters();let $,K,Q,te,ae;v?(K=F&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=w.LINES):(K=F?"fillPattern":"fill",$=w.TRIANGLES);const ue=C.constantOr(null);for(const me of l){const ie=e.getTile(me);if(F&&!ie.patternsLoaded())continue;const ve=ie.getBucket(o);if(!ve)continue;const be=ve.programConfigurations.get(o.id),Ie=f.useProgram(K,be),Ue=f.style.map.terrain&&f.style.map.terrain.getTerrainData(me);F&&(f.context.activeTexture.set(w.TEXTURE0),ie.imageAtlasTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),be.updatePaintBuffers(B)),_a(be,S,ue,ie,o);const tt=Ue?me:null,lt=f.translatePosMatrix(tt?tt.posMatrix:me.posMatrix,ie,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(v){te=ve.indexBuffer2,ae=ve.segments2;const gt=[w.drawingBufferWidth,w.drawingBufferHeight];Q=K==="fillOutlinePattern"&&F?Qs(lt,f,B,ie,gt):gu(lt,gt)}else te=ve.indexBuffer,ae=ve.segments,Q=F?Nl(lt,f,B,ie):Ba(lt);Ie.draw(f.context,$,u,f.stencilModeForClipping(me),p,Rr.disabled,Q,Ue,o.id,ve.layoutVertexBuffer,te,ae,o.paint,f.transform.zoom,be)}}function _u(f,e,o,l,u,p,v){const w=f.context,S=w.gl,C="fill-extrusion-pattern",F=o.paint.get(C),B=F.constantOr(1),$=o.getCrossfadeParameters(),K=o.paint.get("fill-extrusion-opacity"),Q=F.constantOr(null);for(const te of l){const ae=e.getTile(te),ue=ae.getBucket(o);if(!ue)continue;const me=f.style.map.terrain&&f.style.map.terrain.getTerrainData(te),ie=ue.programConfigurations.get(o.id),ve=f.useProgram(B?"fillExtrusionPattern":"fillExtrusion",ie);B&&(f.context.activeTexture.set(S.TEXTURE0),ae.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),ie.updatePaintBuffers($)),_a(ie,C,Q,ae,o);const be=f.translatePosMatrix(te.posMatrix,ae,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Ie=o.paint.get("fill-extrusion-vertical-gradient"),Ue=B?ds(be,f,Ie,K,te,$,ae):Fa(be,f,Ie,K);ve.draw(w,w.gl.TRIANGLES,u,p,v,Rr.backCCW,Ue,me,o.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,o.paint,f.transform.zoom,ie,f.style.map.terrain&&ue.centroidVertexBuffer)}}function $a(f,e,o,l,u,p,v){const w=f.context,S=w.gl,C=o.fbo;if(!C)return;const F=f.useProgram("hillshade"),B=f.style.map.terrain&&f.style.map.terrain.getTerrainData(e);w.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,C.colorAttachment.get()),F.draw(w,S.TRIANGLES,u,p,v,Rr.disabled,(($,K,Q,te)=>{const ae=Q.paint.get("hillshade-shadow-color"),ue=Q.paint.get("hillshade-highlight-color"),me=Q.paint.get("hillshade-accent-color");let ie=Q.paint.get("hillshade-illumination-direction")*(Math.PI/180);Q.paint.get("hillshade-illumination-anchor")==="viewport"&&(ie-=$.transform.angle);const ve=!$.options.moving;return{u_matrix:te?te.posMatrix:$.transform.calculatePosMatrix(K.tileID.toUnwrapped(),ve),u_image:0,u_latrange:nn(0,K.tileID),u_light:[Q.paint.get("hillshade-exaggeration"),ie],u_shadow:ae,u_highlight:ue,u_accent:me}})(f,o,l,B?e:null),B,l.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments)}function sl(f,e,o,l,u,p){const v=f.context,w=v.gl,S=e.dem;if(S&&S.data){const C=S.dim,F=S.stride,B=S.getPixels();if(v.activeTexture.set(w.TEXTURE1),v.pixelStoreUnpackPremultiplyAlpha.set(!1),e.demTexture=e.demTexture||f.getTileTexture(F),e.demTexture){const K=e.demTexture;K.update(B,{premultiply:!1}),K.bind(w.NEAREST,w.CLAMP_TO_EDGE)}else e.demTexture=new Et(v,B,w.RGBA,{premultiply:!1}),e.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE);v.activeTexture.set(w.TEXTURE0);let $=e.fbo;if(!$){const K=new Et(v,{width:C,height:C,data:null},w.RGBA);K.bind(w.LINEAR,w.CLAMP_TO_EDGE),$=e.fbo=v.createFramebuffer(C,C,!0,!1),$.colorAttachment.set(K.texture)}v.bindFramebuffer.set($.framebuffer),v.viewport.set([0,0,C,C]),f.useProgram("hillshadePrepare").draw(v,w.TRIANGLES,l,u,p,Rr.disabled,((K,Q)=>{const te=Q.stride,ae=d.H();return d.aP(ae,0,d.X,-d.X,0,0,1),d.J(ae,ae,[0,-d.X,0]),{u_matrix:ae,u_image:1,u_dimension:[te,te],u_zoom:K.overscaledZ,u_unpack:Q.getUnpackVector()}})(e.tileID,S),null,o.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments),e.needsHillshadePrepare=!1}}function Wu(f,e,o,l,u,p){const v=l.paint.get("raster-fade-duration");if(!p&&v>0){const w=re.now(),S=(w-f.timeAdded)/v,C=e?(w-e.timeAdded)/v:-1,F=o.getSource(),B=u.coveringZoomLevel({tileSize:F.tileSize,roundZoom:F.roundZoom}),$=!e||Math.abs(e.tileID.overscaledZ-B)>Math.abs(f.tileID.overscaledZ-B),K=$&&f.refreshedUponExpiration?1:d.ac($?S:1-C,0,1);return f.refreshedUponExpiration&&S>=1&&(f.refreshedUponExpiration=!1),e?{opacity:1,mix:1-K}:{opacity:K,mix:0}}return{opacity:1,mix:0}}const Ul=new d.aM(1,0,0,1),Pr=new d.aM(0,1,0,1),$l=new d.aM(0,0,1,1),Oc=new d.aM(1,0,1,1),Xu=new d.aM(0,1,1,1);function ll(f,e,o,l){vu(f,0,e+o/2,f.transform.width,o,l)}function Nc(f,e,o,l){vu(f,e-o/2,0,o,f.transform.height,l)}function vu(f,e,o,l,u,p){const v=f.context,w=v.gl;w.enable(w.SCISSOR_TEST),w.scissor(e*f.pixelRatio,o*f.pixelRatio,l*f.pixelRatio,u*f.pixelRatio),v.clear({color:p}),w.disable(w.SCISSOR_TEST)}function jc(f,e,o){const l=f.context,u=l.gl,p=o.posMatrix,v=f.useProgram("debug"),w=Kt.disabled,S=Lr.disabled,C=f.colorModeForRenderPass(),F="$debug",B=f.style.map.terrain&&f.style.map.terrain.getTerrainData(o);l.activeTexture.set(u.TEXTURE0);const $=e.getTileByID(o.key).latestRawTileData,K=Math.floor(($&&$.byteLength||0)/1024),Q=e.getTile(o).tileSize,te=512/Math.min(Q,512)*(o.overscaledZ/f.transform.zoom)*.5;let ae=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(ae+=` => ${o.overscaledZ}`),(function(ue,me){ue.initDebugOverlayCanvas();const ie=ue.debugOverlayCanvas,ve=ue.context.gl,be=ue.debugOverlayCanvas.getContext("2d");be.clearRect(0,0,ie.width,ie.height),be.shadowColor="white",be.shadowBlur=2,be.lineWidth=1.5,be.strokeStyle="white",be.textBaseline="top",be.font="bold 36px Open Sans, sans-serif",be.fillText(me,5,5),be.strokeText(me,5,5),ue.debugOverlayTexture.update(ie),ue.debugOverlayTexture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE)})(f,`${ae} ${K}kB`),v.draw(l,u.TRIANGLES,w,S,nr.alphaBlended,Rr.disabled,$n(p,d.aM.transparent,te),null,F,f.debugBuffer,f.quadTriangleIndexBuffer,f.debugSegments),v.draw(l,u.LINE_STRIP,w,S,C,Rr.disabled,$n(p,d.aM.red),B,F,f.debugBuffer,f.tileBorderIndexBuffer,f.debugSegments)}function Vc(f,e,o){const l=f.context,u=l.gl,p=f.colorModeForRenderPass(),v=new Kt(u.LEQUAL,Kt.ReadWrite,f.depthRangeFor3D),w=f.useProgram("terrain"),S=e.getTerrainMesh();l.bindFramebuffer.set(null),l.viewport.set([0,0,f.width,f.height]);for(const C of o){const F=f.renderToTexture.getTexture(C),B=e.getTerrainData(C.tileID);l.activeTexture.set(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,F.texture);const $=f.transform.calculatePosMatrix(C.tileID.toUnwrapped()),K=e.getMeshFrameDelta(f.transform.zoom),Q=f.transform.calculateFogMatrix(C.tileID.toUnwrapped()),te=ca($,K,Q,f.style.sky,f.transform.pitch);w.draw(l,u.TRIANGLES,v,Lr.disabled,p,Rr.backCCW,te,B,"terrain",S.vertexBuffer,S.indexBuffer,S.segments)}}class Hn{constructor(e,o,l){this.vertexBuffer=e,this.indexBuffer=o,this.segments=l}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class gs{constructor(e,o){this.context=new fs(e),this.transform=o,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:d.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Zt.maxUnderzooming+Zt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Da}resize(e,o,l){if(this.width=Math.floor(e*l),this.height=Math.floor(o*l),this.pixelRatio=l,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const u of this.style._order)this.style._layers[u].resize()}setup(){const e=this.context,o=new d.aX;o.emplaceBack(0,0),o.emplaceBack(d.X,0),o.emplaceBack(0,d.X),o.emplaceBack(d.X,d.X),this.tileExtentBuffer=e.createVertexBuffer(o,Ln.members),this.tileExtentSegments=d.a0.simpleSegment(0,0,4,2);const l=new d.aX;l.emplaceBack(0,0),l.emplaceBack(d.X,0),l.emplaceBack(0,d.X),l.emplaceBack(d.X,d.X),this.debugBuffer=e.createVertexBuffer(l,Ln.members),this.debugSegments=d.a0.simpleSegment(0,0,4,5);const u=new d.$;u.emplaceBack(0,0,0,0),u.emplaceBack(d.X,0,d.X,0),u.emplaceBack(0,d.X,0,d.X),u.emplaceBack(d.X,d.X,d.X,d.X),this.rasterBoundsBuffer=e.createVertexBuffer(u,So.members),this.rasterBoundsSegments=d.a0.simpleSegment(0,0,4,2);const p=new d.aX;p.emplaceBack(0,0),p.emplaceBack(1,0),p.emplaceBack(0,1),p.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(p,Ln.members),this.viewportSegments=d.a0.simpleSegment(0,0,4,2);const v=new d.aZ;v.emplaceBack(0),v.emplaceBack(1),v.emplaceBack(3),v.emplaceBack(2),v.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(v);const w=new d.aY;w.emplaceBack(0,1,2),w.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(w);const S=this.context.gl;this.stencilClearMode=new Lr({func:S.ALWAYS,mask:0},0,255,S.ZERO,S.ZERO,S.ZERO)}clearStencil(){const e=this.context,o=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const l=d.H();d.aP(l,0,this.width,this.height,0,0,1),d.K(l,l,[o.drawingBufferWidth,o.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,o.TRIANGLES,Kt.disabled,this.stencilClearMode,nr.disabled,Rr.disabled,ki(l),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,o){if(this.currentStencilSource===e.source||!e.isTileClipped()||!o||!o.length)return;this.currentStencilSource=e.source;const l=this.context,u=l.gl;this.nextStencilID+o.length>256&&this.clearStencil(),l.setColorMode(nr.disabled),l.setDepthMode(Kt.disabled);const p=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const v of o){const w=this._tileClippingMaskIDs[v.key]=this.nextStencilID++,S=this.style.map.terrain&&this.style.map.terrain.getTerrainData(v);p.draw(l,u.TRIANGLES,Kt.disabled,new Lr({func:u.ALWAYS,mask:0},w,255,u.KEEP,u.KEEP,u.REPLACE),nr.disabled,Rr.disabled,ki(v.posMatrix),S,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,o=this.context.gl;return new Lr({func:o.NOTEQUAL,mask:255},e,255,o.KEEP,o.KEEP,o.REPLACE)}stencilModeForClipping(e){const o=this.context.gl;return new Lr({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,o.KEEP,o.KEEP,o.REPLACE)}stencilConfigForOverlap(e){const o=this.context.gl,l=e.sort(((v,w)=>w.overscaledZ-v.overscaledZ)),u=l[l.length-1].overscaledZ,p=l[0].overscaledZ-u+1;if(p>1){this.currentStencilSource=void 0,this.nextStencilID+p>256&&this.clearStencil();const v={};for(let w=0;w<p;w++)v[w+u]=new Lr({func:o.GEQUAL,mask:255},w+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=p,[v,l]}return[{[u]:Lr.disabled},l]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new nr([e.CONSTANT_COLOR,e.ONE],new d.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?nr.unblended:nr.alphaBlended}depthModeForSublayer(e,o,l){if(!this.opaquePassEnabledForLayer())return Kt.disabled;const u=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Kt(l||this.context.gl.LEQUAL,o,[u,u])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,o){this.style=e,this.options=o,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(re.now()),this.imageManager.beginFrame();const l=this.style._order,u=this.style.sourceCaches,p={},v={},w={};for(const S in u){const C=u[S];C.used&&C.prepare(this.context),p[S]=C.getVisibleCoordinates(),v[S]=p[S].slice().reverse(),w[S]=C.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let S=0;S<l.length;S++)if(this.style._layers[l[S]].is3D()){this.opaquePassCutoff=S;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const S of l){const C=this.style._layers[S];if(!C.hasOffscreenPass()||C.isHidden(this.transform.zoom))continue;const F=v[C.source];(C.type==="custom"||F.length)&&this.renderLayer(this,u[C.source],C,F)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:o.showOverdrawInspector?d.aM.black:d.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(S,C){const F=S.context,B=F.gl,$=((ue,me,ie)=>({u_sky_color:ue.properties.get("sky-color"),u_horizon_color:ue.properties.get("horizon-color"),u_horizon:(me.height/2+me.getHorizon())*ie,u_sky_horizon_blend:ue.properties.get("sky-horizon-blend")*me.height/2*ie}))(C,S.style.map.transform,S.pixelRatio),K=new Kt(B.LEQUAL,Kt.ReadWrite,[0,1]),Q=Lr.disabled,te=S.colorModeForRenderPass(),ae=S.useProgram("sky");if(!C.mesh){const ue=new d.aX;ue.emplaceBack(-1,-1),ue.emplaceBack(1,-1),ue.emplaceBack(1,1),ue.emplaceBack(-1,1);const me=new d.aY;me.emplaceBack(0,1,2),me.emplaceBack(0,2,3),C.mesh=new Hn(F.createVertexBuffer(ue,Ln.members),F.createIndexBuffer(me),d.a0.simpleSegment(0,0,ue.length,me.length))}ae.draw(F,B.TRIANGLES,K,Q,te,Rr.disabled,$,void 0,"sky",C.mesh.vertexBuffer,C.mesh.indexBuffer,C.mesh.segments)})(this,this.style.sky),this._showOverdrawInspector=o.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=l.length-1;this.currentLayer>=0;this.currentLayer--){const S=this.style._layers[l[this.currentLayer]],C=u[S.source],F=p[S.source];this._renderTileClippingMasks(S,F),this.renderLayer(this,C,S,F)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<l.length;this.currentLayer++){const S=this.style._layers[l[this.currentLayer]],C=u[S.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(S))continue;const F=(S.type==="symbol"?w:v)[S.source];this._renderTileClippingMasks(S,p[S.source]),this.renderLayer(this,C,S,F)}if(this.options.showTileBoundaries){const S=(function(C,F){let B=null;const $=Object.values(C._layers).flatMap((ae=>ae.source&&!ae.isHidden(F)?[C.sourceCaches[ae.source]]:[])),K=$.filter((ae=>ae.getSource().type==="vector")),Q=$.filter((ae=>ae.getSource().type!=="vector")),te=ae=>{(!B||B.getSource().maxzoom<ae.getSource().maxzoom)&&(B=ae)};return K.forEach((ae=>te(ae))),B||Q.forEach((ae=>te(ae))),B})(this.style,this.transform.zoom);S&&(function(C,F,B){for(let $=0;$<B.length;$++)jc(C,F,B[$])})(this,S,S.getVisibleCoordinates())}this.options.showPadding&&(function(S){const C=S.transform.padding;ll(S,S.transform.height-(C.top||0),3,Ul),ll(S,C.bottom||0,3,Pr),Nc(S,C.left||0,3,$l),Nc(S,S.transform.width-(C.right||0),3,Oc);const F=S.transform.centerPoint;(function(B,$,K,Q){vu(B,$-1,K-10,2,20,Q),vu(B,$-10,K-1,20,2,Q)})(S,F.x,S.transform.height-F.y,Xu)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const o=this.terrainFacilitator.matrix,l=this.transform.modelViewProjectionMatrix;let u=this.terrainFacilitator.dirty;u||(u=e?!d.a_(o,l):!d.a$(o,l)),u||(u=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),u&&(d.b0(o,l),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(p,v){const w=p.context,S=w.gl,C=nr.unblended,F=new Kt(S.LEQUAL,Kt.ReadWrite,[0,1]),B=v.getTerrainMesh(),$=v.sourceCache.getRenderableTiles(),K=p.useProgram("terrainDepth");w.bindFramebuffer.set(v.getFramebuffer("depth").framebuffer),w.viewport.set([0,0,p.width/devicePixelRatio,p.height/devicePixelRatio]),w.clear({color:d.aM.transparent,depth:1});for(const Q of $){const te=v.getTerrainData(Q.tileID),ae={u_matrix:p.transform.calculatePosMatrix(Q.tileID.toUnwrapped()),u_ele_delta:v.getMeshFrameDelta(p.transform.zoom)};K.draw(w,S.TRIANGLES,F,Lr.disabled,C,Rr.backCCW,ae,te,"terrain",B.vertexBuffer,B.indexBuffer,B.segments)}w.bindFramebuffer.set(null),w.viewport.set([0,0,p.width,p.height])})(this,this.style.map.terrain),(function(p,v){const w=p.context,S=w.gl,C=nr.unblended,F=new Kt(S.LEQUAL,Kt.ReadWrite,[0,1]),B=v.getTerrainMesh(),$=v.getCoordsTexture(),K=v.sourceCache.getRenderableTiles(),Q=p.useProgram("terrainCoords");w.bindFramebuffer.set(v.getFramebuffer("coords").framebuffer),w.viewport.set([0,0,p.width/devicePixelRatio,p.height/devicePixelRatio]),w.clear({color:d.aM.transparent,depth:1}),v.coordsIndex=[];for(const te of K){const ae=v.getTerrainData(te.tileID);w.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,$.texture);const ue={u_matrix:p.transform.calculatePosMatrix(te.tileID.toUnwrapped()),u_terrain_coords_id:(255-v.coordsIndex.length)/255,u_texture:0,u_ele_delta:v.getMeshFrameDelta(p.transform.zoom)};Q.draw(w,S.TRIANGLES,F,Lr.disabled,C,Rr.backCCW,ue,ae,"terrain",B.vertexBuffer,B.indexBuffer,B.segments),v.coordsIndex.push(te.tileID.key)}w.bindFramebuffer.set(null),w.viewport.set([0,0,p.width,p.height])})(this,this.style.map.terrain))}renderLayer(e,o,l,u){if(!l.isHidden(this.transform.zoom)&&(l.type==="background"||l.type==="custom"||(u||[]).length))switch(this.id=l.id,l.type){case"symbol":(function(p,v,w,S,C){if(p.renderPass!=="translucent")return;const F=Lr.disabled,B=p.colorModeForRenderPass();(w._unevaluatedLayout.hasValue("text-variable-anchor")||w._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function($,K,Q,te,ae,ue,me,ie,ve){const be=K.transform,Ie=$o(),Ue=ae==="map",tt=ue==="map";for(const lt of $){const gt=te.getTile(lt),ut=gt.getBucket(Q);if(!ut||!ut.text||!ut.text.segments.get().length)continue;const ot=d.ag(ut.textSizeData,be.zoom),zt=ir(gt,1,K.transform.zoom),Jt=xn(lt.posMatrix,tt,Ue,K.transform,zt),ct=Q.layout.get("icon-text-fit")!=="none"&&ut.hasIconData();if(ot){const dt=Math.pow(2,be.zoom-gt.tileID.overscaledZ),Wt=K.style.map.terrain?(or,dr)=>K.style.map.terrain.getElevation(lt,or,dr):null,Gr=Ie.translatePosition(be,gt,me,ie);Va(ut,Ue,tt,ve,be,Jt,lt.posMatrix,dt,ot,ct,Ie,Gr,lt.toUnwrapped(),Wt)}}})(S,p,w,v,w.layout.get("text-rotation-alignment"),w.layout.get("text-pitch-alignment"),w.paint.get("text-translate"),w.paint.get("text-translate-anchor"),C),w.paint.get("icon-opacity").constantOr(1)!==0&&Ho(p,v,w,S,!1,w.paint.get("icon-translate"),w.paint.get("icon-translate-anchor"),w.layout.get("icon-rotation-alignment"),w.layout.get("icon-pitch-alignment"),w.layout.get("icon-keep-upright"),F,B),w.paint.get("text-opacity").constantOr(1)!==0&&Ho(p,v,w,S,!0,w.paint.get("text-translate"),w.paint.get("text-translate-anchor"),w.layout.get("text-rotation-alignment"),w.layout.get("text-pitch-alignment"),w.layout.get("text-keep-upright"),F,B),v.map.showCollisionBoxes&&(ja(p,v,w,S,!0),ja(p,v,w,S,!1))})(e,o,l,u,this.style.placement.variableOffsets);break;case"circle":(function(p,v,w,S){if(p.renderPass!=="translucent")return;const C=w.paint.get("circle-opacity"),F=w.paint.get("circle-stroke-width"),B=w.paint.get("circle-stroke-opacity"),$=!w.layout.get("circle-sort-key").isConstant();if(C.constantOr(1)===0&&(F.constantOr(1)===0||B.constantOr(1)===0))return;const K=p.context,Q=K.gl,te=p.depthModeForSublayer(0,Kt.ReadOnly),ae=Lr.disabled,ue=p.colorModeForRenderPass(),me=[];for(let ie=0;ie<S.length;ie++){const ve=S[ie],be=v.getTile(ve),Ie=be.getBucket(w);if(!Ie)continue;const Ue=Ie.programConfigurations.get(w.id),tt=p.useProgram("circle",Ue),lt=Ie.layoutVertexBuffer,gt=Ie.indexBuffer,ut=p.style.map.terrain&&p.style.map.terrain.getTerrainData(ve),ot={programConfiguration:Ue,program:tt,layoutVertexBuffer:lt,indexBuffer:gt,uniformValues:el(p,ve,be,w),terrainData:ut};if($){const zt=Ie.segments.get();for(const Jt of zt)me.push({segments:new d.a0([Jt]),sortKey:Jt.sortKey,state:ot})}else me.push({segments:Ie.segments,sortKey:0,state:ot})}$&&me.sort(((ie,ve)=>ie.sortKey-ve.sortKey));for(const ie of me){const{programConfiguration:ve,program:be,layoutVertexBuffer:Ie,indexBuffer:Ue,uniformValues:tt,terrainData:lt}=ie.state;be.draw(K,Q.TRIANGLES,te,ae,ue,Rr.disabled,tt,lt,w.id,Ie,Ue,ie.segments,w.paint,p.transform.zoom,ve)}})(e,o,l,u);break;case"heatmap":(function(p,v,w,S){if(w.paint.get("heatmap-opacity")===0)return;const C=p.context;if(p.style.map.terrain){for(const F of S){const B=v.getTile(F);v.hasRenderableParent(F)||(p.renderPass==="offscreen"?Hu(p,B,w,F):p.renderPass==="translucent"&&Bs(p,w,F))}C.viewport.set([0,0,p.width,p.height])}else p.renderPass==="offscreen"?(function(F,B,$,K){const Q=F.context,te=Q.gl,ae=Lr.disabled,ue=new nr([te.ONE,te.ONE],d.aM.transparent,[!0,!0,!0,!0]);(function(me,ie,ve){const be=me.gl;me.activeTexture.set(be.TEXTURE1),me.viewport.set([0,0,ie.width/4,ie.height/4]);let Ie=ve.heatmapFbos.get(d.aU);Ie?(be.bindTexture(be.TEXTURE_2D,Ie.colorAttachment.get()),me.bindFramebuffer.set(Ie.framebuffer)):(Ie=ol(me,ie.width/4,ie.height/4),ve.heatmapFbos.set(d.aU,Ie))})(Q,F,$),Q.clear({color:d.aM.transparent});for(let me=0;me<K.length;me++){const ie=K[me];if(B.hasRenderableParent(ie))continue;const ve=B.getTile(ie),be=ve.getBucket($);if(!be)continue;const Ie=be.programConfigurations.get($.id),Ue=F.useProgram("heatmap",Ie),{zoom:tt}=F.transform;Ue.draw(Q,te.TRIANGLES,Kt.disabled,ae,ue,Rr.disabled,Vi(ie.posMatrix,ve,tt,$.paint.get("heatmap-intensity")),null,$.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,$.paint,F.transform.zoom,Ie)}Q.viewport.set([0,0,F.width,F.height])})(p,v,w,S):p.renderPass==="translucent"&&(function(F,B){const $=F.context,K=$.gl;$.setColorMode(F.colorModeForRenderPass());const Q=B.heatmapFbos.get(d.aU);Q&&($.activeTexture.set(K.TEXTURE0),K.bindTexture(K.TEXTURE_2D,Q.colorAttachment.get()),$.activeTexture.set(K.TEXTURE1),al($,B).bind(K.LINEAR,K.CLAMP_TO_EDGE),F.useProgram("heatmapTexture").draw($,K.TRIANGLES,Kt.disabled,Lr.disabled,F.colorModeForRenderPass(),Rr.disabled,da(F,B,0,1),null,B.id,F.viewportBuffer,F.quadTriangleIndexBuffer,F.viewportSegments,B.paint,F.transform.zoom))})(p,w)})(e,o,l,u);break;case"line":(function(p,v,w,S){if(p.renderPass!=="translucent")return;const C=w.paint.get("line-opacity"),F=w.paint.get("line-width");if(C.constantOr(1)===0||F.constantOr(1)===0)return;const B=p.depthModeForSublayer(0,Kt.ReadOnly),$=p.colorModeForRenderPass(),K=w.paint.get("line-dasharray"),Q=w.paint.get("line-pattern"),te=Q.constantOr(1),ae=w.paint.get("line-gradient"),ue=w.getCrossfadeParameters(),me=te?"linePattern":K?"lineSDF":ae?"lineGradient":"line",ie=p.context,ve=ie.gl;let be=!0;for(const Ie of S){const Ue=v.getTile(Ie);if(te&&!Ue.patternsLoaded())continue;const tt=Ue.getBucket(w);if(!tt)continue;const lt=tt.programConfigurations.get(w.id),gt=p.context.program.get(),ut=p.useProgram(me,lt),ot=be||ut.program!==gt,zt=p.style.map.terrain&&p.style.map.terrain.getTerrainData(Ie),Jt=Q.constantOr(null);if(Jt&&Ue.imageAtlas){const Wt=Ue.imageAtlas,Gr=Wt.patternPositions[Jt.to.toString()],or=Wt.patternPositions[Jt.from.toString()];Gr&&or&&lt.setConstantPatternPositions(Gr,or)}const ct=zt?Ie:null,dt=te?To(p,Ue,w,ue,ct):K?qu(p,Ue,w,K,ue,ct):ae?jl(p,Ue,w,tt.lineClipsArray.length,ct):tl(p,Ue,w,ct);if(te)ie.activeTexture.set(ve.TEXTURE0),Ue.imageAtlasTexture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE),lt.updatePaintBuffers(ue);else if(K&&(ot||p.lineAtlas.dirty))ie.activeTexture.set(ve.TEXTURE0),p.lineAtlas.bind(ie);else if(ae){const Wt=tt.gradients[w.id];let Gr=Wt.texture;if(w.gradientVersion!==Wt.version){let or=256;if(w.stepInterpolant){const dr=v.getSource().maxzoom,Yr=Ie.canonical.z===dr?Math.ceil(1<<p.transform.maxZoom-Ie.canonical.z):1;or=d.ac(d.aV(tt.maxLineLength/d.X*1024*Yr),256,ie.maxTextureSize)}Wt.gradient=d.aW({expression:w.gradientExpression(),evaluationKey:"lineProgress",resolution:or,image:Wt.gradient||void 0,clips:tt.lineClipsArray}),Wt.texture?Wt.texture.update(Wt.gradient):Wt.texture=new Et(ie,Wt.gradient,ve.RGBA),Wt.version=w.gradientVersion,Gr=Wt.texture}ie.activeTexture.set(ve.TEXTURE0),Gr.bind(w.stepInterpolant?ve.NEAREST:ve.LINEAR,ve.CLAMP_TO_EDGE)}ut.draw(ie,ve.TRIANGLES,B,p.stencilModeForClipping(Ie),$,Rr.disabled,dt,zt,w.id,tt.layoutVertexBuffer,tt.indexBuffer,tt.segments,w.paint,p.transform.zoom,lt,tt.layoutVertexBuffer2),be=!1}})(e,o,l,u);break;case"fill":(function(p,v,w,S){const C=w.paint.get("fill-color"),F=w.paint.get("fill-opacity");if(F.constantOr(1)===0)return;const B=p.colorModeForRenderPass(),$=w.paint.get("fill-pattern"),K=p.opaquePassEnabledForLayer()&&!$.constantOr(1)&&C.constantOr(d.aM.transparent).a===1&&F.constantOr(0)===1?"opaque":"translucent";if(p.renderPass===K){const Q=p.depthModeForSublayer(1,p.renderPass==="opaque"?Kt.ReadWrite:Kt.ReadOnly);Ua(p,v,w,S,Q,B,!1)}if(p.renderPass==="translucent"&&w.paint.get("fill-antialias")){const Q=p.depthModeForSublayer(w.getPaintProperty("fill-outline-color")?2:0,Kt.ReadOnly);Ua(p,v,w,S,Q,B,!0)}})(e,o,l,u);break;case"fill-extrusion":(function(p,v,w,S){const C=w.paint.get("fill-extrusion-opacity");if(C!==0&&p.renderPass==="translucent"){const F=new Kt(p.context.gl.LEQUAL,Kt.ReadWrite,p.depthRangeFor3D);if(C!==1||w.paint.get("fill-extrusion-pattern").constantOr(1))_u(p,v,w,S,F,Lr.disabled,nr.disabled),_u(p,v,w,S,F,p.stencilModeFor3D(),p.colorModeForRenderPass());else{const B=p.colorModeForRenderPass();_u(p,v,w,S,F,Lr.disabled,B)}}})(e,o,l,u);break;case"hillshade":(function(p,v,w,S){if(p.renderPass!=="offscreen"&&p.renderPass!=="translucent")return;const C=p.context,F=p.depthModeForSublayer(0,Kt.ReadOnly),B=p.colorModeForRenderPass(),[$,K]=p.renderPass==="translucent"?p.stencilConfigForOverlap(S):[{},S];for(const Q of K){const te=v.getTile(Q);te.needsHillshadePrepare!==void 0&&te.needsHillshadePrepare&&p.renderPass==="offscreen"?sl(p,te,w,F,Lr.disabled,B):p.renderPass==="translucent"&&$a(p,Q,te,w,F,$[Q.overscaledZ],B)}C.viewport.set([0,0,p.width,p.height])})(e,o,l,u);break;case"raster":(function(p,v,w,S){if(p.renderPass!=="translucent"||w.paint.get("raster-opacity")===0||!S.length)return;const C=p.context,F=C.gl,B=v.getSource(),$=p.useProgram("raster"),K=p.colorModeForRenderPass(),[Q,te]=B instanceof ko?[{},S]:p.stencilConfigForOverlap(S),ae=te[te.length-1].overscaledZ,ue=!p.options.moving;for(const me of te){const ie=p.depthModeForSublayer(me.overscaledZ-ae,w.paint.get("raster-opacity")===1?Kt.ReadWrite:Kt.ReadOnly,F.LESS),ve=v.getTile(me);ve.registerFadeDuration(w.paint.get("raster-fade-duration"));const be=v.findLoadedParent(me,0),Ie=v.findLoadedSibling(me),Ue=Wu(ve,be||Ie||null,v,w,p.transform,p.style.map.terrain);let tt,lt;const gt=w.paint.get("raster-resampling")==="nearest"?F.NEAREST:F.LINEAR;C.activeTexture.set(F.TEXTURE0),ve.texture.bind(gt,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST),C.activeTexture.set(F.TEXTURE1),be?(be.texture.bind(gt,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST),tt=Math.pow(2,be.tileID.overscaledZ-ve.tileID.overscaledZ),lt=[ve.tileID.canonical.x*tt%1,ve.tileID.canonical.y*tt%1]):ve.texture.bind(gt,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST),ve.texture.useMipmap&&C.extTextureFilterAnisotropic&&p.transform.pitch>20&&F.texParameterf(F.TEXTURE_2D,C.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,C.extTextureFilterAnisotropicMax);const ut=p.style.map.terrain&&p.style.map.terrain.getTerrainData(me),ot=ut?me:null,zt=ot?ot.posMatrix:p.transform.calculatePosMatrix(me.toUnwrapped(),ue),Jt=yu(zt,lt||[0,0],tt||1,Ue,w);B instanceof ko?$.draw(C,F.TRIANGLES,ie,Lr.disabled,K,Rr.disabled,Jt,ut,w.id,B.boundsBuffer,p.quadTriangleIndexBuffer,B.boundsSegments):$.draw(C,F.TRIANGLES,ie,Q[me.overscaledZ],K,Rr.disabled,Jt,ut,w.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments)}})(e,o,l,u);break;case"background":(function(p,v,w,S){const C=w.paint.get("background-color"),F=w.paint.get("background-opacity");if(F===0)return;const B=p.context,$=B.gl,K=p.transform,Q=K.tileSize,te=w.paint.get("background-pattern");if(p.isPatternMissing(te))return;const ae=!te&&C.a===1&&F===1&&p.opaquePassEnabledForLayer()?"opaque":"translucent";if(p.renderPass!==ae)return;const ue=Lr.disabled,me=p.depthModeForSublayer(0,ae==="opaque"?Kt.ReadWrite:Kt.ReadOnly),ie=p.colorModeForRenderPass(),ve=p.useProgram(te?"backgroundPattern":"background"),be=S||K.coveringTiles({tileSize:Q,terrain:p.style.map.terrain});te&&(B.activeTexture.set($.TEXTURE0),p.imageManager.bind(p.context));const Ie=w.getCrossfadeParameters();for(const Ue of be){const tt=S?Ue.posMatrix:p.transform.calculatePosMatrix(Ue.toUnwrapped()),lt=te?Vl(tt,F,p,te,{tileID:Ue,tileSize:Q},Ie):fa(tt,F,C),gt=p.style.map.terrain&&p.style.map.terrain.getTerrainData(Ue);ve.draw(B,$.TRIANGLES,me,ue,ie,Rr.disabled,lt,gt,w.id,p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}})(e,0,l,u);break;case"custom":(function(p,v,w){const S=p.context,C=w.implementation;if(p.renderPass==="offscreen"){const F=C.prerender;F&&(p.setCustomLayerDefaults(),S.setColorMode(p.colorModeForRenderPass()),F.call(C,S.gl,p.transform.customLayerMatrix()),S.setDirty(),p.setBaseState())}else if(p.renderPass==="translucent"){p.setCustomLayerDefaults(),S.setColorMode(p.colorModeForRenderPass()),S.setStencilMode(Lr.disabled);const F=C.renderingMode==="3d"?new Kt(p.context.gl.LEQUAL,Kt.ReadWrite,p.depthRangeFor3D):p.depthModeForSublayer(0,Kt.ReadOnly);S.setDepthMode(F),C.render(S.gl,p.transform.customLayerMatrix(),{farZ:p.transform.farZ,nearZ:p.transform.nearZ,fov:p.transform._fov,modelViewProjectionMatrix:p.transform.modelViewProjectionMatrix,projectionMatrix:p.transform.projectionMatrix}),S.setDirty(),p.setBaseState(),S.bindFramebuffer.set(null)}})(e,0,l)}}translatePosMatrix(e,o,l,u,p){if(!l[0]&&!l[1])return e;const v=p?u==="map"?this.transform.angle:0:u==="viewport"?-this.transform.angle:0;if(v){const C=Math.sin(v),F=Math.cos(v);l=[l[0]*F-l[1]*C,l[0]*C+l[1]*F]}const w=[p?l[0]:ir(o,l[0],this.transform.zoom),p?l[1]:ir(o,l[1],this.transform.zoom),0],S=new Float32Array(16);return d.J(S,e,w),S}saveTileTexture(e){const o=this._tileTextures[e.size[0]];o?o.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const o=this._tileTextures[e];return o&&o.length>0?o.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const o=this.imageManager.getPattern(e.from.toString()),l=this.imageManager.getPattern(e.to.toString());return!o||!l}useProgram(e,o){this.cache=this.cache||{};const l=e+(o?o.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[l]||(this.cache[l]=new jr(this.context,Un[e],o,rl[e],this._showOverdrawInspector,this.style.map.terrain)),this.cache[l]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Et(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:o}=this.context.gl;return this.width!==e||this.height!==o}}class Os{constructor(e,o){this.points=e,this.planes=o}static fromInvProjectionMatrix(e,o,l){const u=Math.pow(2,l),p=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((w=>{const S=1/(w=d.af([],w,e))[3]/o*u;return d.b1(w,w,[S,S,1/w[3],S])})),v=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((w=>{const S=(function($,K){var Q=K[0],te=K[1],ae=K[2],ue=Q*Q+te*te+ae*ae;return ue>0&&(ue=1/Math.sqrt(ue)),$[0]=K[0]*ue,$[1]=K[1]*ue,$[2]=K[2]*ue,$})([],(function($,K,Q){var te=K[0],ae=K[1],ue=K[2],me=Q[0],ie=Q[1],ve=Q[2];return $[0]=ae*ve-ue*ie,$[1]=ue*me-te*ve,$[2]=te*ie-ae*me,$})([],Vt([],p[w[0]],p[w[1]]),Vt([],p[w[2]],p[w[1]]))),C=-((F=S)[0]*(B=p[w[1]])[0]+F[1]*B[1]+F[2]*B[2]);var F,B;return S.concat(C)}));return new Os(p,v)}}class Ns{constructor(e,o){this.min=e,this.max=o,this.center=(function(l,u,p){return l[0]=.5*u[0],l[1]=.5*u[1],l[2]=.5*u[2],l})([],(function(l,u,p){return l[0]=u[0]+p[0],l[1]=u[1]+p[1],l[2]=u[2]+p[2],l})([],this.min,this.max))}quadrant(e){const o=[e%2==0,e<2],l=ur(this.min),u=ur(this.max);for(let p=0;p<o.length;p++)l[p]=o[p]?this.min[p]:this.center[p],u[p]=o[p]?this.center[p]:this.max[p];return u[2]=this.max[2],new Ns(l,u)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersects(e){const o=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let l=!0;for(let u=0;u<e.planes.length;u++){const p=e.planes[u];let v=0;for(let w=0;w<o.length;w++)d.b2(p,o[w])>=0&&v++;if(v===0)return 0;v!==o.length&&(l=!1)}if(l)return 2;for(let u=0;u<3;u++){let p=Number.MAX_VALUE,v=-Number.MAX_VALUE;for(let w=0;w<e.points.length;w++){const S=e.points[w][u]-this.min[u];p=Math.min(p,S),v=Math.max(v,S)}if(v<0||p>this.max[u]-this.min[u])return 0}return 1}}class js{constructor(e=0,o=0,l=0,u=0){if(isNaN(e)||e<0||isNaN(o)||o<0||isNaN(l)||l<0||isNaN(u)||u<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=o,this.left=l,this.right=u}interpolate(e,o,l){return o.top!=null&&e.top!=null&&(this.top=d.y.number(e.top,o.top,l)),o.bottom!=null&&e.bottom!=null&&(this.bottom=d.y.number(e.bottom,o.bottom,l)),o.left!=null&&e.left!=null&&(this.left=d.y.number(e.left,o.left,l)),o.right!=null&&e.right!=null&&(this.right=d.y.number(e.right,o.right,l)),this}getCenter(e,o){const l=d.ac((this.left+e-this.right)/2,0,e),u=d.ac((this.top+o-this.bottom)/2,0,o);return new d.P(l,u)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new js(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const xu=85.051129;class ys{constructor(e,o,l,u,p){this.tileSize=512,this._renderWorldCopies=p===void 0||!!p,this._minZoom=e||0,this._maxZoom=o||22,this._minPitch=l??0,this._maxPitch=u??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new d.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new js,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const e=new ys(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.apply(this),e}apply(e){this.tileSize=e.tileSize,this.latRange=e.latRange,this.lngRange=e.lngRange,this.width=e.width,this.height=e.height,this._center=e._center,this._elevation=e._elevation,this.minElevationForCurrentTile=e.minElevationForCurrentTile,this.zoom=e.zoom,this.angle=e.angle,this._fov=e._fov,this._pitch=e._pitch,this._unmodified=e._unmodified,this._edgeInsets=e._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new d.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(e){const o=-d.b3(e,-180,180)*Math.PI/180;this.angle!==o&&(this._unmodified=!1,this.angle=o,this._calcMatrices(),this.rotationMatrix=(function(){var l=new d.A(4);return d.A!=Float32Array&&(l[1]=0,l[2]=0),l[0]=1,l[3]=1,l})(),(function(l,u,p){var v=u[0],w=u[1],S=u[2],C=u[3],F=Math.sin(p),B=Math.cos(p);l[0]=v*B+S*F,l[1]=w*B+C*F,l[2]=v*-F+S*B,l[3]=w*-F+C*B})(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){const o=d.ac(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==o&&(this._unmodified=!1,this._pitch=o,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(e){const o=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==o&&(this._unmodified=!1,this._zoom=o,this.tileZoom=Math.max(0,Math.floor(o)),this.scale=this.zoomScale(o),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,o,l){this._unmodified=!1,this._edgeInsets.interpolate(e,o,l),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){const o=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,o)}getVisibleUnwrappedCoordinates(e){const o=[new d.b4(0,e)];if(this._renderWorldCopies){const l=this.pointCoordinate(new d.P(0,0)),u=this.pointCoordinate(new d.P(this.width,0)),p=this.pointCoordinate(new d.P(this.width,this.height)),v=this.pointCoordinate(new d.P(0,this.height)),w=Math.floor(Math.min(l.x,u.x,p.x,v.x)),S=Math.floor(Math.max(l.x,u.x,p.x,v.x)),C=1;for(let F=w-C;F<=S+C;F++)F!==0&&o.push(new d.b4(F,e))}return o}coveringTiles(e){var o,l;let u=this.coveringZoomLevel(e);const p=u;if(e.minzoom!==void 0&&u<e.minzoom)return[];e.maxzoom!==void 0&&u>e.maxzoom&&(u=e.maxzoom);const v=this.pointCoordinate(this.getCameraPoint()),w=d.Z.fromLngLat(this.center),S=Math.pow(2,u),C=[S*v.x,S*v.y,0],F=[S*w.x,S*w.y,0],B=Os.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,u);let $=e.minzoom||0;!e.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&($=u);const K=e.terrain?2/Math.min(this.tileSize,e.tileSize)*this.tileSize:3,Q=ie=>({aabb:new Ns([ie*S,0,0],[(ie+1)*S,S,0]),zoom:0,x:0,y:0,wrap:ie,fullyVisible:!1}),te=[],ae=[],ue=u,me=e.reparseOverscaled?p:u;if(this._renderWorldCopies)for(let ie=1;ie<=3;ie++)te.push(Q(-ie)),te.push(Q(ie));for(te.push(Q(0));te.length>0;){const ie=te.pop(),ve=ie.x,be=ie.y;let Ie=ie.fullyVisible;if(!Ie){const ut=ie.aabb.intersects(B);if(ut===0)continue;Ie=ut===2}const Ue=e.terrain?C:F,tt=ie.aabb.distanceX(Ue),lt=ie.aabb.distanceY(Ue),gt=Math.max(Math.abs(tt),Math.abs(lt));if(ie.zoom===ue||gt>K+(1<<ue-ie.zoom)-2&&ie.zoom>=$){const ut=ue-ie.zoom,ot=C[0]-.5-(ve<<ut),zt=C[1]-.5-(be<<ut);ae.push({tileID:new d.S(ie.zoom===ue?me:ie.zoom,ie.wrap,ie.zoom,ve,be),distanceSq:zr([F[0]-.5-ve,F[1]-.5-be]),tileDistanceToCamera:Math.sqrt(ot*ot+zt*zt)})}else for(let ut=0;ut<4;ut++){const ot=(ve<<1)+ut%2,zt=(be<<1)+(ut>>1),Jt=ie.zoom+1;let ct=ie.aabb.quadrant(ut);if(e.terrain){const dt=new d.S(Jt,ie.wrap,Jt,ot,zt),Wt=e.terrain.getMinMaxElevation(dt),Gr=(o=Wt.minElevation)!==null&&o!==void 0?o:this.elevation,or=(l=Wt.maxElevation)!==null&&l!==void 0?l:this.elevation;ct=new Ns([ct.min[0],ct.min[1],Gr],[ct.max[0],ct.max[1],or])}te.push({aabb:ct,zoom:Jt,x:ot,y:zt,wrap:ie.wrap,fullyVisible:Ie})}}return ae.sort(((ie,ve)=>ie.distanceSq-ve.distanceSq)).map((ie=>ie.tileID))}resize(e,o){this.width=e,this.height=o,this.pixelsToGLUnits=[2/e,-2/o],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(e){const o=d.ac(e.lat,-85.051129,xu);return new d.P(d.O(e.lng)*this.worldSize,d.Q(o)*this.worldSize)}unproject(e){return new d.Z(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(e){const o=this.elevation,l=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,u=this.pointLocation(this.centerPoint,e),p=e.getElevationForLngLatZoom(u,this.tileZoom);if(!(this.elevation-p))return;const v=l+o-p,w=Math.cos(this._pitch)*this.cameraToCenterDistance/v/d.b5(1,u.lat),S=this.scaleZoom(w/this.tileSize);this._elevation=p,this._center=u,this.zoom=S}setLocationAtPoint(e,o){const l=this.pointCoordinate(o),u=this.pointCoordinate(this.centerPoint),p=this.locationCoordinate(e),v=new d.Z(p.x-(l.x-u.x),p.y-(l.y-u.y));this.center=this.coordinateLocation(v),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(e,o){return o?this.coordinatePoint(this.locationCoordinate(e),o.getElevationForLngLatZoom(e,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(e))}pointLocation(e,o){return this.coordinateLocation(this.pointCoordinate(e,o))}locationCoordinate(e){return d.Z.fromLngLat(e)}coordinateLocation(e){return e&&e.toLngLat()}pointCoordinate(e,o){if(o){const $=o.pointCoordinate(e);if($!=null)return $}const l=[e.x,e.y,0,1],u=[e.x,e.y,1,1];d.af(l,l,this.pixelMatrixInverse),d.af(u,u,this.pixelMatrixInverse);const p=l[3],v=u[3],w=l[1]/p,S=u[1]/v,C=l[2]/p,F=u[2]/v,B=C===F?0:(0-C)/(F-C);return new d.Z(d.y.number(l[0]/p,u[0]/v,B)/this.worldSize,d.y.number(w,S,B)/this.worldSize)}coordinatePoint(e,o=0,l=this.pixelMatrix){const u=[e.x*this.worldSize,e.y*this.worldSize,o,1];return d.af(u,u,l),new d.P(u[0]/u[3],u[1]/u[3])}getBounds(){const e=Math.max(0,this.height/2-this.getHorizon());return new Fe().extend(this.pointLocation(new d.P(0,e))).extend(this.pointLocation(new d.P(this.width,e))).extend(this.pointLocation(new d.P(this.width,this.height))).extend(this.pointLocation(new d.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Fe([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,xu])}calculateTileMatrix(e){const o=e.canonical,l=this.worldSize/this.zoomScale(o.z),u=o.x+Math.pow(2,o.z)*e.wrap,p=d.an(new Float64Array(16));return d.J(p,p,[u*l,o.y*l,0]),d.K(p,p,[l/d.X,l/d.X,1]),p}calculatePosMatrix(e,o=!1){const l=e.key,u=o?this._alignedPosMatrixCache:this._posMatrixCache;if(u[l])return u[l];const p=this.calculateTileMatrix(e);return d.L(p,o?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,p),u[l]=new Float32Array(p),u[l]}calculateFogMatrix(e){const o=e.key,l=this._fogMatrixCache;if(l[o])return l[o];const u=this.calculateTileMatrix(e);return d.L(u,this.fogMatrix,u),l[o]=new Float32Array(u),l[o]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(e,o){o=d.ac(+o,this.minZoom,this.maxZoom);const l={center:new d.N(e.lng,e.lat),zoom:o};let u=this.lngRange;if(!this._renderWorldCopies&&u===null){const ie=179.9999999999;u=[-ie,ie]}const p=this.tileSize*this.zoomScale(l.zoom);let v=0,w=p,S=0,C=p,F=0,B=0;const{x:$,y:K}=this.size;if(this.latRange){const ie=this.latRange;v=d.Q(ie[1])*p,w=d.Q(ie[0])*p,w-v<K&&(F=K/(w-v))}u&&(S=d.b3(d.O(u[0])*p,0,p),C=d.b3(d.O(u[1])*p,0,p),C<S&&(C+=p),C-S<$&&(B=$/(C-S)));const{x:Q,y:te}=this.project.call({worldSize:p},e);let ae,ue;const me=Math.max(B||0,F||0);if(me){const ie=new d.P(B?(C+S)/2:Q,F?(w+v)/2:te);return l.center=this.unproject.call({worldSize:p},ie).wrap(),l.zoom+=this.scaleZoom(me),l}if(this.latRange){const ie=K/2;te-ie<v&&(ue=v+ie),te+ie>w&&(ue=w-ie)}if(u){const ie=(S+C)/2;let ve=Q;this._renderWorldCopies&&(ve=d.b3(Q,ie-p/2,ie+p/2));const be=$/2;ve-be<S&&(ae=S+be),ve+be>C&&(ae=C-be)}if(ae!==void 0||ue!==void 0){const ie=new d.P(ae??Q,ue??te);l.center=this.unproject.call({worldSize:p},ie).wrap()}return l}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:o,zoom:l}=this.getConstrained(this.center,this.zoom);this.center=o,this.zoom=l,this._unmodified=e,this._constraining=!1}_calcMatrices(){if(!this.height)return;const e=this.centerOffset,o=this.point.x,l=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=d.b5(1,this.center.lat)*this.worldSize;let u=d.an(new Float64Array(16));d.K(u,u,[this.width/2,-this.height/2,1]),d.J(u,u,[1,-1,0]),this.labelPlaneMatrix=u,u=d.an(new Float64Array(16)),d.K(u,u,[1,-1,1]),d.J(u,u,[-1,-1,0]),d.K(u,u,[2/this.width,2/this.height,1]),this.glCoordMatrix=u;const p=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),v=Math.min(this.elevation,this.minElevationForCurrentTile),w=p-v*this._pixelPerMeter/Math.cos(this._pitch),S=v<0?w:p,C=Math.PI/2+this._pitch,F=this._fov*(.5+e.y/this.height),B=Math.sin(F)*S/Math.sin(d.ac(Math.PI-C-F,.01,Math.PI-.01)),$=this.getHorizon(),K=2*Math.atan($/this.cameraToCenterDistance)*(.5+e.y/(2*$)),Q=Math.sin(K)*S/Math.sin(d.ac(Math.PI-C-K,.01,Math.PI-.01)),te=Math.min(B,Q);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*te+S),this.nearZ=this.height/50,u=new Float64Array(16),d.b6(u,this._fov,this.width/this.height,this.nearZ,this.farZ),u[8]=2*-e.x/this.width,u[9]=2*e.y/this.height,this.projectionMatrix=d.ae(u),d.K(u,u,[1,-1,1]),d.J(u,u,[0,0,-this.cameraToCenterDistance]),d.b7(u,u,this._pitch),d.ad(u,u,this.angle),d.J(u,u,[-o,-l,0]),this.mercatorMatrix=d.K([],u,[this.worldSize,this.worldSize,this.worldSize]),d.K(u,u,[1,1,this._pixelPerMeter]),this.pixelMatrix=d.L(new Float64Array(16),this.labelPlaneMatrix,u),d.J(u,u,[0,0,-this.elevation]),this.modelViewProjectionMatrix=u,this.invModelViewProjectionMatrix=d.as([],u),this.fogMatrix=new Float64Array(16),d.b6(this.fogMatrix,this._fov,this.width/this.height,p,this.farZ),this.fogMatrix[8]=2*-e.x/this.width,this.fogMatrix[9]=2*e.y/this.height,d.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),d.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),d.b7(this.fogMatrix,this.fogMatrix,this._pitch),d.ad(this.fogMatrix,this.fogMatrix,this.angle),d.J(this.fogMatrix,this.fogMatrix,[-o,-l,0]),d.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),d.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=d.L(new Float64Array(16),this.labelPlaneMatrix,u);const ae=this.width%2/2,ue=this.height%2/2,me=Math.cos(this.angle),ie=Math.sin(this.angle),ve=o-Math.round(o)+me*ae+ie*ue,be=l-Math.round(l)+me*ue+ie*ae,Ie=new Float64Array(u);if(d.J(Ie,Ie,[ve>.5?ve-1:ve,be>.5?be-1:be,0]),this.alignedModelViewProjectionMatrix=Ie,u=d.as(new Float64Array(16),this.pixelMatrix),!u)throw new Error("failed to invert matrix");this.pixelMatrixInverse=u,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const e=this.pointCoordinate(new d.P(0,0)),o=[e.x*this.worldSize,e.y*this.worldSize,0,1];return d.af(o,o,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new d.P(0,e))}getCameraQueryGeometry(e){const o=this.getCameraPoint();if(e.length===1)return[e[0],o];{let l=o.x,u=o.y,p=o.x,v=o.y;for(const w of e)l=Math.min(l,w.x),u=Math.min(u,w.y),p=Math.max(p,w.x),v=Math.max(v,w.y);return[new d.P(l,u),new d.P(p,u),new d.P(p,v),new d.P(l,v),new d.P(l,u)]}}lngLatToCameraDepth(e,o){const l=this.locationCoordinate(e),u=[l.x*this.worldSize,l.y*this.worldSize,o,1];return d.af(u,u,this.modelViewProjectionMatrix),u[2]/u[3]}}function Zl(f,e){let o,l=!1,u=null,p=null;const v=()=>{u=null,l&&(f.apply(p,o),u=setTimeout(v,e),l=!1)};return(...w)=>(l=!0,p=this,o=w,u||v(),u)}class wu{constructor(e){this._getCurrentHash=()=>{const o=window.location.hash.replace("#","");if(this._hashName){let l;return o.split("&").map((u=>u.split("="))).forEach((u=>{u[0]===this._hashName&&(l=u)})),(l&&l[1]||"").split("/")}return o.split("/")},this._onHashChange=()=>{const o=this._getCurrentHash();if(o.length>=3&&!o.some((l=>isNaN(l)))){const l=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(o[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:l,pitch:+(o[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const o=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,o)},this._removeHash=()=>{const o=this._getCurrentHash();if(o.length===0)return;const l=o.join("/");let u=l;u.split("&").length>0&&(u=u.split("&")[0]),this._hashName&&(u=`${this._hashName}=${l}`);let p=window.location.hash.replace(u,"");p.startsWith("#&")?p=p.slice(0,1)+p.slice(2):p==="#"&&(p="");let v=window.location.href.replace(/(#.+)?$/,p);v=v.replace("&&","&"),window.history.replaceState(window.history.state,null,v)},this._updateHash=Zl(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const o=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,u=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),p=Math.pow(10,u),v=Math.round(o.lng*p)/p,w=Math.round(o.lat*p)/p,S=this._map.getBearing(),C=this._map.getPitch();let F="";if(F+=e?`/${v}/${w}/${l}`:`${l}/${w}/${v}`,(S||C)&&(F+="/"+Math.round(10*S)/10),C&&(F+=`/${Math.round(C)}`),this._hashName){const B=this._hashName;let $=!1;const K=window.location.hash.slice(1).split("&").map((Q=>{const te=Q.split("=")[0];return te===B?($=!0,`${te}=${F}`):Q})).filter((Q=>Q));return $||K.push(`${B}=${F}`),`#${K.join("&")}`}return`#${F}`}}const Za={linearity:.3,easing:d.b8(0,0,.3,1)},ql=d.e({deceleration:2500,maxSpeed:1400},Za),Gl=d.e({deceleration:20,maxSpeed:1400},Za),bu=d.e({deceleration:1e3,maxSpeed:360},Za),Hl=d.e({deceleration:1e3,maxSpeed:90},Za);class ul{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:re.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,o=re.now();for(;e.length>0&&o-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const o={zoom:0,bearing:0,pitch:0,pan:new d.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:p}of this._inertiaBuffer)o.zoom+=p.zoomDelta||0,o.bearing+=p.bearingDelta||0,o.pitch+=p.pitchDelta||0,p.panDelta&&o.pan._add(p.panDelta),p.around&&(o.around=p.around),p.pinchAround&&(o.pinchAround=p.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,u={};if(o.pan.mag()){const p=Vs(o.pan.mag(),l,d.e({},ql,e||{}));u.offset=o.pan.mult(p.amount/o.pan.mag()),u.center=this._map.transform.center,va(u,p)}if(o.zoom){const p=Vs(o.zoom,l,Gl);u.zoom=this._map.transform.zoom+p.amount,va(u,p)}if(o.bearing){const p=Vs(o.bearing,l,bu);u.bearing=this._map.transform.bearing+d.ac(p.amount,-179,179),va(u,p)}if(o.pitch){const p=Vs(o.pitch,l,Hl);u.pitch=this._map.transform.pitch+p.amount,va(u,p)}if(u.zoom||u.bearing){const p=o.pinchAround===void 0?o.around:o.pinchAround;u.around=p?this._map.unproject(p):this._map.getCenter()}return this.clear(),d.e(u,{noMoveStart:!0})}}function va(f,e){(!f.duration||f.duration<e.duration)&&(f.duration=e.duration,f.easing=e.easing)}function Vs(f,e,o){const{maxSpeed:l,linearity:u,deceleration:p}=o,v=d.ac(f*u/(e/1e3),-l,l),w=Math.abs(v)/(p*u);return{easing:o.easing,duration:1e3*w,amount:v*(w/2)}}class fn extends d.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,o,l,u={}){const p=ne.mousePos(o.getCanvas(),l),v=o.unproject(p);super(e,d.e({point:p,lngLat:v,originalEvent:l},u)),this._defaultPrevented=!1,this.target=o}}class xa extends d.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,o,l){const u=e==="touchend"?l.changedTouches:l.touches,p=ne.touchPos(o.getCanvasContainer(),u),v=p.map((S=>o.unproject(S))),w=p.reduce(((S,C,F,B)=>S.add(C.div(B.length))),new d.P(0,0));super(e,{points:p,point:w,lngLats:v,lngLat:o.unproject(w),originalEvent:l}),this._defaultPrevented=!1}}class Ku extends d.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,o,l){super(e,{originalEvent:l}),this._defaultPrevented=!1}}class Ju{constructor(e,o){this._map=e,this._clickTolerance=o.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Ku(e.type,this._map,e))}mousedown(e,o){return this._mousedownPos=o,this._firePreventable(new fn(e.type,this._map,e))}mouseup(e){this._map.fire(new fn(e.type,this._map,e))}click(e,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||this._map.fire(new fn(e.type,this._map,e))}dblclick(e){return this._firePreventable(new fn(e.type,this._map,e))}mouseover(e){this._map.fire(new fn(e.type,this._map,e))}mouseout(e){this._map.fire(new fn(e.type,this._map,e))}touchstart(e){return this._firePreventable(new xa(e.type,this._map,e))}touchmove(e){this._map.fire(new xa(e.type,this._map,e))}touchend(e){this._map.fire(new xa(e.type,this._map,e))}touchcancel(e){this._map.fire(new xa(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ti{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new fn(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new fn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new fn(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Co{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.pointLocation(d.P.convert(e),this._map.terrain)}}class Wn{constructor(e,o){this._map=e,this._tr=new Co(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=o.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,o){this.isEnabled()&&e.shiftKey&&e.button===0&&(ne.disableDrag(),this._startPos=this._lastPos=o,this._active=!0)}mousemoveWindow(e,o){if(!this._active)return;const l=o;if(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)return;const u=this._startPos;this._lastPos=l,this._box||(this._box=ne.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const p=Math.min(u.x,l.x),v=Math.max(u.x,l.x),w=Math.min(u.y,l.y),S=Math.max(u.y,l.y);ne.setTransform(this._box,`translate(${p}px,${w}px)`),this._box.style.width=v-p+"px",this._box.style.height=S-w+"px"}mouseupWindow(e,o){if(!this._active||e.button!==0)return;const l=this._startPos,u=o;if(this.reset(),ne.suppressClick(),l.x!==u.x||l.y!==u.y)return this._map.fire(new d.k("boxzoomend",{originalEvent:e})),{cameraAnimation:p=>p.fitScreenCoordinates(l,u,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(ne.remove(this._box),this._box=null),ne.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,o){return this._map.fire(new d.k(e,{originalEvent:o}))}}function cl(f,e){if(f.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${f.length}, points ${e.length}`);const o={};for(let l=0;l<f.length;l++)o[f[l].identifier]=e[l];return o}class wa{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,o,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),l.length===this.numTouches&&(this.centroid=(function(u){const p=new d.P(0,0);for(const v of u)p._add(v);return p.div(u.length)})(o),this.touches=cl(l,o)))}touchmove(e,o,l){if(this.aborted||!this.centroid)return;const u=cl(l,o);for(const p in this.touches){const v=u[p];(!v||v.dist(this.touches[p])>30)&&(this.aborted=!0)}}touchend(e,o,l){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const u=!this.aborted&&this.centroid;if(this.reset(),u)return u}}}class hl{constructor(e){this.singleTap=new wa(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,o,l){this.singleTap.touchstart(e,o,l)}touchmove(e,o,l){this.singleTap.touchmove(e,o,l)}touchend(e,o,l){const u=this.singleTap.touchend(e,o,l);if(u){const p=e.timeStamp-this.lastTime<500,v=!this.lastTap||this.lastTap.dist(u)<30;if(p&&v||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=u,this.count===this.numTaps)return this.reset(),u}}}class _s{constructor(e){this._tr=new Co(e),this._zoomIn=new hl({numTouches:1,numTaps:2}),this._zoomOut=new hl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,o,l){this._zoomIn.touchstart(e,o,l),this._zoomOut.touchstart(e,o,l)}touchmove(e,o,l){this._zoomIn.touchmove(e,o,l),this._zoomOut.touchmove(e,o,l)}touchend(e,o,l){const u=this._zoomIn.touchend(e,o,l),p=this._zoomOut.touchend(e,o,l),v=this._tr;return u?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:v.zoom+1,around:v.unproject(u)},{originalEvent:e})}):p?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:v.zoom-1,around:v.unproject(p)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qa{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const o=this._moveFunction(...e);if(o.bearingDelta||o.pitchDelta||o.around||o.panDelta)return this._active=!0,o}dragStart(e,o){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=o.length?o[0]:o,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,o){if(!this.isEnabled())return;const l=this._lastPoint;if(!l)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const u=o.length?o[0]:o;return!this._moved&&u.dist(l)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=u,this._move(l,u))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&ne.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Yu={0:1,2:2};class vs{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const o=ne.mouseButton(e);this._eventButton=o}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!(function(o,l){const u=Yu[l];return o.buttons===void 0||(o.buttons&u)!==u})(e,this._eventButton)}isValidEndEvent(e){return ne.mouseButton(e)===this._eventButton}}class Qu{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}const Wl=f=>{f.mousedown=f.dragStart,f.mousemoveWindow=f.dragMove,f.mouseup=f.dragEnd,f.contextmenu=e=>{e.preventDefault()}},Su=({enable:f,clickTolerance:e,bearingDegreesPerPixelMoved:o=.8})=>{const l=new vs({checkCorrectEvent:u=>ne.mouseButton(u)===0&&u.ctrlKey||ne.mouseButton(u)===2});return new qa({clickTolerance:e,move:(u,p)=>({bearingDelta:(p.x-u.x)*o}),moveStateManager:l,enable:f,assignEvents:Wl})},ni=({enable:f,clickTolerance:e,pitchDegreesPerPixelMoved:o=-.5})=>{const l=new vs({checkCorrectEvent:u=>ne.mouseButton(u)===0&&u.ctrlKey||ne.mouseButton(u)===2});return new qa({clickTolerance:e,move:(u,p)=>({pitchDelta:(p.y-u.y)*o}),moveStateManager:l,enable:f,assignEvents:Wl})};class Ga{constructor(e,o){this._clickTolerance=e.clickTolerance||1,this._map=o,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new d.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,o,l){return this._calculateTransform(e,o,l)}touchmove(e,o,l){if(this._active){if(!this._shouldBePrevented(l.length))return e.preventDefault(),this._calculateTransform(e,o,l);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,o,l){this._calculateTransform(e,o,l),this._active&&this._shouldBePrevented(l.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,o,l){l.length>0&&(this._active=!0);const u=cl(l,o),p=new d.P(0,0),v=new d.P(0,0);let w=0;for(const C in u){const F=u[C],B=this._touches[C];B&&(p._add(F),v._add(F.sub(B)),w++,u[C]=F)}if(this._touches=u,this._shouldBePrevented(w)||!v.mag())return;const S=v.div(w);return this._sum._add(S),this._sum.mag()<this._clickTolerance?void 0:{around:p.div(w),panDelta:S}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Us{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,o,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([o[0],o[1]]))}touchmove(e,o,l){if(!this._firstTwoTouches)return;e.preventDefault();const[u,p]=this._firstTwoTouches,v=Ha(l,o,u),w=Ha(l,o,p);if(!v||!w)return;const S=this._aroundCenter?null:v.add(w).div(2);return this._move([v,w],S,e)}touchend(e,o,l){if(!this._firstTwoTouches)return;const[u,p]=this._firstTwoTouches,v=Ha(l,o,u),w=Ha(l,o,p);v&&w||(this._active&&ne.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Ha(f,e,o){for(let l=0;l<f.length;l++)if(f[l].identifier===o)return e[l]}function ku(f,e){return Math.log(f/e)/Math.LN2}class Xl extends Us{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,o){const l=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(ku(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ku(this._distance,l),pinchAround:o}}}function $s(f,e){return 180*f.angleWith(e)/Math.PI}class dl extends Us{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,o,l){const u=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:$s(this._vector,u),pinchAround:o}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const o=25/(Math.PI*this._minDiameter)*360,l=$s(e,this._startVector);return Math.abs(l)<o}}function Wa(f){return Math.abs(f.y)>Math.abs(f.x)}class pl extends Us{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,o,l){super.touchstart(e,o,l),this._currentTouchCount=l.length}_start(e){this._lastPoints=e,Wa(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,o,l){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const u=e[0].sub(this._lastPoints[0]),p=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(u,p,l.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(u.y+p.y)/2*-.5}):void 0}gestureBeginsVertically(e,o,l){if(this._valid!==void 0)return this._valid;const u=e.mag()>=2,p=o.mag()>=2;if(!u&&!p)return;if(!u||!p)return this._firstMove===void 0&&(this._firstMove=l),l-this._firstMove<100&&void 0;const v=e.y>0==o.y>0;return Wa(e)&&Wa(o)&&v}}const Uc={panStep:100,bearingStep:15,pitchStep:10};class Io{constructor(e){this._tr=new Co(e);const o=Uc;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let o=0,l=0,u=0,p=0,v=0;switch(e.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:e.shiftKey?l=-1:(e.preventDefault(),p=-1);break;case 39:e.shiftKey?l=1:(e.preventDefault(),p=1);break;case 38:e.shiftKey?u=1:(e.preventDefault(),v=-1);break;case 40:e.shiftKey?u=-1:(e.preventDefault(),v=1);break;default:return}return this._rotationDisabled&&(l=0,u=0),{cameraAnimation:w=>{const S=this._tr;w.easeTo({duration:300,easeId:"keyboardHandler",easing:Wo,zoom:o?Math.round(S.zoom)+o*(e.shiftKey?2:1):S.zoom,bearing:S.bearing+l*this._bearingStep,pitch:S.pitch+u*this._pitchStep,offset:[-p*this._panStep,-v*this._panStep],center:S.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Wo(f){return f*(2-f)}const fl=4.000244140625;class Xn{constructor(e,o){this._onTimeout=l=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},this._map=e,this._tr=new Co(e),this._triggerRenderFrame=o,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let o=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const l=re.now(),u=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,o!==0&&o%fl==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":u>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(u*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),e.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=e,this._delta-=o,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const o=ne.mousePos(this._map.getCanvas(),e),l=this._tr;this._around=o.y>l.transform.height/2-l.transform.getHorizon()?d.N.convert(this._aroundCenter?l.center:l.unproject(o)):d.N.convert(l.center),this._aroundPoint=l.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(this._delta!==0){const S=this._type==="wheel"&&Math.abs(this._delta)>fl?this._wheelZoomRate:this._defaultZoomRate;let C=2/(1+Math.exp(-Math.abs(this._delta*S)));this._delta<0&&C!==0&&(C=1/C);const F=typeof this._targetZoom=="number"?e.zoomScale(this._targetZoom):e.scale;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(F*C))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const o=typeof this._targetZoom=="number"?this._targetZoom:e.zoom,l=this._startZoom,u=this._easing;let p,v=!1;const w=re.now()-this._lastWheelEventTime;if(this._type==="wheel"&&l&&u&&w){const S=Math.min(w/200,1),C=u(S);p=d.y.number(l,o,C),S<1?this._frameId||(this._frameId=!0):v=!0}else p=o,v=!0;return this._active=!0,v&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!v,zoomDelta:p-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let o=d.b9;if(this._prevEase){const l=this._prevEase,u=(re.now()-l.start)/l.duration,p=l.easing(u+.01)-l.easing(u),v=.27/Math.sqrt(p*p+1e-4)*.01,w=Math.sqrt(.0729-v*v);o=d.b8(v,w,.25,1)}return this._prevEase={start:re.now(),duration:e,easing:o},o}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Xa{constructor(e,o){this._clickZoom=e,this._tapZoom=o}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ec{constructor(e){this._tr=new Co(e),this.reset()}reset(){this._active=!1}dblclick(e,o){return e.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(o)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class tc{constructor(){this._tap=new hl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,o,l){if(!this._swipePoint)if(this._tapTime){const u=o[0],p=e.timeStamp-this._tapTime<500,v=this._tapPoint.dist(u)<30;p&&v?l.length>0&&(this._swipePoint=u,this._swipeTouch=l[0].identifier):this.reset()}else this._tap.touchstart(e,o,l)}touchmove(e,o,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const u=o[0],p=u.y-this._swipePoint.y;return this._swipePoint=u,e.preventDefault(),this._active=!0,{zoomDelta:p/128}}}else this._tap.touchmove(e,o,l)}touchend(e,o,l){if(this._tapTime)this._swipePoint&&l.length===0&&this.reset();else{const u=this._tap.touchend(e,o,l);u&&(this._tapTime=e.timeStamp,this._tapPoint=u)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Tu{constructor(e,o,l){this._el=e,this._mousePan=o,this._touchPan=l}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class $c{constructor(e,o,l){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=o,this._mousePitch=l}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class zu{constructor(e,o,l,u){this._el=e,this._touchZoom=o,this._touchRotate=l,this._tapDragZoom=u,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class ml{constructor(e,o){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=o,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=ne.create("div","maplibregl-cooperative-gesture-screen",e);let o=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(o=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const l=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),u=document.createElement("div");u.className="maplibregl-desktop-message",u.textContent=o,this._container.appendChild(u);const p=document.createElement("div");p.className="maplibregl-mobile-message",p.textContent=l,this._container.appendChild(p),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(ne.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,o){this._enabled&&(this._map.fire(new d.k("cooperativegestureprevented",{gestureType:e,originalEvent:o})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const Po=f=>f.zoom||f.drag||f.pitch||f.rotate;class wt extends d.k{}function Xo(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta}class Eu{constructor(e,o){this.handleWindowEvent=u=>{this.handleEvent(u,`${u.type}Window`)},this.handleEvent=(u,p)=>{if(u.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const v=u.type==="renderFrame"?void 0:u,w={needsRenderFrame:!1},S={},C={},F=u.touches,B=F?this._getMapTouches(F):void 0,$=B?ne.touchPos(this._map.getCanvas(),B):ne.mousePos(this._map.getCanvas(),u);for(const{handlerName:te,handler:ae,allowed:ue}of this._handlers){if(!ae.isEnabled())continue;let me;this._blockedByActive(C,ue,te)?ae.reset():ae[p||u.type]&&(me=ae[p||u.type](u,$,B),this.mergeHandlerResult(w,S,me,te,v),me&&me.needsRenderFrame&&this._triggerRenderFrame()),(me||ae.isActive())&&(C[te]=ae)}const K={};for(const te in this._previousActiveHandlers)C[te]||(K[te]=v);this._previousActiveHandlers=C,(Object.keys(K).length||Xo(w))&&(this._changes.push([w,S,K]),this._triggerRenderFrame()),(Object.keys(C).length||Xo(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Q}=w;Q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Q(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ul(e),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(o);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[window,"blur",void 0]];for(const[u,p,v]of this._listeners)ne.addEventListener(u,p,u===document?this.handleWindowEvent:this.handleEvent,v)}destroy(){for(const[e,o,l]of this._listeners)ne.removeEventListener(e,o,e===document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(e){const o=this._map,l=o.getCanvasContainer();this._add("mapEvent",new Ju(o,e));const u=o.boxZoom=new Wn(o,e);this._add("boxZoom",u),e.interactive&&e.boxZoom&&u.enable();const p=o.cooperativeGestures=new ml(o,e.cooperativeGestures);this._add("cooperativeGestures",p),e.cooperativeGestures&&p.enable();const v=new _s(o),w=new ec(o);o.doubleClickZoom=new Xa(w,v),this._add("tapZoom",v),this._add("clickZoom",w),e.interactive&&e.doubleClickZoom&&o.doubleClickZoom.enable();const S=new tc;this._add("tapDragZoom",S);const C=o.touchPitch=new pl(o);this._add("touchPitch",C),e.interactive&&e.touchPitch&&o.touchPitch.enable(e.touchPitch);const F=Su(e),B=ni(e);o.dragRotate=new $c(e,F,B),this._add("mouseRotate",F,["mousePitch"]),this._add("mousePitch",B,["mouseRotate"]),e.interactive&&e.dragRotate&&o.dragRotate.enable();const $=(({enable:me,clickTolerance:ie})=>{const ve=new vs({checkCorrectEvent:be=>ne.mouseButton(be)===0&&!be.ctrlKey});return new qa({clickTolerance:ie,move:(be,Ie)=>({around:Ie,panDelta:Ie.sub(be)}),activateOnStart:!0,moveStateManager:ve,enable:me,assignEvents:Wl})})(e),K=new Ga(e,o);o.dragPan=new Tu(l,$,K),this._add("mousePan",$),this._add("touchPan",K,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&o.dragPan.enable(e.dragPan);const Q=new dl,te=new Xl;o.touchZoomRotate=new zu(l,te,Q,S),this._add("touchRotate",Q,["touchPan","touchZoom"]),this._add("touchZoom",te,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&o.touchZoomRotate.enable(e.touchZoomRotate);const ae=o.scrollZoom=new Xn(o,(()=>this._triggerRenderFrame()));this._add("scrollZoom",ae,["mousePan"]),e.interactive&&e.scrollZoom&&o.scrollZoom.enable(e.scrollZoom);const ue=o.keyboard=new Io(o);this._add("keyboard",ue),e.interactive&&e.keyboard&&o.keyboard.enable(),this._add("blockableMapEvent",new Ti(o))}_add(e,o,l){this._handlers.push({handlerName:e,handler:o,allowed:l}),this._handlersById[e]=o}stop(e){if(!this._updatingCamera){for(const{handler:o}of this._handlers)o.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Po(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,o,l){for(const u in e)if(u!==l&&(!o||o.indexOf(u)<0))return!0;return!1}_getMapTouches(e){const o=[];for(const l of e)this._el.contains(l.target)&&o.push(l);return o}mergeHandlerResult(e,o,l,u,p){if(!l)return;d.e(e,l);const v={handlerName:u,originalEvent:l.originalEvent||p};l.zoomDelta!==void 0&&(o.zoom=v),l.panDelta!==void 0&&(o.drag=v),l.pitchDelta!==void 0&&(o.pitch=v),l.bearingDelta!==void 0&&(o.rotate=v)}_applyChanges(){const e={},o={},l={};for(const[u,p,v]of this._changes)u.panDelta&&(e.panDelta=(e.panDelta||new d.P(0,0))._add(u.panDelta)),u.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+u.zoomDelta),u.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+u.bearingDelta),u.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+u.pitchDelta),u.around!==void 0&&(e.around=u.around),u.pinchAround!==void 0&&(e.pinchAround=u.pinchAround),u.noInertia&&(e.noInertia=u.noInertia),d.e(o,p),d.e(l,v);this._updateMapTransform(e,o,l),this._changes=[]}_updateMapTransform(e,o,l){const u=this._map,p=u._getTransformForUpdate(),v=u.terrain;if(!(Xo(e)||v&&this._terrainMovement))return this._fireEvents(o,l,!0);let{panDelta:w,zoomDelta:S,bearingDelta:C,pitchDelta:F,around:B,pinchAround:$}=e;$!==void 0&&(B=$),u._stop(!0),B=B||u.transform.centerPoint;const K=p.pointLocation(w?B.sub(w):B);C&&(p.bearing+=C),F&&(p.pitch+=F),S&&(p.zoom+=S),v?this._terrainMovement||!o.drag&&!o.zoom?o.drag&&this._terrainMovement?p.center=p.pointLocation(p.centerPoint.sub(w)):p.setLocationAtPoint(K,B):(this._terrainMovement=!0,this._map._elevationFreeze=!0,p.setLocationAtPoint(K,B)):p.setLocationAtPoint(K,B),u._applyUpdatedTransform(p),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(o,l,!0)}_fireEvents(e,o,l){const u=Po(this._eventsInProgress),p=Po(e),v={};for(const B in e){const{originalEvent:$}=e[B];this._eventsInProgress[B]||(v[`${B}start`]=$),this._eventsInProgress[B]=e[B]}!u&&p&&this._fireEvent("movestart",p.originalEvent);for(const B in v)this._fireEvent(B,v[B]);p&&this._fireEvent("move",p.originalEvent);for(const B in e){const{originalEvent:$}=e[B];this._fireEvent(B,$)}const w={};let S;for(const B in this._eventsInProgress){const{handlerName:$,originalEvent:K}=this._eventsInProgress[B];this._handlersById[$].isActive()||(delete this._eventsInProgress[B],S=o[$]||K,w[`${B}end`]=S)}for(const B in w)this._fireEvent(B,w[B]);const C=Po(this._eventsInProgress),F=(u||p)&&!C;if(F&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const B=this._map._getTransformForUpdate();B.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(B)}if(l&&F){this._updatingCamera=!0;const B=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),$=K=>K!==0&&-this._bearingSnap<K&&K<this._bearingSnap;!B||!B.essential&&re.prefersReducedMotion?(this._map.fire(new d.k("moveend",{originalEvent:S})),$(this._map.getBearing())&&this._map.resetNorth()):($(B.bearing||this._map.getBearing())&&(B.bearing=0),B.freezeElevation=!0,this._map.easeTo(B,{originalEvent:S})),this._updatingCamera=!1}}_fireEvent(e,o){this._map.fire(new d.k(e,o?{originalEvent:o}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((e=>{delete this._frameId,this.handleEvent(new wt("renderFrame",{timeStamp:e})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Zs extends d.E{constructor(e,o){super(),this._renderFrameCallback=()=>{const l=Math.min((re.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(l)),l<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=o.bearingSnap,this.on("moveend",(()=>{delete this._requestedCameraState}))}getCenter(){return new d.N(this.transform.center.lng,this.transform.center.lat)}setCenter(e,o){return this.jumpTo({center:e},o)}panBy(e,o,l){return e=d.P.convert(e).mult(-1),this.panTo(this.transform.center,d.e({offset:e},o),l)}panTo(e,o,l){return this.easeTo(d.e({center:e},o),l)}getZoom(){return this.transform.zoom}setZoom(e,o){return this.jumpTo({zoom:e},o),this}zoomTo(e,o,l){return this.easeTo(d.e({zoom:e},o),l)}zoomIn(e,o){return this.zoomTo(this.getZoom()+1,e,o),this}zoomOut(e,o){return this.zoomTo(this.getZoom()-1,e,o),this}getBearing(){return this.transform.bearing}setBearing(e,o){return this.jumpTo({bearing:e},o),this}getPadding(){return this.transform.padding}setPadding(e,o){return this.jumpTo({padding:e},o),this}rotateTo(e,o,l){return this.easeTo(d.e({bearing:e},o),l)}resetNorth(e,o){return this.rotateTo(0,d.e({duration:1e3},e),o),this}resetNorthPitch(e,o){return this.easeTo(d.e({bearing:0,pitch:0,duration:1e3},e),o),this}snapToNorth(e,o){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,o):this}getPitch(){return this.transform.pitch}setPitch(e,o){return this.jumpTo({pitch:e},o),this}cameraForBounds(e,o){e=Fe.convert(e).adjustAntiMeridian();const l=o&&o.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),l,o)}_cameraForBoxAndBearing(e,o,l,u){const p={top:0,bottom:0,right:0,left:0};if(typeof(u=d.e({padding:p,offset:[0,0],maxZoom:this.transform.maxZoom},u)).padding=="number"){const ut=u.padding;u.padding={top:ut,bottom:ut,right:ut,left:ut}}u.padding=d.e(p,u.padding);const v=this.transform,w=v.padding,S=new Fe(e,o),C=v.project(S.getNorthWest()),F=v.project(S.getNorthEast()),B=v.project(S.getSouthEast()),$=v.project(S.getSouthWest()),K=d.ba(-l),Q=C.rotate(K),te=F.rotate(K),ae=B.rotate(K),ue=$.rotate(K),me=new d.P(Math.max(Q.x,te.x,ue.x,ae.x),Math.max(Q.y,te.y,ue.y,ae.y)),ie=new d.P(Math.min(Q.x,te.x,ue.x,ae.x),Math.min(Q.y,te.y,ue.y,ae.y)),ve=me.sub(ie),be=(v.width-(w.left+w.right+u.padding.left+u.padding.right))/ve.x,Ie=(v.height-(w.top+w.bottom+u.padding.top+u.padding.bottom))/ve.y;if(Ie<0||be<0)return void d.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Ue=Math.min(v.scaleZoom(v.scale*Math.min(be,Ie)),u.maxZoom),tt=d.P.convert(u.offset),lt=new d.P((u.padding.left-u.padding.right)/2,(u.padding.top-u.padding.bottom)/2).rotate(d.ba(l)),gt=tt.add(lt).mult(v.scale/v.zoomScale(Ue));return{center:v.unproject(C.add(B).div(2).sub(gt)),zoom:Ue,bearing:l}}fitBounds(e,o,l){return this._fitInternal(this.cameraForBounds(e,o),o,l)}fitScreenCoordinates(e,o,l,u,p){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(d.P.convert(e)),this.transform.pointLocation(d.P.convert(o)),l,u),u,p)}_fitInternal(e,o,l){return e?(delete(o=d.e(e,o)).padding,o.linear?this.easeTo(o,l):this.flyTo(o,l)):this}jumpTo(e,o){this.stop();const l=this._getTransformForUpdate();let u=!1,p=!1,v=!1;return"zoom"in e&&l.zoom!==+e.zoom&&(u=!0,l.zoom=+e.zoom),e.center!==void 0&&(l.center=d.N.convert(e.center)),"bearing"in e&&l.bearing!==+e.bearing&&(p=!0,l.bearing=+e.bearing),"pitch"in e&&l.pitch!==+e.pitch&&(v=!0,l.pitch=+e.pitch),e.padding==null||l.isPaddingEqual(e.padding)||(l.padding=e.padding),this._applyUpdatedTransform(l),this.fire(new d.k("movestart",o)).fire(new d.k("move",o)),u&&this.fire(new d.k("zoomstart",o)).fire(new d.k("zoom",o)).fire(new d.k("zoomend",o)),p&&this.fire(new d.k("rotatestart",o)).fire(new d.k("rotate",o)).fire(new d.k("rotateend",o)),v&&this.fire(new d.k("pitchstart",o)).fire(new d.k("pitch",o)).fire(new d.k("pitchend",o)),this.fire(new d.k("moveend",o))}calculateCameraOptionsFromTo(e,o,l,u=0){const p=d.Z.fromLngLat(e,o),v=d.Z.fromLngLat(l,u),w=v.x-p.x,S=v.y-p.y,C=v.z-p.z,F=Math.hypot(w,S,C);if(F===0)throw new Error("Can't calculate camera options with same From and To");const B=Math.hypot(w,S),$=this.transform.scaleZoom(this.transform.cameraToCenterDistance/F/this.transform.tileSize),K=180*Math.atan2(w,-S)/Math.PI;let Q=180*Math.acos(B/F)/Math.PI;return Q=C<0?90-Q:90+Q,{center:v.toLngLat(),zoom:$,pitch:Q,bearing:K}}easeTo(e,o){var l;this._stop(!1,e.easeId),((e=d.e({offset:[0,0],duration:500,easing:d.b9},e)).animate===!1||!e.essential&&re.prefersReducedMotion)&&(e.duration=0);const u=this._getTransformForUpdate(),p=u.zoom,v=u.bearing,w=u.pitch,S=u.padding,C="bearing"in e?this._normalizeBearing(e.bearing,v):v,F="pitch"in e?+e.pitch:w,B="padding"in e?e.padding:u.padding,$=d.P.convert(e.offset);let K=u.centerPoint.add($);const Q=u.pointLocation(K),{center:te,zoom:ae}=u.getConstrained(d.N.convert(e.center||Q),(l=e.zoom)!==null&&l!==void 0?l:p);this._normalizeCenter(te,u);const ue=u.project(Q),me=u.project(te).sub(ue),ie=u.zoomScale(ae-p);let ve,be;e.around&&(ve=d.N.convert(e.around),be=u.locationPoint(ve));const Ie={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||ae!==p,this._rotating=this._rotating||v!==C,this._pitching=this._pitching||F!==w,this._padding=!u.isPaddingEqual(B),this._easeId=e.easeId,this._prepareEase(o,e.noMoveStart,Ie),this.terrain&&this._prepareElevation(te),this._ease((Ue=>{if(this._zooming&&(u.zoom=d.y.number(p,ae,Ue)),this._rotating&&(u.bearing=d.y.number(v,C,Ue)),this._pitching&&(u.pitch=d.y.number(w,F,Ue)),this._padding&&(u.interpolatePadding(S,B,Ue),K=u.centerPoint.add($)),this.terrain&&!e.freezeElevation&&this._updateElevation(Ue),ve)u.setLocationAtPoint(ve,be);else{const tt=u.zoomScale(u.zoom-p),lt=ae>p?Math.min(2,ie):Math.max(.5,ie),gt=Math.pow(lt,1-Ue),ut=u.unproject(ue.add(me.mult(Ue*gt)).mult(tt));u.setLocationAtPoint(u.renderWorldCopies?ut.wrap():ut,K)}this._applyUpdatedTransform(u),this._fireMoveEvents(o)}),(Ue=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(o,Ue)}),e),this}_prepareEase(e,o,l={}){this._moving=!0,o||l.moving||this.fire(new d.k("movestart",e)),this._zooming&&!l.zooming&&this.fire(new d.k("zoomstart",e)),this._rotating&&!l.rotating&&this.fire(new d.k("rotatestart",e)),this._pitching&&!l.pitching&&this.fire(new d.k("pitchstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const o=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&o!==this._elevationTarget){const l=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(l-(o-(l*e+this._elevationStart))/(1-e)),this._elevationTarget=o}this.transform.elevation=d.y.number(this._elevationStart,this._elevationTarget,e)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){const o=e.getCameraPosition(),l=this.terrain.getElevationForLngLatZoom(o.lngLat,e.zoom);if(o.altitude<l){const u=this.calculateCameraOptionsFromTo(o.lngLat,l,e.center,e.elevation);return{pitch:u.pitch,zoom:u.zoom}}return{}}_applyUpdatedTransform(e){const o=[];if(this.terrain&&o.push((u=>this._elevateCameraIfInsideTerrain(u))),this.transformCameraUpdate&&o.push((u=>this.transformCameraUpdate(u))),!o.length)return;const l=e.clone();for(const u of o){const p=l.clone(),{center:v,zoom:w,pitch:S,bearing:C,elevation:F}=u(p);v&&(p.center=v),w!==void 0&&(p.zoom=w),S!==void 0&&(p.pitch=S),C!==void 0&&(p.bearing=C),F!==void 0&&(p.elevation=F),l.apply(p)}this.transform.apply(l)}_fireMoveEvents(e){this.fire(new d.k("move",e)),this._zooming&&this.fire(new d.k("zoom",e)),this._rotating&&this.fire(new d.k("rotate",e)),this._pitching&&this.fire(new d.k("pitch",e))}_afterEase(e,o){if(this._easeId&&o&&this._easeId===o)return;delete this._easeId;const l=this._zooming,u=this._rotating,p=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,l&&this.fire(new d.k("zoomend",e)),u&&this.fire(new d.k("rotateend",e)),p&&this.fire(new d.k("pitchend",e)),this.fire(new d.k("moveend",e))}flyTo(e,o){var l;if(!e.essential&&re.prefersReducedMotion){const dt=d.M(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(dt,o)}this.stop(),e=d.e({offset:[0,0],speed:1.2,curve:1.42,easing:d.b9},e);const u=this._getTransformForUpdate(),p=u.zoom,v=u.bearing,w=u.pitch,S=u.padding,C="bearing"in e?this._normalizeBearing(e.bearing,v):v,F="pitch"in e?+e.pitch:w,B="padding"in e?e.padding:u.padding,$=d.P.convert(e.offset);let K=u.centerPoint.add($);const Q=u.pointLocation(K),{center:te,zoom:ae}=u.getConstrained(d.N.convert(e.center||Q),(l=e.zoom)!==null&&l!==void 0?l:p);this._normalizeCenter(te,u);const ue=u.zoomScale(ae-p),me=u.project(Q),ie=u.project(te).sub(me);let ve=e.curve;const be=Math.max(u.width,u.height),Ie=be/ue,Ue=ie.mag();if("minZoom"in e){const dt=d.ac(Math.min(e.minZoom,p,ae),u.minZoom,u.maxZoom),Wt=be/u.zoomScale(dt-p);ve=Math.sqrt(Wt/Ue*2)}const tt=ve*ve;function lt(dt){const Wt=(Ie*Ie-be*be+(dt?-1:1)*tt*tt*Ue*Ue)/(2*(dt?Ie:be)*tt*Ue);return Math.log(Math.sqrt(Wt*Wt+1)-Wt)}function gt(dt){return(Math.exp(dt)-Math.exp(-dt))/2}function ut(dt){return(Math.exp(dt)+Math.exp(-dt))/2}const ot=lt(!1);let zt=function(dt){return ut(ot)/ut(ot+ve*dt)},Jt=function(dt){return be*((ut(ot)*(gt(Wt=ot+ve*dt)/ut(Wt))-gt(ot))/tt)/Ue;var Wt},ct=(lt(!0)-ot)/ve;if(Math.abs(Ue)<1e-6||!isFinite(ct)){if(Math.abs(be-Ie)<1e-6)return this.easeTo(e,o);const dt=Ie<be?-1:1;ct=Math.abs(Math.log(Ie/be))/ve,Jt=()=>0,zt=Wt=>Math.exp(dt*ve*Wt)}return e.duration="duration"in e?+e.duration:1e3*ct/("screenSpeed"in e?+e.screenSpeed/ve:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=v!==C,this._pitching=F!==w,this._padding=!u.isPaddingEqual(B),this._prepareEase(o,!1),this.terrain&&this._prepareElevation(te),this._ease((dt=>{const Wt=dt*ct,Gr=1/zt(Wt);u.zoom=dt===1?ae:p+u.scaleZoom(Gr),this._rotating&&(u.bearing=d.y.number(v,C,dt)),this._pitching&&(u.pitch=d.y.number(w,F,dt)),this._padding&&(u.interpolatePadding(S,B,dt),K=u.centerPoint.add($)),this.terrain&&!e.freezeElevation&&this._updateElevation(dt);const or=dt===1?te:u.unproject(me.add(ie.mult(Jt(Wt))).mult(Gr));u.setLocationAtPoint(u.renderWorldCopies?or.wrap():or,K),this._applyUpdatedTransform(u),this._fireMoveEvents(o)}),(()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(o)}),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,o){var l;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const u=this._onEaseEnd;delete this._onEaseEnd,u.call(this,o)}return e||(l=this.handlers)===null||l===void 0||l.stop(!1),this}_ease(e,o,l){l.animate===!1||l.duration===0?(e(1),o()):(this._easeStart=re.now(),this._easeOptions=l,this._onEaseFrame=e,this._onEaseEnd=o,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,o){e=d.b3(e,-180,180);const l=Math.abs(e-o);return Math.abs(e-360-o)<l&&(e-=360),Math.abs(e+360-o)<l&&(e+=360),e}_normalizeCenter(e,o){if(!o.renderWorldCopies||o.lngRange)return;const l=e.lng-o.center.lng;e.lng+=l>180?-360:l<-180?360:0}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(d.N.convert(e),this.transform.tileZoom)-this.transform.elevation:null}}const Fn={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class ba{constructor(e=Fn){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=o=>{!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"&&o.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=ne.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=ne.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ne.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){ne.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,o){const l=this._map._getUIString(`AttributionControl.${o}`);e.title=l,e.setAttribute("aria-label",l)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map((u=>typeof u!="string"?"":u))):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const u=this._map.style.stylesheet;this.styleOwner=u.owner,this.styleId=u.id}const o=this._map.style.sourceCaches;for(const u in o){const p=o[u];if(p.used||p.usedForTerrain){const v=p.getSource();v.attribution&&e.indexOf(v.attribution)<0&&e.push(v.attribution)}}e=e.filter((u=>String(u).trim())),e.sort(((u,p)=>u.length-p.length)),e=e.filter(((u,p)=>{for(let v=p+1;v<e.length;v++)if(e[v].indexOf(u)>=0)return!1;return!0}));const l=e.join(" | ");l!==this._attribHTML&&(this._attribHTML=l,e.length?(this._innerContainer.innerHTML=l,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Ko{constructor(e={}){this._updateCompact=()=>{const o=this._container.children;if(o.length){const l=o[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&l.classList.add("maplibregl-compact"):l.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=ne.create("div","maplibregl-ctrl");const o=ne.create("a","maplibregl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://maplibre.org/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){ne.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class vr{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const o=++this._id;return this._queue.push({callback:e,id:o,cancelled:!1}),o}remove(e){const o=this._currentlyRunning,l=o?this._queue.concat(o):this._queue;for(const u of l)if(u.id===e)return void(u.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const o=this._currentlyRunning=this._queue;this._queue=[];for(const l of o)if(!l.cancelled&&(l.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var rc=d.Y([{name:"a_pos3d",type:"Int16",components:3}]);class Ih extends d.E{constructor(e){super(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,e.usedForTerrain=!0,e.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,o){this.sourceCache.update(e,o),this._renderableTilesKeys=[];const l={};for(const u of e.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:o}))l[u.key]=!0,this._renderableTilesKeys.push(u.key),this._tiles[u.key]||(u.posMatrix=new Float64Array(16),d.aP(u.posMatrix,0,d.X,0,d.X,0,1),this._tiles[u.key]=new ri(u,this.tileSize));for(const u in this._tiles)l[u]||delete this._tiles[u]}freeRtt(e){for(const o in this._tiles){const l=this._tiles[o];(!e||l.tileID.equals(e)||l.tileID.isChildOf(e)||e.isChildOf(l.tileID))&&(l.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((e=>this.getTileByID(e)))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){const o={};for(const l of this._renderableTilesKeys){const u=this._tiles[l].tileID;if(u.canonical.equals(e.canonical)){const p=e.clone();p.posMatrix=new Float64Array(16),d.aP(p.posMatrix,0,d.X,0,d.X,0,1),o[l]=p}else if(u.canonical.isChildOf(e.canonical)){const p=e.clone();p.posMatrix=new Float64Array(16);const v=u.canonical.z-e.canonical.z,w=u.canonical.x-(u.canonical.x>>v<<v),S=u.canonical.y-(u.canonical.y>>v<<v),C=d.X>>v;d.aP(p.posMatrix,0,C,0,C,0,1),d.J(p.posMatrix,p.posMatrix,[-w*C,-S*C,0]),o[l]=p}else if(e.canonical.isChildOf(u.canonical)){const p=e.clone();p.posMatrix=new Float64Array(16);const v=e.canonical.z-u.canonical.z,w=e.canonical.x-(e.canonical.x>>v<<v),S=e.canonical.y-(e.canonical.y>>v<<v),C=d.X>>v;d.aP(p.posMatrix,0,d.X,0,d.X,0,1),d.J(p.posMatrix,p.posMatrix,[w*C,S*C,0]),d.K(p.posMatrix,p.posMatrix,[1/2**v,1/2**v,0]),o[l]=p}}return o}getSourceTile(e,o){const l=this.sourceCache._source;let u=e.overscaledZ-this.deltaZoom;if(u>l.maxzoom&&(u=l.maxzoom),u<l.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(u).key);let p=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!p||!p.dem)&&o)for(;u>=l.minzoom&&(!p||!p.dem);)p=this.sourceCache.getTileByID(e.scaledTo(u--).key);return p}tilesAfterTime(e=Date.now()){return Object.values(this._tiles).filter((o=>o.timeAdded>=e))}}class Ka{constructor(e,o,l){this.painter=e,this.sourceCache=new Ih(o),this.options=l,this.exaggeration=typeof l.exaggeration=="number"?l.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,o,l,u=d.X){var p;if(!(o>=0&&o<u&&l>=0&&l<u))return 0;const v=this.getTerrainData(e),w=(p=v.tile)===null||p===void 0?void 0:p.dem;if(!w)return 0;const S=(function(Q,te,ae){var ue=te[0],me=te[1];return Q[0]=ae[0]*ue+ae[4]*me+ae[12],Q[1]=ae[1]*ue+ae[5]*me+ae[13],Q})([],[o/u*d.X,l/u*d.X],v.u_terrain_matrix),C=[S[0]*w.dim,S[1]*w.dim],F=Math.floor(C[0]),B=Math.floor(C[1]),$=C[0]-F,K=C[1]-B;return w.get(F,B)*(1-$)*(1-K)+w.get(F+1,B)*$*(1-K)+w.get(F,B+1)*(1-$)*K+w.get(F+1,B+1)*$*K}getElevationForLngLatZoom(e,o){if(!d.bb(o,e.wrap()))return 0;const{tileID:l,mercatorX:u,mercatorY:p}=this._getOverscaledTileIDFromLngLatZoom(e,o);return this.getElevation(l,u%d.X,p%d.X,d.X)}getElevation(e,o,l,u=d.X){return this.getDEMElevation(e,o,l,u)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const u=this.painter.context,p=new d.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Et(u,p,u.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Et(u,new d.R({width:1,height:1}),u.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(u.gl.NEAREST,u.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=d.an([])}const o=this.sourceCache.getSourceTile(e,!0);if(o&&o.dem&&(!o.demTexture||o.needsTerrainPrepare)){const u=this.painter.context;o.demTexture=this.painter.getTileTexture(o.dem.stride),o.demTexture?o.demTexture.update(o.dem.getPixels(),{premultiply:!1}):o.demTexture=new Et(u,o.dem.getPixels(),u.gl.RGBA,{premultiply:!1}),o.demTexture.bind(u.gl.NEAREST,u.gl.CLAMP_TO_EDGE),o.needsTerrainPrepare=!1}const l=o&&o+o.tileID.key+e.key;if(l&&!this._demMatrixCache[l]){const u=this.sourceCache.sourceCache._source.maxzoom;let p=e.canonical.z-o.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=u?p=e.canonical.z-u:d.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const v=e.canonical.x-(e.canonical.x>>p<<p),w=e.canonical.y-(e.canonical.y>>p<<p),S=d.bc(new Float64Array(16),[1/(d.X<<p),1/(d.X<<p),0]);d.J(S,S,[v*d.X,w*d.X,0]),this._demMatrixCache[e.key]={matrix:S,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:o&&o.dem&&o.dem.dim||1,u_terrain_matrix:l?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:o&&o.dem&&o.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(o&&o.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:o}}getFramebuffer(e){const o=this.painter,l=o.width/devicePixelRatio,u=o.height/devicePixelRatio;return!this._fbo||this._fbo.width===l&&this._fbo.height===u||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Et(o.context,{width:l,height:u,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Et(o.context,{width:l,height:u,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=o.context.createFramebuffer(l,u,!0,!1),this._fbo.depthAttachment.set(o.context.createRenderbuffer(o.context.gl.DEPTH_COMPONENT16,l,u))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const o=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let p=0,v=0;p<this._coordsTextureSize;p++)for(let w=0;w<this._coordsTextureSize;w++,v+=4)o[v+0]=255&w,o[v+1]=255&p,o[v+2]=w>>8<<4|p>>8,o[v+3]=0;const l=new d.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(o.buffer)),u=new Et(e,l,e.gl.RGBA,{premultiply:!1});return u.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=u,u}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const o=new Uint8Array(4),l=this.painter.context,u=l.gl,p=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),v=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),w=Math.round(this.painter.height/devicePixelRatio);l.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),u.readPixels(p,w-v-1,1,1,u.RGBA,u.UNSIGNED_BYTE,o),l.bindFramebuffer.set(null);const S=o[0]+(o[2]>>4<<8),C=o[1]+((15&o[2])<<8),F=this.coordsIndex[255-o[3]],B=F&&this.sourceCache.getTileByID(F);if(!B)return null;const $=this._coordsTextureSize,K=(1<<B.tileID.canonical.z)*$;return new d.Z((B.tileID.canonical.x*$+S)/K+B.tileID.wrap,(B.tileID.canonical.y*$+C)/K,this.getElevation(B.tileID,S,C,$))}depthAtPoint(e){const o=new Uint8Array(4),l=this.painter.context,u=l.gl;return l.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),u.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,u.RGBA,u.UNSIGNED_BYTE,o),l.bindFramebuffer.set(null),(o[0]/16777216+o[1]/65536+o[2]/256+o[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const e=this.painter.context,o=new d.bd,l=new d.aY,u=this.meshSize,p=d.X/u,v=u*u;for(let B=0;B<=u;B++)for(let $=0;$<=u;$++)o.emplaceBack($*p,B*p,0);for(let B=0;B<v;B+=u+1)for(let $=0;$<u;$++)l.emplaceBack($+B,u+$+B+1,u+$+B+2),l.emplaceBack($+B,u+$+B+2,$+B+1);const w=o.length,S=w+2*(u+1);for(const B of[0,1])for(let $=0;$<=u;$++)for(const K of[0,1])o.emplaceBack($*p,B*d.X,K);for(let B=0;B<2*u;B+=2)l.emplaceBack(S+B,S+B+1,S+B+3),l.emplaceBack(S+B,S+B+3,S+B+2),l.emplaceBack(w+B,w+B+3,w+B+1),l.emplaceBack(w+B,w+B+2,w+B+3);const C=o.length,F=C+2*(u+1);for(const B of[0,1])for(let $=0;$<=u;$++)for(const K of[0,1])o.emplaceBack(B*d.X,$*p,K);for(let B=0;B<2*u;B+=2)l.emplaceBack(C+B,C+B+1,C+B+3),l.emplaceBack(C+B,C+B+3,C+B+2),l.emplaceBack(F+B,F+B+3,F+B+1),l.emplaceBack(F+B,F+B+2,F+B+3);return this._mesh=new Hn(e.createVertexBuffer(o,rc.members),e.createIndexBuffer(l),d.a0.simpleSegment(0,0,o.length,l.length)),this._mesh}getMeshFrameDelta(e){return 2*Math.PI*d.be/Math.pow(2,e)/5}getMinTileElevationForLngLatZoom(e,o){var l;const{tileID:u}=this._getOverscaledTileIDFromLngLatZoom(e,o);return(l=this.getMinMaxElevation(u).minElevation)!==null&&l!==void 0?l:0}getMinMaxElevation(e){const o=this.getTerrainData(e).tile,l={minElevation:null,maxElevation:null};return o&&o.dem&&(l.minElevation=o.dem.min*this.exaggeration,l.maxElevation=o.dem.max*this.exaggeration),l}_getOverscaledTileIDFromLngLatZoom(e,o){const l=d.Z.fromLngLat(e.wrap()),u=(1<<o)*d.X,p=l.x*u,v=l.y*u,w=Math.floor(p/d.X),S=Math.floor(v/d.X);return{tileID:new d.S(o,0,o,w,S),mercatorX:p,mercatorY:v}}}class Kl{constructor(e,o,l){this._context=e,this._size=o,this._tileSize=l,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const o=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),l=new Et(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return l.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),o.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),o.colorAttachment.set(l.texture),{id:e,fbo:o,texture:l,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((o=>e.id!==o)),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const o of this._recentlyUsed)if(!this._objects[o].inUse)return this._objects[o];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((e=>!e.inUse))===!1}}const Jo={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Jl{constructor(e,o){this.painter=e,this.terrain=o,this.pool=new Kl(e.context,30,o.sourceCache.tileSize*o.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,o){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter((l=>!e._layers[l].isHidden(o))),this._coordsDescendingInv={};for(const l in e.sourceCaches){this._coordsDescendingInv[l]={};const u=e.sourceCaches[l].getVisibleCoordinates();for(const p of u){const v=this.terrain.sourceCache.getTerrainCoords(p);for(const w in v)this._coordsDescendingInv[l][w]||(this._coordsDescendingInv[l][w]=[]),this._coordsDescendingInv[l][w].push(v[w])}}this._coordsDescendingInvStr={};for(const l of e._order){const u=e._layers[l],p=u.source;if(Jo[u.type]&&!this._coordsDescendingInvStr[p]){this._coordsDescendingInvStr[p]={};for(const v in this._coordsDescendingInv[p])this._coordsDescendingInvStr[p][v]=this._coordsDescendingInv[p][v].map((w=>w.key)).sort().join()}}for(const l of this._renderableTiles)for(const u in this._coordsDescendingInvStr){const p=this._coordsDescendingInvStr[u][l.tileID.key];p&&p!==l.rttCoords[u]&&(l.rtt=[])}}renderLayer(e){if(e.isHidden(this.painter.transform.zoom))return!1;const o=e.type,l=this.painter,u=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(Jo[o]&&(this._prevType&&Jo[this._prevType]||this._stacks.push([]),this._prevType=o,this._stacks[this._stacks.length-1].push(e.id),!u))return!0;if(Jo[this._prevType]||Jo[o]&&u){this._prevType=o;const p=this._stacks.length-1,v=this._stacks[p]||[];for(const w of this._renderableTiles){if(this.pool.isFull()&&(Vc(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(w),w.rtt[p]){const C=this.pool.getObjectForId(w.rtt[p].id);if(C.stamp===w.rtt[p].stamp){this.pool.useObject(C);continue}}const S=this.pool.getOrCreateFreeObject();this.pool.useObject(S),this.pool.stampObject(S),w.rtt[p]={id:S.id,stamp:S.stamp},l.context.bindFramebuffer.set(S.fbo.framebuffer),l.context.clear({color:d.aM.transparent,stencil:0}),l.currentStencilSource=void 0;for(let C=0;C<v.length;C++){const F=l.style._layers[v[C]],B=F.source?this._coordsDescendingInv[F.source][w.tileID.key]:[w.tileID];l.context.viewport.set([0,0,S.fbo.width,S.fbo.height]),l._renderTileClippingMasks(F,B),l.renderLayer(l,l.style.sourceCaches[F.source],F,B),F.source&&(w.rttCoords[F.source]=this._coordsDescendingInvStr[F.source][w.tileID.key])}}return Vc(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Jo[o]}return!1}}const Yl={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use âŒ˜ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},qs=Se,xs={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Fn,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:d.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},oi=f=>{f.touchstart=f.dragStart,f.touchmoveWindow=f.dragMove,f.touchend=f.dragEnd},ui={showCompass:!0,showZoom:!0,visualizePitch:!1};class ws{constructor(e,o,l=!1){this.mousedown=v=>{this.startMouse(d.e({},v,{ctrlKey:!0,preventDefault:()=>v.preventDefault()}),ne.mousePos(this.element,v)),ne.addEventListener(window,"mousemove",this.mousemove),ne.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=v=>{this.moveMouse(v,ne.mousePos(this.element,v))},this.mouseup=v=>{this.mouseRotate.dragEnd(v),this.mousePitch&&this.mousePitch.dragEnd(v),this.offTemp()},this.touchstart=v=>{v.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ne.touchPos(this.element,v.targetTouches)[0],this.startTouch(v,this._startPos),ne.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),ne.addEventListener(window,"touchend",this.touchend))},this.touchmove=v=>{v.targetTouches.length!==1?this.reset():(this._lastPos=ne.touchPos(this.element,v.targetTouches)[0],this.moveTouch(v,this._lastPos))},this.touchend=v=>{v.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const u=e.dragRotate._mouseRotate.getClickTolerance(),p=e.dragRotate._mousePitch.getClickTolerance();this.element=o,this.mouseRotate=Su({clickTolerance:u,enable:!0}),this.touchRotate=(({enable:v,clickTolerance:w,bearingDegreesPerPixelMoved:S=.8})=>{const C=new Qu;return new qa({clickTolerance:w,move:(F,B)=>({bearingDelta:(B.x-F.x)*S}),moveStateManager:C,enable:v,assignEvents:oi})})({clickTolerance:u,enable:!0}),this.map=e,l&&(this.mousePitch=ni({clickTolerance:p,enable:!0}),this.touchPitch=(({enable:v,clickTolerance:w,pitchDegreesPerPixelMoved:S=-.5})=>{const C=new Qu;return new qa({clickTolerance:w,move:(F,B)=>({pitchDelta:(B.y-F.y)*S}),moveStateManager:C,enable:v,assignEvents:oi})})({clickTolerance:p,enable:!0})),ne.addEventListener(o,"mousedown",this.mousedown),ne.addEventListener(o,"touchstart",this.touchstart,{passive:!1}),ne.addEventListener(o,"touchcancel",this.reset)}startMouse(e,o){this.mouseRotate.dragStart(e,o),this.mousePitch&&this.mousePitch.dragStart(e,o),ne.disableDrag()}startTouch(e,o){this.touchRotate.dragStart(e,o),this.touchPitch&&this.touchPitch.dragStart(e,o),ne.disableDrag()}moveMouse(e,o){const l=this.map,{bearingDelta:u}=this.mouseRotate.dragMove(e,o)||{};if(u&&l.setBearing(l.getBearing()+u),this.mousePitch){const{pitchDelta:p}=this.mousePitch.dragMove(e,o)||{};p&&l.setPitch(l.getPitch()+p)}}moveTouch(e,o){const l=this.map,{bearingDelta:u}=this.touchRotate.dragMove(e,o)||{};if(u&&l.setBearing(l.getBearing()+u),this.touchPitch){const{pitchDelta:p}=this.touchPitch.dragMove(e,o)||{};p&&l.setPitch(l.getPitch()+p)}}off(){const e=this.element;ne.removeEventListener(e,"mousedown",this.mousedown),ne.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),ne.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ne.removeEventListener(window,"touchend",this.touchend),ne.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){ne.enableDrag(),ne.removeEventListener(window,"mousemove",this.mousemove),ne.removeEventListener(window,"mouseup",this.mouseup),ne.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ne.removeEventListener(window,"touchend",this.touchend)}}let Jr;function Sr(f,e,o){const l=new d.N(f.lng,f.lat);if(f=new d.N(f.lng,f.lat),e){const u=new d.N(f.lng-360,f.lat),p=new d.N(f.lng+360,f.lat),v=o.locationPoint(f).distSqr(e);o.locationPoint(u).distSqr(e)<v?f=u:o.locationPoint(p).distSqr(e)<v&&(f=p)}for(;Math.abs(f.lng-o.center.lng)>180;){const u=o.locationPoint(f);if(u.x>=0&&u.y>=0&&u.x<=o.width&&u.y<=o.height)break;f.lng>o.center.lng?f.lng-=360:f.lng+=360}return f.lng!==l.lng&&o.locationPoint(f).y>o.height/2-o.getHorizon()?f:l}const Mo={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ja(f,e,o){const l=f.classList;for(const u in Mo)l.remove(`maplibregl-${o}-anchor-${u}`);l.add(`maplibregl-${o}-anchor-${e}`)}class mn extends d.E{constructor(e){if(super(),this._onKeyPress=o=>{const l=o.code,u=o.charCode||o.keyCode;l!=="Space"&&l!=="Enter"&&u!==32&&u!==13||this.togglePopup()},this._onMapClick=o=>{const l=o.originalEvent.target,u=this._element;this._popup&&(l===u||u.contains(l))&&this.togglePopup()},this._update=o=>{var l;if(!this._map)return;const u=this._map.loaded()&&!this._map.isMoving();(o?.type==="terrain"||o?.type==="render"&&!u)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?Sr(this._lngLat,this._flatPos,this._map.transform):(l=this._lngLat)===null||l===void 0?void 0:l.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let p="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?p=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(p=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let v="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?v="rotateX(0deg)":this._pitchAlignment==="map"&&(v=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||o&&o.type!=="moveend"||(this._pos=this._pos.round()),ne.setTransform(this._element,`${Mo[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${v} ${p}`),re.frameAsync(new AbortController).then((()=>{this._updateOpacity(o&&o.type==="moveend")})).catch((()=>{}))},this._onMove=o=>{if(!this._isDragging){const l=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new d.k("dragstart"))),this.fire(new d.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new d.k("dragend")),this._state="inactive"},this._addDragHandler=o=>{this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(e?.opacity,e?.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=d.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=ne.create("div");const o=ne.createNS("http://www.w3.org/2000/svg","svg"),l=41,u=27;o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height",`${l}px`),o.setAttributeNS(null,"width",`${u}px`),o.setAttributeNS(null,"viewBox",`0 0 ${u} ${l}`);const p=ne.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"stroke","none"),p.setAttributeNS(null,"stroke-width","1"),p.setAttributeNS(null,"fill","none"),p.setAttributeNS(null,"fill-rule","evenodd");const v=ne.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"fill-rule","nonzero");const w=ne.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"transform","translate(3.0, 29.0)"),w.setAttributeNS(null,"fill","#000000");const S=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ue of S){const me=ne.createNS("http://www.w3.org/2000/svg","ellipse");me.setAttributeNS(null,"opacity","0.04"),me.setAttributeNS(null,"cx","10.5"),me.setAttributeNS(null,"cy","5.80029008"),me.setAttributeNS(null,"rx",ue.rx),me.setAttributeNS(null,"ry",ue.ry),w.appendChild(me)}const C=ne.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"fill",this._color);const F=ne.createNS("http://www.w3.org/2000/svg","path");F.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),C.appendChild(F);const B=ne.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"opacity","0.25"),B.setAttributeNS(null,"fill","#000000");const $=ne.createNS("http://www.w3.org/2000/svg","path");$.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),B.appendChild($);const K=ne.createNS("http://www.w3.org/2000/svg","g");K.setAttributeNS(null,"transform","translate(6.0, 7.0)"),K.setAttributeNS(null,"fill","#FFFFFF");const Q=ne.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"transform","translate(8.0, 8.0)");const te=ne.createNS("http://www.w3.org/2000/svg","circle");te.setAttributeNS(null,"fill","#000000"),te.setAttributeNS(null,"opacity","0.25"),te.setAttributeNS(null,"cx","5.5"),te.setAttributeNS(null,"cy","5.5"),te.setAttributeNS(null,"r","5.4999962");const ae=ne.createNS("http://www.w3.org/2000/svg","circle");ae.setAttributeNS(null,"fill","#FFFFFF"),ae.setAttributeNS(null,"cx","5.5"),ae.setAttributeNS(null,"cy","5.5"),ae.setAttributeNS(null,"r","5.4999962"),Q.appendChild(te),Q.appendChild(ae),v.appendChild(w),v.appendChild(C),v.appendChild(B),v.appendChild(K),v.appendChild(Q),o.appendChild(v),o.setAttributeNS(null,"height",l*this._scale+"px"),o.setAttributeNS(null,"width",u*this._scale+"px"),this._element.appendChild(o),this._offset=d.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(o=>{o.preventDefault()})),this._element.addEventListener("mousedown",(o=>{o.preventDefault()})),Ja(this._element,this._anchor,"marker"),e&&e.className)for(const o of e.className.split(" "))this._element.classList.add(o);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ne.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=d.N.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const u=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[u,-1*(38.1-13.5+u)],"bottom-right":[-u,-1*(38.1-13.5+u)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var o,l;if(!(!((o=this._map)===null||o===void 0)&&o.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const u=this._map,p=u.terrain.depthAtPoint(this._pos),v=u.terrain.getElevationForLngLatZoom(this._lngLat,u.transform.tileZoom);if(u.transform.lngLatToCameraDepth(this._lngLat,v)-p<.006)return void(this._element.style.opacity=this._opacity);const w=-this._offset.y/u.transform._pixelPerMeter,S=Math.sin(u.getPitch()*Math.PI/180)*w,C=u.terrain.depthAtPoint(new d.P(this._pos.x,this._pos.y-this._offset.y)),F=u.transform.lngLatToCameraDepth(this._lngLat,v+S)-C>.006;!((l=this._popup)===null||l===void 0)&&l.isOpen()&&F&&this._popup.remove(),this._element.style.opacity=F?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=d.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,o){return e===void 0&&o===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),o!==void 0&&(this._opacityWhenCovered=o),this._map&&this._updateOpacity(!0),this}}const Ql={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let gl=0,yl=!1;const co={maxWidth:100,unit:"metric"};function _l(f,e,o){const l=o&&o.maxWidth||100,u=f._container.clientHeight/2,p=f.unproject([0,u]),v=f.unproject([l,u]),w=p.distanceTo(v);if(o&&o.unit==="imperial"){const S=3.2808*w;S>5280?bt(e,l,S/5280,f._getUIString("ScaleControl.Miles")):bt(e,l,S,f._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?bt(e,l,w/1852,f._getUIString("ScaleControl.NauticalMiles")):w>=1e3?bt(e,l,w/1e3,f._getUIString("ScaleControl.Kilometers")):bt(e,l,w,f._getUIString("ScaleControl.Meters"))}function bt(f,e,o,l){const u=(function(p){const v=Math.pow(10,`${Math.floor(p)}`.length-1);let w=p/v;return w=w>=10?10:w>=5?5:w>=3?3:w>=2?2:w>=1?1:(function(S){const C=Math.pow(10,Math.ceil(-Math.log(S)/Math.LN10));return Math.round(S*C)/C})(w),v*w})(o);f.style.width=e*(u/o)+"px",f.innerHTML=`${u}&nbsp;${l}`}const Nt={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},vl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function eu(f){if(f){if(typeof f=="number"){const e=Math.round(Math.abs(f)/Math.SQRT2);return{center:new d.P(0,0),top:new d.P(0,f),"top-left":new d.P(e,e),"top-right":new d.P(-e,e),bottom:new d.P(0,-f),"bottom-left":new d.P(e,-e),"bottom-right":new d.P(-e,-e),left:new d.P(f,0),right:new d.P(-f,0)}}if(f instanceof d.P||Array.isArray(f)){const e=d.P.convert(f);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:d.P.convert(f.center||[0,0]),top:d.P.convert(f.top||[0,0]),"top-left":d.P.convert(f["top-left"]||[0,0]),"top-right":d.P.convert(f["top-right"]||[0,0]),bottom:d.P.convert(f.bottom||[0,0]),"bottom-left":d.P.convert(f["bottom-left"]||[0,0]),"bottom-right":d.P.convert(f["bottom-right"]||[0,0]),left:d.P.convert(f.left||[0,0]),right:d.P.convert(f.right||[0,0])}}return eu(new d.P(0,0))}const ic=Se;A.AJAXError=d.bh,A.Evented=d.E,A.LngLat=d.N,A.MercatorCoordinate=d.Z,A.Point=d.P,A.addProtocol=d.bi,A.config=d.a,A.removeProtocol=d.bj,A.AttributionControl=ba,A.BoxZoomHandler=Wn,A.CanvasSource=Mn,A.CooperativeGesturesHandler=ml,A.DoubleClickZoomHandler=Xa,A.DragPanHandler=Tu,A.DragRotateHandler=$c,A.EdgeInsets=js,A.FullscreenControl=class extends d.E{constructor(f={}){super(),this._onFullscreenChange=()=>{var e;let o=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=o?.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)o=o.shadowRoot.fullscreenElement;o===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,f&&f.container&&(f.container instanceof HTMLElement?this._container=f.container:d.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=ne.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){ne.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const f=this._fullscreenButton=ne.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);ne.create("span","maplibregl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.title=f}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new d.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new d.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},A.GeoJSONSource=bo,A.GeolocateControl=class extends d.E{constructor(f){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new d.k("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new d.k("geolocate",e)),this._finish()}},this._updateCamera=e=>{const o=new d.N(e.coords.longitude,e.coords.latitude),l=e.coords.accuracy,u=this._map.getBearing(),p=d.e({bearing:u},this.options.fitBoundsOptions),v=Fe.fromLngLat(o,l);this._map.fitBounds(v,p,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const o=new d.N(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&yl)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new d.k("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this._geolocateButton=ne.create("button","maplibregl-ctrl-geolocate",this._container),ne.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){d.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ne.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new mn({element:this._dotElement}),this._circleElement=ne.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new mn({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new d.k("trackuserlocationend")),this.fire(new d.k("userlocationlostfocus")))}))}},this.options=d.e({},Ql,f)}onAdd(f){return this._map=f,this._container=ne.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return d._(this,arguments,void 0,(function*(e=!1){if(Jr!==void 0&&!e)return Jr;if(window.navigator.permissions===void 0)return Jr=!!window.navigator.geolocation,Jr;try{Jr=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Jr=!!window.navigator.geolocation}return Jr}))})().then((e=>this._finishSetupUI(e))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ne.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,gl=0,yl=!1}_isOutOfMapMaxBounds(f){const e=this._map.getMaxBounds(),o=f.coords;return e&&(o.longitude<e.getWest()||o.longitude>e.getEast()||o.latitude<e.getSouth()||o.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const f=this._map.getBounds(),e=f.getSouthEast(),o=f.getNorthEast(),l=e.distanceTo(o),u=Math.ceil(this._accuracy/(l/this._map._container.clientHeight)*2);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}trigger(){if(!this._setup)return d.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new d.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":gl--,yl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new d.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new d.k("trackuserlocationstart")),this.fire(new d.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),gl++,gl>1?(f={maximumAge:6e5,timeout:0},yl=!0):(f=this.options.positionOptions,yl=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,f)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},A.Hash=wu,A.ImageSource=ko,A.KeyboardHandler=Io,A.LngLatBounds=Fe,A.LogoControl=Ko,A.Map=class extends Zs{constructor(f){d.bf.mark(d.bg.create);const e=Object.assign(Object.assign({},xs),f);if(e.minZoom!=null&&e.maxZoom!=null&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(e.minPitch!=null&&e.maxPitch!=null&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(e.minPitch!=null&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(e.maxPitch!=null&&e.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new ys(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),{bearingSnap:e.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new vr,this._controls=[],this._mapId=d.a4(),this._contextLost=o=>{o.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new d.k("webglcontextlost",{originalEvent:o}))},this._contextRestored=o=>{this._setupPainter(),this.resize(),this._update(),this.fire(new d.k("webglcontextrestored",{originalEvent:o}))},this._onMapScroll=o=>{if(o.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._maxTileCacheZoomLevels=e.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=e.preserveDrawingBuffer===!0,this._antialias=e.antialias===!0,this._trackResize=e.trackResize===!0,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles===!0,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions===!0,this._collectResourceTiming=e.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Yl),e.locale),this._clickTolerance=e.clickTolerance,this._overridePixelRatio=e.pixelRatio,this._maxCanvasSize=e.maxCanvasSize,this.transformCameraUpdate=e.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=e.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=St.addThrottleControl((()=>this.isMoving())),this._requestManager=new ar(e.transformRequest),typeof e.container=="string"){if(this._container=document.getElementById(e.container),!this._container)throw new Error(`Container '${e.container}' not found.`)}else{if(!(e.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))).on("moveend",(()=>this._update(!1))).on("zoom",(()=>this._update(!0))).on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})).once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let o=!1;const l=Zl((u=>{this._trackResize&&!this._removed&&(this.resize(u),this.redraw())}),50);this._resizeObserver=new ResizeObserver((u=>{o?l(u):o=!0})),this._resizeObserver.observe(this._container)}this.handlers=new Eu(this,e),this._hash=e.hash&&new wu(typeof e.hash=="string"&&e.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,d.e({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=e.localIdeographFontFamily,this._validateStyle=e.validateStyle,e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new ba(typeof e.attributionControl=="boolean"?void 0:e.attributionControl)),e.maplibreLogo&&this.addControl(new Ko,e.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(o=>{this._update(o.dataType==="style"),this.fire(new d.k(`${o.dataType}data`,o))})),this.on("dataloading",(o=>{this.fire(new d.k(`${o.dataType}dataloading`,o))})),this.on("dataabort",(o=>{this.fire(new d.k("sourcedataabort",o))}))}_getMapId(){return this._mapId}addControl(f,e){if(e===void 0&&(e=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new d.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const o=f.onAdd(this);this._controls.push(f);const l=this._controlPositions[e];return e.indexOf("bottom")!==-1?l.insertBefore(o,l.firstChild):l.appendChild(o),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new d.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(f);return e>-1&&this._controls.splice(e,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}calculateCameraOptionsFromTo(f,e,o,l){return l==null&&this.terrain&&(l=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(f,e,o,l)}resize(f){var e;const o=this._containerDimensions(),l=o[0],u=o[1],p=this._getClampedPixelRatio(l,u);if(this._resizeCanvas(l,u,p),this.painter.resize(l,u,p),this.painter.overLimit()){const w=this.painter.context.gl;this._maxCanvasSize=[w.drawingBufferWidth,w.drawingBufferHeight];const S=this._getClampedPixelRatio(l,u);this._resizeCanvas(l,u,S),this.painter.resize(l,u,S)}this.transform.resize(l,u),(e=this._requestedCameraState)===null||e===void 0||e.resize(l,u);const v=!this._moving;return v&&(this.stop(),this.fire(new d.k("movestart",f)).fire(new d.k("move",f))),this.fire(new d.k("resize",f)),v&&this.fire(new d.k("moveend",f)),this}_getClampedPixelRatio(f,e){const{0:o,1:l}=this._maxCanvasSize,u=this.getPixelRatio(),p=f*u,v=e*u;return Math.min(p>o?o/p:1,v>l?l/v:1)*u}getPixelRatio(){var f;return(f=this._overridePixelRatio)!==null&&f!==void 0?f:devicePixelRatio}setPixelRatio(f){this._overridePixelRatio=f,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(f){return this.transform.setMaxBounds(Fe.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.minZoom=f,this._update(),this.getZoom()<f&&this.setZoom(f),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.maxZoom=f,this._update(),this.getZoom()>f&&this.setZoom(f),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.minPitch=f,this._update(),this.getPitch()<f&&this.setPitch(f),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(f>=this.transform.minPitch)return this.transform.maxPitch=f,this._update(),this.getPitch()>f&&this.setPitch(f),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.renderWorldCopies=f,this._update()}project(f){return this.transform.locationPoint(d.N.convert(f),this.style&&this.terrain)}unproject(f){return this.transform.pointLocation(d.P.convert(f),this.terrain)}isMoving(){var f;return this._moving||((f=this.handlers)===null||f===void 0?void 0:f.isMoving())}isZooming(){var f;return this._zooming||((f=this.handlers)===null||f===void 0?void 0:f.isZooming())}isRotating(){var f;return this._rotating||((f=this.handlers)===null||f===void 0?void 0:f.isRotating())}_createDelegatedListener(f,e,o){if(f==="mouseenter"||f==="mouseover"){let l=!1;return{layers:e,listener:o,delegates:{mousemove:p=>{const v=e.filter((S=>this.getLayer(S))),w=v.length!==0?this.queryRenderedFeatures(p.point,{layers:v}):[];w.length?l||(l=!0,o.call(this,new fn(f,this,p.originalEvent,{features:w}))):l=!1},mouseout:()=>{l=!1}}}}if(f==="mouseleave"||f==="mouseout"){let l=!1;return{layers:e,listener:o,delegates:{mousemove:v=>{const w=e.filter((S=>this.getLayer(S)));(w.length!==0?this.queryRenderedFeatures(v.point,{layers:w}):[]).length?l=!0:l&&(l=!1,o.call(this,new fn(f,this,v.originalEvent)))},mouseout:v=>{l&&(l=!1,o.call(this,new fn(f,this,v.originalEvent)))}}}}{const l=u=>{const p=e.filter((w=>this.getLayer(w))),v=p.length!==0?this.queryRenderedFeatures(u.point,{layers:p}):[];v.length&&(u.features=v,o.call(this,u),delete u.features)};return{layers:e,listener:o,delegates:{[f]:l}}}}_saveDelegatedListener(f,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(e)}_removeDelegatedListener(f,e,o){if(!this._delegatedListeners||!this._delegatedListeners[f])return;const l=this._delegatedListeners[f];for(let u=0;u<l.length;u++){const p=l[u];if(p.listener===o&&p.layers.length===e.length&&p.layers.every((v=>e.includes(v)))){for(const v in p.delegates)this.off(v,p.delegates[v]);return void l.splice(u,1)}}}on(f,e,o){if(o===void 0)return super.on(f,e);const l=this._createDelegatedListener(f,typeof e=="string"?[e]:e,o);this._saveDelegatedListener(f,l);for(const u in l.delegates)this.on(u,l.delegates[u]);return this}once(f,e,o){if(o===void 0)return super.once(f,e);const l=typeof e=="string"?[e]:e,u=this._createDelegatedListener(f,l,o);for(const p in u.delegates){const v=u.delegates[p];u.delegates[p]=(...w)=>{this._removeDelegatedListener(f,l,o),v(...w)}}this._saveDelegatedListener(f,u);for(const p in u.delegates)this.once(p,u.delegates[p]);return this}off(f,e,o){return o===void 0?super.off(f,e):(this._removeDelegatedListener(f,typeof e=="string"?[e]:e,o),this)}queryRenderedFeatures(f,e){if(!this.style)return[];let o;const l=f instanceof d.P||Array.isArray(f),u=l?f:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(l?{}:f)||{},u instanceof d.P||typeof u[0]=="number")o=[d.P.convert(u)];else{const p=d.P.convert(u[0]),v=d.P.convert(u[1]);o=[p,new d.P(v.x,p.y),v,new d.P(p.x,v.y),p]}return this.style.queryRenderedFeatures(o,e,this.transform)}querySourceFeatures(f,e){return this.style.querySourceFeatures(f,e)}setStyle(f,e){return(e=d.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&f?(this._diffStyle(f,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(f,e))}setTransformRequest(f){return this._requestManager.setTransformRequest(f),this}_getUIString(f){const e=this._locale[f];if(e==null)throw new Error(`Missing UI string '${f}'`);return e}_updateStyle(f,e){if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(f,e)));const o=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!f)),f?(this.style=new La(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof f=="string"?this.style.loadURL(f,e,o):this.style.loadJSON(f,e,o),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new La(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,e){if(typeof f=="string"){const o=this._requestManager.transformRequest(f,"Style");d.h(o,new AbortController).then((l=>{this._updateDiff(l.data,e)})).catch((l=>{l&&this.fire(new d.j(l))}))}else typeof f=="object"&&this._updateDiff(f,e)}_updateDiff(f,e){try{this.style.setState(f,e)&&this._update(!0)}catch(o){d.w(`Unable to perform style diff: ${o.message||o.error||o}.  Rebuilding the style from scratch.`),this._updateStyle(f,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():d.w("There is no style added to the map.")}addSource(f,e){return this._lazyInitEmptyStyle(),this.style.addSource(f,e),this._update(!0)}isSourceLoaded(f){const e=this.style&&this.style.sourceCaches[f];if(e!==void 0)return e.loaded();this.fire(new d.j(new Error(`There is no source with ID '${f}'`)))}setTerrain(f){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),f){const e=this.style.sourceCaches[f.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${f.source}`);this.terrain===null&&e.reload();for(const o in this.style._layers){const l=this.style._layers[o];l.type==="hillshade"&&l.source===f.source&&d.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Ka(this.painter,e,f),this.painter.renderToTexture=new Jl(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=o=>{o.dataType==="style"?this.terrain.sourceCache.freeRtt():o.dataType==="source"&&o.tile&&(o.sourceId!==f.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(o.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new d.k("terrain",{terrain:f})),this}getTerrain(){var f,e;return(e=(f=this.terrain)===null||f===void 0?void 0:f.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const f=this.style&&this.style.sourceCaches;for(const e in f){const o=f[e]._tiles;for(const l in o){const u=o[l];if(u.state!=="loaded"&&u.state!=="errored")return!1}}return!0}removeSource(f){return this.style.removeSource(f),this._update(!0)}getSource(f){return this.style.getSource(f)}addImage(f,e,o={}){const{pixelRatio:l=1,sdf:u=!1,stretchX:p,stretchY:v,content:w,textFitWidth:S,textFitHeight:C}=o;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||d.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new d.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:F,height:B,data:$}=e,K=e;return this.style.addImage(f,{data:new d.R({width:F,height:B},new Uint8Array($)),pixelRatio:l,stretchX:p,stretchY:v,content:w,textFitWidth:S,textFitHeight:C,sdf:u,version:0,userImage:K}),K.onAdd&&K.onAdd(this,f),this}}{const{width:F,height:B,data:$}=re.getImageData(e);this.style.addImage(f,{data:new d.R({width:F,height:B},$),pixelRatio:l,stretchX:p,stretchY:v,content:w,textFitWidth:S,textFitHeight:C,sdf:u,version:0})}}updateImage(f,e){const o=this.style.getImage(f);if(!o)return this.fire(new d.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=e instanceof HTMLImageElement||d.b(e)?re.getImageData(e):e,{width:u,height:p,data:v}=l;if(u===void 0||p===void 0)return this.fire(new d.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(u!==o.data.width||p!==o.data.height)return this.fire(new d.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const w=!(e instanceof HTMLImageElement||d.b(e));return o.data.replace(v,w),this.style.updateImage(f,o),this}getImage(f){return this.style.getImage(f)}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new d.j(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f){return St.getImage(this._requestManager.transformRequest(f,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(f,e){return this._lazyInitEmptyStyle(),this.style.addLayer(f,e),this._update(!0)}moveLayer(f,e){return this.style.moveLayer(f,e),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(f,e,o){return this.style.setLayerZoomRange(f,e,o),this._update(!0)}setFilter(f,e,o={}){return this.style.setFilter(f,e,o),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,e,o,l={}){return this.style.setPaintProperty(f,e,o,l),this._update(!0)}getPaintProperty(f,e){return this.style.getPaintProperty(f,e)}setLayoutProperty(f,e,o,l={}){return this.style.setLayoutProperty(f,e,o,l),this._update(!0)}getLayoutProperty(f,e){return this.style.getLayoutProperty(f,e)}setGlyphs(f,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(f,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(f,e,o={}){return this._lazyInitEmptyStyle(),this.style.addSprite(f,e,o,(l=>{l||this._update(!0)})),this}removeSprite(f){return this._lazyInitEmptyStyle(),this.style.removeSprite(f),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(f,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(f,e,(o=>{o||this._update(!0)})),this}setLight(f,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(f){return this._lazyInitEmptyStyle(),this.style.setSky(f),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(f,e){return this.style.setFeatureState(f,e),this._update()}removeFeatureState(f,e){return this.style.removeFeatureState(f,e),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let f=0,e=0;return this._container&&(f=this._container.clientWidth||400,e=this._container.clientHeight||300),[f,e]}_setupContainer(){const f=this._container;f.classList.add("maplibregl-map");const e=this._canvasContainer=ne.create("div","maplibregl-canvas-container",f);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=ne.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const o=this._containerDimensions(),l=this._getClampedPixelRatio(o[0],o[1]);this._resizeCanvas(o[0],o[1],l);const u=this._controlContainer=ne.create("div","maplibregl-control-container",f),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((v=>{p[v]=ne.create("div",`maplibregl-ctrl-${v} `,u)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,e,o){this._canvas.width=Math.floor(o*f),this._canvas.height=Math.floor(o*e),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const f={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let e=null;this._canvas.addEventListener("webglcontextcreationerror",(l=>{e={requestedAttributes:f},l&&(e.statusMessage=l.statusMessage,e.type=l.type)}),{once:!0});const o=this._canvas.getContext("webgl2",f)||this._canvas.getContext("webgl",f);if(!o){const l="Failed to initialize WebGL";throw e?(e.message=l,new Error(JSON.stringify(e))):new Error(l)}this.painter=new gs(o,this.transform),Ge.testSupport(o)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_render(f){const e=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(f),this._removed)return;let o=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const u=this.transform.zoom,p=re.now();this.style.zoomHistory.update(u,p);const v=new d.z(u,{now:p,fadeDuration:e,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),w=v.crossFadingFactor();w===1&&w===this._crossFadingFactor||(o=!0,this._crossFadingFactor=w),this.style.update(v)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,e,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:e,showPadding:this.showPadding}),this.fire(new d.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,d.bf.mark(d.bg.load),this.fire(new d.k("load"))),this.style&&(this.style.hasTransitions()||o)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const l=this._sourcesDirty||this._styleDirty||this._placementDirty;return l||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new d.k("idle")),!this._loaded||this._fullyLoaded||l||(this._fullyLoaded=!0,d.bf.mark(d.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var f;this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),St.removeThrottleControl(this._imageQueueHandle),(f=this._resizeObserver)===null||f===void 0||f.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e?.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),ne.remove(this._canvasContainer),ne.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),d.bf.clearMetrics(),this._removed=!0,this.fire(new d.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,re.frameAsync(this._frameRequest).then((f=>{d.bf.frame(f),this._frameRequest=null,this._render(f)})).catch((()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get version(){return qs}getCameraTargetElevation(){return this.transform.elevation}},A.MapMouseEvent=fn,A.MapTouchEvent=xa,A.MapWheelEvent=Ku,A.Marker=mn,A.NavigationControl=class{constructor(f){this._updateZoomButtons=()=>{const e=this._map.getZoom(),o=e===this._map.getMaxZoom(),l=e===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())},this._rotateCompassArrow=()=>{const e=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=e},this._setButtonTitle=(e,o)=>{const l=this._map._getUIString(`NavigationControl.${o}`);e.title=l,e.setAttribute("aria-label",l)},this.options=d.e({},ui,f),this._container=ne.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(e=>this._map.zoomIn({},{originalEvent:e}))),ne.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(e=>this._map.zoomOut({},{originalEvent:e}))),ne.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})})),this._compassIcon=ne.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ws(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){ne.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(f,e){const o=ne.create("button",f,this._container);return o.type="button",o.addEventListener("click",e),o}},A.Popup=class extends d.E{constructor(f){super(),this.remove=()=>(this._content&&ne.remove(this._content),this._container&&(ne.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new d.k("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var o;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=ne.create("div","maplibregl-popup",this._map.getContainer()),this._tip=ne.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const w of this.options.className.split(" "))this._container.classList.add(w);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?Sr(this._lngLat,this._flatPos,this._map.transform):(o=this._lngLat)===null||o===void 0?void 0:o.wrap(),this._trackPointer&&!e)return;const l=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationPoint(this._lngLat));let u=this.options.anchor;const p=eu(this.options.offset);if(!u){const w=this._container.offsetWidth,S=this._container.offsetHeight;let C;C=l.y+p.bottom.y<S?["top"]:l.y>this._map.transform.height-S?["bottom"]:[],l.x<w/2?C.push("left"):l.x>this._map.transform.width-w/2&&C.push("right"),u=C.length===0?"bottom":C.join("-")}let v=l.add(p[u]);this.options.subpixelPositioning||(v=v.round()),ne.setTransform(this._container,`${Mo[u]} translate(${v.x}px,${v.y}px)`),Ja(this._container,u,"popup")},this._onClose=()=>{this.remove()},this.options=d.e(Object.create(Nt),f)}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new d.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(f){return this._lngLat=d.N.convert(f),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(document.createTextNode(f))}setHTML(f){const e=document.createDocumentFragment(),o=document.createElement("body");let l;for(o.innerHTML=f;l=o.firstChild,l;)e.appendChild(l);return this.setDOMContent(e)}getMaxWidth(){var f;return(f=this._container)===null||f===void 0?void 0:f.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ne.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(f),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(f){return this._container&&this._container.classList.add(f),this}removeClassName(f){return this._container&&this._container.classList.remove(f),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){if(this._container)return this._container.classList.toggle(f)}setSubpixelPositioning(f){this.options.subpixelPositioning=f}_createCloseButton(){this.options.closeButton&&(this._closeButton=ne.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(vl);f&&f.focus()}},A.RasterDEMTileSource=qr,A.RasterTileSource=Er,A.ScaleControl=class{constructor(f){this._onMove=()=>{_l(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,_l(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},co),f)}getDefaultPosition(){return"bottom-left"}onAdd(f){return this._map=f,this._container=ne.create("div","maplibregl-ctrl maplibregl-ctrl-scale",f.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){ne.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},A.ScrollZoomHandler=Xn,A.Style=La,A.TerrainControl=class{constructor(f){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=f}onAdd(f){return this._map=f,this._container=ne.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=ne.create("button","maplibregl-ctrl-terrain",this._container),ne.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){ne.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},A.TwoFingersTouchPitchHandler=pl,A.TwoFingersTouchRotateHandler=dl,A.TwoFingersTouchZoomHandler=Xl,A.TwoFingersTouchZoomRotateHandler=zu,A.VectorTileSource=ua,A.VideoSource=Pa,A.addSourceType=(f,e)=>d._(void 0,void 0,void 0,(function*(){if(Ma(f))throw new Error(`A source type called "${f}" already exists.`);((o,l)=>{cs[o]=l})(f,e)})),A.clearPrewarmedResources=function(){const f=tr;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(Tt),tr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},A.getMaxParallelImageRequests=function(){return d.a.MAX_PARALLEL_IMAGE_REQUESTS},A.getRTLTextPluginStatus=function(){return fr().getRTLTextPluginStatus()},A.getVersion=function(){return ic},A.getWorkerCount=function(){return $t.workerCount},A.getWorkerUrl=function(){return d.a.WORKER_URL},A.importScriptInWorkers=function(f){return Pn().broadcast("IS",f)},A.prewarm=function(){Ar().acquire(Tt)},A.setMaxParallelImageRequests=function(f){d.a.MAX_PARALLEL_IMAGE_REQUESTS=f},A.setRTLTextPlugin=function(f,e){return fr().setRTLTextPlugin(f,e)},A.setWorkerCount=function(f){$t.workerCount=f},A.setWorkerUrl=function(f){d.a.WORKER_URL=f}}));var ee=I;return ee}))})(up)),up.exports}var mm=Vy();const Th=tf(mm);var us=Uint8Array,Eh=Uint16Array,Uy=Int32Array,gm=new us([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ym=new us([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),$y=new us([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),_m=function(T,D){for(var I=new Eh(31),H=0;H<31;++H)I[H]=D+=1<<T[H-1];for(var W=new Uy(I[30]),H=1;H<30;++H)for(var ee=I[H];ee<I[H+1];++ee)W[ee]=ee-I[H]<<5|H;return{b:I,r:W}},vm=_m(gm,2),xm=vm.b,Zy=vm.r;xm[28]=258,Zy[258]=28;var qy=_m(ym,0),Gy=qy.b,Yp=new Eh(32768);for(var Oi=0;Oi<32768;++Oi){var Uu=(Oi&43690)>>1|(Oi&21845)<<1;Uu=(Uu&52428)>>2|(Uu&13107)<<2,Uu=(Uu&61680)>>4|(Uu&3855)<<4,Yp[Oi]=((Uu&65280)>>8|(Uu&255)<<8)>>1}var sd=(function(T,D,I){for(var H=T.length,W=0,ee=new Eh(D);W<H;++W)T[W]&&++ee[T[W]-1];var A=new Eh(D);for(W=1;W<D;++W)A[W]=A[W-1]+ee[W-1]<<1;var d;if(I){d=new Eh(1<<D);var Se=15-D;for(W=0;W<H;++W)if(T[W])for(var Pe=W<<4|T[W],Le=D-T[W],re=A[T[W]-1]++<<Le,ne=re|(1<<Le)-1;re<=ne;++re)d[Yp[re]>>Se]=Pe}else for(d=new Eh(H),W=0;W<H;++W)T[W]&&(d[W]=Yp[A[T[W]-1]++]>>15-T[W]);return d}),pd=new us(288);for(var Oi=0;Oi<144;++Oi)pd[Oi]=8;for(var Oi=144;Oi<256;++Oi)pd[Oi]=9;for(var Oi=256;Oi<280;++Oi)pd[Oi]=7;for(var Oi=280;Oi<288;++Oi)pd[Oi]=8;var wm=new us(32);for(var Oi=0;Oi<32;++Oi)wm[Oi]=5;var Hy=sd(pd,9,1),Wy=sd(wm,5,1),Hp=function(T){for(var D=T[0],I=1;I<T.length;++I)T[I]>D&&(D=T[I]);return D},Ys=function(T,D,I){var H=D/8|0;return(T[H]|T[H+1]<<8)>>(D&7)&I},Wp=function(T,D){var I=D/8|0;return(T[I]|T[I+1]<<8|T[I+2]<<16)>>(D&7)},Xy=function(T){return(T+7)/8|0},Ky=function(T,D,I){return(I==null||I>T.length)&&(I=T.length),new us(T.subarray(D,I))},Jy=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ls=function(T,D,I){var H=new Error(D||Jy[T]);if(H.code=T,Error.captureStackTrace&&Error.captureStackTrace(H,ls),!I)throw H;return H},uf=function(T,D,I,H){var W=T.length,ee=0;if(!W||D.f&&!D.l)return I||new us(0);var A=!I,d=A||D.i!=2,Se=D.i;A&&(I=new us(W*3));var Pe=function(Pn){var di=I.length;if(Pn>di){var en=new us(Math.max(di*2,Pn));en.set(I),I=en}},Le=D.f||0,re=D.p||0,ne=D.b||0,Ge=D.l,et=D.d,je=D.m,Xe=D.n,Pt=W*8;do{if(!Ge){Le=Ys(T,re,1);var mt=Ys(T,re+1,3);if(re+=3,mt)if(mt==1)Ge=Hy,et=Wy,je=9,Xe=5;else if(mt==2){var gr=Ys(T,re,31)+257,Vt=Ys(T,re+10,15)+4,zr=gr+Ys(T,re+5,31)+1;re+=14;for(var xr=new us(zr),Br=new us(19),Et=0;Et<Vt;++Et)Br[$y[Et]]=Ys(T,re+Et*3,7);re+=Vt*3;for(var Hr=Hp(Br),kr=(1<<Hr)-1,_r=sd(Br,Hr,1),Et=0;Et<zr;){var ti=_r[Ys(T,re,kr)];re+=ti&15;var St=ti>>4;if(St<16)xr[Et++]=St;else{var Wr=0,wr=0;for(St==16?(wr=3+Ys(T,re,3),re+=2,Wr=xr[Et-1]):St==17?(wr=3+Ys(T,re,7),re+=3):St==18&&(wr=11+Ys(T,re,127),re+=7);wr--;)xr[Et++]=Wr}}var ft=xr.subarray(0,gr),Mt=xr.subarray(gr);je=Hp(ft),Xe=Hp(Mt),Ge=sd(ft,je,1),et=sd(Mt,Xe,1)}else ls(1);else{var St=Xy(re)+4,ar=T[St-4]|T[St-3]<<8,ur=St+ar;if(ur>W){Se&&ls(0);break}d&&Pe(ne+ar),I.set(T.subarray(St,ur),ne),D.b=ne+=ar,D.p=re=ur*8,D.f=Le;continue}if(re>Pt){Se&&ls(0);break}}d&&Pe(ne+131072);for(var xt=(1<<je)-1,ke=(1<<Xe)-1,He=re;;He=re){var Wr=Ge[Wp(T,re)&xt],Gt=Wr>>4;if(re+=Wr&15,re>Pt){Se&&ls(0);break}if(Wr||ls(2),Gt<256)I[ne++]=Gt;else if(Gt==256){He=re,Ge=null;break}else{var Tt=Gt-254;if(Gt>264){var Et=Gt-257,$t=gm[Et];Tt=Ys(T,re,(1<<$t)-1)+xm[Et],re+=$t}var rr=et[Wp(T,re)&ke],tr=rr>>4;rr||ls(3),re+=rr&15;var Mt=Gy[tr];if(tr>3){var $t=ym[tr];Mt+=Wp(T,re)&(1<<$t)-1,re+=$t}if(re>Pt){Se&&ls(0);break}d&&Pe(ne+131072);var cr=ne+Tt;if(ne<Mt){var Ar=ee-Mt,bi=Math.min(Mt,cr);for(Ar+ne<0&&ls(3);ne<bi;++ne)I[ne]=H[Ar+ne]}for(;ne<cr;++ne)I[ne]=I[ne-Mt]}}D.l=Ge,D.p=He,D.b=ne,D.f=Le,Ge&&(Le=1,D.m=je,D.d=et,D.n=Xe)}while(!Le);return ne!=I.length&&A?Ky(I,0,ne):I.subarray(0,ne)},Yy=new us(0),Qy=function(T){(T[0]!=31||T[1]!=139||T[2]!=8)&&ls(6,"invalid gzip data");var D=T[3],I=10;D&4&&(I+=(T[10]|T[11]<<8)+2);for(var H=(D>>3&1)+(D>>4&1);H>0;H-=!T[I++]);return I+(D&2)},e_=function(T){var D=T.length;return(T[D-4]|T[D-3]<<8|T[D-2]<<16|T[D-1]<<24)>>>0},t_=function(T,D){return((T[0]&15)!=8||T[0]>>4>7||(T[0]<<8|T[1])%31)&&ls(6,"invalid zlib data"),(T[1]>>5&1)==1&&ls(6,"invalid zlib data: "+(T[1]&32?"need":"unexpected")+" dictionary"),(T[1]>>3&4)+2};function r_(T,D){return uf(T,{i:2},D,D)}function i_(T,D){var I=Qy(T);return I+8>T.length&&ls(6,"invalid gzip data"),uf(T.subarray(I,-8),{i:2},new us(e_(T)),D)}function n_(T,D){return uf(T.subarray(t_(T),-4),{i:2},D,D)}function o_(T,D){return T[0]==31&&T[1]==139&&T[2]==8?i_(T,D):(T[0]&15)!=8||T[0]>>4>7||(T[0]<<8|T[1])%31?r_(T,D):n_(T,D)}var a_=typeof TextDecoder<"u"&&new TextDecoder,s_=0;try{a_.decode(Yy,{stream:!0}),s_=1}catch{}var l_=Object.defineProperty,ld=Math.pow,wi=(T,D)=>l_(T,"name",{value:D,configurable:!0}),oo=(T,D,I)=>new Promise((H,W)=>{var ee=Se=>{try{d(I.next(Se))}catch(Pe){W(Pe)}},A=Se=>{try{d(I.throw(Se))}catch(Pe){W(Pe)}},d=Se=>Se.done?H(Se.value):Promise.resolve(Se.value).then(ee,A);d((I=I.apply(T,D)).next())});wi((T,D)=>{let I=!1,H="",W=L.GridLayer.extend({createTile:wi((ee,A)=>{let d=document.createElement("img"),Se=new AbortController,Pe=Se.signal;return d.cancel=()=>{Se.abort()},I||(T.getHeader().then(Le=>{Le.tileType===1?console.error("Error: archive contains MVT vector tiles, but leafletRasterLayer is for displaying raster tiles. See https://github.com/protomaps/PMTiles/tree/main/js for details."):Le.tileType===2?H="image/png":Le.tileType===3?H="image/jpeg":Le.tileType===4?H="image/webp":Le.tileType===5&&(H="image/avif")}),I=!0),T.getZxy(ee.z,ee.x,ee.y,Pe).then(Le=>{if(Le){let re=new Blob([Le.data],{type:H}),ne=window.URL.createObjectURL(re);d.src=ne,d.cancel=void 0,A(void 0,d)}}).catch(Le=>{if(Le.name!=="AbortError")throw Le}),d},"createTile"),_removeTile:wi(function(ee){let A=this._tiles[ee];A&&(A.el.cancel&&A.el.cancel(),A.el.width=0,A.el.height=0,A.el.deleted=!0,L.DomUtil.remove(A.el),delete this._tiles[ee],this.fire("tileunload",{tile:A.el,coords:this._keyToTileCoords(ee)}))},"_removeTile")});return new W(D)},"leafletRasterLayer");var u_=wi(T=>(D,I)=>{if(I instanceof AbortController)return T(D,I);let H=new AbortController;return T(D,H).then(W=>I(void 0,W.data,W.cacheControl||"",W.expires||""),W=>I(W)).catch(W=>I(W)),{cancel:wi(()=>H.abort(),"cancel")}},"v3compat"),bm=class{constructor(D){this.tilev4=wi((I,H)=>oo(this,null,function*(){if(I.type==="json"){let Ge=I.url.substr(10),et=this.tiles.get(Ge);if(et||(et=new Gf(Ge),this.tiles.set(Ge,et)),this.metadata)return{data:yield et.getTileJson(I.url)};let je=yield et.getHeader();return(je.minLon>=je.maxLon||je.minLat>=je.maxLat)&&console.error(`Bounds of PMTiles archive ${je.minLon},${je.minLat},${je.maxLon},${je.maxLat} are not valid.`),{data:{tiles:[`${I.url}/{z}/{x}/{y}`],minzoom:je.minZoom,maxzoom:je.maxZoom,bounds:[je.minLon,je.minLat,je.maxLon,je.maxLat]}}}let W=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),ee=I.url.match(W);if(!ee)throw new Error("Invalid PMTiles protocol URL");let A=ee[1],d=this.tiles.get(A);d||(d=new Gf(A),this.tiles.set(A,d));let Se=ee[2],Pe=ee[3],Le=ee[4],re=yield d.getHeader(),ne=yield d?.getZxy(+Se,+Pe,+Le,H.signal);if(ne)return{data:new Uint8Array(ne.data),cacheControl:ne.cacheControl,expires:ne.expires};if(re.tileType===1){if(this.errorOnMissingTile)throw new Error("Tile not found.");return{data:new Uint8Array}}return{data:null}}),"tilev4"),this.tile=u_(this.tilev4),this.tiles=new Map,this.metadata=D?.metadata||!1,this.errorOnMissingTile=D?.errorOnMissingTile||!1}add(D){this.tiles.set(D.source.getKey(),D)}get(D){return this.tiles.get(D)}};wi(bm,"Protocol");var c_=bm;function Sm(T,D){return(D>>>0)*4294967296+(T>>>0)}wi(Sm,"toNum");function km(T,D){let I=D.buf,H=I[D.pos++],W=(H&112)>>4;if(H<128||(H=I[D.pos++],W|=(H&127)<<3,H<128)||(H=I[D.pos++],W|=(H&127)<<10,H<128)||(H=I[D.pos++],W|=(H&127)<<17,H<128)||(H=I[D.pos++],W|=(H&127)<<24,H<128)||(H=I[D.pos++],W|=(H&1)<<31,H<128))return Sm(T,W);throw new Error("Expected varint not more than 10 bytes")}wi(km,"readVarintRemainder");function zh(T){let D=T.buf,I=D[T.pos++],H=I&127;return I<128||(I=D[T.pos++],H|=(I&127)<<7,I<128)||(I=D[T.pos++],H|=(I&127)<<14,I<128)||(I=D[T.pos++],H|=(I&127)<<21,I<128)?H:(I=D[T.pos],H|=(I&15)<<28,km(H,T))}wi(zh,"readVarint");function cf(T,D,I,H){if(H===0){I===1&&(D[0]=T-1-D[0],D[1]=T-1-D[1]);let W=D[0];D[0]=D[1],D[1]=W}}wi(cf,"rotate");function Tm(T,D){let I=ld(2,T),H=D,W=D,ee=D,A=[0,0],d=1;for(;d<I;)H=1&ee/2,W=1&(ee^H),cf(d,A,H,W),A[0]+=d*H,A[1]+=d*W,ee=ee/4,d*=2;return[T,A[0],A[1]]}wi(Tm,"idOnLevel");var h_=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function zm(T,D,I){if(T>26)throw new Error("Tile zoom level exceeds max safe number limit (26)");if(D>ld(2,T)-1||I>ld(2,T)-1)throw new Error("tile x/y outside zoom level bounds");let H=h_[T],W=ld(2,T),ee=0,A=0,d=0,Se=[D,I],Pe=W/2;for(;Pe>0;)ee=(Se[0]&Pe)>0?1:0,A=(Se[1]&Pe)>0?1:0,d+=Pe*Pe*(3*ee^A),cf(Pe,Se,ee,A),Pe=Pe/2;return H+d}wi(zm,"zxyToTileId");function d_(T){let D=0;for(let I=0;I<27;I++){let H=(1<<I)*(1<<I);if(D+H>T)return Tm(I,T-D);D+=H}throw new Error("Tile zoom level exceeds max safe number limit (26)")}wi(d_,"tileIdToZxy");var p_=(T=>(T[T.Unknown=0]="Unknown",T[T.None=1]="None",T[T.Gzip=2]="Gzip",T[T.Brotli=3]="Brotli",T[T.Zstd=4]="Zstd",T))(p_||{});function fp(T,D){return oo(this,null,function*(){if(D===1||D===0)return T;if(D===2){if(typeof globalThis.DecompressionStream>"u")return o_(new Uint8Array(T));let I=new Response(T).body;if(!I)throw new Error("Failed to read response stream");let H=I.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(H).arrayBuffer()}throw new Error("Compression method not supported")})}wi(fp,"defaultDecompress");var f_=(T=>(T[T.Unknown=0]="Unknown",T[T.Mvt=1]="Mvt",T[T.Png=2]="Png",T[T.Jpeg=3]="Jpeg",T[T.Webp=4]="Webp",T[T.Avif=5]="Avif",T))(f_||{});function Em(T){return T===1?".mvt":T===2?".png":T===3?".jpg":T===4?".webp":T===5?".avif":""}wi(Em,"tileTypeExt");var m_=127;function Cm(T,D){let I=0,H=T.length-1;for(;I<=H;){let W=H+I>>1,ee=D-T[W].tileId;if(ee>0)I=W+1;else if(ee<0)H=W-1;else return T[W]}return H>=0&&(T[H].runLength===0||D-T[H].tileId<T[H].runLength)?T[H]:null}wi(Cm,"findTile");var g_=class{constructor(D){this.file=D}getKey(){return this.file.name}getBytes(D,I){return oo(this,null,function*(){return{data:yield this.file.slice(D,D+I).arrayBuffer()}})}};wi(g_,"FileSource");var Im=class{constructor(D,I=new Headers){this.url=D,this.customHeaders=I,this.mustReload=!1;let H="";"navigator"in globalThis&&(H=globalThis.navigator.userAgent||"");let W=H.indexOf("Windows")>-1,ee=/Chrome|Chromium|Edg|OPR|Brave/.test(H);this.chromeWindowsNoCache=!1,W&&ee&&(this.chromeWindowsNoCache=!0)}getKey(){return this.url}setHeaders(D){this.customHeaders=D}getBytes(D,I,H,W){return oo(this,null,function*(){let ee,A;H?A=H:(ee=new AbortController,A=ee.signal);let d=new Headers(this.customHeaders);d.set("range",`bytes=${D}-${D+I-1}`);let Se;this.mustReload?Se="reload":this.chromeWindowsNoCache&&(Se="no-store");let Pe=yield fetch(this.url,{signal:A,cache:Se,headers:d});if(D===0&&Pe.status===416){let ne=Pe.headers.get("Content-Range");if(!ne||!ne.startsWith("bytes */"))throw new Error("Missing content-length on 416 response");let Ge=+ne.substr(8);Pe=yield fetch(this.url,{signal:A,cache:"reload",headers:{range:`bytes=0-${Ge-1}`}})}let Le=Pe.headers.get("Etag");if(Le!=null&&Le.startsWith("W/")&&(Le=null),Pe.status===416||W&&Le&&Le!==W)throw this.mustReload=!0,new Qp(`Server returned non-matching ETag ${W} after one retry. Check browser extensions and servers for issues that may affect correct ETag headers.`);if(Pe.status>=300)throw new Error(`Bad response code: ${Pe.status}`);let re=Pe.headers.get("Content-Length");if(Pe.status===200&&(!re||+re>I))throw ee&&ee.abort(),new Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield Pe.arrayBuffer(),etag:Le||void 0,cacheControl:Pe.headers.get("Cache-Control")||void 0,expires:Pe.headers.get("Expires")||void 0}})}};wi(Im,"FetchSource");var y_=Im;function Is(T,D){let I=T.getUint32(D+4,!0),H=T.getUint32(D+0,!0);return I*ld(2,32)+H}wi(Is,"getUint64");function Pm(T,D){let I=new DataView(T),H=I.getUint8(7);if(H>3)throw new Error(`Archive is spec version ${H} but this library supports up to spec version 3`);return{specVersion:H,rootDirectoryOffset:Is(I,8),rootDirectoryLength:Is(I,16),jsonMetadataOffset:Is(I,24),jsonMetadataLength:Is(I,32),leafDirectoryOffset:Is(I,40),leafDirectoryLength:Is(I,48),tileDataOffset:Is(I,56),tileDataLength:Is(I,64),numAddressedTiles:Is(I,72),numTileEntries:Is(I,80),numTileContents:Is(I,88),clustered:I.getUint8(96)===1,internalCompression:I.getUint8(97),tileCompression:I.getUint8(98),tileType:I.getUint8(99),minZoom:I.getUint8(100),maxZoom:I.getUint8(101),minLon:I.getInt32(102,!0)/1e7,minLat:I.getInt32(106,!0)/1e7,maxLon:I.getInt32(110,!0)/1e7,maxLat:I.getInt32(114,!0)/1e7,centerZoom:I.getUint8(118),centerLon:I.getInt32(119,!0)/1e7,centerLat:I.getInt32(123,!0)/1e7,etag:D}}wi(Pm,"bytesToHeader");function hf(T){let D={buf:new Uint8Array(T),pos:0},I=zh(D),H=[],W=0;for(let ee=0;ee<I;ee++){let A=zh(D);H.push({tileId:W+A,offset:0,length:0,runLength:1}),W+=A}for(let ee=0;ee<I;ee++)H[ee].runLength=zh(D);for(let ee=0;ee<I;ee++)H[ee].length=zh(D);for(let ee=0;ee<I;ee++){let A=zh(D);A===0&&ee>0?H[ee].offset=H[ee-1].offset+H[ee-1].length:H[ee].offset=A-1}return H}wi(hf,"deserializeIndex");var Mm=class extends Error{};wi(Mm,"EtagMismatch");var Qp=Mm;function df(T,D){return oo(this,null,function*(){let I=yield T.getBytes(0,16384);if(new DataView(I.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");let H=I.data.slice(0,m_),W=Pm(H,I.etag),ee=I.data.slice(W.rootDirectoryOffset,W.rootDirectoryOffset+W.rootDirectoryLength),A=`${T.getKey()}|${W.etag||""}|${W.rootDirectoryOffset}|${W.rootDirectoryLength}`,d=hf(yield D(ee,W.internalCompression));return[W,[A,d.length,d]]})}wi(df,"getHeaderAndRoot");function pf(T,D,I,H,W){return oo(this,null,function*(){let ee=yield T.getBytes(I,H,void 0,W.etag),A=yield D(ee.data,W.internalCompression),d=hf(A);if(d.length===0)throw new Error("Empty directory is invalid");return d})}wi(pf,"getDirectory");var __=class{constructor(D=100,I=!0,H=fp){this.cache=new Map,this.maxCacheEntries=D,this.counter=1,this.decompress=H}getHeader(D){return oo(this,null,function*(){let I=D.getKey(),H=this.cache.get(I);if(H)return H.lastUsed=this.counter++,H.data;let W=yield df(D,this.decompress);return W[1]&&this.cache.set(W[1][0],{lastUsed:this.counter++,data:W[1][2]}),this.cache.set(I,{lastUsed:this.counter++,data:W[0]}),this.prune(),W[0]})}getDirectory(D,I,H,W){return oo(this,null,function*(){let ee=`${D.getKey()}|${W.etag||""}|${I}|${H}`,A=this.cache.get(ee);if(A)return A.lastUsed=this.counter++,A.data;let d=yield pf(D,this.decompress,I,H,W);return this.cache.set(ee,{lastUsed:this.counter++,data:d}),this.prune(),d})}prune(){if(this.cache.size>this.maxCacheEntries){let D=1/0,I;this.cache.forEach((H,W)=>{H.lastUsed<D&&(D=H.lastUsed,I=W)}),I&&this.cache.delete(I)}}invalidate(D){return oo(this,null,function*(){this.cache.delete(D.getKey())})}};wi(__,"ResolvedValueCache");var Am=class{constructor(D=100,I=!0,H=fp){this.cache=new Map,this.invalidations=new Map,this.maxCacheEntries=D,this.counter=1,this.decompress=H}getHeader(D){return oo(this,null,function*(){let I=D.getKey(),H=this.cache.get(I);if(H)return H.lastUsed=this.counter++,yield H.data;let W=new Promise((ee,A)=>{df(D,this.decompress).then(d=>{d[1]&&this.cache.set(d[1][0],{lastUsed:this.counter++,data:Promise.resolve(d[1][2])}),ee(d[0]),this.prune()}).catch(d=>{A(d)})});return this.cache.set(I,{lastUsed:this.counter++,data:W}),W})}getDirectory(D,I,H,W){return oo(this,null,function*(){let ee=`${D.getKey()}|${W.etag||""}|${I}|${H}`,A=this.cache.get(ee);if(A)return A.lastUsed=this.counter++,yield A.data;let d=new Promise((Se,Pe)=>{pf(D,this.decompress,I,H,W).then(Le=>{Se(Le),this.prune()}).catch(Le=>{Pe(Le)})});return this.cache.set(ee,{lastUsed:this.counter++,data:d}),d})}prune(){if(this.cache.size>=this.maxCacheEntries){let D=1/0,I;this.cache.forEach((H,W)=>{H.lastUsed<D&&(D=H.lastUsed,I=W)}),I&&this.cache.delete(I)}}invalidate(D){return oo(this,null,function*(){let I=D.getKey();if(this.invalidations.get(I))return yield this.invalidations.get(I);this.cache.delete(D.getKey());let H=new Promise((W,ee)=>{this.getHeader(D).then(A=>{W(),this.invalidations.delete(I)}).catch(A=>{ee(A)})});this.invalidations.set(I,H)})}};wi(Am,"SharedPromiseCache");var v_=Am,Dm=class{constructor(D,I,H){typeof D=="string"?this.source=new y_(D):this.source=D,H?this.decompress=H:this.decompress=fp,I?this.cache=I:this.cache=new v_}getHeader(){return oo(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(D,I,H,W){return oo(this,null,function*(){let ee=zm(D,I,H),A=yield this.cache.getHeader(this.source);if(D<A.minZoom||D>A.maxZoom)return;let d=A.rootDirectoryOffset,Se=A.rootDirectoryLength;for(let Pe=0;Pe<=3;Pe++){let Le=yield this.cache.getDirectory(this.source,d,Se,A),re=Cm(Le,ee);if(re){if(re.runLength>0){let ne=yield this.source.getBytes(A.tileDataOffset+re.offset,re.length,W,A.etag);return{data:yield this.decompress(ne.data,A.tileCompression),cacheControl:ne.cacheControl,expires:ne.expires}}d=A.leafDirectoryOffset+re.offset,Se=re.length}else return}throw new Error("Maximum directory depth exceeded")})}getZxy(D,I,H,W){return oo(this,null,function*(){try{return yield this.getZxyAttempt(D,I,H,W)}catch(ee){if(ee instanceof Qp)return this.cache.invalidate(this.source),yield this.getZxyAttempt(D,I,H,W);throw ee}})}getMetadataAttempt(){return oo(this,null,function*(){let D=yield this.cache.getHeader(this.source),I=yield this.source.getBytes(D.jsonMetadataOffset,D.jsonMetadataLength,void 0,D.etag),H=yield this.decompress(I.data,D.internalCompression),W=new TextDecoder("utf-8");return JSON.parse(W.decode(H))})}getMetadata(){return oo(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(D){if(D instanceof Qp)return this.cache.invalidate(this.source),yield this.getMetadataAttempt();throw D}})}getTileJson(D){return oo(this,null,function*(){let I=yield this.getHeader(),H=yield this.getMetadata(),W=Em(I.tileType);return{tilejson:"3.0.0",scheme:"xyz",tiles:[`${D}/{z}/{x}/{y}${W}`],vector_layers:H.vector_layers,attribution:H.attribution,description:H.description,name:H.name,version:H.version,bounds:[I.minLon,I.minLat,I.maxLon,I.maxLat],center:[I.centerLon,I.centerLat,I.centerZoom],minzoom:I.minZoom,maxzoom:I.maxZoom}})}};wi(Dm,"PMTiles");var Gf=Dm,ap,Xp,ef;function ff(T,D){if(!ap)ap=D;else if(!Xp)Xp=D;else{var I="var sharedChunk = {}; ("+ap+")(sharedChunk); ("+Xp+")(sharedChunk);",H={};ap(H),ef=D(H),typeof window<"u"&&(ef.workerUrl=window.URL.createObjectURL(new Blob([I],{type:"text/javascript"})))}}ff(["exports"],(function(T){class D{constructor(z,M){this.start=z,this.end=M,this.points=[],this.append=this.append.bind(this),this.prepend=this.prepend.bind(this)}append(z,M){this.points.push(Math.round(z),Math.round(M))}prepend(z,M){this.points.splice(0,0,Math.round(z),Math.round(M))}lineString(){return this.toArray()}isEmpty(){return this.points.length<2}appendFragment(z){this.points.push(...z.points),this.end=z.end}toArray(){return this.points}}const I=[[],[[[1,2],[0,1]]],[[[2,1],[1,2]]],[[[2,1],[0,1]]],[[[1,0],[2,1]]],[[[1,2],[0,1]],[[1,0],[2,1]]],[[[1,0],[1,2]]],[[[1,0],[0,1]]],[[[0,1],[1,0]]],[[[1,2],[1,0]]],[[[0,1],[1,0]],[[2,1],[1,2]]],[[[2,1],[1,0]]],[[[0,1],[2,1]]],[[[1,2],[2,1]]],[[[0,1],[1,2]]],[]];function H(N,z,M,q){return z=z*2+q[0],M=M*2+q[1],z+M*(N+1)*2}function W(N,z,M){return(z-N)/(M-N)}function ee(N,z,M=4096,q=1){if(!N)return{};const Y=M/(z.width-1);let pe,fe,Ce,$e,Ne,Ke;const We={},st=new Map,Dr=new Map;function si(yr,Mi,li){yr[0]===0?li(Y*(Ke-1),Y*(Ne-W(Ce,Mi,pe))):yr[0]===2?li(Y*Ke,Y*(Ne-W($e,Mi,fe))):yr[1]===0?li(Y*(Ke-W(fe,Mi,pe)),Y*(Ne-1)):li(Y*(Ke-W($e,Mi,Ce)),Y*Ne)}for(Ne=1-q;Ne<z.height+q;Ne++){fe=z.get(0,Ne-1),$e=z.get(0,Ne);let yr=Math.min(fe,$e),Mi=Math.max(fe,$e);for(Ke=1-q;Ke<z.width+q;Ke++){pe=fe,Ce=$e,fe=z.get(Ke,Ne-1),$e=z.get(Ke,Ne);const li=yr,dn=Mi;if(yr=Math.min(fe,$e),Mi=Math.max(fe,$e),isNaN(pe)||isNaN(fe)||isNaN($e)||isNaN(Ce))continue;const Wi=Math.min(li,yr),zo=Math.max(dn,Mi),Ai=Math.ceil(Wi/N)*N,Rn=Math.floor(zo/N)*N;for(let ii=Ai;ii<=Rn;ii+=N){const Na=pe>ii,Ui=fe>ii,Di=Ce>ii,Li=$e>ii;for(const uo of I[(Na?8:0)|(Ui?4:0)|(Li?2:0)|(Di?1:0)]){let kn=st.get(ii);kn||st.set(ii,kn=new Map);let qn=Dr.get(ii);qn||Dr.set(ii,qn=new Map);const ga=uo[0],$i=uo[1],Gn=H(z.width,Ke,Ne,ga),Eo=H(z.width,Ke,Ne,$i);let nr,fs;if(nr=qn.get(Gn))if(qn.delete(Gn),fs=kn.get(Eo))if(kn.delete(Eo),nr===fs){if(si($i,ii,nr.append),!nr.isEmpty()){let Kt=We[ii];Kt||(We[ii]=Kt=[]),Kt.push(nr.lineString())}}else nr.appendFragment(fs),qn.set(nr.end=fs.end,nr);else si($i,ii,nr.append),qn.set(nr.end=Eo,nr);else if(nr=kn.get(Eo))kn.delete(Eo),si(ga,ii,nr.prepend),kn.set(nr.start=Gn,nr);else{const Kt=new D(Gn,Eo);si(ga,ii,Kt.append),si($i,ii,Kt.append),kn.set(Gn,Kt),qn.set(Eo,Kt)}}}}}for(const[yr,Mi]of st.entries()){let li=null;for(const dn of Mi.values())dn.isEmpty()||(li==null&&(li=We[yr]||(We[yr]=[])),li.push(dn.lineString()))}return We}function A(N,z){var M={};for(var q in N)Object.prototype.hasOwnProperty.call(N,q)&&z.indexOf(q)<0&&(M[q]=N[q]);if(N!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Y=0,q=Object.getOwnPropertySymbols(N);Y<q.length;Y++)z.indexOf(q[Y])<0&&Object.prototype.propertyIsEnumerable.call(N,q[Y])&&(M[q[Y]]=N[q[Y]]);return M}function d(N,z,M,q){function Y(pe){return pe instanceof M?pe:new M(function(fe){fe(pe)})}return new(M||(M=Promise))(function(pe,fe){function Ce(Ke){try{Ne(q.next(Ke))}catch(We){fe(We)}}function $e(Ke){try{Ne(q.throw(Ke))}catch(We){fe(We)}}function Ne(Ke){Ke.done?pe(Ke.value):Y(Ke.value).then(Ce,$e)}Ne((q=q.apply(N,z||[])).next())})}typeof SuppressedError=="function"&&SuppressedError;function Se(N){const z=Object.entries(N);return z.sort(([M],[q])=>M<q?-1:M>q?1:0),z}function Pe(N){return Se(N).map(([z,M])=>[z,...typeof M=="number"?[M]:M].join("*")).join("~")}function Le(N){return Object.fromEntries(N.split("~").map(z=>z.split("*").map(Number)).map(([z,...M])=>[z,M]))}function re(N){var{thresholds:z}=N,M=A(N,["thresholds"]);return Se(Object.assign({thresholds:Pe(z)},M)).map(([q,Y])=>`${encodeURIComponent(q)}=${encodeURIComponent(Y)}`).join("&")}function ne(N){return Object.fromEntries(N.replace(/^.*\?/,"").split("&").map(z=>{const M=z.split("=").map(decodeURIComponent),q=M[0];let Y=M[1];switch(q){case"thresholds":Y=Le(Y);break;case"extent":case"multiplier":case"overzoom":case"buffer":Y=Number(Y)}return[q,Y]}))}function Ge(N){return Se(N).map(([z,M])=>`${encodeURIComponent(z)}=${encodeURIComponent(M)}`).join(",")}function et(N,z){const{thresholds:M}=N,q=A(N,["thresholds"]);let Y=[];if(M){let pe=-1/0;Object.entries(M).forEach(([fe,Ce])=>{const $e=Number(fe);$e<=z&&$e>pe&&(pe=$e,Y=typeof Ce=="number"?[Ce]:Ce)})}return Object.assign({levels:Y},q)}function je(N){const z=new ArrayBuffer(N.byteLength);return new Uint8Array(z).set(new Uint8Array(N)),z}function Xe(N,z){return N.then(M=>{var{data:q}=M,Y=A(M,["data"]);let pe=q;return z&&(pe=new Float32Array(q.length),pe.set(q)),Object.assign(Object.assign({},Y),{data:pe,transferrables:[pe.buffer]})})}function Pt(N){return N.then(({arrayBuffer:z})=>{const M=je(z);return{arrayBuffer:M,transferrables:[M]}})}let mt=null;function St(){return mt==null&&(mt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),mt||!1}let ar=null;function ur(){if(ar==null&&(ar=!1,St()&&typeof VideoFrame<"u")){const M=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(M){for(let Y=0;Y<25;Y++){const pe=Y*4;M.fillStyle=`rgb(${pe},${pe+1},${pe+2})`,M.fillRect(Y%5,Math.floor(Y/5),1,1)}const q=M.getImageData(0,0,5,5).data;for(let Y=0;Y<100;Y++)if(Y%4!==3&&q[Y]!==Y){ar=!0;break}}}return ar||!1}function gr(N,z,M){let q=()=>{};const Y=setTimeout(()=>{q(new Error("timed out")),M?.abort()},N);Vt(M,()=>{q(new Error("aborted")),clearTimeout(Y)});const pe=new Promise((fe,Ce)=>{q=Ce});return Promise.race([pe,z.finally(()=>clearTimeout(Y))])}function Vt(N,z){z&&N?.signal.addEventListener("abort",z)}function zr(N){var z;return!!(!((z=N?.signal)===null||z===void 0)&&z.aborted)}let xr=0;class Br{constructor(z=100){this.size=()=>this.items.size,this.get=(M,q,Y)=>{let pe=this.items.get(M);if(pe)pe.lastUsed=++xr,pe.waiting++;else{const Ne=new AbortController,Ke=q(M,Ne);pe={abortController:Ne,item:Ke,lastUsed:++xr,waiting:1},this.items.set(M,pe),this.prune()}const fe=this.items,Ce=pe.item.then(Ne=>Ne,Ne=>(fe.delete(M),Promise.reject(Ne)));let $e=!1;return Vt(Y,()=>{var Ne;pe&&pe.abortController&&!$e&&($e=!0,--pe.waiting<=0&&((Ne=pe.abortController)===null||Ne===void 0||Ne.abort(),fe.delete(M)))}),Ce},this.clear=()=>this.items.clear(),this.maxSize=z,this.items=new Map}prune(){if(this.items.size>this.maxSize){let z,M=1/0;this.items.forEach((q,Y)=>{q.lastUsed<M&&(M=q.lastUsed,z=Y)}),typeof z<"u"&&this.items.delete(z)}}}var Et=Uint8Array,Hr=Uint16Array,kr=Int32Array,_r=new Et([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ti=new Et([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Wr=new Et([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),wr=function(N,z){for(var M=new Hr(31),q=0;q<31;++q)M[q]=z+=1<<N[q-1];for(var Y=new kr(M[30]),q=1;q<30;++q)for(var pe=M[q];pe<M[q+1];++pe)Y[pe]=pe-M[q]<<5|q;return{b:M,r:Y}},ft=wr(_r,2),Mt=ft.b,xt=ft.r;Mt[28]=258,xt[258]=28;for(var ke=wr(ti,0),He=ke.b,Gt=new Hr(32768),Tt=0;Tt<32768;++Tt){var $t=(Tt&43690)>>1|(Tt&21845)<<1;$t=($t&52428)>>2|($t&13107)<<2,$t=($t&61680)>>4|($t&3855)<<4,Gt[Tt]=(($t&65280)>>8|($t&255)<<8)>>1}for(var rr=(function(N,z,M){for(var q=N.length,Y=0,pe=new Hr(z);Y<q;++Y)N[Y]&&++pe[N[Y]-1];var fe=new Hr(z);for(Y=1;Y<z;++Y)fe[Y]=fe[Y-1]+pe[Y-1]<<1;var Ce;{Ce=new Hr(1<<z);var $e=15-z;for(Y=0;Y<q;++Y)if(N[Y])for(var Ne=Y<<4|N[Y],Ke=z-N[Y],We=fe[N[Y]-1]++<<Ke,st=We|(1<<Ke)-1;We<=st;++We)Ce[Gt[We]>>$e]=Ne}return Ce}),tr=new Et(288),Tt=0;Tt<144;++Tt)tr[Tt]=8;for(var Tt=144;Tt<256;++Tt)tr[Tt]=9;for(var Tt=256;Tt<280;++Tt)tr[Tt]=7;for(var Tt=280;Tt<288;++Tt)tr[Tt]=8;for(var cr=new Et(32),Tt=0;Tt<32;++Tt)cr[Tt]=5;var Ar=rr(tr,9),bi=rr(cr,5),Pn=function(N){for(var z=N[0],M=1;M<N.length;++M)N[M]>z&&(z=N[M]);return z},di=function(N,z,M){var q=z/8|0;return(N[q]|N[q+1]<<8)>>(z&7)&M},en=function(N,z){var M=z/8|0;return(N[M]|N[M+1]<<8|N[M+2]<<16)>>(z&7)},wo=function(N){return(N+7)/8|0},Ia=function(N,z,M){return(M==null||M>N.length)&&(M=N.length),new Et(N.subarray(z,M))},Fe=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Si=function(N,z,M){var q=new Error(z||Fe[N]);if(q.code=N,Error.captureStackTrace&&Error.captureStackTrace(q,Si),!M)throw q;return q},ua=function(N,z,M,q){var Y=N.length,pe=0;if(!Y||z.f&&!z.l)return M||new Et(0);var fe=!M,Ce=fe||z.i!=2,$e=z.i;fe&&(M=new Et(Y*3));var Ne=function(Tn){var Ho=M.length;if(Tn>Ho){var nl=new Et(Math.max(Ho*2,Tn));nl.set(M),M=nl}},Ke=z.f||0,We=z.p||0,st=z.b||0,Dr=z.l,si=z.d,yr=z.m,Mi=z.n,li=Y*8;do{if(!Dr){Ke=di(N,We,1);var dn=di(N,We+1,3);if(We+=3,dn)if(dn==1)Dr=Ar,si=bi,yr=9,Mi=5;else if(dn==2){var Rn=di(N,We,31)+257,ii=di(N,We+10,15)+4,Na=Rn+di(N,We+5,31)+1;We+=14;for(var Ui=new Et(Na),Di=new Et(19),Li=0;Li<ii;++Li)Di[Wr[Li]]=di(N,We+Li*3,7);We+=ii*3;for(var uo=Pn(Di),kn=(1<<uo)-1,qn=rr(Di,uo),Li=0;Li<Na;){var ga=qn[di(N,We,kn)];We+=ga&15;var Wi=ga>>4;if(Wi<16)Ui[Li++]=Wi;else{var $i=0,Gn=0;for(Wi==16?(Gn=3+di(N,We,3),We+=2,$i=Ui[Li-1]):Wi==17?(Gn=3+di(N,We,7),We+=3):Wi==18&&(Gn=11+di(N,We,127),We+=7);Gn--;)Ui[Li++]=$i}}var Eo=Ui.subarray(0,Rn),nr=Ui.subarray(Rn);yr=Pn(Eo),Mi=Pn(nr),Dr=rr(Eo,yr),si=rr(nr,Mi)}else Si(1);else{var Wi=wo(We)+4,zo=N[Wi-4]|N[Wi-3]<<8,Ai=Wi+zo;if(Ai>Y){$e&&Si(0);break}Ce&&Ne(st+zo),M.set(N.subarray(Wi,Ai),st),z.b=st+=zo,z.p=We=Ai*8,z.f=Ke;continue}if(We>li){$e&&Si(0);break}}Ce&&Ne(st+131072);for(var fs=(1<<yr)-1,Kt=(1<<Mi)-1,ms=We;;ms=We){var $i=Dr[en(N,We)&fs],Lr=$i>>4;if(We+=$i&15,We>li){$e&&Si(0);break}if($i||Si(2),Lr<256)M[st++]=Lr;else if(Lr==256){ms=We,Dr=null;break}else{var Rr=Lr-254;if(Lr>264){var Li=Lr-257,pn=_r[Li];Rr=di(N,We,(1<<pn)-1)+Mt[Li],We+=pn}var ja=si[en(N,We)&Kt],ya=ja>>4;ja||Si(3),We+=ja&15;var nr=He[ya];if(ya>3){var pn=ti[ya];nr+=en(N,We)&(1<<pn)-1,We+=pn}if(We>li){$e&&Si(0);break}Ce&&Ne(st+131072);var Fs=st+Rr;if(st<nr){var Go=pe-nr,Va=Math.min(nr,Fs);for(Go+st<0&&Si(3);st<Va;++st)M[st]=q[Go+st]}for(;st<Fs;++st)M[st]=M[st-nr]}}z.l=Dr,z.p=ms,z.b=st,z.f=Ke,Dr&&(Ke=1,z.m=yr,z.d=si,z.n=Mi)}while(!Ke);return st!=M.length&&fe?Ia(M,0,st):M.subarray(0,st)},Er=new Et(0),qr=function(N){(N[0]!=31||N[1]!=139||N[2]!=8)&&Si(6,"invalid gzip data");var z=N[3],M=10;z&4&&(M+=(N[10]|N[11]<<8)+2);for(var q=(z>>3&1)+(z>>4&1);q>0;q-=!N[M++]);return M+(z&2)},bo=function(N){var z=N.length;return(N[z-4]|N[z-3]<<8|N[z-2]<<16|N[z-1]<<24)>>>0},So=function(N,z){return((N[0]&15)!=8||N[0]>>4>7||(N[0]<<8|N[1])%31)&&Si(6,"invalid zlib data"),(N[1]>>5&1)==1&&Si(6,"invalid zlib data: "+(N[1]&32?"need":"unexpected")+" dictionary"),(N[1]>>3&4)+2};function ko(N,z){return ua(N,{i:2},z,z)}function Pa(N,z){var M=qr(N);return M+8>N.length&&Si(6,"invalid gzip data"),ua(N.subarray(M,-8),{i:2},new Et(bo(N)),z)}function Mn(N,z){return ua(N.subarray(So(N),-4),{i:2},z,z)}function cs(N,z){return N[0]==31&&N[1]==139&&N[2]==8?Pa(N,z):(N[0]&15)!=8||N[0]>>4>7||(N[0]<<8|N[1])%31?ko(N,z):Mn(N,z)}var Ma=typeof TextDecoder<"u"&&new TextDecoder,rt=0;try{Ma.decode(Er,{stream:!0}),rt=1}catch{}var ao=Object.defineProperty,pi=Math.pow,fr=(N,z)=>ao(N,"name",{value:z,configurable:!0}),ri=(N,z,M)=>new Promise((q,Y)=>{var pe=$e=>{try{Ce(M.next($e))}catch(Ne){Y(Ne)}},fe=$e=>{try{Ce(M.throw($e))}catch(Ne){Y(Ne)}},Ce=$e=>$e.done?q($e.value):Promise.resolve($e.value).then(pe,fe);Ce((M=M.apply(N,z)).next())});fr((N,z)=>{let M=!1,q="",Y=L.GridLayer.extend({createTile:fr((pe,fe)=>{let Ce=document.createElement("img"),$e=new AbortController,Ne=$e.signal;return Ce.cancel=()=>{$e.abort()},M||(N.getHeader().then(Ke=>{Ke.tileType===1?console.error("Error: archive contains MVT vector tiles, but leafletRasterLayer is for displaying raster tiles. See https://github.com/protomaps/PMTiles/tree/main/js for details."):Ke.tileType===2?q="image/png":Ke.tileType===3?q="image/jpeg":Ke.tileType===4?q="image/webp":Ke.tileType===5&&(q="image/avif")}),M=!0),N.getZxy(pe.z,pe.x,pe.y,Ne).then(Ke=>{if(Ke){let We=new Blob([Ke.data],{type:q}),st=window.URL.createObjectURL(We);Ce.src=st,Ce.cancel=void 0,fe(void 0,Ce)}}).catch(Ke=>{if(Ke.name!=="AbortError")throw Ke}),Ce},"createTile"),_removeTile:fr(function(pe){let fe=this._tiles[pe];fe&&(fe.el.cancel&&fe.el.cancel(),fe.el.width=0,fe.el.height=0,fe.el.deleted=!0,L.DomUtil.remove(fe.el),delete this._tiles[pe],this.fire("tileunload",{tile:fe.el,coords:this._keyToTileCoords(pe)}))},"_removeTile")});return new Y(z)},"leafletRasterLayer");var at=fr(N=>(z,M)=>{if(M instanceof AbortController)return N(z,M);let q=new AbortController;return N(z,q).then(Y=>M(void 0,Y.data,Y.cacheControl||"",Y.expires||""),Y=>M(Y)).catch(Y=>M(Y)),{cancel:fr(()=>q.abort(),"cancel")}},"v3compat"),sr=class{constructor(z){this.tilev4=fr((M,q)=>ri(this,null,function*(){if(M.type==="json"){let Dr=M.url.substr(10),si=this.tiles.get(Dr);if(si||(si=new Xr(Dr),this.tiles.set(Dr,si)),this.metadata)return{data:yield si.getTileJson(M.url)};let yr=yield si.getHeader();return(yr.minLon>=yr.maxLon||yr.minLat>=yr.maxLat)&&console.error(`Bounds of PMTiles archive ${yr.minLon},${yr.minLat},${yr.maxLon},${yr.maxLat} are not valid.`),{data:{tiles:[`${M.url}/{z}/{x}/{y}`],minzoom:yr.minZoom,maxzoom:yr.maxZoom,bounds:[yr.minLon,yr.minLat,yr.maxLon,yr.maxLat]}}}let Y=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),pe=M.url.match(Y);if(!pe)throw new Error("Invalid PMTiles protocol URL");let fe=pe[1],Ce=this.tiles.get(fe);Ce||(Ce=new Xr(fe),this.tiles.set(fe,Ce));let $e=pe[2],Ne=pe[3],Ke=pe[4],We=yield Ce.getHeader(),st=yield Ce?.getZxy(+$e,+Ne,+Ke,q.signal);if(st)return{data:new Uint8Array(st.data),cacheControl:st.cacheControl,expires:st.expires};if(We.tileType===1){if(this.errorOnMissingTile)throw new Error("Tile not found.");return{data:new Uint8Array}}return{data:null}}),"tilev4"),this.tile=at(this.tilev4),this.tiles=new Map,this.metadata=z?.metadata||!1,this.errorOnMissingTile=z?.errorOnMissingTile||!1}add(z){this.tiles.set(z.source.getKey(),z)}get(z){return this.tiles.get(z)}};fr(sr,"Protocol");function Zt(N,z){return(z>>>0)*4294967296+(N>>>0)}fr(Zt,"toNum");function Gi(N,z){let M=z.buf,q=M[z.pos++],Y=(q&112)>>4;if(q<128||(q=M[z.pos++],Y|=(q&127)<<3,q<128)||(q=M[z.pos++],Y|=(q&127)<<10,q<128)||(q=M[z.pos++],Y|=(q&127)<<17,q<128)||(q=M[z.pos++],Y|=(q&127)<<24,q<128)||(q=M[z.pos++],Y|=(q&1)<<31,q<128))return Zt(N,Y);throw new Error("Expected varint not more than 10 bytes")}fr(Gi,"readVarintRemainder");function Ni(N){let z=N.buf,M=z[N.pos++],q=M&127;return M<128||(M=z[N.pos++],q|=(M&127)<<7,M<128)||(M=z[N.pos++],q|=(M&127)<<14,M<128)||(M=z[N.pos++],q|=(M&127)<<21,M<128)?q:(M=z[N.pos],q|=(M&15)<<28,Gi(q,N))}fr(Ni,"readVarint");function Ht(N,z,M,q){if(q===0){M===1&&(z[0]=N-1-z[0],z[1]=N-1-z[1]);let Y=z[0];z[0]=z[1],z[1]=Y}}fr(Ht,"rotate");function An(N,z){let M=pi(2,N),q=z,Y=z,pe=z,fe=[0,0],Ce=1;for(;Ce<M;)q=1&pe/2,Y=1&(pe^q),Ht(Ce,fe,q,Y),fe[0]+=Ce*q,fe[1]+=Ce*Y,pe=pe/4,Ce*=2;return[N,fe[0],fe[1]]}fr(An,"idOnLevel");var so=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function xn(N,z,M){if(N>26)throw new Error("Tile zoom level exceeds max safe number limit (26)");if(z>pi(2,N)-1||M>pi(2,N)-1)throw new Error("tile x/y outside zoom level bounds");let q=so[N],Y=pi(2,N),pe=0,fe=0,Ce=0,$e=[z,M],Ne=Y/2;for(;Ne>0;)pe=($e[0]&Ne)>0?1:0,fe=($e[1]&Ne)>0?1:0,Ce+=Ne*Ne*(3*pe^fe),Ht(Ne,$e,pe,fe),Ne=Ne/2;return q+Ce}fr(xn,"zxyToTileId");function ln(N){let z=0;for(let M=0;M<27;M++){let q=(1<<M)*(1<<M);if(z+q>N)return An(M,N-z);z+=q}throw new Error("Tile zoom level exceeds max safe number limit (26)")}fr(ln,"tileIdToZxy");var le=(N=>(N[N.Unknown=0]="Unknown",N[N.None=1]="None",N[N.Gzip=2]="Gzip",N[N.Brotli=3]="Brotli",N[N.Zstd=4]="Zstd",N))(le||{});function j(N,z){return ri(this,null,function*(){if(z===1||z===0)return N;if(z===2){if(typeof globalThis.DecompressionStream>"u")return cs(new Uint8Array(N));let M=new Response(N).body;if(!M)throw new Error("Failed to read response stream");let q=M.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(q).arrayBuffer()}throw new Error("Compression method not supported")})}fr(j,"defaultDecompress");var V=(N=>(N[N.Unknown=0]="Unknown",N[N.Mvt=1]="Mvt",N[N.Png=2]="Png",N[N.Jpeg=3]="Jpeg",N[N.Webp=4]="Webp",N[N.Avif=5]="Avif",N))(V||{});function X(N){return N===1?".mvt":N===2?".png":N===3?".jpg":N===4?".webp":N===5?".avif":""}fr(X,"tileTypeExt");var oe=127;function ge(N,z){let M=0,q=N.length-1;for(;M<=q;){let Y=q+M>>1,pe=z-N[Y].tileId;if(pe>0)M=Y+1;else if(pe<0)q=Y-1;else return N[Y]}return q>=0&&(N[q].runLength===0||z-N[q].tileId<N[q].runLength)?N[q]:null}fr(ge,"findTile");var xe=class{constructor(z){this.file=z}getKey(){return this.file.name}getBytes(z,M){return ri(this,null,function*(){return{data:yield this.file.slice(z,z+M).arrayBuffer()}})}};fr(xe,"FileSource");var Te=class{constructor(z,M=new Headers){this.url=z,this.customHeaders=M,this.mustReload=!1;let q="";"navigator"in globalThis&&(q=globalThis.navigator.userAgent||"");let Y=q.indexOf("Windows")>-1,pe=/Chrome|Chromium|Edg|OPR|Brave/.test(q);this.chromeWindowsNoCache=!1,Y&&pe&&(this.chromeWindowsNoCache=!0)}getKey(){return this.url}setHeaders(z){this.customHeaders=z}getBytes(z,M,q,Y){return ri(this,null,function*(){let pe,fe;q?fe=q:(pe=new AbortController,fe=pe.signal);let Ce=new Headers(this.customHeaders);Ce.set("range",`bytes=${z}-${z+M-1}`);let $e;this.mustReload?$e="reload":this.chromeWindowsNoCache&&($e="no-store");let Ne=yield fetch(this.url,{signal:fe,cache:$e,headers:Ce});if(z===0&&Ne.status===416){let st=Ne.headers.get("Content-Range");if(!st||!st.startsWith("bytes */"))throw new Error("Missing content-length on 416 response");let Dr=+st.substr(8);Ne=yield fetch(this.url,{signal:fe,cache:"reload",headers:{range:`bytes=0-${Dr-1}`}})}let Ke=Ne.headers.get("Etag");if(Ke!=null&&Ke.startsWith("W/")&&(Ke=null),Ne.status===416||Y&&Ke&&Ke!==Y)throw this.mustReload=!0,new Ct(`Server returned non-matching ETag ${Y} after one retry. Check browser extensions and servers for issues that may affect correct ETag headers.`);if(Ne.status>=300)throw new Error(`Bad response code: ${Ne.status}`);let We=Ne.headers.get("Content-Length");if(Ne.status===200&&(!We||+We>M))throw pe&&pe.abort(),new Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield Ne.arrayBuffer(),etag:Ke||void 0,cacheControl:Ne.headers.get("Cache-Control")||void 0,expires:Ne.headers.get("Expires")||void 0}})}};fr(Te,"FetchSource");var de=Te;function De(N,z){let M=N.getUint32(z+4,!0),q=N.getUint32(z+0,!0);return M*pi(2,32)+q}fr(De,"getUint64");function qe(N,z){let M=new DataView(N),q=M.getUint8(7);if(q>3)throw new Error(`Archive is spec version ${q} but this library supports up to spec version 3`);return{specVersion:q,rootDirectoryOffset:De(M,8),rootDirectoryLength:De(M,16),jsonMetadataOffset:De(M,24),jsonMetadataLength:De(M,32),leafDirectoryOffset:De(M,40),leafDirectoryLength:De(M,48),tileDataOffset:De(M,56),tileDataLength:De(M,64),numAddressedTiles:De(M,72),numTileEntries:De(M,80),numTileContents:De(M,88),clustered:M.getUint8(96)===1,internalCompression:M.getUint8(97),tileCompression:M.getUint8(98),tileType:M.getUint8(99),minZoom:M.getUint8(100),maxZoom:M.getUint8(101),minLon:M.getInt32(102,!0)/1e7,minLat:M.getInt32(106,!0)/1e7,maxLon:M.getInt32(110,!0)/1e7,maxLat:M.getInt32(114,!0)/1e7,centerZoom:M.getUint8(118),centerLon:M.getInt32(119,!0)/1e7,centerLat:M.getInt32(123,!0)/1e7,etag:z}}fr(qe,"bytesToHeader");function Ae(N){let z={buf:new Uint8Array(N),pos:0},M=Ni(z),q=[],Y=0;for(let pe=0;pe<M;pe++){let fe=Ni(z);q.push({tileId:Y+fe,offset:0,length:0,runLength:1}),Y+=fe}for(let pe=0;pe<M;pe++)q[pe].runLength=Ni(z);for(let pe=0;pe<M;pe++)q[pe].length=Ni(z);for(let pe=0;pe<M;pe++){let fe=Ni(z);fe===0&&pe>0?q[pe].offset=q[pe-1].offset+q[pe-1].length:q[pe].offset=fe-1}return q}fr(Ae,"deserializeIndex");var it=class extends Error{};fr(it,"EtagMismatch");var Ct=it;function Lt(N,z){return ri(this,null,function*(){let M=yield N.getBytes(0,16384);if(new DataView(M.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");let q=M.data.slice(0,oe),Y=qe(q,M.etag),pe=M.data.slice(Y.rootDirectoryOffset,Y.rootDirectoryOffset+Y.rootDirectoryLength),fe=`${N.getKey()}|${Y.etag||""}|${Y.rootDirectoryOffset}|${Y.rootDirectoryLength}`,Ce=Ae(yield z(pe,Y.internalCompression));return[Y,[fe,Ce.length,Ce]]})}fr(Lt,"getHeaderAndRoot");function br(N,z,M,q,Y){return ri(this,null,function*(){let pe=yield N.getBytes(M,q,void 0,Y.etag),fe=yield z(pe.data,Y.internalCompression),Ce=Ae(fe);if(Ce.length===0)throw new Error("Empty directory is invalid");return Ce})}fr(br,"getDirectory");var er=class{constructor(z=100,M=!0,q=j){this.cache=new Map,this.maxCacheEntries=z,this.counter=1,this.decompress=q}getHeader(z){return ri(this,null,function*(){let M=z.getKey(),q=this.cache.get(M);if(q)return q.lastUsed=this.counter++,q.data;let Y=yield Lt(z,this.decompress);return Y[1]&&this.cache.set(Y[1][0],{lastUsed:this.counter++,data:Y[1][2]}),this.cache.set(M,{lastUsed:this.counter++,data:Y[0]}),this.prune(),Y[0]})}getDirectory(z,M,q,Y){return ri(this,null,function*(){let pe=`${z.getKey()}|${Y.etag||""}|${M}|${q}`,fe=this.cache.get(pe);if(fe)return fe.lastUsed=this.counter++,fe.data;let Ce=yield br(z,this.decompress,M,q,Y);return this.cache.set(pe,{lastUsed:this.counter++,data:Ce}),this.prune(),Ce})}prune(){if(this.cache.size>this.maxCacheEntries){let z=1/0,M;this.cache.forEach((q,Y)=>{q.lastUsed<z&&(z=q.lastUsed,M=Y)}),M&&this.cache.delete(M)}}invalidate(z){return ri(this,null,function*(){this.cache.delete(z.getKey())})}};fr(er,"ResolvedValueCache");var Tr=class{constructor(z=100,M=!0,q=j){this.cache=new Map,this.invalidations=new Map,this.maxCacheEntries=z,this.counter=1,this.decompress=q}getHeader(z){return ri(this,null,function*(){let M=z.getKey(),q=this.cache.get(M);if(q)return q.lastUsed=this.counter++,yield q.data;let Y=new Promise((pe,fe)=>{Lt(z,this.decompress).then(Ce=>{Ce[1]&&this.cache.set(Ce[1][0],{lastUsed:this.counter++,data:Promise.resolve(Ce[1][2])}),pe(Ce[0]),this.prune()}).catch(Ce=>{fe(Ce)})});return this.cache.set(M,{lastUsed:this.counter++,data:Y}),Y})}getDirectory(z,M,q,Y){return ri(this,null,function*(){let pe=`${z.getKey()}|${Y.etag||""}|${M}|${q}`,fe=this.cache.get(pe);if(fe)return fe.lastUsed=this.counter++,yield fe.data;let Ce=new Promise(($e,Ne)=>{br(z,this.decompress,M,q,Y).then(Ke=>{$e(Ke),this.prune()}).catch(Ke=>{Ne(Ke)})});return this.cache.set(pe,{lastUsed:this.counter++,data:Ce}),Ce})}prune(){if(this.cache.size>=this.maxCacheEntries){let z=1/0,M;this.cache.forEach((q,Y)=>{q.lastUsed<z&&(z=q.lastUsed,M=Y)}),M&&this.cache.delete(M)}}invalidate(z){return ri(this,null,function*(){let M=z.getKey();if(this.invalidations.get(M))return yield this.invalidations.get(M);this.cache.delete(z.getKey());let q=new Promise((Y,pe)=>{this.getHeader(z).then(fe=>{Y(),this.invalidations.delete(M)}).catch(fe=>{pe(fe)})});this.invalidations.set(M,q)})}};fr(Tr,"SharedPromiseCache");var ir=Tr,gi=class{constructor(z,M,q){typeof z=="string"?this.source=new de(z):this.source=z,q?this.decompress=q:this.decompress=j,M?this.cache=M:this.cache=new ir}getHeader(){return ri(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(z,M,q,Y){return ri(this,null,function*(){let pe=xn(z,M,q),fe=yield this.cache.getHeader(this.source);if(z<fe.minZoom||z>fe.maxZoom)return;let Ce=fe.rootDirectoryOffset,$e=fe.rootDirectoryLength;for(let Ne=0;Ne<=3;Ne++){let Ke=yield this.cache.getDirectory(this.source,Ce,$e,fe),We=ge(Ke,pe);if(We){if(We.runLength>0){let st=yield this.source.getBytes(fe.tileDataOffset+We.offset,We.length,Y,fe.etag);return{data:yield this.decompress(st.data,fe.tileCompression),cacheControl:st.cacheControl,expires:st.expires}}Ce=fe.leafDirectoryOffset+We.offset,$e=We.length}else return}throw new Error("Maximum directory depth exceeded")})}getZxy(z,M,q,Y){return ri(this,null,function*(){try{return yield this.getZxyAttempt(z,M,q,Y)}catch(pe){if(pe instanceof Ct)return this.cache.invalidate(this.source),yield this.getZxyAttempt(z,M,q,Y);throw pe}})}getMetadataAttempt(){return ri(this,null,function*(){let z=yield this.cache.getHeader(this.source),M=yield this.source.getBytes(z.jsonMetadataOffset,z.jsonMetadataLength,void 0,z.etag),q=yield this.decompress(M.data,z.internalCompression),Y=new TextDecoder("utf-8");return JSON.parse(Y.decode(q))})}getMetadata(){return ri(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(z){if(z instanceof Ct)return this.cache.invalidate(this.source),yield this.getMetadataAttempt();throw z}})}getTileJson(z){return ri(this,null,function*(){let M=yield this.getHeader(),q=yield this.getMetadata(),Y=X(M.tileType);return{tilejson:"3.0.0",scheme:"xyz",tiles:[`${z}/{z}/{x}/{y}${Y}`],vector_layers:q.vector_layers,attribution:q.attribution,description:q.description,name:q.name,version:q.version,bounds:[M.minLon,M.minLat,M.maxLon,M.maxLat],center:[M.centerLon,M.centerLat,M.centerZoom],minzoom:M.minZoom,maxzoom:M.maxZoom}})}};fr(gi,"PMTiles");var Xr=gi;function hr(N){const z=new de(N);return new Xr(z)}function Or(N,z,M,q){return d(this,void 0,void 0,function*(){try{const Y=yield N.getZxy(z,M,q);return Y&&Y.data?{data:Y.data}:{data:void 0}}catch(Y){return console.error("Error fetching tile:",Y),{data:void 0}}})}function Kr(N,z,M){return d(this,void 0,void 0,function*(){})}let yi,Pi,ji,Aa;function Xt(N,z,M){return d(this,void 0,void 0,function*(){const q=yield Kr();return zr(M)?null:q})}function Bl(N,z,M){return d(this,void 0,void 0,function*(){const q=yield createImageBitmap(N);return zr(M)?null:hs(q,z)})}function hs(N,z){return yi||(yi=new OffscreenCanvas(N.width,N.height),Pi=yi.getContext("2d",{willReadFrequently:!0})),rn(N,z,yi,Pi)}function wn(N,z,M){return d(this,void 0,void 0,function*(){var q,Y,pe;const fe=yield createImageBitmap(N);if(zr(M))return null;const Ce=new VideoFrame(fe,{timestamp:0});try{if(!(((q=Ce?.format)===null||q===void 0?void 0:q.startsWith("BGR"))||((Y=Ce?.format)===null||Y===void 0?void 0:Y.startsWith("RGB"))))throw new Error(`Unrecognized format: ${Ce?.format}`);const Ne=(pe=Ce?.format)===null||pe===void 0?void 0:pe.startsWith("BGR"),Ke=Ce.allocationSize(),We=new Uint8ClampedArray(Ke);if(yield Ce.copyTo(We),Ne)for(let st=0;st<We.length;st+=4){const Dr=We[st];We[st]=We[st+2],We[st+2]=Dr}return $o(fe.width,fe.height,z,We)}catch{return zr(M)?null:hs(fe,z)}finally{Ce.close()}})}function tn(N,z,M){return d(this,void 0,void 0,function*(){ji||(ji=document.createElement("canvas"),Aa=ji.getContext("2d",{willReadFrequently:!0}));const q=new Image;Vt(M,()=>q.src="");const Y=yield new Promise((pe,fe)=>{q.onload=()=>{zr(M)||pe(q),URL.revokeObjectURL(q.src),q.onload=null},q.onerror=()=>fe(new Error("Could not load image.")),q.src=N.size?URL.createObjectURL(N):""});return rn(Y,z,ji,Aa)})}function Zu(N,z,M){return self.actor.send("decodeImage",[],M,void 0,N,z)}function Dn(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}const Hi=ur()?wn:St()?Bl:Dn()?Zu:typeof document<"u"?tn:Xt;function rn(N,z,M,q){if(M.width=N.width,M.height=N.height,!q)throw new Error("failed to get context");q.drawImage(N,0,0,N.width,N.height);const Y=q.getImageData(0,0,N.width,N.height).data;return $o(N.width,N.height,z,Y)}function $o(N,z,M,q){const Y=M==="mapbox"?(fe,Ce,$e)=>-1e4+(fe*256*256+Ce*256+$e)*.1:(fe,Ce,$e)=>fe*256+Ce+$e/256-32768,pe=new Float32Array(N*z);for(let fe=0;fe<q.length;fe+=4)pe[fe/4]=Y(q[fe],q[fe+1],q[fe+2]);return{width:N,height:z,data:pe}}const Vr=-12e3,As=9e3;function lo(N){return!isNaN(N)&&N>=Vr&&N<=As}class Nr{constructor(z,M,q){this.split=(Y,pe,fe)=>{if(Y===0)return this;const Ce=1<<Y,$e=pe*this.width/Ce,Ne=fe*this.height/Ce;return new Nr(this.width/Ce,this.height/Ce,(Ke,We)=>this.get(Ke+$e,We+Ne))},this.subsamplePixelCenters=Y=>{const pe=($e,Ne,Ke)=>isNaN($e)?Ne:isNaN(Ne)?$e:$e+(Ne-$e)*Ke;if(Y<=1)return this;const fe=.5-1/(2*Y),Ce=($e,Ne)=>{const Ke=$e/Y-fe,We=Ne/Y-fe,st=Math.floor(Ke),Dr=Math.floor(We),si=this.get(st,Dr),yr=this.get(st+1,Dr),Mi=this.get(st,Dr+1),li=this.get(st+1,Dr+1),dn=Ke-st,Wi=We-Dr,zo=pe(si,yr,dn),Ai=pe(Mi,li,dn);return pe(zo,Ai,Wi)};return new Nr(this.width*Y,this.height*Y,Ce)},this.averagePixelCentersToGrid=(Y=1)=>new Nr(this.width+1,this.height+1,(pe,fe)=>{let Ce=0,$e=0,Ne=0;for(let Ke=pe-Y;Ke<pe+Y;Ke++)for(let We=fe-Y;We<fe+Y;We++)isNaN(Ne=this.get(Ke,We))||($e++,Ce+=Ne);return $e===0?NaN:Ce/$e}),this.scaleElevation=Y=>Y===1?this:new Nr(this.width,this.height,(pe,fe)=>this.get(pe,fe)*Y),this.materialize=(Y=2)=>{const pe=this.width+2*Y,fe=new Float32Array(pe*(this.height+2*Y));let Ce=0;for(let $e=-Y;$e<this.height+Y;$e++)for(let Ne=-Y;Ne<this.width+Y;Ne++)fe[Ce++]=this.get(Ne,$e);return new Nr(this.width,this.height,($e,Ne)=>fe[(Ne+Y)*pe+$e+Y])},this.get=q,this.width=z,this.height=M}static fromRawDem(z){return new Nr(z.width,z.height,(M,q)=>{const Y=z.data[q*z.width+M];return lo(Y)?Y:NaN})}static combineNeighbors(z){if(z.length!==9)throw new Error("Must include a tile plus 8 neighbors");const M=z[4];if(!M)return;const q=M.width,Y=M.height;return new Nr(q,Y,(pe,fe)=>{let Ce=0;fe<0?fe+=Y:fe<Y?Ce+=3:(fe-=Y,Ce+=6),pe<0?pe+=q:pe<q?Ce+=1:(pe-=q,Ce+=2);const $e=z[Ce];return $e?$e.get(pe,fe):NaN})}}const Zo=65536*65536,un=1/Zo,Da=12,cn=typeof TextDecoder>"u"?null:new TextDecoder("utf-8"),Ol=0,La=1,Ln=2,Un=5;class Cr{constructor(z=new Uint8Array(16)){this.buf=ArrayBuffer.isView(z)?z:new Uint8Array(z),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(z,M,q=this.length){for(;this.pos<q;){const Y=this.readVarint(),pe=Y>>3,fe=this.pos;this.type=Y&7,z(pe,M,this),this.pos===fe&&this.skip(Y)}return M}readMessage(z,M){return this.readFields(z,M,this.readVarint()+this.pos)}readFixed32(){const z=this.dataView.getUint32(this.pos,!0);return this.pos+=4,z}readSFixed32(){const z=this.dataView.getInt32(this.pos,!0);return this.pos+=4,z}readFixed64(){const z=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Zo;return this.pos+=8,z}readSFixed64(){const z=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Zo;return this.pos+=8,z}readFloat(){const z=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,z}readDouble(){const z=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,z}readVarint(z){const M=this.buf;let q,Y;return Y=M[this.pos++],q=Y&127,Y<128||(Y=M[this.pos++],q|=(Y&127)<<7,Y<128)||(Y=M[this.pos++],q|=(Y&127)<<14,Y<128)||(Y=M[this.pos++],q|=(Y&127)<<21,Y<128)?q:(Y=M[this.pos],q|=(Y&15)<<28,Ra(q,z,this))}readVarint64(){return this.readVarint(!0)}readSVarint(){const z=this.readVarint();return z%2===1?(z+1)/-2:z/2}readBoolean(){return!!this.readVarint()}readString(){const z=this.readVarint()+this.pos,M=this.pos;return this.pos=z,z-M>=Da&&cn?cn.decode(this.buf.subarray(M,z)):Vi(this.buf,M,z)}readBytes(){const z=this.readVarint()+this.pos,M=this.buf.subarray(this.pos,z);return this.pos=z,M}readPackedVarint(z=[],M){const q=this.readPackedEnd();for(;this.pos<q;)z.push(this.readVarint(M));return z}readPackedSVarint(z=[]){const M=this.readPackedEnd();for(;this.pos<M;)z.push(this.readSVarint());return z}readPackedBoolean(z=[]){const M=this.readPackedEnd();for(;this.pos<M;)z.push(this.readBoolean());return z}readPackedFloat(z=[]){const M=this.readPackedEnd();for(;this.pos<M;)z.push(this.readFloat());return z}readPackedDouble(z=[]){const M=this.readPackedEnd();for(;this.pos<M;)z.push(this.readDouble());return z}readPackedFixed32(z=[]){const M=this.readPackedEnd();for(;this.pos<M;)z.push(this.readFixed32());return z}readPackedSFixed32(z=[]){const M=this.readPackedEnd();for(;this.pos<M;)z.push(this.readSFixed32());return z}readPackedFixed64(z=[]){const M=this.readPackedEnd();for(;this.pos<M;)z.push(this.readFixed64());return z}readPackedSFixed64(z=[]){const M=this.readPackedEnd();for(;this.pos<M;)z.push(this.readSFixed64());return z}readPackedEnd(){return this.type===Ln?this.readVarint()+this.pos:this.pos+1}skip(z){const M=z&7;if(M===Ol)for(;this.buf[this.pos++]>127;);else if(M===Ln)this.pos=this.readVarint()+this.pos;else if(M===Un)this.pos+=4;else if(M===La)this.pos+=8;else throw new Error(`Unimplemented type: ${M}`)}writeTag(z,M){this.writeVarint(z<<3|M)}realloc(z){let M=this.length||16;for(;M<this.pos+z;)M*=2;if(M!==this.length){const q=new Uint8Array(M);q.set(this.buf),this.buf=q,this.dataView=new DataView(q.buffer),this.length=M}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(z){this.realloc(4),this.dataView.setInt32(this.pos,z,!0),this.pos+=4}writeSFixed32(z){this.realloc(4),this.dataView.setInt32(this.pos,z,!0),this.pos+=4}writeFixed64(z){this.realloc(8),this.dataView.setInt32(this.pos,z&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(z*un),!0),this.pos+=8}writeSFixed64(z){this.realloc(8),this.dataView.setInt32(this.pos,z&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(z*un),!0),this.pos+=8}writeVarint(z){if(z=+z||0,z>268435455||z<0){ha(z,this);return}this.realloc(4),this.buf[this.pos++]=z&127|(z>127?128:0),!(z<=127)&&(this.buf[this.pos++]=(z>>>=7)&127|(z>127?128:0),!(z<=127)&&(this.buf[this.pos++]=(z>>>=7)&127|(z>127?128:0),!(z<=127)&&(this.buf[this.pos++]=z>>>7&127)))}writeSVarint(z){this.writeVarint(z<0?-z*2-1:z*2)}writeBoolean(z){this.writeVarint(+z)}writeString(z){z=String(z),this.realloc(z.length*4),this.pos++;const M=this.pos;this.pos=da(this.buf,z,this.pos);const q=this.pos-M;q>=128&&Fa(M,q,this),this.pos=M-1,this.writeVarint(q),this.pos+=q}writeFloat(z){this.realloc(4),this.dataView.setFloat32(this.pos,z,!0),this.pos+=4}writeDouble(z){this.realloc(8),this.dataView.setFloat64(this.pos,z,!0),this.pos+=8}writeBytes(z){const M=z.length;this.writeVarint(M),this.realloc(M);for(let q=0;q<M;q++)this.buf[this.pos++]=z[q]}writeRawMessage(z,M){this.pos++;const q=this.pos;z(M,this);const Y=this.pos-q;Y>=128&&Fa(q,Y,this),this.pos=q-1,this.writeVarint(Y),this.pos+=Y}writeMessage(z,M,q){this.writeTag(z,Ln),this.writeRawMessage(M,q)}writePackedVarint(z,M){M.length&&this.writeMessage(z,ds,M)}writePackedSVarint(z,M){M.length&&this.writeMessage(z,Ba,M)}writePackedBoolean(z,M){M.length&&this.writeMessage(z,Qs,M)}writePackedFloat(z,M){M.length&&this.writeMessage(z,Nl,M)}writePackedDouble(z,M){M.length&&this.writeMessage(z,gu,M)}writePackedFixed32(z,M){M.length&&this.writeMessage(z,el,M)}writePackedSFixed32(z,M){M.length&&this.writeMessage(z,bn,M)}writePackedFixed64(z,M){M.length&&this.writeMessage(z,$n,M)}writePackedSFixed64(z,M){M.length&&this.writeMessage(z,ki,M)}writeBytesField(z,M){this.writeTag(z,Ln),this.writeBytes(M)}writeFixed32Field(z,M){this.writeTag(z,Un),this.writeFixed32(M)}writeSFixed32Field(z,M){this.writeTag(z,Un),this.writeSFixed32(M)}writeFixed64Field(z,M){this.writeTag(z,La),this.writeFixed64(M)}writeSFixed64Field(z,M){this.writeTag(z,La),this.writeSFixed64(M)}writeVarintField(z,M){this.writeTag(z,Ol),this.writeVarint(M)}writeSVarintField(z,M){this.writeTag(z,Ol),this.writeSVarint(M)}writeStringField(z,M){this.writeTag(z,Ln),this.writeString(M)}writeFloatField(z,M){this.writeTag(z,Un),this.writeFloat(M)}writeDoubleField(z,M){this.writeTag(z,La),this.writeDouble(M)}writeBooleanField(z,M){this.writeVarintField(z,+M)}}function Ra(N,z,M){const q=M.buf;let Y,pe;if(pe=q[M.pos++],Y=(pe&112)>>4,pe<128||(pe=q[M.pos++],Y|=(pe&127)<<3,pe<128)||(pe=q[M.pos++],Y|=(pe&127)<<10,pe<128)||(pe=q[M.pos++],Y|=(pe&127)<<17,pe<128)||(pe=q[M.pos++],Y|=(pe&127)<<24,pe<128)||(pe=q[M.pos++],Y|=(pe&1)<<31,pe<128))return ca(N,Y,z);throw new Error("Expected varint not more than 10 bytes")}function ca(N,z,M){return M?z*4294967296+(N>>>0):(z>>>0)*4294967296+(N>>>0)}function ha(N,z){let M,q;if(N>=0?(M=N%4294967296|0,q=N/4294967296|0):(M=~(-N%4294967296),q=~(-N/4294967296),M^4294967295?M=M+1|0:(M=0,q=q+1|0)),N>=18446744073709552e3||N<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");z.realloc(10),jr(M,q,z),Ds(q,z)}function jr(N,z,M){M.buf[M.pos++]=N&127|128,N>>>=7,M.buf[M.pos++]=N&127|128,N>>>=7,M.buf[M.pos++]=N&127|128,N>>>=7,M.buf[M.pos++]=N&127|128,N>>>=7,M.buf[M.pos]=N&127}function Ds(N,z){const M=(N&7)<<4;z.buf[z.pos++]|=M|((N>>>=3)?128:0),N&&(z.buf[z.pos++]=N&127|((N>>>=7)?128:0),N&&(z.buf[z.pos++]=N&127|((N>>>=7)?128:0),N&&(z.buf[z.pos++]=N&127|((N>>>=7)?128:0),N&&(z.buf[z.pos++]=N&127|((N>>>=7)?128:0),N&&(z.buf[z.pos++]=N&127)))))}function Fa(N,z,M){const q=z<=16383?1:z<=2097151?2:z<=268435455?3:Math.floor(Math.log(z)/(Math.LN2*7));M.realloc(q);for(let Y=M.pos-1;Y>=N;Y--)M.buf[Y+q]=M.buf[Y]}function ds(N,z){for(let M=0;M<N.length;M++)z.writeVarint(N[M])}function Ba(N,z){for(let M=0;M<N.length;M++)z.writeSVarint(N[M])}function Nl(N,z){for(let M=0;M<N.length;M++)z.writeFloat(N[M])}function gu(N,z){for(let M=0;M<N.length;M++)z.writeDouble(N[M])}function Qs(N,z){for(let M=0;M<N.length;M++)z.writeBoolean(N[M])}function el(N,z){for(let M=0;M<N.length;M++)z.writeFixed32(N[M])}function bn(N,z){for(let M=0;M<N.length;M++)z.writeSFixed32(N[M])}function $n(N,z){for(let M=0;M<N.length;M++)z.writeFixed64(N[M])}function ki(N,z){for(let M=0;M<N.length;M++)z.writeSFixed64(N[M])}function Vi(N,z,M){let q="",Y=z;for(;Y<M;){const pe=N[Y];let fe=null,Ce=pe>239?4:pe>223?3:pe>191?2:1;if(Y+Ce>M)break;let $e,Ne,Ke;Ce===1?pe<128&&(fe=pe):Ce===2?($e=N[Y+1],($e&192)===128&&(fe=(pe&31)<<6|$e&63,fe<=127&&(fe=null))):Ce===3?($e=N[Y+1],Ne=N[Y+2],($e&192)===128&&(Ne&192)===128&&(fe=(pe&15)<<12|($e&63)<<6|Ne&63,(fe<=2047||fe>=55296&&fe<=57343)&&(fe=null))):Ce===4&&($e=N[Y+1],Ne=N[Y+2],Ke=N[Y+3],($e&192)===128&&(Ne&192)===128&&(Ke&192)===128&&(fe=(pe&15)<<18|($e&63)<<12|(Ne&63)<<6|Ke&63,(fe<=65535||fe>=1114112)&&(fe=null))),fe===null?(fe=65533,Ce=1):fe>65535&&(fe-=65536,q+=String.fromCharCode(fe>>>10&1023|55296),fe=56320|fe&1023),q+=String.fromCharCode(fe),Y+=Ce}return q}function da(N,z,M){for(let q=0,Y,pe;q<z.length;q++){if(Y=z.charCodeAt(q),Y>55295&&Y<57344)if(pe)if(Y<56320){N[M++]=239,N[M++]=191,N[M++]=189,pe=Y;continue}else Y=pe-55296<<10|Y-56320|65536,pe=null;else{Y>56319||q+1===z.length?(N[M++]=239,N[M++]=191,N[M++]=189):pe=Y;continue}else pe&&(N[M++]=239,N[M++]=191,N[M++]=189,pe=null);Y<128?N[M++]=Y:(Y<2048?N[M++]=Y>>6|192:(Y<65536?N[M++]=Y>>12|224:(N[M++]=Y>>18|240,N[M++]=Y>>12&63|128),N[M++]=Y>>6&63|128),N[M++]=Y&63|128)}return M}var nn;(function(N){N[N.UNKNOWN=0]="UNKNOWN",N[N.POINT=1]="POINT",N[N.LINESTRING=2]="LINESTRING",N[N.POLYGON=3]="POLYGON"})(nn||(nn={}));function tl(N){const z=new Cr;for(const M in N.layers){const q=N.layers[M];q.extent||(q.extent=N.extent),z.writeMessage(3,jl,Object.assign(Object.assign({},q),{id:M}))}return z.finish()}function jl(N,z){if(!z)throw new Error("pbf undefined");z.writeVarintField(15,2),z.writeStringField(1,N.id||""),z.writeVarintField(5,N.extent||4096);const M={keys:[],values:[],keycache:{},valuecache:{}};for(const q of N.features)M.feature=q,z.writeMessage(2,To,M);for(const q of M.keys)z.writeStringField(3,q);for(const q of M.values)z.writeMessage(4,Gu,q)}function To(N,z){const M=N.feature;if(!M||!z)throw new Error;z.writeMessage(2,qu,N),z.writeVarintField(3,M.type),z.writeMessage(4,yu,M)}function qu(N,z){const M=N.feature;if(!M||!z)throw new Error;const q=N.keys,Y=N.values,pe=N.keycache,fe=N.valuecache;for(const Ce in M.properties){let $e=M.properties[Ce],Ne=pe[Ce];if($e===null)continue;typeof Ne>"u"&&(q.push(Ce),Ne=q.length-1,pe[Ce]=Ne),z.writeVarint(Ne);const Ke=typeof $e;Ke!=="string"&&Ke!=="boolean"&&Ke!=="number"&&($e=JSON.stringify($e));const We=`${Ke}:${$e}`;let st=fe[We];typeof st>"u"&&(Y.push($e),st=Y.length-1,fe[We]=st),z.writeVarint(st)}}function Ls(N,z){return(z<<3)+(N&7)}function ps(N){return N<<1^N>>31}function yu(N,z){if(!z)throw new Error;const M=N.geometry,q=N.type;let Y=0,pe=0;for(const fe of M){let Ce=1;q===nn.POINT&&(Ce=fe.length/2),z.writeVarint(Ls(1,Ce));const $e=fe.length/2,Ne=q===nn.POLYGON?$e-1:$e;for(let Ke=0;Ke<Ne;Ke++){Ke===1&&q!==1&&z.writeVarint(Ls(2,Ne-1));const We=fe[Ke*2]-Y,st=fe[Ke*2+1]-pe;z.writeVarint(ps(We)),z.writeVarint(ps(st)),Y+=We,pe+=st}q===nn.POLYGON&&z.writeVarint(Ls(7,1))}}function Gu(N,z){if(!z)throw new Error;typeof N=="string"?z.writeStringField(1,N):typeof N=="boolean"?z.writeBooleanField(7,N):typeof N=="number"&&(N%1!==0?z.writeDoubleField(3,N):N<0?z.writeSVarintField(6,N):z.writeVarintField(5,N))}const Sn=typeof performance<"u"?performance:void 0,qo=Sn?Sn.timeOrigin||new Date().getTime()-Sn.now():new Date().getTime();function pa(N){var z;return JSON.parse(JSON.stringify(((z=Sn?.getEntriesByName)===null||z===void 0?void 0:z.call(Sn,N))||[]))}function fa(){return Sn?Sn.now():new Date().getTime()}function Vl(N){const z=[];for(const M of N)z.push(...M);return z}class rl{constructor(z){this.marks={},this.urls=[],this.fetched=[],this.resources=[],this.tilesFetched=0,this.timeOrigin=qo,this.finish=M=>{this.markFinish();const q=$e=>{const Ne=this.marks[$e]||[],Ke=Math.max(...Ne.map(st=>Math.max(...st))),We=Math.min(...Ne.map(st=>Math.min(...st)));return Number.isFinite(Ke)?Ke-We:void 0},Y=q("main")||0,pe=q("fetch"),fe=q("decode"),Ce=q("isoline");return{url:M,tilesUsed:this.tilesFetched,origin:this.timeOrigin,marks:this.marks,resources:[...this.resources,...Vl(this.fetched.map(pa))],duration:Y,fetch:pe,decode:fe,process:Ce,wait:Y-(pe||0)-(fe||0)-(Ce||0)}},this.error=M=>Object.assign(Object.assign({},this.finish(M)),{error:!0}),this.marker=M=>{var q;this.marks[M]||(this.marks[M]=[]);const Y=[fa()];return(q=this.marks[M])===null||q===void 0||q.push(Y),()=>Y.push(fa())},this.useTile=M=>{this.urls.indexOf(M)<0&&(this.urls.push(M),this.tilesFetched++)},this.fetchTile=M=>{this.fetched.indexOf(M)<0&&this.fetched.push(M)},this.addAll=M=>{var q;this.tilesFetched+=M.tilesUsed;const Y=M.origin-this.timeOrigin;for(const pe in M.marks){const fe=pe;(this.marks[fe]||(this.marks[fe]=[])).push(...((q=M.marks[fe])===null||q===void 0?void 0:q.map($e=>$e.map(Ne=>Ne+Y)))||[])}this.resources.push(...M.resources.map(pe=>il(pe,Y)))},this.markFinish=this.marker(z)}}const Zn=/(Start$|End$|^start|^end)/;function il(N,z){const M={};for(const q in N)N[q]!==0&&Zn.test(q)?M[q]=Number(N[q])+z:M[q]=N[q];return M}const Rs=(N,z,M,q,Y)=>d(void 0,void 0,void 0,function*(){const pe=q.replace("{z}",N.toString()).replace("{x}",z.toString()).replace("{y}",M.toString()),fe={signal:Y.signal},Ce=yield fetch(pe,fe);if(!Ce.ok)throw new Error(`Bad response: ${Ce.status} for ${pe}`);return{data:yield Ce.blob(),expires:Ce.headers.get("expires")||void 0,cacheControl:Ce.headers.get("cache-control")||void 0}}),ma=(N,z,M,q,Y,pe)=>d(void 0,void 0,void 0,function*(){if(!pe)throw new Error("pmtiles is not initialized.");if(Y.signal.aborted)throw new Error("Request aborted by parent.");try{const fe=yield Or(pe,N,z,M);if(fe&&fe.data)return{data:new Blob([fe.data]),expires:void 0,cacheControl:void 0};throw new Error(`Tile data not found for z:${N} x:${z} y:${M}`)}catch(fe){throw new Error(`Failed to fetch DEM tile for z:${N} x:${z} y:${M} from PMTiles: ${fe}`)}});class hn{constructor(z){if(this.pmtiles=null,this.loaded=Promise.resolve(),this.fetchAndParseTile=(M,q,Y,pe,fe)=>{const Ce=this,$e=`${M}/${q}/${Y}`;return fe?.useTile($e),this.parsedCache.get($e,(Ne,Ke)=>d(this,void 0,void 0,function*(){const We=yield Ce.fetchTile(M,q,Y,Ke,fe);if(zr(Ke))throw new Error("canceled");const st=Ce.decodeImage(We.data,Ce.encoding,Ke),Dr=fe?.marker("decode"),si=yield st;return Dr?.(),si}),pe)},this.tileCache=new Br(z.cacheSize),this.parsedCache=new Br(z.cacheSize),this.contourCache=new Br(z.cacheSize),this.timeoutMs=z.timeoutMs,this.demUrlPattern=z.demUrlPattern,this.encoding=z.encoding,this.maxzoom=z.maxzoom,this.decodeImage=z.decodeImage||Hi,this.demUrlPattern.startsWith("pmtiles://"))try{this.pmtiles=hr(this.demUrlPattern.replace("pmtiles://",""))}catch(M){console.warn("Could not open pmtiles",M)}this.getTile=z.getTile||(this.demUrlPattern.startsWith("pmtiles://")?ma:Rs)}fetchTile(z,M,q,Y,pe){const fe=`${z}/${M}/${q}`;return pe?.useTile(fe),this.tileCache.get(fe,(Ce,$e)=>{pe?.fetchTile(fe);const Ne=pe?.marker("fetch");return gr(this.timeoutMs,this.getTile(z,M,q,this.demUrlPattern,$e,this.pmtiles).finally(()=>Ne?.()),$e)},Y)}fetchDem(z,M,q,Y,pe,fe){return d(this,void 0,void 0,function*(){const Ce=Math.min(z-(Y.overzoom||0),this.maxzoom),$e=z-Ce,Ne=1<<$e,Ke=Math.floor(M/Ne),We=Math.floor(q/Ne),st=yield this.fetchAndParseTile(Ce,Ke,We,pe,fe);return Nr.fromRawDem(st).split($e,M%Ne,q%Ne)})}fetchContourTile(z,M,q,Y,pe,fe){const{levels:Ce,multiplier:$e=1,buffer:Ne=1,extent:Ke=4096,contourLayer:We="contours",elevationKey:st="ele",levelKey:Dr="level",subsampleBelow:si=100}=Y;if(!Ce||Ce.length===0)return Promise.resolve({arrayBuffer:new ArrayBuffer(0)});const yr=[z,M,q,Ge(Y)].join("/");return this.contourCache.get(yr,(Mi,li)=>d(this,void 0,void 0,function*(){const dn=1<<z,Wi=[];for(let Ui=q-1;Ui<=q+1;Ui++)for(let Di=M-1;Di<=M+1;Di++)Wi.push(Ui<0||Ui>=dn?void 0:this.fetchDem(z,(Di+dn)%dn,Ui,Y,li,fe));const zo=yield Promise.all(Wi);let Ai=Nr.combineNeighbors(zo);if(!Ai||zr(li))return{arrayBuffer:new Uint8Array().buffer};const Rn=fe?.marker("isoline");if(Ai.width>=si)Ai=Ai.materialize(2);else for(;Ai.width<si;)Ai=Ai.subsamplePixelCenters(2).materialize(2);Ai=Ai.averagePixelCentersToGrid().scaleElevation($e).materialize(1);const ii=ee(Ce[0],Ai,Ke,Ne);Rn?.();const Na=tl({extent:Ke,layers:{[We]:{features:Object.entries(ii).map(([Ui,Di])=>{const Li=Number(Ui);return{type:nn.LINESTRING,geometry:Di,properties:{[st]:Li,[Dr]:Math.max(...Ce.map((uo,kn)=>Li%uo===0?kn:0))}}})}}});return Rn?.(),{arrayBuffer:Na.buffer}}),pe)}}let Ir=0;class Oa{constructor(z,M,q=2e4){this.callbacks={},this.cancels={},this.dest=z,this.timeoutMs=q,this.dest.onmessage=Y=>d(this,[Y],void 0,function*({data:pe}){const fe=pe;if(fe.type==="cancel"){const Ce=this.cancels[fe.id];delete this.cancels[fe.id],Ce?.abort()}else if(fe.type==="response"){const Ce=this.callbacks[fe.id];delete this.callbacks[fe.id],Ce&&Ce(fe.error?new Error(fe.error):void 0,fe.response,fe.timings)}else if(fe.type==="request"){const Ce=new rl("worker"),$e=M[fe.name],Ne=new AbortController,Ke=$e.apply($e,[...fe.args,Ne,Ce]),We=`${fe.name}_${fe.id}`;if(fe.id&&Ke){this.cancels[fe.id]=Ne;try{const st=yield Ke,Dr=st?.transferrables;this.postMessage({id:fe.id,type:"response",response:st,timings:Ce.finish(We)},Dr)}catch(st){this.postMessage({id:fe.id,type:"response",error:st?.toString()||"error",timings:Ce.finish(We)})}delete this.cancels[fe.id]}}})}postMessage(z,M){this.dest.postMessage(z,M||[])}send(z,M,q,Y,...pe){const fe=++Ir,Ce=new Promise(($e,Ne)=>{this.postMessage({id:fe,type:"request",name:z,args:pe},M),this.callbacks[fe]=(Ke,We,st)=>{Y?.addAll(st),Ke?Ne(Ke):$e(We)}});return Vt(q,()=>{delete this.callbacks[fe],this.postMessage({id:fe,type:"cancel"})}),gr(this.timeoutMs,Ce,q)}}T.A=Oa,T.H=Nr,T.L=hn,T.T=rl,T._=d,T.a=ne,T.b=$o,T.c=ee,T.d=Hi,T.e=re,T.f=Pt,T.g=et,T.p=Xe}));ff(["./shared"],(function(T){const D=W=>Promise.reject(new Error(`No manager registered for ${W}`));class I{constructor(){this.managers={},this.init=(ee,A)=>(this.managers[ee.managerId]=new T.L(ee),Promise.resolve()),this.fetchTile=(ee,A,d,Se,Pe,Le)=>{var re;return((re=this.managers[ee])===null||re===void 0?void 0:re.fetchTile(A,d,Se,Pe,Le))||D(ee)},this.fetchAndParseTile=(ee,A,d,Se,Pe,Le)=>{var re;return T.p(((re=this.managers[ee])===null||re===void 0?void 0:re.fetchAndParseTile(A,d,Se,Pe,Le))||D(ee),!0)},this.fetchContourTile=(ee,A,d,Se,Pe,Le,re)=>{var ne;return T.f(((ne=this.managers[ee])===null||ne===void 0?void 0:ne.fetchContourTile(A,d,Se,Pe,Le,re))||D(ee))}}}const H=typeof self<"u"?self:typeof window<"u"?window:global;H.actor=new T.A(H,new I)}));ff(["./shared"],(function(T){const D={workerUrl:""};let I,H=0;class W{constructor(){this.decodeImage=(ne,Ge,et)=>T.p(T.d(ne,Ge,et),!1)}}function ee(){if(!I){const re=new Worker(D.workerUrl),ne=new W;I=new T.A(re,ne)}return I}class A{constructor(ne){this.fetchTile=(et,je,Xe,Pt,mt)=>this.actor.send("fetchTile",[],Pt,mt,this.managerId,et,je,Xe),this.fetchAndParseTile=(et,je,Xe,Pt,mt)=>this.actor.send("fetchAndParseTile",[],Pt,mt,this.managerId,et,je,Xe),this.fetchContourTile=(et,je,Xe,Pt,mt,St)=>this.actor.send("fetchContourTile",[],mt,St,this.managerId,et,je,Xe,Pt);const Ge=this.managerId=++H;this.actor=ne.actor||ee(),this.loaded=this.actor.send("init",[],new AbortController,void 0,Object.assign(Object.assign({},ne),{managerId:Ge}))}}Blob.prototype.arrayBuffer||(Blob.prototype.arrayBuffer=function(){return new Promise((ne,Ge)=>{const et=new FileReader;et.onload=je=>{var Xe;return ne((Xe=je.target)===null||Xe===void 0?void 0:Xe.result)},et.onerror=Ge,et.readAsArrayBuffer(this)})});const d=re=>(ne,Ge)=>{if(Ge instanceof AbortController)return re(ne,Ge);{const et=new AbortController;return re(ne,et).then(je=>Ge(void 0,je.data,je.cacheControl,je.expires),je=>Ge(je)).catch(je=>Ge(je)),{cancel:()=>et.abort()}}},Se=new Set;class Pe{constructor({url:ne,cacheSize:Ge=100,id:et="dem",encoding:je="terrarium",maxzoom:Xe=12,worker:Pt=!0,timeoutMs:mt=1e4,actor:St}){this.timingCallbacks=[],this.onTiming=Vt=>{this.timingCallbacks.push(Vt)},this.setupMaplibre=Vt=>{Vt.addProtocol(this.sharedDemProtocolId,this.sharedDemProtocol),Vt.addProtocol(this.contourProtocolId,this.contourProtocol)},this.sharedDemProtocolV4=(Vt,zr)=>T._(this,void 0,void 0,function*(){const[xr,Br,Et]=this.parseUrl(Vt.url),Hr=new T.T("main");let kr;try{const _r=yield this.manager.fetchTile(xr,Br,Et,zr,Hr);return kr=Hr.finish(Vt.url),{data:yield _r.data.arrayBuffer(),cacheControl:_r.cacheControl,expires:_r.expires}}catch(_r){throw kr=Hr.error(Vt.url),_r}finally{this.timingCallbacks.forEach(_r=>_r(kr))}}),this.contourProtocolV4=(Vt,zr)=>T._(this,void 0,void 0,function*(){const xr=new T.T("main");let Br;try{const[Et,Hr,kr]=this.parseUrl(Vt.url),_r=T.a(Vt.url),ti=yield this.manager.fetchContourTile(Et,Hr,kr,T.g(_r,Et),zr,xr);return Br=xr.finish(Vt.url),{data:ti.arrayBuffer}}catch(Et){throw Br=xr.error(Vt.url),Et}finally{this.timingCallbacks.forEach(Et=>Et(Br))}}),this.contourProtocol=d(this.contourProtocolV4),this.sharedDemProtocol=d(this.sharedDemProtocolV4),this.contourProtocolUrl=Vt=>`${this.contourProtocolUrlBase}?${T.e(Vt)}`;let ar=et,ur=1;for(;Se.has(ar);)ar=et+ur++;Se.add(ar),this.sharedDemProtocolId=`${ar}-shared`,this.contourProtocolId=`${ar}-contour`,this.sharedDemProtocolUrl=`${this.sharedDemProtocolId}://{z}/{x}/{y}`,this.contourProtocolUrlBase=`${this.contourProtocolId}://{z}/{x}/{y}`;const gr=Pt?A:T.L;this.manager=new gr({demUrlPattern:ne,cacheSize:Ge,encoding:je,maxzoom:Xe,timeoutMs:mt,actor:St})}getDemTile(ne,Ge,et,je){return this.manager.fetchAndParseTile(ne,Ge,et,je||new AbortController)}parseUrl(ne){const[,Ge,et,je]=/\/\/(\d+)\/(\d+)\/(\d+)/.exec(ne)||[];return[Number(Ge),Number(et),Number(je)]}}return{generateIsolines:T.c,DemSource:Pe,HeightTile:T.H,LocalDemManager:T.L,decodeParsedImage:T.b,set workerUrl(re){D.workerUrl=re},get workerUrl(){return D.workerUrl}}}));var x_=ef;class w_{_container;_map;_btn;_bearing;_pitch;_minpitchzoom;constructor(D){this._pitch=D.pitch||70,this._bearing=D.bearing||null,this._minpitchzoom=D.minpitchzoom||null}onAdd(D){return this._map=D,this._btn=document.createElement("button"),this._btn.className="maplibregl-ctrl-icon maplibregl-ctrl-pitchtoggle-3d",this._btn.type="button",this._btn.onclick=()=>{if(D.getPitch()===0){const I={pitch:this._pitch,bearing:0,zoom:D.getZoom()};this._bearing?I.bearing=this._bearing:I.bearing=D.getBearing(),this._minpitchzoom&&D.getZoom()>this._minpitchzoom&&(I.zoom=this._minpitchzoom),D.easeTo(I),this._btn.className="maplibregl-ctrl-icon maplibregl-ctrl-pitchtoggle-2d"}else D.easeTo({pitch:0,bearing:D.getBearing()}),this._btn.className="maplibregl-ctrl-icon maplibregl-ctrl-pitchtoggle-3d"},this._map.on("pitchend",()=>{this._map&&(this._map.getPitch()===0?this._btn.className="maplibregl-ctrl-icon maplibregl-ctrl-pitchtoggle-3d":this._btn.className="maplibregl-ctrl-icon maplibregl-ctrl-pitchtoggle-2d")}),this._container=document.createElement("div"),this._container.className="maplibregl-ctrl maplibregl-ctrl-group",this._container.appendChild(this._btn),this._container}onRemove(){!this._container||!this._container.parentNode||!this._map||(this._container.parentNode.removeChild(this._container),this._map=void 0)}}function b_(T){const D=new c_;Th.addProtocol("pmtiles",D.tile);const I=new x_.DemSource({url:"pmtiles://"+window.location.protocol+"//"+window.location.host+"/terrain/terrain.pmtiles",encoding:"mapbox",maxzoom:12,cacheSize:100,worker:!0});I.setupMaplibre(Th);const H=S_(),W=new Th.Map({container:T,attributionControl:!1,minZoom:11,maxZoom:16.95,maxPitch:60,pitch:0,hash:!0,style:{version:8,sources:{vector_map:{type:"vector",url:"pmtiles:///map/map.pmtiles",attribution:"&copy; OSM"},terrainSource:{url:"pmtiles:///terrain/terrain.pmtiles",tileSize:256,type:"raster-dem",encoding:"mapbox",minzoom:5,maxzoom:12,bounds:[-180,-85.05112877980659,180,85.0511287798066],attribution:"&copy; Sentinel"},contours:{type:"vector",tiles:[I.contourProtocolUrl({multiplier:1,overzoom:1,thresholds:{11:[100,500],12:[50,200],13:[25,100],14:[10,50],15:[10,50]},elevationKey:"ele",levelKey:"level",contourLayer:"contours"})],maxzoom:15}},sprite:"/images/sprites",glyphs:"/fonts/{fontstack}/{range}.pbf",layers:[{id:"background",type:"background",paint:{"background-color":"#f0f0f0"}},{id:"hillshade",type:"hillshade",source:"terrainSource",paint:{"hillshade-illumination-direction":315,"hillshade-shadow-color":"#444454ff","hillshade-highlight-color":"#f0f0f0ff","hillshade-accent-color":"#343444ff","hillshade-exaggeration":.5}},...H,{id:"contours",type:"line",source:"contours","source-layer":"contours",paint:{"line-opacity":["match",["get","level"],1,.3,.1],"line-width":1}},{id:"contour-labels",type:"symbol",source:"contours","source-layer":"contours",filter:[">",["get","level"],0],paint:{"text-halo-color":"white","text-halo-width":1,"text-color":"#444444","text-opacity":.9},layout:{"symbol-placement":"line","text-size":7,"text-field":"{ele}","text-font":["Noto Sans Regular"],"text-pitch-alignment":"viewport"}}],terrain:{source:"terrainSource",exaggeration:1.25}}});return W.addControl(new mm.GeolocateControl({}),"bottom-right"),W.addControl(new w_({}),"bottom-right"),W.addControl(new Th.NavigationControl,"bottom-right"),W.addControl(new Th.ScaleControl({maxWidth:150,unit:"metric"}),"bottom-left"),W.addControl(new Th.AttributionControl({compact:!0,customAttribution:"MapLibre"}),"bottom-left"),W}function S_(){return[{source:"vector_map",id:"water-ocean",type:"fill","source-layer":"ocean",paint:{"fill-color":"rgb(150,180,220)"}},{source:"vector_map",id:"land-glacier",type:"fill","source-layer":"water_polygons",filter:["all",["==","kind","glacier"]],paint:{"fill-color":"rgba(209, 237, 249, 0.5)"}},{source:"vector_map",id:"land-waste",type:"fill","source-layer":"land",filter:["all",["in","kind","landfill"]],paint:{"fill-color":"rgb(219,214,189)"}},{source:"vector_map",id:"land-park",type:"fill","source-layer":"land",filter:["all",["in","kind","park","village_green","recreation_ground"]],paint:{"fill-color":"rgb(217,217,165)"}},{source:"vector_map",id:"land-rock",type:"fill","source-layer":"land",filter:["all",["in","kind","bare_rock","scree","shingle"]],paint:{"fill-color":"rgba(139, 187, 199, 0.7)"}},{source:"vector_map",id:"land-forest",type:"fill","source-layer":"land",filter:["all",["in","kind","forest"]],paint:{"fill-color":"rgba(6, 119, 42, 0.15)"}},{source:"vector_map",id:"land-grass",type:"fill","source-layer":"land",filter:["all",["in","kind","grass","grassland","meadow","wet_meadow"]],paint:{"fill-color":"rgba(215, 238, 254, 0.4)"}},{source:"vector_map",id:"land-vegetation",type:"fill","source-layer":"land",filter:["all",["in","kind","heath","scrub"]],paint:{"fill-color":"rgba(6, 119, 42, 0.15)"}},{source:"vector_map",id:"land-sand",type:"fill","source-layer":"land",filter:["all",["in","kind","beach","sand"]],paint:{"fill-color":"rgb(250,250,237)"}},{source:"vector_map",id:"land-wetland",type:"fill","source-layer":"land",filter:["all",["in","kind","bog","marsh","string_bog","swamp"]],paint:{"fill-color":"rgb(211,230,219)"}},{source:"vector_map",id:"water-river",type:"line","source-layer":"water_lines",filter:["all",["in","kind","river"],["!=","tunnel",!0],["!=","bridge",!0]],paint:{"line-color":"rgb(150,180,220)","line-width":["interpolate",["exponential",1.75],["zoom"],9,0,10,3,15,5,17,9,18,20,20,60]},layout:{"line-cap":"round","line-join":"round"}},{source:"vector_map",id:"water-canal",type:"line","source-layer":"water_lines",filter:["all",["in","kind","canal"],["!=","tunnel",!0],["!=","bridge",!0]],paint:{"line-color":"rgb(150,180,220)","line-width":["interpolate",["exponential",1.75],["zoom"],9,0,10,2,15,4,17,8,18,17,20,50]},layout:{"line-cap":"round","line-join":"round"}},{source:"vector_map",id:"water-stream",type:"line","source-layer":"water_lines",filter:["all",["in","kind","stream"],["!=","tunnel",!0],["!=","bridge",!0]],paint:{"line-color":"rgb(150,180,220)","line-width":["interpolate",["exponential",1.75],["zoom"],13,0,14,1,15,2,17,6,18,12,20,30]},layout:{"line-cap":"round","line-join":"round"}},{source:"vector_map",id:"water-ditch",type:"line","source-layer":"water_lines",filter:["all",["in","kind","ditch"],["!=","tunnel",!0],["!=","bridge",!0]],paint:{"line-color":"rgb(150,180,220)","line-width":["interpolate",["exponential",1.75],["zoom"],14,0,15,1,17,4,18,8,20,20]},layout:{"line-cap":"round","line-join":"round"}},{source:"vector_map",id:"water-area",type:"fill","source-layer":"water_polygons",filter:["==","kind","water"],paint:{"fill-color":"rgb(150,180,220)"}},{source:"vector_map",id:"water-area-river",type:"fill","source-layer":"water_polygons",filter:["==","kind","river"],paint:{"fill-color":"rgb(150,180,220)"}},{source:"vector_map",id:"water-area-small",type:"fill","source-layer":"water_polygons",filter:["in","kind","reservoir","basin","dock"],paint:{"fill-color":"rgb(150,180,220)"}},{source:"vector_map",id:"water-dam-area",type:"fill","source-layer":"dam_polygons",filter:["==","kind","dam"],paint:{"fill-color":"rgb(249,244,238)","fill-opacity":["interpolate",["linear"],["zoom"],12,0,13,1]}},{source:"vector_map",id:"water-dam",type:"line","source-layer":"dam_lines",filter:["==","kind","dam"],paint:{"line-color":"rgb(150,180,220)"},layout:{"line-cap":"round","line-join":"round"}},{source:"vector_map",id:"water-pier-area",type:"fill","source-layer":"pier_polygons",filter:["in","kind","pier","breakwater","groyne"],paint:{"fill-color":"rgb(249,244,238)","fill-opacity":["interpolate",["linear"],["zoom"],12,0,13,1]}},{source:"vector_map",id:"water-pier",type:"line","source-layer":"pier_lines",filter:["in","kind","pier","breakwater","groyne"],paint:{"line-color":"rgb(249,244,238)"},layout:{"line-cap":"round","line-join":"round"}},{source:"vector_map",id:"site-dangerarea",type:"fill","source-layer":"sites",filter:["in","kind","danger_area"],paint:{"fill-color":"rgb(255,0,0)","fill-outline-color":"rgb(255,0,0)","fill-opacity":.3}},{source:"vector_map",id:"site-parking",type:"fill","source-layer":"sites",filter:["in","kind","parking"],paint:{"fill-color":"rgba(67, 67, 67, 0.5)"}},{source:"vector_map",id:"site-construction",type:"fill","source-layer":"sites",filter:["in","kind","construction"],paint:{"fill-color":"rgba(65, 65, 65, 1)","fill-opacity":.1}},{source:"vector_map",id:"airport-area",type:"fill","source-layer":"street_polygons",filter:["in","kind","runway","taxiway"],paint:{"fill-color":"rgba(223, 181, 255, 1)","fill-opacity":.5}},{source:"vector_map",id:"airport-runway:outline",type:"line","source-layer":"streets",filter:["==","kind","runway"],paint:{"line-color":"rgb(207,205,202)","line-width":["interpolate",["exponential",1.75],["zoom"],11,0,12,6,13,9,14,16,15,24,16,40,17,100,18,160,20,300]},layout:{"line-join":"round"}},{source:"vector_map",id:"airport-runway",type:"line","source-layer":"streets",filter:["==","kind","runway"],paint:{"line-color":"rgb(255,255,255)","line-width":["interpolate",["exponential",1.75],["zoom"],11,0,12,5,13,8,14,14,15,22,16,38,17,98,18,158,20,298],"line-opacity":["interpolate",["linear"],["zoom"],11,0,12,1]},layout:{"line-join":"round"}},{source:"vector_map",id:"building:outline",type:"fill","source-layer":"buildings",paint:{"fill-color":"rgba(221, 197, 173, 0.4)","fill-opacity":["interpolate",["linear"],["zoom"],14,0,15,1]}},{id:"building-3d",type:"fill-extrusion",source:"vector_map","source-layer":"buildings",minzoom:14,paint:{"fill-extrusion-base":["get","render_min_height"],"fill-extrusion-color":"rgba(221, 197, 173, 1)","fill-extrusion-height":["get","render_height"],"fill-extrusion-opacity":.8}},{source:"vector_map",id:"tunnel-street-pedestrian-zone",type:"fill","source-layer":"street_polygons",filter:["all",["==","tunnel",!0],["==","kind","pedestrian"]],paint:{"fill-color":"rgb(247,247,247)","fill-opacity":["interpolate",["linear"],["zoom"],12,0,13,1]}},{source:"vector_map",id:"tunnel-way-footway:outline",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","footway"]],layout:{"line-cap":"round"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,5,18,7,19,12,20,22],"line-color":"hsl(288,13%,86%)"},minzoom:15},{source:"vector_map",id:"tunnel-way-steps:outline",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","steps"]],layout:{"line-cap":"round"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,5,18,7,19,12,20,22],"line-color":"hsl(288,13%,86%)"},minzoom:15},{source:"vector_map",id:"tunnel-way-path:outline",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","path"]],layout:{"line-cap":"round"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,5,18,7,19,12,20,22],"line-color":"hsl(288,13%,86%)"},minzoom:15},{source:"vector_map",id:"tunnel-way-cycleway:outline",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","cycleway"]],layout:{"line-cap":"round"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,5,18,7,19,12,20,22],"line-color":"hsl(203,11%,87%)"},minzoom:15},{source:"vector_map",id:"tunnel-street-track:outline",type:"line","source-layer":"streets",filter:["all",["==","kind","track"],["==","tunnel",!0]],paint:{"line-color":"rgb(222,222,222)","line-width":["interpolate",["exponential",1.75],["zoom"],14,2,16,4,18,18,19,48,20,96],"line-opacity":["interpolate",["linear"],["zoom"],14,0,15,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-pedestrian:outline",type:"line","source-layer":"streets",filter:["all",["==","kind","pedestrian"],["==","tunnel",!0]],paint:{"line-color":"rgb(222,222,222)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,6,18,26,19,64,20,128],"line-opacity":["interpolate",["linear"],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-service:outline",type:"line","source-layer":"streets",filter:["all",["==","kind","service"],["==","tunnel",!0]],paint:{"line-color":"rgb(221,220,218)","line-width":["interpolate",["exponential",1.75],["zoom"],14,1,16,3,18,12,19,32,20,48],"line-opacity":["interpolate",["linear"],["zoom"],14,0,15,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-livingstreet:outline",type:"line","source-layer":"streets",filter:["all",["==","kind","living_street"],["==","tunnel",!0]],paint:{"line-color":"rgb(222,222,222)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,6,18,26,19,64,20,128],"line-opacity":["interpolate",["linear"],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-residential:outline",type:"line","source-layer":"streets",filter:["all",["==","kind","residential"],["==","tunnel",!0]],paint:{"line-color":"rgb(222,222,222)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,6,18,26,19,64,20,128],"line-opacity":["interpolate",["linear"],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-unclassified:outline",type:"line","source-layer":"streets",filter:["all",["==","kind","unclassified"],["==","tunnel",!0]],paint:{"line-color":"rgb(222,222,222)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,6,18,26,19,64,20,128],"line-opacity":["interpolate",["linear"],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-tertiary-link:outline",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","tertiary"],["==","link",!0]],paint:{"line-color":"rgb(222,222,222)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,6,18,26,19,64,20,128],"line-opacity":["interpolate",["linear"],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-secondary-link:outline",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","secondary"],["==","link",!0]],paint:{"line-color":"rgb(234,176,126)","line-dasharray":[1,.3],"line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,7,18,14,20,40]},layout:{"line-join":"round","line-cap":"round"},minzoom:13},{source:"vector_map",id:"tunnel-street-primary-link:outline",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","primary"],["==","link",!0]],paint:{"line-color":"rgb(234,176,126)","line-dasharray":[1,.3],"line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,7,18,14,20,40]},layout:{"line-join":"round","line-cap":"round"},minzoom:13},{source:"vector_map",id:"tunnel-street-trunk-link:outline",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","trunk"],["==","link",!0]],paint:{"line-color":"rgb(234,176,126)","line-dasharray":[1,.3],"line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,7,18,14,20,40]},layout:{"line-join":"round","line-cap":"round"},minzoom:13},{source:"vector_map",id:"tunnel-street-motorway-link:outline",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","motorway"],["==","link",!0]],paint:{"line-color":"rgb(234,176,126)","line-dasharray":[1,.3],"line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,7,18,14,20,40]},layout:{"line-join":"round","line-cap":"round"},minzoom:12},{source:"vector_map",id:"tunnel-street-tertiary:outline",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","tertiary"],["!=","link",!0]],paint:{"line-color":"rgb(222,222,222)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,6,18,26,19,64,20,128],"line-opacity":["interpolate",["linear"],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-secondary:outline",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","secondary"],["!=","link",!0]],paint:{"line-color":"rgb(234,176,126)","line-dasharray":[1,.3],"line-width":["interpolate",["exponential",1.75],["zoom"],11,2,14,5,16,8,18,30,19,68,20,138],"line-opacity":["interpolate",["linear"],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-primary:outline",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","primary"],["!=","link",!0]],paint:{"line-color":"rgb(234,176,126)","line-dasharray":[1,.3],"line-width":["interpolate",["exponential",1.75],["zoom"],8,0,9,1,10,4,14,6,16,12,18,36,19,74,20,144]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-trunk:outline",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","trunk"],["!=","link",!0]],paint:{"line-color":"rgb(234,176,126)","line-dasharray":[1,.3],"line-width":["interpolate",["exponential",1.75],["zoom"],7,0,8,2,10,4,14,6,16,12,18,36,19,74,20,144]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-motorway:outline",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","motorway"],["!=","link",!0]],paint:{"line-color":"rgb(234,176,126)","line-dasharray":[1,.3],"line-width":["interpolate",["exponential",1.75],["zoom"],5,0,6,2,10,5,14,5,16,14,18,38,19,84,20,168]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-way-footway",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","footway"]],layout:{"line-cap":"round"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,4,18,6,19,10,20,20],"line-color":"hsl(288,33%,94%)","line-dasharray":[1,.2]},minzoom:15},{source:"vector_map",id:"tunnel-way-steps",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","steps"]],layout:{"line-cap":"round"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,4,18,6,19,10,20,20],"line-color":"hsl(288,33%,94%)","line-dasharray":[1,.2]},minzoom:15},{source:"vector_map",id:"tunnel-way-path",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","path"]],layout:{"line-cap":"round"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,4,18,6,19,10,20,20],"line-color":"hsl(288,33%,94%)","line-dasharray":[1,.2]},minzoom:15},{source:"vector_map",id:"tunnel-way-cycleway",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","cycleway"]],layout:{"line-cap":"round"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,4,18,6,19,10,20,20],"line-color":"hsl(203,30%,95%)","line-dasharray":[1,.2]},minzoom:15},{source:"vector_map",id:"tunnel-street-track",type:"line","source-layer":"streets",filter:["all",["==","kind","track"],["==","tunnel",!0]],paint:{"line-color":"rgb(247,247,247)","line-width":["interpolate",["exponential",1.75],["zoom"],14,1,16,3,18,16,19,44,20,88],"line-opacity":["interpolate",["linear"],["zoom"],14,0,15,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-pedestrian",type:"line","source-layer":"streets",filter:["all",["==","kind","pedestrian"],["==","tunnel",!0]],paint:{"line-color":"rgb(247,247,247)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["linear"],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-service",type:"line","source-layer":"streets",filter:["all",["==","kind","service"],["==","tunnel",!0]],paint:{"line-color":"rgb(247,247,247)","line-width":["interpolate",["exponential",1.75],["zoom"],14,1,16,2,18,10,19,28,20,40],"line-opacity":["interpolate",["linear"],["zoom"],15,0,16,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-livingstreet",type:"line","source-layer":"streets",filter:["all",["==","kind","living_street"],["==","tunnel",!0]],paint:{"line-color":"rgb(247,247,247)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["linear"],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-residential",type:"line","source-layer":"streets",filter:["all",["==","kind","residential"],["==","tunnel",!0]],paint:{"line-color":"rgb(247,247,247)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["linear"],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-unclassified",type:"line","source-layer":"streets",filter:["all",["==","kind","unclassified"],["==","tunnel",!0]],paint:{"line-color":"rgb(247,247,247)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["linear"],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-track-bicycle",type:"line","source-layer":"streets",filter:["all",["==","kind","track"],["==","bicycle","designated"],["==","tunnel",!0]],paint:{"line-color":"rgb(247,247,247)"},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-pedestrian-bicycle",type:"line","source-layer":"streets",filter:["all",["==","kind","pedestrian"],["==","bicycle","designated"],["==","tunnel",!0]],paint:{"line-color":"rgb(239,249,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["linear"],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-service-bicycle",type:"line","source-layer":"streets",filter:["all",["==","kind","service"],["==","bicycle","designated"],["==","tunnel",!0]],paint:{"line-color":"rgb(247,247,247)"},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-livingstreet-bicycle",type:"line","source-layer":"streets",filter:["all",["==","kind","living_street"],["==","bicycle","designated"],["==","tunnel",!0]],paint:{"line-color":"rgb(239,249,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["linear"],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-residential-bicycle",type:"line","source-layer":"streets",filter:["all",["==","kind","residential"],["==","bicycle","designated"],["==","tunnel",!0]],paint:{"line-color":"rgb(239,249,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["linear"],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-unclassified-bicycle",type:"line","source-layer":"streets",filter:["all",["==","kind","unclassified"],["==","bicycle","designated"],["==","tunnel",!0]],paint:{"line-color":"rgb(239,249,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["linear"],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-tertiary-link",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","tertiary"],["==","link",!0]],paint:{"line-color":"rgb(247,247,247)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["linear"],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-secondary-link",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","secondary"],["==","link",!0]],paint:{"line-color":"rgb(255,240,179)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,12,20,38]},layout:{"line-join":"round","line-cap":"butt"},minzoom:13},{source:"vector_map",id:"tunnel-street-primary-link",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","primary"],["==","link",!0]],paint:{"line-color":"rgb(255,240,179)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,12,20,38]},layout:{"line-join":"round","line-cap":"butt"},minzoom:13},{source:"vector_map",id:"tunnel-street-trunk-link",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","trunk"],["==","link",!0]],paint:{"line-color":"rgb(255,240,179)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,12,20,38]},layout:{"line-join":"round","line-cap":"butt"},minzoom:13},{source:"vector_map",id:"tunnel-street-motorway-link",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","motorway"],["==","link",!0]],paint:{"line-color":"rgb(255,209,148)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,12,20,38]},layout:{"line-join":"round","line-cap":"butt"},minzoom:12},{source:"vector_map",id:"tunnel-street-tertiary",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","tertiary"],["!=","link",!0]],paint:{"line-color":"rgb(247,247,247)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["linear"],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"tunnel-street-secondary",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","secondary"],["!=","link",!0]],paint:{"line-color":"rgb(255,240,179)","line-width":["interpolate",["exponential",1.75],["zoom"],11,1,14,4,16,6,18,28,19,64,20,130],"line-opacity":["interpolate",["exponential",1.75],["zoom"],11,0,12,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"tunnel-street-primary",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","primary"],["!=","link",!0]],paint:{"line-color":"rgb(255,240,179)","line-width":["interpolate",["exponential",1.75],["zoom"],8,0,9,2,10,3,14,5,16,10,18,34,19,70,20,140],"line-opacity":["interpolate",["exponential",1.75],["zoom"],8,0,9,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"tunnel-street-trunk",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","trunk"],["!=","link",!0]],paint:{"line-color":"rgb(255,240,179)","line-width":["interpolate",["exponential",1.75],["zoom"],7,0,8,1,10,3,14,5,16,10,18,34,19,70,20,140],"line-opacity":["interpolate",["exponential",1.75],["zoom"],7,0,8,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"tunnel-street-motorway",type:"line","source-layer":"streets",filter:["all",["==","tunnel",!0],["in","kind","motorway"],["!=","link",!0]],paint:{"line-color":"rgb(255,209,148)","line-width":["interpolate",["exponential",1.75],["zoom"],5,0,6,1,10,4,14,4,16,12,18,36,19,80,20,160],"line-opacity":["interpolate",["exponential",1.75],["zoom"],5,0,6,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"tunnel-transport-monorail:outline",type:"line","source-layer":"streets",filter:["all",["in","kind","monorail"],["==","tunnel",!0]],minzoom:15,paint:{"line-color":"rgb(177,187,196)","line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,5,18,7,20,20],"line-dasharray":[.1,.5]}},{source:"vector_map",id:"bridge",type:"fill","source-layer":"bridges",paint:{"fill-color":"rgb(244,239,233)","fill-antialias":!0,"fill-opacity":.8}},{source:"vector_map",id:"street-pedestrian-zone",type:"fill","source-layer":"street_polygons",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["==","kind","pedestrian"]],paint:{"fill-color":"rgba(251,235,255,0.25)","fill-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1,14,0,15,1]}},{source:"vector_map",id:"way-footway:outline",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","footway"]],layout:{"line-cap":"round"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,5,18,7,19,12,20,22],"line-color":"rgb(226,212,230)"},minzoom:15},{source:"vector_map",id:"way-steps:outline",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","steps"]],layout:{"line-cap":"round"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,5,18,7,19,12,20,22],"line-color":"rgb(226,212,230)"},minzoom:15},{source:"vector_map",id:"way-path:outline",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","path"]],layout:{"line-cap":"round"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,5,18,7,19,12,20,22],"line-color":"rgb(226,212,230)"},minzoom:15},{source:"vector_map",id:"way-cycleway:outline",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","cycleway"]],layout:{"line-cap":"round"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,5,18,7,19,12,20,22],"line-color":"rgb(215,224,230)"},minzoom:15},{source:"vector_map",id:"street-track:outline",type:"line","source-layer":"streets",filter:["all",["==","kind","track"],["!=","bridge",!0],["!=","tunnel",!0]],paint:{"line-color":"rgb(207,205,202)","line-width":["interpolate",["exponential",1.75],["zoom"],14,2,16,4,18,18,19,48,20,96],"line-opacity":["interpolate",["exponential",1.75],["zoom"],14,0,15,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-pedestrian:outline",type:"line","source-layer":"streets",filter:["all",["==","kind","pedestrian"],["!=","bridge",!0],["!=","tunnel",!0]],paint:{"line-color":"rgb(207,205,202)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,6,18,26,19,64,20,128],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-service:outline",type:"line","source-layer":"streets",filter:["all",["==","kind","service"],["!=","bridge",!0],["!=","tunnel",!0]],paint:{"line-color":"rgb(221,220,218)","line-width":["interpolate",["exponential",1.75],["zoom"],14,1,16,3,18,12,19,32,20,48],"line-opacity":["interpolate",["exponential",1.75],["zoom"],15,0,16,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-livingstreet:outline",type:"line","source-layer":"streets",filter:["all",["==","kind","living_street"],["!=","bridge",!0],["!=","tunnel",!0]],paint:{"line-color":"rgb(207,205,202)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,6,18,26,19,64,20,128],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-residential:outline",type:"line","source-layer":"streets",filter:["all",["==","kind","residential"],["!=","bridge",!0],["!=","tunnel",!0]],paint:{"line-color":"rgb(207,205,202)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,6,18,26,19,64,20,128],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-unclassified:outline",type:"line","source-layer":"streets",filter:["all",["==","kind","unclassified"],["!=","bridge",!0],["!=","tunnel",!0]],paint:{"line-color":"rgb(207,205,202)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,6,18,26,19,64,20,128],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-tertiary-link:outline",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","tertiary"],["==","link",!0]],paint:{"line-color":"rgb(207,205,202)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,6,18,26,19,64,20,128],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-secondary-link:outline",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","secondary"],["==","link",!0]],paint:{"line-color":"rgb(233,172,119)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,7,18,14,20,40]},layout:{"line-join":"round","line-cap":"round"},minzoom:13},{source:"vector_map",id:"street-primary-link:outline",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","primary"],["==","link",!0]],paint:{"line-color":"rgb(233,172,119)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,7,18,14,20,40]},layout:{"line-join":"round","line-cap":"round"},minzoom:13},{source:"vector_map",id:"street-trunk-link:outline",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","trunk"],["==","link",!0]],paint:{"line-color":"rgb(233,172,119)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,7,18,14,20,40]},layout:{"line-join":"round","line-cap":"round"},minzoom:13},{source:"vector_map",id:"street-motorway-link:outline",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","motorway"],["==","link",!0]],paint:{"line-color":"rgb(233,172,119)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,7,18,14,20,40]},layout:{"line-join":"round","line-cap":"round"},minzoom:12},{source:"vector_map",id:"street-tertiary:outline",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","tertiary"],["!=","link",!0]],paint:{"line-color":"rgb(207,205,202)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,6,18,26,19,64,20,128],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-secondary:outline",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","secondary"],["!=","link",!0]],paint:{"line-color":"rgb(233,172,119)","line-width":["interpolate",["exponential",1.75],["zoom"],11,2,14,5,16,8,18,30,19,68,20,138],"line-opacity":["interpolate",["exponential",1.75],["zoom"],11,0,12,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-primary:outline",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","primary"],["!=","link",!0]],paint:{"line-color":"rgb(233,172,119)","line-width":["interpolate",["exponential",1.75],["zoom"],8,0,9,1,10,4,14,6,16,12,18,36,19,74,20,144]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-trunk:outline",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","trunk"],["!=","link",!0]],paint:{"line-color":"rgb(233,172,119)","line-width":["interpolate",["exponential",1.75],["zoom"],7,0,8,2,10,4,14,6,16,12,18,36,19,74,20,144]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-motorway:outline",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","motorway"],["!=","link",!0]],paint:{"line-color":"rgb(233,172,119)","line-width":["interpolate",["exponential",1.75],["zoom"],5,0,6,2,10,5,14,5,16,14,18,38,19,84,20,168]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"way-footway",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","footway"]],layout:{"line-cap":"round"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,4,18,6,19,10,20,20],"line-color":"rgb(251,235,255)"},minzoom:15},{source:"vector_map",id:"way-steps",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","steps"]],layout:{"line-cap":"round"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,4,18,6,19,10,20,20],"line-color":"rgb(251,235,255)"},minzoom:15},{source:"vector_map",id:"way-path",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","path"]],layout:{"line-cap":"round"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,4,18,6,19,10,20,20],"line-color":"rgb(251,235,255)"},minzoom:15},{source:"vector_map",id:"way-cycleway",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","cycleway"]],layout:{"line-cap":"round"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,4,18,6,19,10,20,20],"line-color":"rgb(239,249,255)"},minzoom:15},{source:"vector_map",id:"street-track",type:"line","source-layer":"streets",filter:["all",["==","kind","track"],["!=","bridge",!0],["!=","tunnel",!0]],paint:{"line-color":"rgb(255,255,255)","line-width":["interpolate",["exponential",1.75],["zoom"],14,1,16,3,18,16,19,44,20,88],"line-opacity":["interpolate",["exponential",1.75],["zoom"],14,0,15,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-pedestrian",type:"line","source-layer":"streets",filter:["all",["==","kind","pedestrian"],["!=","bridge",!0],["!=","tunnel",!0]],paint:{"line-color":"rgb(251,235,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,0,14,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-service",type:"line","source-layer":"streets",filter:["all",["==","kind","service"],["!=","bridge",!0],["!=","tunnel",!0]],paint:{"line-color":"rgb(247,247,247)","line-width":["interpolate",["exponential",1.75],["zoom"],14,1,16,2,18,10,19,28,20,40],"line-opacity":["interpolate",["exponential",1.75],["zoom"],15,0,16,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-livingstreet",type:"line","source-layer":"streets",filter:["all",["==","kind","living_street"],["!=","bridge",!0],["!=","tunnel",!0]],paint:{"line-color":"rgb(255,255,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-residential",type:"line","source-layer":"streets",filter:["all",["==","kind","residential"],["!=","bridge",!0],["!=","tunnel",!0]],paint:{"line-color":"rgb(255,255,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-unclassified",type:"line","source-layer":"streets",filter:["all",["==","kind","unclassified"],["!=","bridge",!0],["!=","tunnel",!0]],paint:{"line-color":"rgb(255,255,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-track-bicycle",type:"line","source-layer":"streets",filter:["all",["==","kind","track"],["==","bicycle","designated"],["!=","bridge",!0],["!=","tunnel",!0]],paint:{"line-color":"rgb(255,255,255)"},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-pedestrian-bicycle",type:"line","source-layer":"streets",filter:["all",["==","kind","pedestrian"],["==","bicycle","designated"],["!=","bridge",!0],["!=","tunnel",!0]],paint:{"line-color":"rgb(239,249,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-service-bicycle",type:"line","source-layer":"streets",filter:["all",["==","kind","service"],["==","bicycle","designated"],["!=","bridge",!0],["!=","tunnel",!0]],paint:{"line-color":"rgb(255,255,255)"},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-livingstreet-bicycle",type:"line","source-layer":"streets",filter:["all",["==","kind","living_street"],["==","bicycle","designated"],["!=","bridge",!0],["!=","tunnel",!0]],paint:{"line-color":"rgb(239,249,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-residential-bicycle",type:"line","source-layer":"streets",filter:["all",["==","kind","residential"],["==","bicycle","designated"],["!=","bridge",!0],["!=","tunnel",!0]],paint:{"line-color":"rgb(239,249,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-unclassified-bicycle",type:"line","source-layer":"streets",filter:["all",["==","kind","unclassified"],["==","bicycle","designated"],["!=","bridge",!0],["!=","tunnel",!0]],paint:{"line-color":"rgb(239,249,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-tertiary-link",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","tertiary"],["==","link",!0]],paint:{"line-color":"rgb(255,255,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-secondary-link",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","secondary"],["==","link",!0]],paint:{"line-color":"rgb(255,238,170)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,12,20,38]},layout:{"line-join":"round","line-cap":"round"},minzoom:13},{source:"vector_map",id:"street-primary-link",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","primary"],["==","link",!0]],paint:{"line-color":"rgb(255,238,170)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,12,20,38]},layout:{"line-join":"round","line-cap":"round"},minzoom:13},{source:"vector_map",id:"street-trunk-link",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","trunk"],["==","link",!0]],paint:{"line-color":"rgb(255,238,170)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,12,20,38]},layout:{"line-join":"round","line-cap":"round"},minzoom:13},{source:"vector_map",id:"street-motorway-link",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","motorway"],["==","link",!0]],paint:{"line-color":"rgb(255,204,136)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,12,20,38]},layout:{"line-join":"round","line-cap":"round"},minzoom:12},{source:"vector_map",id:"street-tertiary",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","tertiary"],["!=","link",!0]],paint:{"line-color":"rgb(255,255,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-secondary",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","secondary"],["!=","link",!0]],paint:{"line-color":"rgb(255,238,170)","line-width":["interpolate",["exponential",1.75],["zoom"],11,1,14,4,16,6,18,28,19,64,20,130],"line-opacity":["interpolate",["exponential",1.75],["zoom"],11,0,12,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-primary",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","primary"],["!=","link",!0]],paint:{"line-color":"rgb(255,238,170)","line-width":["interpolate",["exponential",1.75],["zoom"],8,0,9,2,10,3,14,5,16,10,18,34,19,70,20,140],"line-opacity":["interpolate",["exponential",1.75],["zoom"],8,0,9,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-trunk",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","trunk"],["!=","link",!0]],paint:{"line-color":"rgb(255,238,170)","line-width":["interpolate",["exponential",1.75],["zoom"],7,0,8,1,10,3,14,5,16,10,18,34,19,70,20,140],"line-opacity":["interpolate",["exponential",1.75],["zoom"],7,0,8,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"street-motorway",type:"line","source-layer":"streets",filter:["all",["!=","bridge",!0],["!=","tunnel",!0],["in","kind","motorway"],["!=","link",!0]],paint:{"line-color":"rgb(255,204,136)","line-width":["interpolate",["exponential",1.75],["zoom"],5,0,6,1,10,4,14,4,16,12,18,36,19,80,20,160],"line-opacity":["interpolate",["exponential",1.75],["zoom"],5,0,6,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"bridge-way-footway:bridge",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","footway"]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":"rgb(244,239,233)","line-opacity":.5,"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,7,18,10,19,17,20,31]},minzoom:15},{source:"vector_map",id:"bridge-way-steps:bridge",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","steps"]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":"rgb(244,239,233)","line-opacity":.5,"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,7,18,10,19,17,20,31]},minzoom:15},{source:"vector_map",id:"bridge-way-path:bridge",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","path"]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":"rgb(244,239,233)","line-opacity":.5,"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,7,18,10,19,17,20,31]},minzoom:15},{source:"vector_map",id:"bridge-way-cycleway:bridge",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","cycleway"]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":"rgb(244,239,233)","line-opacity":.5,"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,7,18,10,19,17,20,31]},minzoom:15},{source:"vector_map",id:"bridge-street-track:bridge",type:"line","source-layer":"streets",filter:["all",["==","kind","track"],["==","bridge",!0]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":"rgb(244,239,233)","line-opacity":["interpolate",["exponential",1.75],["zoom"],14,0,15,1],"line-width":["interpolate",["exponential",1.75],["zoom"],14,3,16,6,18,25,19,67,20,134]}},{source:"vector_map",id:"bridge-street-pedestrian:bridge",type:"line","source-layer":"streets",filter:["all",["==","kind","pedestrian"],["==","bridge",!0]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":"rgb(244,239,233)","line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1],"line-width":["interpolate",["exponential",1.75],["zoom"],12,3,14,4,16,8,18,36,19,90,20,179]}},{source:"vector_map",id:"bridge-street-service:bridge",type:"line","source-layer":"streets",filter:["all",["==","kind","service"],["==","bridge",!0]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":"rgb(244,239,233)","line-opacity":["interpolate",["exponential",1.75],["zoom"],14,0,15,1],"line-width":["interpolate",["exponential",1.75],["zoom"],14,3,16,6,18,25,19,67,20,134]}},{source:"vector_map",id:"bridge-street-livingstreet:bridge",type:"line","source-layer":"streets",filter:["all",["==","kind","living_street"],["==","bridge",!0]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":"rgb(244,239,233)","line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1],"line-width":["interpolate",["exponential",1.75],["zoom"],12,3,14,4,16,8,18,36,19,90,20,179]}},{source:"vector_map",id:"bridge-street-residential:bridge",type:"line","source-layer":"streets",filter:["all",["==","kind","residential"],["==","bridge",!0]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":"rgb(244,239,233)","line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1],"line-width":["interpolate",["exponential",1.75],["zoom"],12,3,14,4,16,8,18,36,19,90,20,179]}},{source:"vector_map",id:"bridge-street-unclassified:bridge",type:"line","source-layer":"streets",filter:["all",["==","kind","unclassified"],["==","bridge",!0]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":"rgb(244,239,233)","line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1],"line-width":["interpolate",["exponential",1.75],["zoom"],12,3,14,4,16,8,18,36,19,90,20,179]}},{source:"vector_map",id:"bridge-street-tertiary-link:bridge",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","tertiary"],["==","link",!0]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":"rgb(244,239,233)","line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1],"line-width":["interpolate",["exponential",1.75],["zoom"],12,3,14,4,16,8,18,36,19,90,20,179]}},{source:"vector_map",id:"bridge-street-secondary-link:bridge",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","secondary"],["==","link",!0]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":"rgb(244,239,233)","line-opacity":.5,"line-width":["interpolate",["exponential",1.75],["zoom"],12,3,14,4,16,10,18,20,20,56]},minzoom:13},{source:"vector_map",id:"bridge-street-primary-link:bridge",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","primary"],["==","link",!0]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":"rgb(244,239,233)","line-opacity":.5,"line-width":["interpolate",["exponential",1.75],["zoom"],12,3,14,4,16,10,18,20,20,56]},minzoom:13},{source:"vector_map",id:"bridge-street-trunk-link:bridge",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","trunk"],["==","link",!0]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":"rgb(244,239,233)","line-opacity":.5,"line-width":["interpolate",["exponential",1.75],["zoom"],12,3,14,4,16,10,18,20,20,56]},minzoom:13},{source:"vector_map",id:"bridge-street-motorway-link:bridge",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","motorway"],["==","link",!0]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":"rgb(244,239,233)","line-opacity":.5,"line-width":["interpolate",["exponential",1.75],["zoom"],12,3,14,4,16,10,18,20,20,56]},minzoom:12},{source:"vector_map",id:"bridge-street-tertiary:bridge",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","tertiary"],["!=","link",!0]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":"rgb(244,239,233)","line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1],"line-width":["interpolate",["exponential",1.75],["zoom"],12,3,14,4,16,8,18,36,19,90,20,179]}},{source:"vector_map",id:"bridge-street-secondary:bridge",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","secondary"],["!=","link",!0]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":"rgb(244,239,233)","line-opacity":["interpolate",["exponential",1.75],["zoom"],11,0,12,1],"line-width":["interpolate",["exponential",1.75],["zoom"],11,3,14,7,16,11,18,42,19,95,20,193]}},{source:"vector_map",id:"bridge-street-primary:bridge",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","primary"],["!=","link",!0]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":"rgb(244,239,233)","line-opacity":.5,"line-width":["interpolate",["exponential",1.75],["zoom"],8,0,9,1,10,6,14,8,16,17,18,50,19,104,20,202]}},{source:"vector_map",id:"bridge-street-trunk:bridge",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","trunk"],["!=","link",!0]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":"rgb(244,239,233)","line-opacity":.5,"line-width":["interpolate",["exponential",1.75],["zoom"],7,0,8,3,10,6,14,8,16,17,18,50,19,104,20,202]}},{source:"vector_map",id:"bridge-street-motorway:bridge",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","motorway"],["!=","link",!0]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":"rgb(244,239,233)","line-opacity":.5,"line-width":["interpolate",["exponential",1.75],["zoom"],5,0,6,3,10,7,14,7,16,20,18,53,19,118,20,235]}},{source:"vector_map",id:"bridge-street-pedestrian-zone",type:"fill","source-layer":"street_polygons",filter:["all",["==","bridge",!0],["==","kind","pedestrian"]],paint:{"fill-color":"rgb(255,255,255)","fill-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]}},{source:"vector_map",id:"bridge-way-footway:outline",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","footway"]],layout:{"line-cap":"butt"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,5,18,7,19,12,20,22],"line-color":"rgb(226,212,230)"},minzoom:15},{source:"vector_map",id:"bridge-way-steps:outline",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","steps"]],layout:{"line-cap":"butt"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,5,18,7,19,12,20,22],"line-color":"rgb(226,212,230)"},minzoom:15},{source:"vector_map",id:"bridge-way-path:outline",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","path"]],layout:{"line-cap":"butt"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,5,18,7,19,12,20,22],"line-color":"rgb(226,212,230)"},minzoom:15},{source:"vector_map",id:"bridge-way-cycleway:outline",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","cycleway"]],layout:{"line-cap":"butt"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,5,18,7,19,12,20,22],"line-color":"rgb(215,224,230)"},minzoom:15},{source:"vector_map",id:"bridge-street-track:outline",type:"line","source-layer":"streets",filter:["all",["==","kind","track"],["==","bridge",!0]],paint:{"line-color":"rgb(217,217,217)","line-width":["interpolate",["exponential",1.75],["zoom"],14,2,16,4,18,18,19,48,20,96],"line-opacity":["interpolate",["exponential",1.75],["zoom"],14,0,15,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-pedestrian:outline",type:"line","source-layer":"streets",filter:["all",["==","kind","pedestrian"],["==","bridge",!0]],paint:{"line-color":"rgb(217,217,217)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,6,18,26,19,64,20,128],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-service:outline",type:"line","source-layer":"streets",filter:["all",["==","kind","service"],["==","bridge",!0]],paint:{"line-color":"rgb(221,220,218)","line-width":["interpolate",["exponential",1.75],["zoom"],14,1,16,3,18,12,19,32,20,48],"line-opacity":["interpolate",["exponential",1.75],["zoom"],15,0,16,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-livingstreet:outline",type:"line","source-layer":"streets",filter:["all",["==","kind","living_street"],["==","bridge",!0]],paint:{"line-color":"rgb(217,217,217)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,6,18,26,19,64,20,128],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-residential:outline",type:"line","source-layer":"streets",filter:["all",["==","kind","residential"],["==","bridge",!0]],paint:{"line-color":"rgb(217,217,217)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,6,18,26,19,64,20,128],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-unclassified:outline",type:"line","source-layer":"streets",filter:["all",["==","kind","unclassified"],["==","bridge",!0]],paint:{"line-color":"rgb(217,217,217)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,6,18,26,19,64,20,128],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-tertiary-link:outline",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","tertiary"],["==","link",!0]],paint:{"line-color":"rgb(217,217,217)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,6,18,26,19,64,20,128],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-secondary-link:outline",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","secondary"],["==","link",!0]],paint:{"line-color":"rgb(233,172,119)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,7,18,14,20,40]},layout:{"line-join":"round","line-cap":"butt"},minzoom:13},{source:"vector_map",id:"bridge-street-primary-link:outline",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","primary"],["==","link",!0]],paint:{"line-color":"rgb(233,172,119)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,7,18,14,20,40]},layout:{"line-join":"round","line-cap":"butt"},minzoom:13},{source:"vector_map",id:"bridge-street-trunk-link:outline",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","trunk"],["==","link",!0]],paint:{"line-color":"rgb(233,172,119)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,7,18,14,20,40]},layout:{"line-join":"round","line-cap":"butt"},minzoom:13},{source:"vector_map",id:"bridge-street-motorway-link:outline",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","motorway"],["==","link",!0]],paint:{"line-color":"rgb(233,172,119)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,7,18,14,20,40]},layout:{"line-join":"round","line-cap":"butt"},minzoom:12},{source:"vector_map",id:"bridge-street-tertiary:outline",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","tertiary"],["!=","link",!0]],paint:{"line-color":"rgb(217,217,217)","line-width":["interpolate",["exponential",1.75],["zoom"],12,2,14,3,16,6,18,26,19,64,20,128],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-secondary:outline",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","secondary"],["!=","link",!0]],paint:{"line-color":"rgb(233,172,119)","line-width":["interpolate",["exponential",1.75],["zoom"],11,2,14,5,16,8,18,30,19,68,20,138],"line-opacity":["interpolate",["exponential",1.75],["zoom"],11,0,12,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-primary:outline",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","primary"],["!=","link",!0]],paint:{"line-color":"rgb(233,172,119)","line-width":["interpolate",["exponential",1.75],["zoom"],8,0,9,1,10,4,14,6,16,12,18,36,19,74,20,144]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-trunk:outline",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","trunk"],["!=","link",!0]],paint:{"line-color":"rgb(233,172,119)","line-width":["interpolate",["exponential",1.75],["zoom"],7,0,8,2,10,4,14,6,16,12,18,36,19,74,20,144]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-motorway:outline",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","motorway"],["!=","link",!0]],paint:{"line-color":"rgb(233,172,119)","line-width":["interpolate",["exponential",1.75],["zoom"],5,0,6,2,10,5,14,5,16,14,18,38,19,84,20,168]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-way-footway",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","footway"]],layout:{"line-cap":"butt"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,4,18,6,19,10,20,20],"line-color":"rgb(251,235,255)"},minzoom:15},{source:"vector_map",id:"bridge-way-steps",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","steps"]],layout:{"line-cap":"butt"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,4,18,6,19,10,20,20],"line-color":"rgb(251,235,255)"},minzoom:15},{source:"vector_map",id:"bridge-way-path",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","path"]],layout:{"line-cap":"butt"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,4,18,6,19,10,20,20],"line-color":"rgb(251,235,255)"},minzoom:15},{source:"vector_map",id:"bridge-way-cycleway",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","cycleway"]],layout:{"line-cap":"butt"},paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],15,0,16,4,18,6,19,10,20,20],"line-color":"rgb(239,249,255)"},minzoom:15},{source:"vector_map",id:"bridge-street-track",type:"line","source-layer":"streets",filter:["all",["==","kind","track"],["==","bridge",!0]],paint:{"line-color":"rgb(255,255,255)","line-width":["interpolate",["exponential",1.75],["zoom"],14,1,16,3,18,16,19,44,20,88],"line-opacity":["interpolate",["exponential",1.75],["zoom"],14,0,15,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-pedestrian",type:"line","source-layer":"streets",filter:["all",["==","kind","pedestrian"],["==","bridge",!0]],paint:{"line-color":"rgb(255,255,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-service",type:"line","source-layer":"streets",filter:["all",["==","kind","service"],["==","bridge",!0]],paint:{"line-color":"rgb(247,247,247)","line-width":["interpolate",["exponential",1.75],["zoom"],14,1,16,2,18,10,19,28,20,40],"line-opacity":["interpolate",["exponential",1.75],["zoom"],15,0,16,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-livingstreet",type:"line","source-layer":"streets",filter:["all",["==","kind","living_street"],["==","bridge",!0]],paint:{"line-color":"rgb(255,255,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-residential",type:"line","source-layer":"streets",filter:["all",["==","kind","residential"],["==","bridge",!0]],paint:{"line-color":"rgb(255,255,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-unclassified",type:"line","source-layer":"streets",filter:["all",["==","kind","unclassified"],["==","bridge",!0]],paint:{"line-color":"rgb(255,255,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-track-bicycle",type:"line","source-layer":"streets",filter:["all",["==","kind","track"],["==","bicycle","designated"],["==","bridge",!0]],paint:{"line-color":"rgb(255,255,255)"},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-pedestrian-bicycle",type:"line","source-layer":"streets",filter:["all",["==","kind","pedestrian"],["==","bicycle","designated"],["==","bridge",!0]],paint:{"line-color":"rgb(239,249,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"bridge-street-service-bicycle",type:"line","source-layer":"streets",filter:["all",["==","kind","service"],["==","bicycle","designated"],["==","bridge",!0]],paint:{"line-color":"rgb(255,255,255)"},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-livingstreet-bicycle",type:"line","source-layer":"streets",filter:["all",["==","kind","living_street"],["==","bicycle","designated"],["==","bridge",!0]],paint:{"line-color":"rgb(239,249,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"bridge-street-residential-bicycle",type:"line","source-layer":"streets",filter:["all",["==","kind","residential"],["==","bicycle","designated"],["==","bridge",!0]],paint:{"line-color":"rgb(239,249,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"bridge-street-unclassified-bicycle",type:"line","source-layer":"streets",filter:["all",["==","kind","unclassified"],["==","bicycle","designated"],["==","bridge",!0]],paint:{"line-color":"rgb(239,249,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"round"}},{source:"vector_map",id:"bridge-street-tertiary-link",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","tertiary"],["==","link",!0]],paint:{"line-color":"rgb(255,255,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-secondary-link",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","secondary"],["==","link",!0]],paint:{"line-color":"rgb(255,238,170)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,12,20,38]},layout:{"line-join":"round","line-cap":"butt"},minzoom:13},{source:"vector_map",id:"bridge-street-primary-link",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","primary"],["==","link",!0]],paint:{"line-color":"rgb(255,238,170)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,12,20,38]},layout:{"line-join":"round","line-cap":"butt"},minzoom:13},{source:"vector_map",id:"bridge-street-trunk-link",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","trunk"],["==","link",!0]],paint:{"line-color":"rgb(255,238,170)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,12,20,38]},layout:{"line-join":"round","line-cap":"butt"},minzoom:13},{source:"vector_map",id:"bridge-street-motorway-link",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","motorway"],["==","link",!0]],paint:{"line-color":"rgb(255,204,136)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,12,20,38]},layout:{"line-join":"round","line-cap":"butt"},minzoom:12},{source:"vector_map",id:"bridge-street-tertiary",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","tertiary"],["!=","link",!0]],paint:{"line-color":"rgb(255,255,255)","line-width":["interpolate",["exponential",1.75],["zoom"],12,1,14,2,16,5,18,24,19,60,20,120],"line-opacity":["interpolate",["exponential",1.75],["zoom"],12,0,13,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-secondary",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","secondary"],["!=","link",!0]],paint:{"line-color":"rgb(255,238,170)","line-width":["interpolate",["exponential",1.75],["zoom"],11,1,14,4,16,6,18,28,19,64,20,130],"line-opacity":["interpolate",["exponential",1.75],["zoom"],11,0,12,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-primary",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","primary"],["!=","link",!0]],paint:{"line-color":"rgb(255,238,170)","line-width":["interpolate",["exponential",1.75],["zoom"],8,0,9,2,10,3,14,5,16,10,18,34,19,70,20,140],"line-opacity":["interpolate",["exponential",1.75],["zoom"],8,0,9,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-trunk",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","trunk"],["!=","link",!0]],paint:{"line-color":"rgb(255,238,170)","line-width":["interpolate",["exponential",1.75],["zoom"],7,0,8,1,10,3,14,5,16,10,18,34,19,70,20,140],"line-opacity":["interpolate",["exponential",1.75],["zoom"],7,0,8,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"bridge-street-motorway",type:"line","source-layer":"streets",filter:["all",["==","bridge",!0],["in","kind","motorway"],["!=","link",!0]],paint:{"line-color":"rgb(255,204,136)","line-width":["interpolate",["exponential",1.75],["zoom"],5,0,6,1,10,4,14,4,16,12,18,36,19,80,20,160],"line-opacity":["interpolate",["exponential",1.75],["zoom"],5,0,6,1]},layout:{"line-join":"round","line-cap":"butt"}},{source:"vector_map",id:"poi-amenity",type:"symbol","source-layer":"pois",filter:["to-boolean",["get","amenity"]],minzoom:16,layout:{"symbol-placement":"point","icon-optional":!0,"text-font":["Noto Sans Regular"],"icon-image":["match",["get","amenity"],"arts_centre","art_gallery_11","atm","bank_11","bank","bank_11","bar","bar_11","bench","picnic_site_11","bicycle_rental","bicycle_rental_11","biergarten","beergarden_11","cafe","cafe_11","car_rental","car_11","car_sharing","car_11","car_wash","car_11","cinema","cinema_11","college","college_11","community_centre","information","dentist","dentist_11","doctors","doctor_11","dog_park","dog_park_11","drinking_water","drinking_water_11","embassy","embassy_11","fast_food","fast_food_11","fire_station","fire_station_11","fountain","fountain_11","grave_yard","cemetery_11","hospital","hospital_11","hunting_stand","huntingstand_11","library","library_11","marketplace","marketplace_11","nightclub","bar_11","nursing_home","nursinghome_11","pharmacy","pharmacy_11","place_of_worship","place_of_worship_11","playground","playground_11","police","police","post_box_11","postbox","post_office_11","post_11","prison","prison_11","pub","beer_11","recycling","recycling_11","restaurant","restaurant_11","school","school_11","shelter","shelter_11","telephone","telephone_11","theatre","theatre_11","toilets","toilets_11","townhall","town_hall_11","vending_machine","vendingmachine_11","veterinary","veterinary_11","waste_basket","waste_basket",""]},paint:{"icon-opacity":["interpolate",["exponential",1.75],["zoom"],13,0,15,1],"text-opacity":["interpolate",["exponential",1.75],["zoom"],13,0,15,.4],"icon-color":"rgb(85,85,85)","text-color":"rgb(85,85,85)"}},{source:"vector_map",id:"poi-leisure",type:"symbol","source-layer":"pois",filter:["to-boolean",["get","leisure"]],minzoom:16,layout:{"symbol-placement":"point","icon-optional":!0,"text-font":["Noto Sans Regular"],"icon-image":["match",["get","leisure"],"golf_course","golf","ice_rink","stadium_11","pitch","pitch","stadium","stadium_11","swimming_pool","swimming","water_park","waterpark","sports","stadium",""]},paint:{"icon-opacity":["interpolate",["exponential",1.75],["zoom"],13,0,15,1],"text-opacity":["interpolate",["exponential",1.75],["zoom"],13,0,15,.4],"icon-color":"rgb(85,85,85)","text-color":"rgb(85,85,85)"}},{source:"vector_map",id:"poi-tourism",type:"symbol","source-layer":"pois",filter:["to-boolean",["get","tourism"]],minzoom:16,layout:{"symbol-placement":"point","icon-optional":!0,"text-font":["Noto Sans Regular"],"icon-image":["match",["get","tourism"],"chalet","shelter","information","information_11","picnic_site","picnic_site","viewpoint","veiw-point_11","zoo","zoo",""]},paint:{"icon-opacity":["interpolate",["exponential",1.75],["zoom"],13,0,15,1],"text-opacity":["interpolate",["exponential",1.75],["zoom"],13,0,15,.4],"icon-color":"rgb(85,85,85)","text-color":"rgb(85,85,85)"}},{source:"vector_map",id:"poi-shop",type:"symbol","source-layer":"pois",filter:["to-boolean",["get","shop"]],minzoom:16,layout:{"symbol-placement":"point","icon-optional":!0,"text-font":["Noto Sans Regular"],"icon-image":["match",["get","shop"],"alcohol","alcohol_shop","bakery","bakery","beauty","shop_11","beverages","shop_11","books","books","butcher","butcher","chemist","shop_11","clothes","shop_11","doityourself","shop_11","dry_cleaning","drycleaning","florist","florist","furniture","furniture","garden_centre","garden_centre","general","shop_11","gift","gift","greengrocer","shop_11","hairdresser","hairdresser","hardware","hardware","jewelry","jewelry_store","kiosk","shop_11","laundry","laundry","newsagent","newsagent","optican","optician","outdoor","shop_11","shoes","shop_11","sports","shop_11","stationery","stationery","toys","shop_11","travel_agency","shop_11","video","video","shop"]},paint:{"icon-opacity":["interpolate",["exponential",1.75],["zoom"],13,0,15,1],"text-opacity":["interpolate",["exponential",1.75],["zoom"],13,0,15,.4],"icon-color":"rgb(85,85,85)","text-color":"rgb(85,85,85)"}},{source:"vector_map",id:"poi-man_made",type:"symbol","source-layer":"pois",filter:["to-boolean",["get","man_made"]],minzoom:16,layout:{"symbol-placement":"point","icon-optional":!0,"text-font":["Noto Sans Regular"],"icon-image":["match",["get","man_made"],"lighthouse","lighthouse","surveillance","surveillance","tower","observation_tower","watermill","watermill","windmill","windmill",""]},paint:{"icon-opacity":["interpolate",["exponential",1.75],["zoom"],13,0,15,1],"text-opacity":["interpolate",["exponential",1.75],["zoom"],13,0,15,.4],"icon-color":"rgb(85,85,85)","text-color":"rgb(85,85,85)"}},{source:"vector_map",id:"poi-historic",type:"symbol","source-layer":"pois",filter:["to-boolean",["get","historic"]],minzoom:16,layout:{"symbol-placement":"point","icon-optional":!0,"text-font":["Noto Sans Regular"],"icon-image":["match",["get","historic"],"artwork","artwork","castle","castle","monument","monument","wayside_shrine","shrine","historic","museum_11",""]},paint:{"icon-opacity":["interpolate",["exponential",1.75],["zoom"],13,0,15,1],"text-opacity":["interpolate",["exponential",1.75],["zoom"],13,0,15,.4],"icon-color":"rgb(85,85,85)","text-color":"rgb(85,85,85)"}},{source:"vector_map",id:"poi-emergency",type:"symbol","source-layer":"pois",filter:["to-boolean",["get","emergency"]],minzoom:16,layout:{"symbol-placement":"point","icon-optional":!0,"text-font":["Noto Sans Regular"],"icon-image":["match",["get","emergency"],"defibrillator","defibrillator","fire_hydrant","hydrant","phone","emergency_phone",""]},paint:{"icon-opacity":["interpolate",["exponential",1.75],["zoom"],13,0,15,1],"text-opacity":["interpolate",["exponential",1.75],["zoom"],13,0,15,.4],"icon-color":"rgb(85,85,85)","text-color":"rgb(85,85,85)"}},{source:"vector_map",id:"boundary-country:outline",type:"line","source-layer":"boundaries",filter:["all",["==","admin_level",2],["!=","maritime",!0],["!=","disputed",!0],["!=","coastline",!0]],paint:{"line-color":"rgb(249,245,239)","line-blur":1,"line-width":["interpolate",["exponential",1.75],["zoom"],2,0,3,2,10,8],"line-opacity":.75},layout:{"line-cap":"round","line-join":"round"}},{source:"vector_map",id:"boundary-country-disputed:outline",type:"line","source-layer":"boundaries",filter:["all",["==","admin_level",2],["==","disputed",!0],["!=","maritime",!0],["!=","coastline",!0]],paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],2,0,3,2,10,8],"line-opacity":.75,"line-color":"rgb(249,245,239)"}},{source:"vector_map",id:"boundary-state:outline",type:"line","source-layer":"boundaries",filter:["all",["==","admin_level",4],["!=","maritime",!0],["!=","disputed",!0],["!=","coastline",!0]],paint:{"line-color":"rgb(250,245,240)","line-blur":1,"line-width":["interpolate",["exponential",1.75],["zoom"],7,0,8,2,10,4],"line-opacity":.75},layout:{"line-cap":"round","line-join":"round"}},{source:"vector_map",id:"boundary-country",type:"line","source-layer":"boundaries",filter:["all",["==","admin_level",2],["!=","maritime",!0],["!=","disputed",!0],["!=","coastline",!0]],paint:{"line-color":"rgb(166,166,200)","line-width":["interpolate",["exponential",1.75],["zoom"],2,0,3,1,10,4]},layout:{"line-cap":"round","line-join":"round"}},{source:"vector_map",id:"boundary-country-disputed",type:"line","source-layer":"boundaries",filter:["all",["==","admin_level",2],["==","disputed",!0],["!=","maritime",!0],["!=","coastline",!0]],paint:{"line-width":["interpolate",["exponential",1.75],["zoom"],2,0,3,1,10,4],"line-color":"rgb(190,188,207)","line-dasharray":[2,1]},layout:{"line-cap":"square"}},{source:"vector_map",id:"boundary-state",type:"line","source-layer":"boundaries",filter:["all",["==","admin_level",4],["!=","maritime",!0],["!=","disputed",!0],["!=","coastline",!0]],paint:{"line-color":"rgb(166,166,200)","line-width":["interpolate",["exponential",1.75],["zoom"],7,0,8,1,10,2]},layout:{"line-cap":"round","line-join":"round"}},{source:"vector_map",id:"label-address-housenumber",type:"symbol","source-layer":"addresses",filter:["has","housenumber"],layout:{"text-field":"{housenumber}","text-font":["Noto Sans Regular"],"symbol-placement":"point","text-anchor":"center","text-size":["interpolate",["exponential",1.75],["zoom"],17,8,19,10]},paint:{"text-halo-color":"rgb(243,235,227)","text-halo-width":2,"text-halo-blur":1,"icon-color":"rgb(169,164,158)","text-color":"rgb(169,164,158)"},minzoom:17},{source:"vector_map",id:"label-motorway-shield",type:"symbol","source-layer":"street_labels",filter:["==","kind","motorway"],layout:{"text-field":"{ref}","text-font":["noto_sans_bold"],"symbol-placement":"line","text-anchor":"center","text-size":["interpolate",["exponential",1.75],["zoom"],14,10,18,12,20,16]},paint:{"icon-color":"rgb(255,255,255)","text-color":"rgb(255,255,255)","text-halo-color":"rgb(255,204,136)","text-halo-width":.1,"text-halo-blur":1},minzoom:14},{source:"vector_map",id:"label-street-pedestrian",type:"symbol","source-layer":"street_labels",filter:["==","kind","pedestrian"],layout:{"text-field":["case",["to-boolean",["get","name_en"]],["get","name_en"],["get","name"]],"text-font":["Noto Sans Regular"],"symbol-placement":"line","text-anchor":"center","text-size":["interpolate",["exponential",1.75],["zoom"],12,10,15,13]},paint:{"icon-color":"rgb(51,51,68)","text-color":"rgb(51,51,68)","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":2,"text-halo-blur":1},minzoom:12},{source:"vector_map",id:"label-street-livingstreet",type:"symbol","source-layer":"street_labels",filter:["==","kind","living_street"],layout:{"text-field":["case",["to-boolean",["get","name_en"]],["get","name_en"],["get","name"]],"text-font":["Noto Sans Regular"],"symbol-placement":"line","text-anchor":"center","text-size":["interpolate",["exponential",1.75],["zoom"],12,10,15,13]},paint:{"icon-color":"rgb(51,51,68)","text-color":"rgb(51,51,68)","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":2,"text-halo-blur":1},minzoom:12},{source:"vector_map",id:"label-street-residential",type:"symbol","source-layer":"street_labels",filter:["==","kind","residential"],layout:{"text-field":["case",["to-boolean",["get","name_en"]],["get","name_en"],["get","name"]],"text-font":["Noto Sans Regular"],"symbol-placement":"line","text-anchor":"center","text-size":["interpolate",["exponential",1.75],["zoom"],12,10,15,13]},paint:{"icon-color":"rgb(51,51,68)","text-color":"rgb(51,51,68)","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":2,"text-halo-blur":1},minzoom:12},{source:"vector_map",id:"label-street-unclassified",type:"symbol","source-layer":"street_labels",filter:["==","kind","unclassified"],layout:{"text-field":["case",["to-boolean",["get","name_en"]],["get","name_en"],["get","name"]],"text-font":["Noto Sans Regular"],"symbol-placement":"line","text-anchor":"center","text-size":["interpolate",["exponential",1.75],["zoom"],12,10,15,13]},paint:{"icon-color":"rgb(51,51,68)","text-color":"rgb(51,51,68)","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":2,"text-halo-blur":1},minzoom:12},{source:"vector_map",id:"label-street-tertiary",type:"symbol","source-layer":"street_labels",filter:["==","kind","tertiary"],layout:{"text-field":["case",["to-boolean",["get","name_en"]],["get","name_en"],["get","name"]],"text-font":["Noto Sans Regular"],"symbol-placement":"line","text-anchor":"center","text-size":["interpolate",["exponential",1.75],["zoom"],12,10,15,13]},paint:{"icon-color":"rgb(51,51,68)","text-color":"rgb(51,51,68)","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":2,"text-halo-blur":1},minzoom:12},{source:"vector_map",id:"label-street-secondary",type:"symbol","source-layer":"street_labels",filter:["==","kind","secondary"],layout:{"text-field":["case",["to-boolean",["get","name_en"]],["get","name_en"],["get","name"]],"text-font":["Noto Sans Regular"],"symbol-placement":"line","text-anchor":"center","text-size":["interpolate",["exponential",1.75],["zoom"],12,10,15,13]},paint:{"icon-color":"rgb(51,51,68)","text-color":"rgb(51,51,68)","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":2,"text-halo-blur":1},minzoom:12},{source:"vector_map",id:"label-street-primary",type:"symbol","source-layer":"street_labels",filter:["==","kind","primary"],layout:{"text-field":["case",["to-boolean",["get","name_en"]],["get","name_en"],["get","name"]],"text-font":["Noto Sans Regular"],"symbol-placement":"line","text-anchor":"center","text-size":["interpolate",["exponential",1.75],["zoom"],12,10,15,13]},paint:{"icon-color":"rgb(51,51,68)","text-color":"rgb(51,51,68)","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":2,"text-halo-blur":1},minzoom:12},{source:"vector_map",id:"label-street-trunk",type:"symbol","source-layer":"street_labels",filter:["==","kind","trunk"],layout:{"text-field":["case",["to-boolean",["get","name_en"]],["get","name_en"],["get","name"]],"text-font":["Noto Sans Regular"],"symbol-placement":"line","text-anchor":"center","text-size":["interpolate",["exponential",1.75],["zoom"],12,10,15,13]},paint:{"icon-color":"rgb(51,51,68)","text-color":"rgb(51,51,68)","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":2,"text-halo-blur":1},minzoom:12},{source:"vector_map",id:"label-place-neighbourhood",type:"symbol","source-layer":"place_labels",filter:["==","kind","neighbourhood"],layout:{"text-field":["case",["to-boolean",["get","name_en"]],["get","name_en"],["get","name"]],"text-font":["Noto Sans Regular"],"text-size":["interpolate",["linear"],["zoom"],14,12],"text-transform":"uppercase"},paint:{"icon-color":"rgb(40,67,73)","text-color":"rgb(40,67,73)","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":2,"text-halo-blur":1},minzoom:14},{source:"vector_map",id:"label-place-quarter",type:"symbol","source-layer":"place_labels",filter:["==","kind","quarter"],layout:{"text-field":["case",["to-boolean",["get","name_en"]],["get","name_en"],["get","name"]],"text-font":["Noto Sans Regular"],"text-size":["interpolate",["linear"],["zoom"],13,13],"text-transform":"uppercase"},paint:{"icon-color":"rgb(40,62,73)","text-color":"rgb(40,62,73)","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":2,"text-halo-blur":1},minzoom:13},{source:"vector_map",id:"label-place-suburb",type:"symbol","source-layer":"place_labels",filter:["==","kind","suburb"],layout:{"text-field":["case",["to-boolean",["get","name_en"]],["get","name_en"],["get","name"]],"text-font":["Noto Sans Regular"],"text-size":["interpolate",["exponential",1.75],["zoom"],11,11,13,14],"text-transform":"uppercase"},paint:{"icon-color":"rgb(40,57,73)","text-color":"rgb(40,57,73)","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":2,"text-halo-blur":1},minzoom:11},{source:"vector_map",id:"label-place-hamlet",type:"symbol","source-layer":"place_labels",filter:["==","kind","hamlet"],layout:{"text-field":["case",["to-boolean",["get","name_en"]],["get","name_en"],["get","name"]],"text-font":["Noto Sans Regular"],"text-size":["interpolate",["exponential",1.75],["zoom"],10,11,12,14]},paint:{"icon-color":"rgb(40,48,73)","text-color":"rgb(40,48,73)","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":2,"text-halo-blur":1},minzoom:13},{source:"vector_map",id:"label-place-village",type:"symbol","source-layer":"place_labels",filter:["==","kind","village"],layout:{"text-field":["case",["to-boolean",["get","name_en"]],["get","name_en"],["get","name"]],"text-font":["Noto Sans Regular"],"text-size":["interpolate",["exponential",1.75],["zoom"],9,11,12,14]},paint:{"icon-color":"rgb(40,48,73)","text-color":"rgb(40,48,73)","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":2,"text-halo-blur":1},minzoom:11},{source:"vector_map",id:"label-place-town",type:"symbol","source-layer":"place_labels",filter:["==","kind","town"],layout:{"text-field":["case",["to-boolean",["get","name_en"]],["get","name_en"],["get","name"]],"text-font":["Noto Sans Regular"],"text-size":["interpolate",["exponential",1.75],["zoom"],8,11,12,14]},paint:{"icon-color":"rgb(40,48,73)","text-color":"rgb(40,48,73)","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":2,"text-halo-blur":1},minzoom:9},{source:"vector_map",id:"label-boundary-state",type:"symbol","source-layer":"boundary_labels",filter:["in","admin_level",4,"4"],layout:{"text-field":["case",["to-boolean",["get","name_en"]],["get","name_en"],["get","name"]],"text-font":["Noto Sans Regular"],"text-transform":"uppercase","text-anchor":"top","text-offset":[0,.2],"text-padding":0,"text-optional":!0,"text-size":["interpolate",["exponential",1.75],["zoom"],5,8,8,12]},paint:{"icon-color":"rgb(61,61,77)","text-color":"rgb(61,61,77)","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":2,"text-halo-blur":1},minzoom:5},{source:"vector_map",id:"label-place-city",type:"symbol","source-layer":"place_labels",filter:["==","kind","city"],layout:{"text-field":["case",["to-boolean",["get","name_en"]],["get","name_en"],["get","name"]],"text-font":["Noto Sans Regular"],"text-size":["interpolate",["exponential",1.75],["zoom"],7,11,10,14]},paint:{"icon-color":"rgb(40,48,73)","text-color":"rgb(40,48,73)","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":2,"text-halo-blur":1},minzoom:7},{source:"vector_map",id:"label-boundary-country-medium",type:"symbol","source-layer":"boundary_labels",filter:["all",["in","admin_level",2,"2"],["<","way_area",9e7],[">","way_area",1e7]],layout:{"text-field":["case",["to-boolean",["get","name_en"]],["get","name_en"],["get","name"]],"text-font":["Noto Sans Regular"],"text-transform":"uppercase","text-anchor":"top","text-offset":[0,.2],"text-padding":0,"text-optional":!0,"text-size":["interpolate",["exponential",1.75],["zoom"],3,8,5,12]},paint:{"icon-color":"rgb(51,51,68)","text-color":"rgb(51,51,68)","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":2,"text-halo-blur":1},minzoom:3},{source:"vector_map",id:"label-boundary-country-large",type:"symbol","source-layer":"boundary_labels",filter:["all",["in","admin_level",2,"2"],[">=","way_area",9e7]],layout:{"text-field":["case",["to-boolean",["get","name_en"]],["get","name_en"],["get","name"]],"text-font":["Noto Sans Regular"],"text-transform":"uppercase","text-anchor":"top","text-offset":[0,.2],"text-padding":0,"text-optional":!0,"text-size":["interpolate",["exponential",1.75],["zoom"],2,8,5,13]},paint:{"icon-color":"rgb(51,51,68)","text-color":"rgb(51,51,68)","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":2,"text-halo-blur":1},minzoom:2},{source:"vector_map",id:"symbol-transit-bus",type:"symbol","source-layer":"public_transport",filter:["==","kind","bus_stop"],layout:{"text-field":["case",["to-boolean",["get","name_en"]],["get","name_en"],["get","name"]],"symbol-placement":"point","icon-keep-upright":!0,"icon-allow-overlap":!0,"icon-ignore-placement":!0,"text-font":["Noto Sans Regular"],"text-size":9,"text-allow-overlap":!0,"icon-anchor":"bottom","text-anchor":"top","icon-image":"bus"},paint:{"text-color":"rgb(102,98,106)","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":2,"text-halo-blur":1},minzoom:12},{id:"piste-freeride",type:"line",source:"vector_map","source-layer":"pistes",filter:["all",["==",["get","piste_difficulty"],"freeride"],["match",["geometry-type"],["LineString","MultiLineString"],!0,!1]],layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#e8e","line-width":3}},{id:"piste-novice",type:"line",source:"vector_map","source-layer":"pistes",filter:["all",["==",["get","piste_difficulty"],"novice"],["match",["geometry-type"],["LineString","MultiLineString"],!0,!1]],layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#6b6","line-width":5}},{id:"piste-easy",type:"line",source:"vector_map","source-layer":"pistes",filter:["==",["get","piste_difficulty"],"easy"],layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#8af","line-width":5}},{id:"piste-intermediate",type:"line",source:"vector_map","source-layer":"pistes",filter:["==",["get","piste_difficulty"],"intermediate"],layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#f44","line-width":5}},{id:"piste-advanced",type:"line",source:"vector_map","source-layer":"pistes",filter:["==",["get","piste_difficulty"],"advanced"],layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#333","line-width":5}},{id:"piste-direction-arrows",type:"symbol",source:"vector_map","source-layer":"pistes",filter:["all",["match",["geometry-type"],["LineString","MultiLineString"],!0,!1],["==",["get","piste_type"],"downhill"]],layout:{"symbol-placement":"line","symbol-spacing":8,"icon-image":"right-chevron-white","icon-rotation-alignment":"map","icon-allow-overlap":!0,"icon-ignore-placement":!1}},{id:"piste-icons-closed",type:"symbol",source:"vector_map","source-layer":"pistes",filter:["all",["match",["geometry-type"],["LineString","MultiLineString"],!0,!1],["match",["get","opening_hours"],"never",!0,!1]],layout:{"symbol-placement":"line","symbol-spacing":50,"icon-image":"no_entry_sign","icon-rotation-alignment":"viewport","icon-allow-overlap":!0,"icon-ignore-placement":!1}},{id:"piste-labels",type:"symbol",source:"vector_map","source-layer":"pistes",paint:{"text-halo-color":"white","text-halo-width":2,"text-color":"#222222","text-opacity":1},layout:{"symbol-placement":"line-center","text-size":9,"text-field":"{name}","text-font":["Noto Sans Regular"],"text-pitch-alignment":"map"}},{id:"aerialway-direction-arrows",type:"symbol",source:"vector_map","source-layer":"aerialways",filter:["all",["match",["geometry-type"],["LineString","MultiLineString"],!0,!1],["match",["get","aerialway"],["gondola","chair_lift","platter","drag_lift","rope_tow","t-bar"],!0,!1]],layout:{"symbol-placement":"line","symbol-spacing":1,"icon-image":"right-fir-black","icon-rotation-alignment":"map","icon-allow-overlap":!0,"icon-ignore-placement":!1}},{id:"aerialways",type:"line",source:"vector_map","source-layer":"aerialways",filter:["all",["match",["geometry-type"],["LineString","MultiLineString"],!0,!1],["match",["get","aerialway"],["gondola","chair_lift","platter","drag_lift","rope_tow","t-bar"],!0,!1]],paint:{"line-color":"#222222","line-width":1}},{id:"aerialway-stations",type:"symbol",source:"vector_map","source-layer":"aerialways",filter:["match",["geometry-type"],["Point"],!0,!1],layout:{"icon-image":"aerialway_station","icon-allow-overlap":!0}},{id:"aerialway-icons-gondola",type:"symbol",source:"vector_map","source-layer":"aerialways",filter:["all",["match",["geometry-type"],["LineString","MultiLineString"],!0,!1],["==",["get","aerialway"],"gondola"]],layout:{"symbol-placement":"line","symbol-spacing":75,"icon-image":"gondola","icon-rotation-alignment":"viewport","icon-allow-overlap":!0,"icon-ignore-placement":!1}},{id:"aerialway-icons-skilift",type:"symbol",source:"vector_map","source-layer":"aerialways",filter:["all",["match",["geometry-type"],["LineString","MultiLineString"],!0,!1],["==",["get","aerialway"],"chair_lift"]],layout:{"symbol-placement":"line","symbol-spacing":75,"icon-image":"skilift","icon-rotation-alignment":"viewport","icon-allow-overlap":!0,"icon-ignore-placement":!1}},{id:"aerialway-icons-platter",type:"symbol",source:"vector_map","source-layer":"aerialways",filter:["all",["match",["geometry-type"],["LineString","MultiLineString"],!0,!1],["match",["get","aerialway"],["platter","drag_lift","rope_tow","t-bar"],!0,!1]],layout:{"symbol-placement":"line","symbol-spacing":75,"icon-image":"platterlift","icon-rotation-alignment":"viewport","icon-allow-overlap":!0,"icon-ignore-placement":!1}},{id:"aerialway-icons-closed",type:"symbol",source:"vector_map","source-layer":"aerialways",filter:["all",["match",["geometry-type"],["LineString","MultiLineString"],!0,!1],["match",["get","opening_hours"],"never",!0,!1]],layout:{"symbol-placement":"line","symbol-spacing":30,"icon-image":"no_entry_sign","icon-rotation-alignment":"viewport","icon-allow-overlap":!0,"icon-ignore-placement":!1}},{id:"aerialway-labels",type:"symbol",source:"vector_map","source-layer":"aerialways",paint:{"text-halo-color":"white","text-halo-width":2,"text-color":"#222222","text-opacity":1},layout:{"symbol-placement":"line-center","text-size":9,"text-field":"{name}","text-font":["Noto Sans Regular"],"text-pitch-alignment":"map"}},{id:"toilet_icons",type:"symbol",source:"vector_map","source-layer":"toilets",layout:{"icon-image":"toilets_11","icon-size":1}}]}function k_(){return[{name:"Gudauri",position:[42.5017,44.5001],heading:13,pitch:43,zoom:12.2,bounds:[[42.43,44.4],[42.59,44.59]],subareas:[]},{name:"Bakuriani",position:[41.7239,43.5416],heading:150,pitch:35,zoom:11.66,bounds:[[41.62,43.42],[41.82,43.65]],subareas:[{name:"Didveli",position:[41.70797,43.53101],heading:-172.4,pitch:26,zoom:12.97,bounds:[[41.62,43.42],[41.82,43.65]],subareas:[]},{name:"Kohta",position:[41.74237,43.55757],heading:-150,pitch:39,zoom:13.45,bounds:[[41.62,43.42],[41.82,43.65]],subareas:[]}]},{name:"Mestia",position:[43.028,42.8292],heading:90,pitch:0,zoom:11,bounds:[[42.9,42.65],[43.16,42.99]],subareas:[{name:"Hatsvali",position:[43.03138,42.7321],heading:166.8,pitch:49,zoom:13.6,bounds:[[42.9,42.65],[43.16,42.99]],subareas:[]},{name:"Tetnuldi",position:[43.02774,42.89251],heading:92,pitch:33,zoom:12.9,bounds:[[42.9,42.65],[43.16,42.99]],subareas:[]}]},{name:"Goderzi",position:[41.62587,42.50173],heading:150,pitch:42,zoom:13.2,bounds:[[41.55,42.42],[41.7,42.7]],subareas:[]}]}function T_({onClose:T}){return pr.jsx("div",{className:"dialog-backdrop",onClick:T,children:pr.jsxs("div",{className:"dialog",onClick:D=>D.stopPropagation(),children:[pr.jsx("h2",{className:"dialog-title",children:"About"}),pr.jsxs("div",{className:"dialog-body",children:[pr.jsx("p",{children:"Georgian Ski Map â€” unofficial interactive Georgian ski resorts map."}),pr.jsx("h3",{children:"Data Sources & Credits"}),pr.jsxs("ul",{children:[pr.jsxs("li",{children:[pr.jsx("strong",{children:"Map tiles:"})," Â©"," ",pr.jsx("a",{href:"https://www.openstreetmap.org/copyright",target:"_blank",rel:"noreferrer",children:"OpenStreetMap"})," ","contributors"]}),pr.jsxs("li",{children:[pr.jsx("strong",{children:"Elevation data:"})," Â©"," ",pr.jsx("a",{href:"https://www.sentinel-hub.com/",target:"_blank",rel:"noreferrer",children:"Sentinel Hub"})," ","/ European Space Agency (ESA)"]}),pr.jsxs("li",{children:[pr.jsx("strong",{children:"Map rendering:"})," ",pr.jsx("a",{href:"https://maplibre.org/",target:"_blank",rel:"noreferrer",children:"MapLibre GL JS"})," ","(BSD-3-Clause)"]})]})]}),pr.jsxs("div",{className:"dialog-body",style:{marginTop:"1rem"},children:[pr.jsx("h3",{children:"Useful Resources"}),pr.jsxs("ul",{children:[pr.jsxs("li",{children:[pr.jsx("a",{href:"https://mta.ski/en",target:"_blank",rel:"noreferrer",children:"mta.ski"})," ","â€” Mountain Trails Agency (MTA) manages Georgian ski resorts."]}),pr.jsxs("li",{children:[pr.jsx("a",{href:"https://georailway.com/",target:"_blank",rel:"noreferrer",children:"georailway.com"})," ","â€” your navigator in Georgia's railways."]}),pr.jsxs("li",{children:[pr.jsx("a",{href:"https://marshrutka.info/",target:"_blank",rel:"noreferrer",children:"marshrutka.info"})," ","â€” find minibus (aka marsrutka) to your destination"]})]})]}),pr.jsxs("div",{className:"dialog-feedback",children:["Feedback:"," ",pr.jsx("a",{href:"https://t.me/geoskimap_bot",target:"_blank",rel:"noreferrer",children:"t.me/geoskimap_bot"})]}),pr.jsx("div",{className:"dialog-footer",children:pr.jsx("button",{className:"dialog-ok",onClick:T,children:"OK"})})]})})}function z_(){const T=Ze.useRef(null),D=Ze.useRef(null),[I]=Ze.useState(()=>k_()),[H,W]=Ey(),[ee,A]=Ze.useState(!1),[d,Se]=Ze.useState(!1),Pe=Ze.useRef(null),[Le,re]=Ze.useState(()=>I.flatMap(Ge=>[Ge,...Ge.subareas]).find(Ge=>Ge.name.toLowerCase()===H.get("resort"))?.name||I[0].name);Ze.useEffect(()=>{W({resort:Le.toLowerCase()})},[Le,I,W]),Ze.useEffect(()=>{function Ge(et){Pe.current&&!Pe.current.contains(et.target)&&A(!1)}return document.addEventListener("mousedown",Ge),()=>document.removeEventListener("mousedown",Ge)},[]);function ne(Ge){re(Ge)}return Ze.useEffect(()=>{D.current===null&&T.current&&(D.current=b_(T.current));const Ge=I.flatMap(Xe=>[Xe,...Xe.subareas]).find(Xe=>Xe.name.toLowerCase()===Le.toLowerCase()),et=D.current,je=Ge.bounds;return et.setMaxBounds([[je[0][1],je[0][0]],[je[1][1],je[1][0]]]),et.setPitch(Ge.pitch),et.setBearing(Ge.heading),et.setCenter([Ge.position[1],Ge.position[0]]),et.setZoom(Ge.zoom),()=>{D.current?.remove(),D.current=null}},[Le,I]),pr.jsxs("div",{className:"app",children:[pr.jsxs("header",{className:"header",children:[pr.jsx("img",{src:"/images/geo-ski-map-logo.svg",alt:"Georgian Ski Map",className:"logo"}),pr.jsx("select",{value:Le.toLowerCase(),onChange:Ge=>ne(Ge.target.value),className:"resort-select",children:I.flatMap(Ge=>[pr.jsx("option",{value:Ge.name.toLowerCase(),children:Ge.name},Ge.name),...Ge.subareas.map(et=>pr.jsxs("option",{value:et.name.toLowerCase(),children:["Â Â Â  ",et.name]},et.name))])}),pr.jsxs("div",{className:"menu-container",ref:Pe,children:[pr.jsx("button",{className:"menu-button",onClick:()=>A(!ee),"aria-label":"Menu",children:pr.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[pr.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),pr.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),pr.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]})}),ee&&pr.jsx("div",{className:"menu-dropdown",children:pr.jsx("button",{className:"menu-item",onClick:()=>{A(!1),Se(!0)},children:"About"})})]})]}),pr.jsx("div",{ref:T,className:"map-container"}),d&&pr.jsx(T_,{onClose:()=>Se(!1)})]})}Ny.createRoot(document.getElementById("root")).render(pr.jsx(tg.StrictMode,{children:pr.jsx(by,{children:pr.jsx(z_,{})})}));
